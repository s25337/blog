function Mx(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Ox(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var S={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zl=Symbol.for("react.element"),Rb=Symbol.for("react.portal"),_b=Symbol.for("react.fragment"),Db=Symbol.for("react.strict_mode"),Ab=Symbol.for("react.profiler"),Pb=Symbol.for("react.provider"),Ib=Symbol.for("react.context"),Lb=Symbol.for("react.forward_ref"),Mb=Symbol.for("react.suspense"),Ob=Symbol.for("react.memo"),Nb=Symbol.for("react.lazy"),im=Symbol.iterator;function Bb(e){return e===null||typeof e!="object"?null:(e=im&&e[im]||e["@@iterator"],typeof e=="function"?e:null)}var Nx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bx=Object.assign,Hx={};function Jo(e,t,r){this.props=e,this.context=t,this.refs=Hx,this.updater=r||Nx}Jo.prototype.isReactComponent={};Jo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Jo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wx(){}Wx.prototype=Jo.prototype;function Y0(e,t,r){this.props=e,this.context=t,this.refs=Hx,this.updater=r||Nx}var Q0=Y0.prototype=new Wx;Q0.constructor=Y0;Bx(Q0,Jo.prototype);Q0.isPureReactComponent=!0;var om=Array.isArray,Vx=Object.prototype.hasOwnProperty,Z0={current:null},Gx={key:!0,ref:!0,__self:!0,__source:!0};function zx(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Vx.call(t,n)&&!Gx.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:zl,type:e,key:i,ref:o,props:s,_owner:Z0.current}}function Hb(e,t){return{$$typeof:zl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function q0(e){return typeof e=="object"&&e!==null&&e.$$typeof===zl}function Wb(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var am=/\/+/g;function ud(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Wb(""+e.key):t.toString(36)}function $c(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case zl:case Rb:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+ud(o,0):n,om(s)?(r="",e!=null&&(r=e.replace(am,"$&/")+"/"),$c(s,t,r,"",function(c){return c})):s!=null&&(q0(s)&&(s=Hb(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(am,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",om(e))for(var a=0;a<e.length;a++){i=e[a];var l=n+ud(i,a);o+=$c(i,t,r,l,s)}else if(l=Bb(e),typeof l=="function")for(e=l.call(e),a=0;!(i=e.next()).done;)i=i.value,l=n+ud(i,a++),o+=$c(i,t,r,l,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function uc(e,t,r){if(e==null)return e;var n=[],s=0;return $c(e,n,"","",function(i){return t.call(r,i,s++)}),n}function Vb(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _r={current:null},Kc={transition:null},Gb={ReactCurrentDispatcher:_r,ReactCurrentBatchConfig:Kc,ReactCurrentOwner:Z0};function Ux(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:uc,forEach:function(e,t,r){uc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return uc(e,function(){t++}),t},toArray:function(e){return uc(e,function(t){return t})||[]},only:function(e){if(!q0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ze.Component=Jo;ze.Fragment=_b;ze.Profiler=Ab;ze.PureComponent=Y0;ze.StrictMode=Db;ze.Suspense=Mb;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gb;ze.act=Ux;ze.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Bx({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Z0.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)Vx.call(t,l)&&!Gx.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:zl,type:e.type,key:s,ref:i,props:n,_owner:o}};ze.createContext=function(e){return e={$$typeof:Ib,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Pb,_context:e},e.Consumer=e};ze.createElement=zx;ze.createFactory=function(e){var t=zx.bind(null,e);return t.type=e,t};ze.createRef=function(){return{current:null}};ze.forwardRef=function(e){return{$$typeof:Lb,render:e}};ze.isValidElement=q0;ze.lazy=function(e){return{$$typeof:Nb,_payload:{_status:-1,_result:e},_init:Vb}};ze.memo=function(e,t){return{$$typeof:Ob,type:e,compare:t===void 0?null:t}};ze.startTransition=function(e){var t=Kc.transition;Kc.transition={};try{e()}finally{Kc.transition=t}};ze.unstable_act=Ux;ze.useCallback=function(e,t){return _r.current.useCallback(e,t)};ze.useContext=function(e){return _r.current.useContext(e)};ze.useDebugValue=function(){};ze.useDeferredValue=function(e){return _r.current.useDeferredValue(e)};ze.useEffect=function(e,t){return _r.current.useEffect(e,t)};ze.useId=function(){return _r.current.useId()};ze.useImperativeHandle=function(e,t,r){return _r.current.useImperativeHandle(e,t,r)};ze.useInsertionEffect=function(e,t){return _r.current.useInsertionEffect(e,t)};ze.useLayoutEffect=function(e,t){return _r.current.useLayoutEffect(e,t)};ze.useMemo=function(e,t){return _r.current.useMemo(e,t)};ze.useReducer=function(e,t,r){return _r.current.useReducer(e,t,r)};ze.useRef=function(e){return _r.current.useRef(e)};ze.useState=function(e){return _r.current.useState(e)};ze.useSyncExternalStore=function(e,t,r){return _r.current.useSyncExternalStore(e,t,r)};ze.useTransition=function(){return _r.current.useTransition()};ze.version="18.3.1";(function(e){e.exports=ze})(S);const ue=Ox(S.exports),J0=Mx({__proto__:null,default:ue},[S.exports]);var ea={exports:{}},Zr={},jx={exports:{}},$x={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,H){var Q=Z.length;Z.push(H);e:for(;0<Q;){var ie=Q-1>>>1,F=Z[ie];if(0<s(F,H))Z[ie]=H,Z[Q]=F,Q=ie;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var H=Z[0],Q=Z.pop();if(Q!==H){Z[0]=Q;e:for(var ie=0,F=Z.length,W=F>>>1;ie<W;){var B=2*(ie+1)-1,V=Z[B],X=B+1,ne=Z[X];if(0>s(V,Q))X<F&&0>s(ne,V)?(Z[ie]=ne,Z[X]=Q,ie=X):(Z[ie]=V,Z[B]=Q,ie=B);else if(X<F&&0>s(ne,Q))Z[ie]=ne,Z[X]=Q,ie=X;else break e}}return H}function s(Z,H){var Q=Z.sortIndex-H.sortIndex;return Q!==0?Q:Z.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(Z){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=Z)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(c)}}function w(Z){if(g=!1,x(Z),!p)if(r(l)!==null)p=!0,se(k);else{var H=r(c);H!==null&&te(w,H.startTime-Z)}}function k(Z,H){p=!1,g&&(g=!1,v(R),R=-1),f=!0;var Q=d;try{for(x(H),h=r(l);h!==null&&(!(h.expirationTime>H)||Z&&!O());){var ie=h.callback;if(typeof ie=="function"){h.callback=null,d=h.priorityLevel;var F=ie(h.expirationTime<=H);H=e.unstable_now(),typeof F=="function"?h.callback=F:h===r(l)&&n(l),x(H)}else n(l);h=r(l)}if(h!==null)var W=!0;else{var B=r(c);B!==null&&te(w,B.startTime-H),W=!1}return W}finally{h=null,d=Q,f=!1}}var E=!1,y=null,R=-1,D=5,N=-1;function O(){return!(e.unstable_now()-N<D)}function A(){if(y!==null){var Z=e.unstable_now();N=Z;var H=!0;try{H=y(!0,Z)}finally{H?G():(E=!1,y=null)}}else E=!1}var G;if(typeof C=="function")G=function(){C(A)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,z=q.port2;q.port1.onmessage=A,G=function(){z.postMessage(null)}}else G=function(){m(A,0)};function se(Z){y=Z,E||(E=!0,G())}function te(Z,H){R=m(function(){Z(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,se(k))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Z){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var Q=d;d=H;try{return Z()}finally{d=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,H){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Q=d;d=Z;try{return H()}finally{d=Q}},e.unstable_scheduleCallback=function(Z,H,Q){var ie=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ie+Q:ie):Q=ie,Z){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=Q+F,Z={id:u++,callback:H,priorityLevel:Z,startTime:Q,expirationTime:F,sortIndex:-1},Q>ie?(Z.sortIndex=Q,t(c,Z),r(l)===null&&Z===r(c)&&(g?(v(R),R=-1):g=!0,te(w,Q-ie))):(Z.sortIndex=F,t(l,Z),p||f||(p=!0,se(k))),Z},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(Z){var H=d;return function(){var Q=d;d=H;try{return Z.apply(this,arguments)}finally{d=Q}}}})($x);(function(e){e.exports=$x})(jx);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zb=S.exports,Yr=jx.exports;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kx=new Set,ol={};function ji(e,t){Wo(e,t),Wo(e+"Capture",t)}function Wo(e,t){for(ol[e]=t,e=0;e<t.length;e++)Kx.add(t[e])}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bf=Object.prototype.hasOwnProperty,Ub=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lm={},cm={};function jb(e){return bf.call(cm,e)?!0:bf.call(lm,e)?!1:Ub.test(e)?cm[e]=!0:(lm[e]=!0,!1)}function $b(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Kb(e,t,r,n){if(t===null||typeof t>"u"||$b(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dr(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ir[e]=new Dr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ir[t]=new Dr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ir[e]=new Dr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ir[e]=new Dr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ir[e]=new Dr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ir[e]=new Dr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ir[e]=new Dr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ir[e]=new Dr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ir[e]=new Dr(e,5,!1,e.toLowerCase(),null,!1,!1)});var eg=/[\-:]([a-z])/g;function tg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eg,tg);ir[t]=new Dr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eg,tg);ir[t]=new Dr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eg,tg);ir[t]=new Dr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ir[e]=new Dr(e,1,!1,e.toLowerCase(),null,!1,!1)});ir.xlinkHref=new Dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ir[e]=new Dr(e,1,!1,e.toLowerCase(),null,!0,!0)});function rg(e,t,r,n){var s=ir.hasOwnProperty(t)?ir[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Kb(t,r,s,n)&&(r=null),n||s===null?jb(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Cs=zb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hc=Symbol.for("react.element"),co=Symbol.for("react.portal"),uo=Symbol.for("react.fragment"),ng=Symbol.for("react.strict_mode"),Ef=Symbol.for("react.profiler"),Xx=Symbol.for("react.provider"),Yx=Symbol.for("react.context"),sg=Symbol.for("react.forward_ref"),Ff=Symbol.for("react.suspense"),Tf=Symbol.for("react.suspense_list"),ig=Symbol.for("react.memo"),Ts=Symbol.for("react.lazy"),Qx=Symbol.for("react.offscreen"),um=Symbol.iterator;function ma(e){return e===null||typeof e!="object"?null:(e=um&&e[um]||e["@@iterator"],typeof e=="function"?e:null)}var Et=Object.assign,hd;function Ra(e){if(hd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);hd=t&&t[1]||""}return`
`+hd+e}var dd=!1;function fd(e,t){if(!e||dd)return"";dd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{dd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ra(e):""}function Xb(e){switch(e.tag){case 5:return Ra(e.type);case 16:return Ra("Lazy");case 13:return Ra("Suspense");case 19:return Ra("SuspenseList");case 0:case 2:case 15:return e=fd(e.type,!1),e;case 11:return e=fd(e.type.render,!1),e;case 1:return e=fd(e.type,!0),e;default:return""}}function Rf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case uo:return"Fragment";case co:return"Portal";case Ef:return"Profiler";case ng:return"StrictMode";case Ff:return"Suspense";case Tf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yx:return(e.displayName||"Context")+".Consumer";case Xx:return(e._context.displayName||"Context")+".Provider";case sg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ig:return t=e.displayName||null,t!==null?t:Rf(e.type)||"Memo";case Ts:t=e._payload,e=e._init;try{return Rf(e(t))}catch{}}return null}function Yb(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Rf(t);case 8:return t===ng?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Zx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Qb(e){var t=Zx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function dc(e){e._valueTracker||(e._valueTracker=Qb(e))}function qx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Zx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function xu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _f(e,t){var r=t.checked;return Et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function hm(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Qs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Jx(e,t){t=t.checked,t!=null&&rg(e,"checked",t,!1)}function Df(e,t){Jx(e,t);var r=Qs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Af(e,t.type,r):t.hasOwnProperty("defaultValue")&&Af(e,t.type,Qs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function dm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Af(e,t,r){(t!=="number"||xu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var _a=Array.isArray;function Fo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Qs(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Pf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return Et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(de(92));if(_a(r)){if(1<r.length)throw Error(de(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Qs(r)}}function eC(e,t){var r=Qs(t.value),n=Qs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function gm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tC(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function If(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tC(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fc,rC=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fc=fc||document.createElement("div"),fc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function al(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zb=["Webkit","ms","Moz","O"];Object.keys(Ba).forEach(function(e){Zb.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ba[t]=Ba[e]})});function nC(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ba.hasOwnProperty(e)&&Ba[e]?(""+t).trim():t+"px"}function sC(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=nC(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var qb=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lf(e,t){if(t){if(qb[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function Mf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Of=null;function og(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nf=null,To=null,Ro=null;function pm(e){if(e=$l(e)){if(typeof Nf!="function")throw Error(de(280));var t=e.stateNode;t&&(t=Fh(t),Nf(e.stateNode,e.type,t))}}function iC(e){To?Ro?Ro.push(e):Ro=[e]:To=e}function oC(){if(To){var e=To,t=Ro;if(Ro=To=null,pm(e),t)for(e=0;e<t.length;e++)pm(t[e])}}function aC(e,t){return e(t)}function lC(){}var gd=!1;function cC(e,t,r){if(gd)return e(t,r);gd=!0;try{return aC(e,t,r)}finally{gd=!1,(To!==null||Ro!==null)&&(lC(),oC())}}function ll(e,t){var r=e.stateNode;if(r===null)return null;var n=Fh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(de(231,t,typeof r));return r}var Bf=!1;if(gs)try{var va={};Object.defineProperty(va,"passive",{get:function(){Bf=!0}}),window.addEventListener("test",va,va),window.removeEventListener("test",va,va)}catch{Bf=!1}function Jb(e,t,r,n,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Ha=!1,Cu=null,wu=!1,Hf=null,eE={onError:function(e){Ha=!0,Cu=e}};function tE(e,t,r,n,s,i,o,a,l){Ha=!1,Cu=null,Jb.apply(eE,arguments)}function rE(e,t,r,n,s,i,o,a,l){if(tE.apply(this,arguments),Ha){if(Ha){var c=Cu;Ha=!1,Cu=null}else throw Error(de(198));wu||(wu=!0,Hf=c)}}function $i(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function uC(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function mm(e){if($i(e)!==e)throw Error(de(188))}function nE(e){var t=e.alternate;if(!t){if(t=$i(e),t===null)throw Error(de(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return mm(s),e;if(i===n)return mm(s),t;i=i.sibling}throw Error(de(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o)throw Error(de(189))}}if(r.alternate!==n)throw Error(de(190))}if(r.tag!==3)throw Error(de(188));return r.stateNode.current===r?e:t}function hC(e){return e=nE(e),e!==null?dC(e):null}function dC(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dC(e);if(t!==null)return t;e=e.sibling}return null}var fC=Yr.unstable_scheduleCallback,vm=Yr.unstable_cancelCallback,sE=Yr.unstable_shouldYield,iE=Yr.unstable_requestPaint,Pt=Yr.unstable_now,oE=Yr.unstable_getCurrentPriorityLevel,ag=Yr.unstable_ImmediatePriority,gC=Yr.unstable_UserBlockingPriority,yu=Yr.unstable_NormalPriority,aE=Yr.unstable_LowPriority,pC=Yr.unstable_IdlePriority,Sh=null,Kn=null;function lE(e){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(Sh,e,void 0,(e.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:hE,cE=Math.log,uE=Math.LN2;function hE(e){return e>>>=0,e===0?32:31-(cE(e)/uE|0)|0}var gc=64,pc=4194304;function Da(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Su(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~s;a!==0?n=Da(a):(i&=o,i!==0&&(n=Da(i)))}else o=r&~s,o!==0?n=Da(o):i!==0&&(n=Da(i));if(n===0)return 0;if(t!==0&&t!==n&&(t&s)===0&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if((n&4)!==0&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-_n(t),s=1<<r,n|=e[r],t&=~s;return n}function dE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fE(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-_n(i),a=1<<o,l=s[o];l===-1?((a&r)===0||(a&n)!==0)&&(s[o]=dE(a,t)):l<=t&&(e.expiredLanes|=a),i&=~a}}function Wf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function mC(){var e=gc;return gc<<=1,(gc&4194240)===0&&(gc=64),e}function pd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ul(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_n(t),e[t]=r}function gE(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-_n(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function lg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-_n(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var nt=0;function vC(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var xC,cg,CC,wC,yC,Vf=!1,mc=[],Hs=null,Ws=null,Vs=null,cl=new Map,ul=new Map,As=[],pE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xm(e,t){switch(e){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Vs=null;break;case"pointerover":case"pointerout":cl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ul.delete(t.pointerId)}}function xa(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=$l(t),t!==null&&cg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function mE(e,t,r,n,s){switch(t){case"focusin":return Hs=xa(Hs,e,t,r,n,s),!0;case"dragenter":return Ws=xa(Ws,e,t,r,n,s),!0;case"mouseover":return Vs=xa(Vs,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return cl.set(i,xa(cl.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ul.set(i,xa(ul.get(i)||null,e,t,r,n,s)),!0}return!1}function SC(e){var t=vi(e.target);if(t!==null){var r=$i(t);if(r!==null){if(t=r.tag,t===13){if(t=uC(r),t!==null){e.blockedOn=t,yC(e.priority,function(){CC(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Of=n,r.target.dispatchEvent(n),Of=null}else return t=$l(r),t!==null&&cg(t),e.blockedOn=r,!1;t.shift()}return!0}function Cm(e,t,r){Xc(e)&&r.delete(t)}function vE(){Vf=!1,Hs!==null&&Xc(Hs)&&(Hs=null),Ws!==null&&Xc(Ws)&&(Ws=null),Vs!==null&&Xc(Vs)&&(Vs=null),cl.forEach(Cm),ul.forEach(Cm)}function Ca(e,t){e.blockedOn===t&&(e.blockedOn=null,Vf||(Vf=!0,Yr.unstable_scheduleCallback(Yr.unstable_NormalPriority,vE)))}function hl(e){function t(s){return Ca(s,e)}if(0<mc.length){Ca(mc[0],e);for(var r=1;r<mc.length;r++){var n=mc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Hs!==null&&Ca(Hs,e),Ws!==null&&Ca(Ws,e),Vs!==null&&Ca(Vs,e),cl.forEach(t),ul.forEach(t),r=0;r<As.length;r++)n=As[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<As.length&&(r=As[0],r.blockedOn===null);)SC(r),r.blockedOn===null&&As.shift()}var _o=Cs.ReactCurrentBatchConfig,ku=!0;function xE(e,t,r,n){var s=nt,i=_o.transition;_o.transition=null;try{nt=1,ug(e,t,r,n)}finally{nt=s,_o.transition=i}}function CE(e,t,r,n){var s=nt,i=_o.transition;_o.transition=null;try{nt=4,ug(e,t,r,n)}finally{nt=s,_o.transition=i}}function ug(e,t,r,n){if(ku){var s=Gf(e,t,r,n);if(s===null)Ed(e,t,n,bu,r),xm(e,n);else if(mE(s,e,t,r,n))n.stopPropagation();else if(xm(e,n),t&4&&-1<pE.indexOf(e)){for(;s!==null;){var i=$l(s);if(i!==null&&xC(i),i=Gf(e,t,r,n),i===null&&Ed(e,t,n,bu,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Ed(e,t,n,null,r)}}var bu=null;function Gf(e,t,r,n){if(bu=null,e=og(n),e=vi(e),e!==null)if(t=$i(e),t===null)e=null;else if(r=t.tag,r===13){if(e=uC(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return bu=e,null}function kC(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oE()){case ag:return 1;case gC:return 4;case yu:case aE:return 16;case pC:return 536870912;default:return 16}default:return 16}}var Ls=null,hg=null,Yc=null;function bC(){if(Yc)return Yc;var e,t=hg,r=t.length,n,s="value"in Ls?Ls.value:Ls.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Yc=s.slice(e,1<n?1-n:void 0)}function Qc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vc(){return!0}function wm(){return!1}function qr(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?vc:wm,this.isPropagationStopped=wm,this}return Et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vc)},persist:function(){},isPersistent:vc}),t}var ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dg=qr(ta),jl=Et({},ta,{view:0,detail:0}),wE=qr(jl),md,vd,wa,kh=Et({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==wa&&(wa&&e.type==="mousemove"?(md=e.screenX-wa.screenX,vd=e.screenY-wa.screenY):vd=md=0,wa=e),md)},movementY:function(e){return"movementY"in e?e.movementY:vd}}),ym=qr(kh),yE=Et({},kh,{dataTransfer:0}),SE=qr(yE),kE=Et({},jl,{relatedTarget:0}),xd=qr(kE),bE=Et({},ta,{animationName:0,elapsedTime:0,pseudoElement:0}),EE=qr(bE),FE=Et({},ta,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),TE=qr(FE),RE=Et({},ta,{data:0}),Sm=qr(RE),_E={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=AE[e])?!!t[e]:!1}function fg(){return PE}var IE=Et({},jl,{key:function(e){if(e.key){var t=_E[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?DE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fg,charCode:function(e){return e.type==="keypress"?Qc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),LE=qr(IE),ME=Et({},kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),km=qr(ME),OE=Et({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fg}),NE=qr(OE),BE=Et({},ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),HE=qr(BE),WE=Et({},kh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),VE=qr(WE),GE=[9,13,27,32],gg=gs&&"CompositionEvent"in window,Wa=null;gs&&"documentMode"in document&&(Wa=document.documentMode);var zE=gs&&"TextEvent"in window&&!Wa,EC=gs&&(!gg||Wa&&8<Wa&&11>=Wa),bm=String.fromCharCode(32),Em=!1;function FC(e,t){switch(e){case"keyup":return GE.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TC(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ho=!1;function UE(e,t){switch(e){case"compositionend":return TC(t);case"keypress":return t.which!==32?null:(Em=!0,bm);case"textInput":return e=t.data,e===bm&&Em?null:e;default:return null}}function jE(e,t){if(ho)return e==="compositionend"||!gg&&FC(e,t)?(e=bC(),Yc=hg=Ls=null,ho=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return EC&&t.locale!=="ko"?null:t.data;default:return null}}var $E={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$E[e.type]:t==="textarea"}function RC(e,t,r,n){iC(n),t=Eu(t,"onChange"),0<t.length&&(r=new dg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Va=null,dl=null;function KE(e){HC(e,0)}function bh(e){var t=po(e);if(qx(t))return e}function XE(e,t){if(e==="change")return t}var _C=!1;if(gs){var Cd;if(gs){var wd="oninput"in document;if(!wd){var Tm=document.createElement("div");Tm.setAttribute("oninput","return;"),wd=typeof Tm.oninput=="function"}Cd=wd}else Cd=!1;_C=Cd&&(!document.documentMode||9<document.documentMode)}function Rm(){Va&&(Va.detachEvent("onpropertychange",DC),dl=Va=null)}function DC(e){if(e.propertyName==="value"&&bh(dl)){var t=[];RC(t,dl,e,og(e)),cC(KE,t)}}function YE(e,t,r){e==="focusin"?(Rm(),Va=t,dl=r,Va.attachEvent("onpropertychange",DC)):e==="focusout"&&Rm()}function QE(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bh(dl)}function ZE(e,t){if(e==="click")return bh(t)}function qE(e,t){if(e==="input"||e==="change")return bh(t)}function JE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:JE;function fl(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!bf.call(t,s)||!In(e[s],t[s]))return!1}return!0}function _m(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dm(e,t){var r=_m(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_m(r)}}function AC(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?AC(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function PC(){for(var e=window,t=xu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=xu(e.document)}return t}function pg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function eF(e){var t=PC(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&AC(r.ownerDocument.documentElement,r)){if(n!==null&&pg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Dm(r,i);var o=Dm(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tF=gs&&"documentMode"in document&&11>=document.documentMode,fo=null,zf=null,Ga=null,Uf=!1;function Am(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Uf||fo==null||fo!==xu(n)||(n=fo,"selectionStart"in n&&pg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ga&&fl(Ga,n)||(Ga=n,n=Eu(zf,"onSelect"),0<n.length&&(t=new dg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=fo)))}function xc(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var go={animationend:xc("Animation","AnimationEnd"),animationiteration:xc("Animation","AnimationIteration"),animationstart:xc("Animation","AnimationStart"),transitionend:xc("Transition","TransitionEnd")},yd={},IC={};gs&&(IC=document.createElement("div").style,"AnimationEvent"in window||(delete go.animationend.animation,delete go.animationiteration.animation,delete go.animationstart.animation),"TransitionEvent"in window||delete go.transitionend.transition);function Eh(e){if(yd[e])return yd[e];if(!go[e])return e;var t=go[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in IC)return yd[e]=t[r];return e}var LC=Eh("animationend"),MC=Eh("animationiteration"),OC=Eh("animationstart"),NC=Eh("transitionend"),BC=new Map,Pm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ri(e,t){BC.set(e,t),ji(t,[e])}for(var Sd=0;Sd<Pm.length;Sd++){var kd=Pm[Sd],rF=kd.toLowerCase(),nF=kd[0].toUpperCase()+kd.slice(1);ri(rF,"on"+nF)}ri(LC,"onAnimationEnd");ri(MC,"onAnimationIteration");ri(OC,"onAnimationStart");ri("dblclick","onDoubleClick");ri("focusin","onFocus");ri("focusout","onBlur");ri(NC,"onTransitionEnd");Wo("onMouseEnter",["mouseout","mouseover"]);Wo("onMouseLeave",["mouseout","mouseover"]);Wo("onPointerEnter",["pointerout","pointerover"]);Wo("onPointerLeave",["pointerout","pointerover"]);ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ji("onBeforeInput",["compositionend","keypress","textInput","paste"]);ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Aa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Aa));function Im(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,rE(n,t,void 0,e),e.currentTarget=null}function HC(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Im(s,a,c),i=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Im(s,a,c),i=l}}}if(wu)throw e=Hf,wu=!1,Hf=null,e}function ht(e,t){var r=t[Yf];r===void 0&&(r=t[Yf]=new Set);var n=e+"__bubble";r.has(n)||(WC(t,e,2,!1),r.add(n))}function bd(e,t,r){var n=0;t&&(n|=4),WC(r,e,n,t)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function gl(e){if(!e[Cc]){e[Cc]=!0,Kx.forEach(function(r){r!=="selectionchange"&&(sF.has(r)||bd(r,!1,e),bd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cc]||(t[Cc]=!0,bd("selectionchange",!1,t))}}function WC(e,t,r,n){switch(kC(t)){case 1:var s=xE;break;case 4:s=CE;break;default:s=ug}r=s.bind(null,t,r,e),s=void 0,!Bf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Ed(e,t,r,n,s){var i=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=vi(a),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}a=a.parentNode}}n=n.return}cC(function(){var c=i,u=og(r),h=[];e:{var d=BC.get(e);if(d!==void 0){var f=dg,p=e;switch(e){case"keypress":if(Qc(r)===0)break e;case"keydown":case"keyup":f=LE;break;case"focusin":p="focus",f=xd;break;case"focusout":p="blur",f=xd;break;case"beforeblur":case"afterblur":f=xd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=ym;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=SE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=NE;break;case LC:case MC:case OC:f=EE;break;case NC:f=HE;break;case"scroll":f=wE;break;case"wheel":f=VE;break;case"copy":case"cut":case"paste":f=TE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=km}var g=(t&4)!==0,m=!g&&e==="scroll",v=g?d!==null?d+"Capture":null:d;g=[];for(var C=c,x;C!==null;){x=C;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=ll(C,v),w!=null&&g.push(pl(C,w,x)))),m)break;C=C.return}0<g.length&&(d=new f(d,p,null,r,u),h.push({event:d,listeners:g}))}}if((t&7)===0){e:{if(d=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",d&&r!==Of&&(p=r.relatedTarget||r.fromElement)&&(vi(p)||p[ps]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=c,p=p?vi(p):null,p!==null&&(m=$i(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=ym,w="onMouseLeave",v="onMouseEnter",C="mouse",(e==="pointerout"||e==="pointerover")&&(g=km,w="onPointerLeave",v="onPointerEnter",C="pointer"),m=f==null?d:po(f),x=p==null?d:po(p),d=new g(w,C+"leave",f,r,u),d.target=m,d.relatedTarget=x,w=null,vi(u)===c&&(g=new g(v,C+"enter",p,r,u),g.target=x,g.relatedTarget=m,w=g),m=w,f&&p)t:{for(g=f,v=p,C=0,x=g;x;x=ro(x))C++;for(x=0,w=v;w;w=ro(w))x++;for(;0<C-x;)g=ro(g),C--;for(;0<x-C;)v=ro(v),x--;for(;C--;){if(g===v||v!==null&&g===v.alternate)break t;g=ro(g),v=ro(v)}g=null}else g=null;f!==null&&Lm(h,d,f,g,!1),p!==null&&m!==null&&Lm(h,m,p,g,!0)}}e:{if(d=c?po(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var k=XE;else if(Fm(d))if(_C)k=qE;else{k=QE;var E=YE}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(k=ZE);if(k&&(k=k(e,c))){RC(h,k,r,u);break e}E&&E(e,d,c),e==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&Af(d,"number",d.value)}switch(E=c?po(c):window,e){case"focusin":(Fm(E)||E.contentEditable==="true")&&(fo=E,zf=c,Ga=null);break;case"focusout":Ga=zf=fo=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,Am(h,r,u);break;case"selectionchange":if(tF)break;case"keydown":case"keyup":Am(h,r,u)}var y;if(gg)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else ho?FC(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(EC&&r.locale!=="ko"&&(ho||R!=="onCompositionStart"?R==="onCompositionEnd"&&ho&&(y=bC()):(Ls=u,hg="value"in Ls?Ls.value:Ls.textContent,ho=!0)),E=Eu(c,R),0<E.length&&(R=new Sm(R,e,null,r,u),h.push({event:R,listeners:E}),y?R.data=y:(y=TC(r),y!==null&&(R.data=y)))),(y=zE?UE(e,r):jE(e,r))&&(c=Eu(c,"onBeforeInput"),0<c.length&&(u=new Sm("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=y))}HC(h,t)})}function pl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Eu(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ll(e,r),i!=null&&n.unshift(pl(e,i,s)),i=ll(e,t),i!=null&&n.push(pl(e,i,s))),e=e.return}return n}function ro(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Lm(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,s?(l=ll(r,i),l!=null&&o.unshift(pl(r,l,a))):s||(l=ll(r,i),l!=null&&o.push(pl(r,l,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var iF=/\r\n?/g,oF=/\u0000|\uFFFD/g;function Mm(e){return(typeof e=="string"?e:""+e).replace(iF,`
`).replace(oF,"")}function wc(e,t,r){if(t=Mm(t),Mm(e)!==t&&r)throw Error(de(425))}function Fu(){}var jf=null,$f=null;function Kf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xf=typeof setTimeout=="function"?setTimeout:void 0,aF=typeof clearTimeout=="function"?clearTimeout:void 0,Om=typeof Promise=="function"?Promise:void 0,lF=typeof queueMicrotask=="function"?queueMicrotask:typeof Om<"u"?function(e){return Om.resolve(null).then(e).catch(cF)}:Xf;function cF(e){setTimeout(function(){throw e})}function Fd(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),hl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);hl(t)}function Gs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Nm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ra=Math.random().toString(36).slice(2),Un="__reactFiber$"+ra,ml="__reactProps$"+ra,ps="__reactContainer$"+ra,Yf="__reactEvents$"+ra,uF="__reactListeners$"+ra,hF="__reactHandles$"+ra;function vi(e){var t=e[Un];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ps]||r[Un]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Nm(e);e!==null;){if(r=e[Un])return r;e=Nm(e)}return t}e=r,r=e.parentNode}return null}function $l(e){return e=e[Un]||e[ps],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function po(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function Fh(e){return e[ml]||null}var Qf=[],mo=-1;function ni(e){return{current:e}}function ft(e){0>mo||(e.current=Qf[mo],Qf[mo]=null,mo--)}function lt(e,t){mo++,Qf[mo]=e.current,e.current=t}var Zs={},vr=ni(Zs),Or=ni(!1),Pi=Zs;function Vo(e,t){var r=e.type.contextTypes;if(!r)return Zs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Nr(e){return e=e.childContextTypes,e!=null}function Tu(){ft(Or),ft(vr)}function Bm(e,t,r){if(vr.current!==Zs)throw Error(de(168));lt(vr,t),lt(Or,r)}function VC(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(de(108,Yb(e)||"Unknown",s));return Et({},r,n)}function Ru(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Zs,Pi=vr.current,lt(vr,e),lt(Or,Or.current),!0}function Hm(e,t,r){var n=e.stateNode;if(!n)throw Error(de(169));r?(e=VC(e,t,Pi),n.__reactInternalMemoizedMergedChildContext=e,ft(Or),ft(vr),lt(vr,e)):ft(Or),lt(Or,r)}var ns=null,Th=!1,Td=!1;function GC(e){ns===null?ns=[e]:ns.push(e)}function dF(e){Th=!0,GC(e)}function si(){if(!Td&&ns!==null){Td=!0;var e=0,t=nt;try{var r=ns;for(nt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ns=null,Th=!1}catch(s){throw ns!==null&&(ns=ns.slice(e+1)),fC(ag,si),s}finally{nt=t,Td=!1}}return null}var vo=[],xo=0,_u=null,Du=0,un=[],hn=0,Ii=null,os=1,as="";function fi(e,t){vo[xo++]=Du,vo[xo++]=_u,_u=e,Du=t}function zC(e,t,r){un[hn++]=os,un[hn++]=as,un[hn++]=Ii,Ii=e;var n=os;e=as;var s=32-_n(n)-1;n&=~(1<<s),r+=1;var i=32-_n(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,os=1<<32-_n(t)+s|r<<s|n,as=i+e}else os=1<<i|r<<s|n,as=e}function mg(e){e.return!==null&&(fi(e,1),zC(e,1,0))}function vg(e){for(;e===_u;)_u=vo[--xo],vo[xo]=null,Du=vo[--xo],vo[xo]=null;for(;e===Ii;)Ii=un[--hn],un[hn]=null,as=un[--hn],un[hn]=null,os=un[--hn],un[hn]=null}var Kr=null,$r=null,xt=!1,Fn=null;function UC(e,t){var r=fn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Wm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kr=e,$r=Gs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kr=e,$r=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ii!==null?{id:os,overflow:as}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Kr=e,$r=null,!0):!1;default:return!1}}function Zf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qf(e){if(xt){var t=$r;if(t){var r=t;if(!Wm(e,t)){if(Zf(e))throw Error(de(418));t=Gs(r.nextSibling);var n=Kr;t&&Wm(e,t)?UC(n,r):(e.flags=e.flags&-4097|2,xt=!1,Kr=e)}}else{if(Zf(e))throw Error(de(418));e.flags=e.flags&-4097|2,xt=!1,Kr=e}}}function Vm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kr=e}function yc(e){if(e!==Kr)return!1;if(!xt)return Vm(e),xt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Kf(e.type,e.memoizedProps)),t&&(t=$r)){if(Zf(e))throw jC(),Error(de(418));for(;t;)UC(e,t),t=Gs(t.nextSibling)}if(Vm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){$r=Gs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}$r=null}}else $r=Kr?Gs(e.stateNode.nextSibling):null;return!0}function jC(){for(var e=$r;e;)e=Gs(e.nextSibling)}function Go(){$r=Kr=null,xt=!1}function xg(e){Fn===null?Fn=[e]:Fn.push(e)}var fF=Cs.ReactCurrentBatchConfig;function ya(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(de(309));var n=r.stateNode}if(!n)throw Error(de(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(de(284));if(!r._owner)throw Error(de(290,e))}return e}function Sc(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Gm(e){var t=e._init;return t(e._payload)}function $C(e){function t(v,C){if(e){var x=v.deletions;x===null?(v.deletions=[C],v.flags|=16):x.push(C)}}function r(v,C){if(!e)return null;for(;C!==null;)t(v,C),C=C.sibling;return null}function n(v,C){for(v=new Map;C!==null;)C.key!==null?v.set(C.key,C):v.set(C.index,C),C=C.sibling;return v}function s(v,C){return v=$s(v,C),v.index=0,v.sibling=null,v}function i(v,C,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<C?(v.flags|=2,C):x):(v.flags|=2,C)):(v.flags|=1048576,C)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function a(v,C,x,w){return C===null||C.tag!==6?(C=Ld(x,v.mode,w),C.return=v,C):(C=s(C,x),C.return=v,C)}function l(v,C,x,w){var k=x.type;return k===uo?u(v,C,x.props.children,w,x.key):C!==null&&(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ts&&Gm(k)===C.type)?(w=s(C,x.props),w.ref=ya(v,C,x),w.return=v,w):(w=nu(x.type,x.key,x.props,null,v.mode,w),w.ref=ya(v,C,x),w.return=v,w)}function c(v,C,x,w){return C===null||C.tag!==4||C.stateNode.containerInfo!==x.containerInfo||C.stateNode.implementation!==x.implementation?(C=Md(x,v.mode,w),C.return=v,C):(C=s(C,x.children||[]),C.return=v,C)}function u(v,C,x,w,k){return C===null||C.tag!==7?(C=ki(x,v.mode,w,k),C.return=v,C):(C=s(C,x),C.return=v,C)}function h(v,C,x){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Ld(""+C,v.mode,x),C.return=v,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case hc:return x=nu(C.type,C.key,C.props,null,v.mode,x),x.ref=ya(v,null,C),x.return=v,x;case co:return C=Md(C,v.mode,x),C.return=v,C;case Ts:var w=C._init;return h(v,w(C._payload),x)}if(_a(C)||ma(C))return C=ki(C,v.mode,x,null),C.return=v,C;Sc(v,C)}return null}function d(v,C,x,w){var k=C!==null?C.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return k!==null?null:a(v,C,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case hc:return x.key===k?l(v,C,x,w):null;case co:return x.key===k?c(v,C,x,w):null;case Ts:return k=x._init,d(v,C,k(x._payload),w)}if(_a(x)||ma(x))return k!==null?null:u(v,C,x,w,null);Sc(v,x)}return null}function f(v,C,x,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,a(C,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case hc:return v=v.get(w.key===null?x:w.key)||null,l(C,v,w,k);case co:return v=v.get(w.key===null?x:w.key)||null,c(C,v,w,k);case Ts:var E=w._init;return f(v,C,x,E(w._payload),k)}if(_a(w)||ma(w))return v=v.get(x)||null,u(C,v,w,k,null);Sc(C,w)}return null}function p(v,C,x,w){for(var k=null,E=null,y=C,R=C=0,D=null;y!==null&&R<x.length;R++){y.index>R?(D=y,y=null):D=y.sibling;var N=d(v,y,x[R],w);if(N===null){y===null&&(y=D);break}e&&y&&N.alternate===null&&t(v,y),C=i(N,C,R),E===null?k=N:E.sibling=N,E=N,y=D}if(R===x.length)return r(v,y),xt&&fi(v,R),k;if(y===null){for(;R<x.length;R++)y=h(v,x[R],w),y!==null&&(C=i(y,C,R),E===null?k=y:E.sibling=y,E=y);return xt&&fi(v,R),k}for(y=n(v,y);R<x.length;R++)D=f(y,v,R,x[R],w),D!==null&&(e&&D.alternate!==null&&y.delete(D.key===null?R:D.key),C=i(D,C,R),E===null?k=D:E.sibling=D,E=D);return e&&y.forEach(function(O){return t(v,O)}),xt&&fi(v,R),k}function g(v,C,x,w){var k=ma(x);if(typeof k!="function")throw Error(de(150));if(x=k.call(x),x==null)throw Error(de(151));for(var E=k=null,y=C,R=C=0,D=null,N=x.next();y!==null&&!N.done;R++,N=x.next()){y.index>R?(D=y,y=null):D=y.sibling;var O=d(v,y,N.value,w);if(O===null){y===null&&(y=D);break}e&&y&&O.alternate===null&&t(v,y),C=i(O,C,R),E===null?k=O:E.sibling=O,E=O,y=D}if(N.done)return r(v,y),xt&&fi(v,R),k;if(y===null){for(;!N.done;R++,N=x.next())N=h(v,N.value,w),N!==null&&(C=i(N,C,R),E===null?k=N:E.sibling=N,E=N);return xt&&fi(v,R),k}for(y=n(v,y);!N.done;R++,N=x.next())N=f(y,v,R,N.value,w),N!==null&&(e&&N.alternate!==null&&y.delete(N.key===null?R:N.key),C=i(N,C,R),E===null?k=N:E.sibling=N,E=N);return e&&y.forEach(function(A){return t(v,A)}),xt&&fi(v,R),k}function m(v,C,x,w){if(typeof x=="object"&&x!==null&&x.type===uo&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case hc:e:{for(var k=x.key,E=C;E!==null;){if(E.key===k){if(k=x.type,k===uo){if(E.tag===7){r(v,E.sibling),C=s(E,x.props.children),C.return=v,v=C;break e}}else if(E.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ts&&Gm(k)===E.type){r(v,E.sibling),C=s(E,x.props),C.ref=ya(v,E,x),C.return=v,v=C;break e}r(v,E);break}else t(v,E);E=E.sibling}x.type===uo?(C=ki(x.props.children,v.mode,w,x.key),C.return=v,v=C):(w=nu(x.type,x.key,x.props,null,v.mode,w),w.ref=ya(v,C,x),w.return=v,v=w)}return o(v);case co:e:{for(E=x.key;C!==null;){if(C.key===E)if(C.tag===4&&C.stateNode.containerInfo===x.containerInfo&&C.stateNode.implementation===x.implementation){r(v,C.sibling),C=s(C,x.children||[]),C.return=v,v=C;break e}else{r(v,C);break}else t(v,C);C=C.sibling}C=Md(x,v.mode,w),C.return=v,v=C}return o(v);case Ts:return E=x._init,m(v,C,E(x._payload),w)}if(_a(x))return p(v,C,x,w);if(ma(x))return g(v,C,x,w);Sc(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,C!==null&&C.tag===6?(r(v,C.sibling),C=s(C,x),C.return=v,v=C):(r(v,C),C=Ld(x,v.mode,w),C.return=v,v=C),o(v)):r(v,C)}return m}var zo=$C(!0),KC=$C(!1),Au=ni(null),Pu=null,Co=null,Cg=null;function wg(){Cg=Co=Pu=null}function yg(e){var t=Au.current;ft(Au),e._currentValue=t}function Jf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Do(e,t){Pu=e,Cg=Co=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Lr=!0),e.firstContext=null)}function xn(e){var t=e._currentValue;if(Cg!==e)if(e={context:e,memoizedValue:t,next:null},Co===null){if(Pu===null)throw Error(de(308));Co=e,Pu.dependencies={lanes:0,firstContext:e}}else Co=Co.next=e;return t}var xi=null;function Sg(e){xi===null?xi=[e]:xi.push(e)}function XC(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Sg(t)):(r.next=s.next,s.next=r),t.interleaved=r,ms(e,n)}function ms(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Rs=!1;function kg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YC(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(Ke&2)!==0){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ms(e,r)}return s=n.interleaved,s===null?(t.next=t,Sg(n)):(t.next=s.next,s.next=t),n.interleaved=t,ms(e,r)}function Zc(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lg(e,r)}}function zm(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Iu(e,t,r,n){var s=e.updateQueue;Rs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,f=r,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Et({},h,d);break e;case 2:Rs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,d=s.effects,d===null?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;d=a,a=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Mi|=o,e.lanes=o,e.memoizedState=h}}function Um(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(de(191,s));s.call(n)}}}var Kl={},Xn=ni(Kl),vl=ni(Kl),xl=ni(Kl);function Ci(e){if(e===Kl)throw Error(de(174));return e}function bg(e,t){switch(lt(xl,t),lt(vl,e),lt(Xn,Kl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:If(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=If(t,e)}ft(Xn),lt(Xn,t)}function Uo(){ft(Xn),ft(vl),ft(xl)}function QC(e){Ci(xl.current);var t=Ci(Xn.current),r=If(t,e.type);t!==r&&(lt(vl,e),lt(Xn,r))}function Eg(e){vl.current===e&&(ft(Xn),ft(vl))}var yt=ni(0);function Lu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Rd=[];function Fg(){for(var e=0;e<Rd.length;e++)Rd[e]._workInProgressVersionPrimary=null;Rd.length=0}var qc=Cs.ReactCurrentDispatcher,_d=Cs.ReactCurrentBatchConfig,Li=0,bt=null,zt=null,Xt=null,Mu=!1,za=!1,Cl=0,gF=0;function ar(){throw Error(de(321))}function Tg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!In(e[r],t[r]))return!1;return!0}function Rg(e,t,r,n,s,i){if(Li=i,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qc.current=e===null||e.memoizedState===null?xF:CF,e=r(n,s),za){i=0;do{if(za=!1,Cl=0,25<=i)throw Error(de(301));i+=1,Xt=zt=null,t.updateQueue=null,qc.current=wF,e=r(n,s)}while(za)}if(qc.current=Ou,t=zt!==null&&zt.next!==null,Li=0,Xt=zt=bt=null,Mu=!1,t)throw Error(de(300));return e}function _g(){var e=Cl!==0;return Cl=0,e}function Wn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?bt.memoizedState=Xt=e:Xt=Xt.next=e,Xt}function Cn(){if(zt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=zt.next;var t=Xt===null?bt.memoizedState:Xt.next;if(t!==null)Xt=t,zt=e;else{if(e===null)throw Error(de(310));zt=e,e={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},Xt===null?bt.memoizedState=Xt=e:Xt=Xt.next=e}return Xt}function wl(e,t){return typeof t=="function"?t(e):t}function Dd(e){var t=Cn(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=zt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Li&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,bt.lanes|=u,Mi|=u}c=c.next}while(c!==null&&c!==i);l===null?o=n:l.next=a,In(n,t.memoizedState)||(Lr=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,bt.lanes|=i,Mi|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ad(e){var t=Cn(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);In(i,t.memoizedState)||(Lr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function ZC(){}function qC(e,t){var r=bt,n=Cn(),s=t(),i=!In(n.memoizedState,s);if(i&&(n.memoizedState=s,Lr=!0),n=n.queue,Dg(tw.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Xt!==null&&Xt.memoizedState.tag&1){if(r.flags|=2048,yl(9,ew.bind(null,r,n,s,t),void 0,null),qt===null)throw Error(de(349));(Li&30)!==0||JC(r,t,s)}return s}function JC(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ew(e,t,r,n){t.value=r,t.getSnapshot=n,rw(t)&&nw(e)}function tw(e,t,r){return r(function(){rw(t)&&nw(e)})}function rw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!In(e,r)}catch{return!0}}function nw(e){var t=ms(e,1);t!==null&&Dn(t,e,1,-1)}function jm(e){var t=Wn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:e},t.queue=e,e=e.dispatch=vF.bind(null,bt,e),[t.memoizedState,e]}function yl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function sw(){return Cn().memoizedState}function Jc(e,t,r,n){var s=Wn();bt.flags|=e,s.memoizedState=yl(1|t,r,void 0,n===void 0?null:n)}function Rh(e,t,r,n){var s=Cn();n=n===void 0?null:n;var i=void 0;if(zt!==null){var o=zt.memoizedState;if(i=o.destroy,n!==null&&Tg(n,o.deps)){s.memoizedState=yl(t,r,i,n);return}}bt.flags|=e,s.memoizedState=yl(1|t,r,i,n)}function $m(e,t){return Jc(8390656,8,e,t)}function Dg(e,t){return Rh(2048,8,e,t)}function iw(e,t){return Rh(4,2,e,t)}function ow(e,t){return Rh(4,4,e,t)}function aw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lw(e,t,r){return r=r!=null?r.concat([e]):null,Rh(4,4,aw.bind(null,t,e),r)}function Ag(){}function cw(e,t){var r=Cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Tg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function uw(e,t){var r=Cn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Tg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function hw(e,t,r){return(Li&21)===0?(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=r):(In(r,t)||(r=mC(),bt.lanes|=r,Mi|=r,e.baseState=!0),t)}function pF(e,t){var r=nt;nt=r!==0&&4>r?r:4,e(!0);var n=_d.transition;_d.transition={};try{e(!1),t()}finally{nt=r,_d.transition=n}}function dw(){return Cn().memoizedState}function mF(e,t,r){var n=js(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fw(e))gw(t,r);else if(r=XC(e,t,r,n),r!==null){var s=Er();Dn(r,e,n,s),pw(r,t,n)}}function vF(e,t,r){var n=js(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fw(e))gw(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,In(a,o)){var l=t.interleaved;l===null?(s.next=s,Sg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=XC(e,t,s,n),r!==null&&(s=Er(),Dn(r,e,n,s),pw(r,t,n))}}function fw(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function gw(e,t){za=Mu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function pw(e,t,r){if((r&4194240)!==0){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lg(e,r)}}var Ou={readContext:xn,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},xF={readContext:xn,useCallback:function(e,t){return Wn().memoizedState=[e,t===void 0?null:t],e},useContext:xn,useEffect:$m,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Jc(4194308,4,aw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Jc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Jc(4,2,e,t)},useMemo:function(e,t){var r=Wn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=mF.bind(null,bt,e),[n.memoizedState,e]},useRef:function(e){var t=Wn();return e={current:e},t.memoizedState=e},useState:jm,useDebugValue:Ag,useDeferredValue:function(e){return Wn().memoizedState=e},useTransition:function(){var e=jm(!1),t=e[0];return e=pF.bind(null,e[1]),Wn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=bt,s=Wn();if(xt){if(r===void 0)throw Error(de(407));r=r()}else{if(r=t(),qt===null)throw Error(de(349));(Li&30)!==0||JC(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,$m(tw.bind(null,n,i,e),[e]),n.flags|=2048,yl(9,ew.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Wn(),t=qt.identifierPrefix;if(xt){var r=as,n=os;r=(n&~(1<<32-_n(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Cl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=gF++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},CF={readContext:xn,useCallback:cw,useContext:xn,useEffect:Dg,useImperativeHandle:lw,useInsertionEffect:iw,useLayoutEffect:ow,useMemo:uw,useReducer:Dd,useRef:sw,useState:function(){return Dd(wl)},useDebugValue:Ag,useDeferredValue:function(e){var t=Cn();return hw(t,zt.memoizedState,e)},useTransition:function(){var e=Dd(wl)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:ZC,useSyncExternalStore:qC,useId:dw,unstable_isNewReconciler:!1},wF={readContext:xn,useCallback:cw,useContext:xn,useEffect:Dg,useImperativeHandle:lw,useInsertionEffect:iw,useLayoutEffect:ow,useMemo:uw,useReducer:Ad,useRef:sw,useState:function(){return Ad(wl)},useDebugValue:Ag,useDeferredValue:function(e){var t=Cn();return zt===null?t.memoizedState=e:hw(t,zt.memoizedState,e)},useTransition:function(){var e=Ad(wl)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:ZC,useSyncExternalStore:qC,useId:dw,unstable_isNewReconciler:!1};function bn(e,t){if(e&&e.defaultProps){t=Et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function e0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _h={isMounted:function(e){return(e=e._reactInternals)?$i(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Er(),s=js(e),i=cs(n,s);i.payload=t,r!=null&&(i.callback=r),t=zs(e,i,s),t!==null&&(Dn(t,e,s,n),Zc(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Er(),s=js(e),i=cs(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=zs(e,i,s),t!==null&&(Dn(t,e,s,n),Zc(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Er(),n=js(e),s=cs(r,n);s.tag=2,t!=null&&(s.callback=t),t=zs(e,s,n),t!==null&&(Dn(t,e,n,r),Zc(t,e,n))}};function Km(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!fl(r,n)||!fl(s,i):!0}function mw(e,t,r){var n=!1,s=Zs,i=t.contextType;return typeof i=="object"&&i!==null?i=xn(i):(s=Nr(t)?Pi:vr.current,n=t.contextTypes,i=(n=n!=null)?Vo(e,s):Zs),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_h,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Xm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_h.enqueueReplaceState(t,t.state,null)}function t0(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},kg(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=xn(i):(i=Nr(t)?Pi:vr.current,s.context=Vo(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(e0(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&_h.enqueueReplaceState(s,s.state,null),Iu(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function jo(e,t){try{var r="",n=t;do r+=Xb(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Pd(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function r0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var yF=typeof WeakMap=="function"?WeakMap:Map;function vw(e,t,r){r=cs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Bu||(Bu=!0,d0=n),r0(e,t)},r}function xw(e,t,r){r=cs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){r0(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){r0(e,t),typeof n!="function"&&(Us===null?Us=new Set([this]):Us.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Ym(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new yF;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=MF.bind(null,e,t,r),t.then(e,e))}function Qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Zm(e,t,r,n,s){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=cs(-1,1),t.tag=2,zs(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var SF=Cs.ReactCurrentOwner,Lr=!1;function Sr(e,t,r,n){t.child=e===null?KC(t,null,r,n):zo(t,e.child,r,n)}function qm(e,t,r,n,s){r=r.render;var i=t.ref;return Do(t,s),n=Rg(e,t,r,n,i,s),r=_g(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vs(e,t,s)):(xt&&r&&mg(t),t.flags|=1,Sr(e,t,n,s),t.child)}function Jm(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Hg(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Cw(e,t,i,n,s)):(e=nu(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,(e.lanes&s)===0){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:fl,r(o,n)&&e.ref===t.ref)return vs(e,t,s)}return t.flags|=1,e=$s(i,n),e.ref=t.ref,e.return=t,t.child=e}function Cw(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(fl(i,n)&&e.ref===t.ref)if(Lr=!1,t.pendingProps=n=i,(e.lanes&s)!==0)(e.flags&131072)!==0&&(Lr=!0);else return t.lanes=e.lanes,vs(e,t,s)}return n0(e,t,r,n,s)}function ww(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(yo,Vr),Vr|=r;else{if((r&1073741824)===0)return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,lt(yo,Vr),Vr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,lt(yo,Vr),Vr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,lt(yo,Vr),Vr|=n;return Sr(e,t,s,r),t.child}function yw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function n0(e,t,r,n,s){var i=Nr(r)?Pi:vr.current;return i=Vo(t,i),Do(t,s),r=Rg(e,t,r,n,i,s),n=_g(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vs(e,t,s)):(xt&&n&&mg(t),t.flags|=1,Sr(e,t,r,s),t.child)}function ev(e,t,r,n,s){if(Nr(r)){var i=!0;Ru(t)}else i=!1;if(Do(t,s),t.stateNode===null)eu(e,t),mw(t,r,n),t0(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=xn(c):(c=Nr(r)?Pi:vr.current,c=Vo(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&Xm(t,o,n,c),Rs=!1;var d=t.memoizedState;o.state=d,Iu(t,n,o,s),l=t.memoizedState,a!==n||d!==l||Or.current||Rs?(typeof u=="function"&&(e0(t,r,u,n),l=t.memoizedState),(a=Rs||Km(t,r,a,n,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,YC(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:bn(t.type,a),o.props=c,h=t.pendingProps,d=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=xn(l):(l=Nr(r)?Pi:vr.current,l=Vo(t,l));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&Xm(t,o,n,l),Rs=!1,d=t.memoizedState,o.state=d,Iu(t,n,o,s);var p=t.memoizedState;a!==h||d!==p||Or.current||Rs?(typeof f=="function"&&(e0(t,r,f,n),p=t.memoizedState),(c=Rs||Km(t,r,c,n,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return s0(e,t,r,n,i,s)}function s0(e,t,r,n,s,i){yw(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Hm(t,r,!1),vs(e,t,i);n=t.stateNode,SF.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=zo(t,e.child,null,i),t.child=zo(t,null,a,i)):Sr(e,t,a,i),t.memoizedState=n.state,s&&Hm(t,r,!0),t.child}function Sw(e){var t=e.stateNode;t.pendingContext?Bm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Bm(e,t.context,!1),bg(e,t.containerInfo)}function tv(e,t,r,n,s){return Go(),xg(s),t.flags|=256,Sr(e,t,r,n),t.child}var i0={dehydrated:null,treeContext:null,retryLane:0};function o0(e){return{baseLanes:e,cachePool:null,transitions:null}}function kw(e,t,r){var n=t.pendingProps,s=yt.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),lt(yt,s&1),e===null)return qf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},(n&1)===0&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ph(o,n,0,null),e=ki(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=o0(r),t.memoizedState=i0,e):Pg(t,o));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return kF(e,t,o,n,a,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,a=s.sibling;var l={mode:"hidden",children:n.children};return(o&1)===0&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=$s(s,l),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=$s(a,i):(i=ki(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?o0(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=i0,n}return i=e.child,e=i.sibling,n=$s(i,{mode:"visible",children:n.children}),(t.mode&1)===0&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Pg(e,t){return t=Ph({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function kc(e,t,r,n){return n!==null&&xg(n),zo(t,e.child,null,r),e=Pg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kF(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Pd(Error(de(422))),kc(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Ph({mode:"visible",children:n.children},s,0,null),i=ki(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,(t.mode&1)!==0&&zo(t,e.child,null,o),t.child.memoizedState=o0(o),t.memoizedState=i0,i);if((t.mode&1)===0)return kc(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(de(419)),n=Pd(i,n,void 0),kc(e,t,o,n)}if(a=(o&e.childLanes)!==0,Lr||a){if(n=qt,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=(s&(n.suspendedLanes|o))!==0?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ms(e,s),Dn(n,e,s,-1))}return Bg(),n=Pd(Error(de(421))),kc(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=OF.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,$r=Gs(s.nextSibling),Kr=t,xt=!0,Fn=null,e!==null&&(un[hn++]=os,un[hn++]=as,un[hn++]=Ii,os=e.id,as=e.overflow,Ii=t),t=Pg(t,n.children),t.flags|=4096,t)}function rv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Jf(e.return,t,r)}function Id(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function bw(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Sr(e,t,n.children,r),n=yt.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rv(e,r,t);else if(e.tag===19)rv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(lt(yt,n),(t.mode&1)===0)t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Lu(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Id(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Lu(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Id(t,!0,r,null,i);break;case"together":Id(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function eu(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Mi|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,r=$s(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=$s(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bF(e,t,r){switch(t.tag){case 3:Sw(t),Go();break;case 5:QC(t);break;case 1:Nr(t.type)&&Ru(t);break;case 4:bg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;lt(Au,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(lt(yt,yt.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?kw(e,t,r):(lt(yt,yt.current&1),e=vs(e,t,r),e!==null?e.sibling:null);lt(yt,yt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,(e.flags&128)!==0){if(n)return bw(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),lt(yt,yt.current),n)break;return null;case 22:case 23:return t.lanes=0,ww(e,t,r)}return vs(e,t,r)}var Ew,a0,Fw,Tw;Ew=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};a0=function(){};Fw=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ci(Xn.current);var i=null;switch(r){case"input":s=_f(e,s),n=_f(e,n),i=[];break;case"select":s=Et({},s,{value:void 0}),n=Et({},n,{value:void 0}),i=[];break;case"textarea":s=Pf(e,s),n=Pf(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Fu)}Lf(r,n);var o;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ol.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(a=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ol.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ht("scroll",e),i||a===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Tw=function(e,t,r,n){r!==n&&(t.flags|=4)};function Sa(e,t){if(!xt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function lr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function EF(e,t,r){var n=t.pendingProps;switch(vg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(t),null;case 1:return Nr(t.type)&&Tu(),lr(t),null;case 3:return n=t.stateNode,Uo(),ft(Or),ft(vr),Fg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Fn!==null&&(p0(Fn),Fn=null))),a0(e,t),lr(t),null;case 5:Eg(t);var s=Ci(xl.current);if(r=t.type,e!==null&&t.stateNode!=null)Fw(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(de(166));return lr(t),null}if(e=Ci(Xn.current),yc(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Un]=t,n[ml]=i,e=(t.mode&1)!==0,r){case"dialog":ht("cancel",n),ht("close",n);break;case"iframe":case"object":case"embed":ht("load",n);break;case"video":case"audio":for(s=0;s<Aa.length;s++)ht(Aa[s],n);break;case"source":ht("error",n);break;case"img":case"image":case"link":ht("error",n),ht("load",n);break;case"details":ht("toggle",n);break;case"input":hm(n,i),ht("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ht("invalid",n);break;case"textarea":fm(n,i),ht("invalid",n)}Lf(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&wc(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&wc(n.textContent,a,e),s=["children",""+a]):ol.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ht("scroll",n)}switch(r){case"input":dc(n),dm(n,i,!0);break;case"textarea":dc(n),gm(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Fu)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tC(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Un]=t,e[ml]=n,Ew(e,t,!1,!1),t.stateNode=e;e:{switch(o=Mf(r,n),r){case"dialog":ht("cancel",e),ht("close",e),s=n;break;case"iframe":case"object":case"embed":ht("load",e),s=n;break;case"video":case"audio":for(s=0;s<Aa.length;s++)ht(Aa[s],e);s=n;break;case"source":ht("error",e),s=n;break;case"img":case"image":case"link":ht("error",e),ht("load",e),s=n;break;case"details":ht("toggle",e),s=n;break;case"input":hm(e,n),s=_f(e,n),ht("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Et({},n,{value:void 0}),ht("invalid",e);break;case"textarea":fm(e,n),s=Pf(e,n),ht("invalid",e);break;default:s=n}Lf(r,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?sC(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&rC(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&al(e,l):typeof l=="number"&&al(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ol.hasOwnProperty(i)?l!=null&&i==="onScroll"&&ht("scroll",e):l!=null&&rg(e,i,l,o))}switch(r){case"input":dc(e),dm(e,n,!1);break;case"textarea":dc(e),gm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Qs(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Fo(e,!!n.multiple,i,!1):n.defaultValue!=null&&Fo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Fu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return lr(t),null;case 6:if(e&&t.stateNode!=null)Tw(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(de(166));if(r=Ci(xl.current),Ci(Xn.current),yc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Un]=t,(i=n.nodeValue!==r)&&(e=Kr,e!==null))switch(e.tag){case 3:wc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wc(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Un]=t,t.stateNode=n}return lr(t),null;case 13:if(ft(yt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(xt&&$r!==null&&(t.mode&1)!==0&&(t.flags&128)===0)jC(),Go(),t.flags|=98560,i=!1;else if(i=yc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(de(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(de(317));i[Un]=t}else Go(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lr(t),i=!1}else Fn!==null&&(p0(Fn),Fn=null),i=!0;if(!i)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(yt.current&1)!==0?jt===0&&(jt=3):Bg())),t.updateQueue!==null&&(t.flags|=4),lr(t),null);case 4:return Uo(),a0(e,t),e===null&&gl(t.stateNode.containerInfo),lr(t),null;case 10:return yg(t.type._context),lr(t),null;case 17:return Nr(t.type)&&Tu(),lr(t),null;case 19:if(ft(yt),i=t.memoizedState,i===null)return lr(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Sa(i,!1);else{if(jt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(o=Lu(e),o!==null){for(t.flags|=128,Sa(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return lt(yt,yt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Pt()>$o&&(t.flags|=128,n=!0,Sa(i,!1),t.lanes=4194304)}else{if(!n)if(e=Lu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Sa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!xt)return lr(t),null}else 2*Pt()-i.renderingStartTime>$o&&r!==1073741824&&(t.flags|=128,n=!0,Sa(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Pt(),t.sibling=null,r=yt.current,lt(yt,n?r&1|2:r&1),t):(lr(t),null);case 22:case 23:return Ng(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(Vr&1073741824)!==0&&(lr(t),t.subtreeFlags&6&&(t.flags|=8192)):lr(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function FF(e,t){switch(vg(t),t.tag){case 1:return Nr(t.type)&&Tu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Uo(),ft(Or),ft(vr),Fg(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Eg(t),null;case 13:if(ft(yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));Go()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ft(yt),null;case 4:return Uo(),null;case 10:return yg(t.type._context),null;case 22:case 23:return Ng(),null;case 24:return null;default:return null}}var bc=!1,fr=!1,TF=typeof WeakSet=="function"?WeakSet:Set,ke=null;function wo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ft(e,t,n)}else r.current=null}function l0(e,t,r){try{r()}catch(n){Ft(e,t,n)}}var nv=!1;function RF(e,t){if(jf=ku,e=PC(),pg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var f;h!==r||s!==0&&h.nodeType!==3||(a=o+s),h!==i||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===e)break t;if(d===r&&++c===s&&(a=o),d===i&&++u===n&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for($f={focusedElem:e,selectionRange:r},ku=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var p=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,v=t.stateNode,C=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:bn(t.type,g),m);v.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(w){Ft(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return p=nv,nv=!1,p}function Ua(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&l0(t,r,i)}s=s.next}while(s!==n)}}function Dh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function c0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Rw(e){var t=e.alternate;t!==null&&(e.alternate=null,Rw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Un],delete t[ml],delete t[Yf],delete t[uF],delete t[hF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _w(e){return e.tag===5||e.tag===3||e.tag===4}function sv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_w(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function u0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fu));else if(n!==4&&(e=e.child,e!==null))for(u0(e,t,r),e=e.sibling;e!==null;)u0(e,t,r),e=e.sibling}function h0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(h0(e,t,r),e=e.sibling;e!==null;)h0(e,t,r),e=e.sibling}var tr=null,En=!1;function bs(e,t,r){for(r=r.child;r!==null;)Dw(e,t,r),r=r.sibling}function Dw(e,t,r){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(Sh,r)}catch{}switch(r.tag){case 5:fr||wo(r,t);case 6:var n=tr,s=En;tr=null,bs(e,t,r),tr=n,En=s,tr!==null&&(En?(e=tr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tr.removeChild(r.stateNode));break;case 18:tr!==null&&(En?(e=tr,r=r.stateNode,e.nodeType===8?Fd(e.parentNode,r):e.nodeType===1&&Fd(e,r),hl(e)):Fd(tr,r.stateNode));break;case 4:n=tr,s=En,tr=r.stateNode.containerInfo,En=!0,bs(e,t,r),tr=n,En=s;break;case 0:case 11:case 14:case 15:if(!fr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&((i&2)!==0||(i&4)!==0)&&l0(r,t,o),s=s.next}while(s!==n)}bs(e,t,r);break;case 1:if(!fr&&(wo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ft(r,t,a)}bs(e,t,r);break;case 21:bs(e,t,r);break;case 22:r.mode&1?(fr=(n=fr)||r.memoizedState!==null,bs(e,t,r),fr=n):bs(e,t,r);break;default:bs(e,t,r)}}function iv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new TF),t.forEach(function(n){var s=NF.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Sn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:tr=a.stateNode,En=!1;break e;case 3:tr=a.stateNode.containerInfo,En=!0;break e;case 4:tr=a.stateNode.containerInfo,En=!0;break e}a=a.return}if(tr===null)throw Error(de(160));Dw(i,o,s),tr=null,En=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ft(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Aw(t,e),t=t.sibling}function Aw(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sn(t,e),On(e),n&4){try{Ua(3,e,e.return),Dh(3,e)}catch(g){Ft(e,e.return,g)}try{Ua(5,e,e.return)}catch(g){Ft(e,e.return,g)}}break;case 1:Sn(t,e),On(e),n&512&&r!==null&&wo(r,r.return);break;case 5:if(Sn(t,e),On(e),n&512&&r!==null&&wo(r,r.return),e.flags&32){var s=e.stateNode;try{al(s,"")}catch(g){Ft(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Jx(s,i),Mf(a,o);var c=Mf(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?sC(s,h):u==="dangerouslySetInnerHTML"?rC(s,h):u==="children"?al(s,h):rg(s,u,h,c)}switch(a){case"input":Df(s,i);break;case"textarea":eC(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Fo(s,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?Fo(s,!!i.multiple,i.defaultValue,!0):Fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[ml]=i}catch(g){Ft(e,e.return,g)}}break;case 6:if(Sn(t,e),On(e),n&4){if(e.stateNode===null)throw Error(de(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){Ft(e,e.return,g)}}break;case 3:if(Sn(t,e),On(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{hl(t.containerInfo)}catch(g){Ft(e,e.return,g)}break;case 4:Sn(t,e),On(e);break;case 13:Sn(t,e),On(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Mg=Pt())),n&4&&iv(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(fr=(c=fr)||u,Sn(t,e),fr=c):Sn(t,e),On(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&(e.mode&1)!==0)for(ke=e,u=e.child;u!==null;){for(h=ke=u;ke!==null;){switch(d=ke,f=d.child,d.tag){case 0:case 11:case 14:case 15:Ua(4,d,d.return);break;case 1:wo(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Ft(n,r,g)}}break;case 5:wo(d,d.return);break;case 22:if(d.memoizedState!==null){av(h);continue}}f!==null?(f.return=d,ke=f):av(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=nC("display",o))}catch(g){Ft(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Ft(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Sn(t,e),On(e),n&4&&iv(e);break;case 21:break;default:Sn(t,e),On(e)}}function On(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_w(r)){var n=r;break e}r=r.return}throw Error(de(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(al(s,""),n.flags&=-33);var i=sv(e);h0(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=sv(e);u0(e,a,o);break;default:throw Error(de(161))}}catch(l){Ft(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _F(e,t,r){ke=e,Pw(e)}function Pw(e,t,r){for(var n=(e.mode&1)!==0;ke!==null;){var s=ke,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||bc;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||fr;a=bc;var c=fr;if(bc=o,(fr=l)&&!c)for(ke=s;ke!==null;)o=ke,l=o.child,o.tag===22&&o.memoizedState!==null?lv(s):l!==null?(l.return=o,ke=l):lv(s);for(;i!==null;)ke=i,Pw(i),i=i.sibling;ke=s,bc=a,fr=c}ov(e)}else(s.subtreeFlags&8772)!==0&&i!==null?(i.return=s,ke=i):ov(e)}}function ov(e){for(;ke!==null;){var t=ke;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:fr||Dh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!fr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:bn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Um(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Um(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&hl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}fr||t.flags&512&&c0(t)}catch(d){Ft(t,t.return,d)}}if(t===e){ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,ke=r;break}ke=t.return}}function av(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ke=r;break}ke=t.return}}function lv(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Dh(4,t)}catch(l){Ft(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Ft(t,s,l)}}var i=t.return;try{c0(t)}catch(l){Ft(t,i,l)}break;case 5:var o=t.return;try{c0(t)}catch(l){Ft(t,o,l)}}}catch(l){Ft(t,t.return,l)}if(t===e){ke=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ke=a;break}ke=t.return}}var DF=Math.ceil,Nu=Cs.ReactCurrentDispatcher,Ig=Cs.ReactCurrentOwner,mn=Cs.ReactCurrentBatchConfig,Ke=0,qt=null,Ht=null,sr=0,Vr=0,yo=ni(0),jt=0,Sl=null,Mi=0,Ah=0,Lg=0,ja=null,Ir=null,Mg=0,$o=1/0,rs=null,Bu=!1,d0=null,Us=null,Ec=!1,Ms=null,Hu=0,$a=0,f0=null,tu=-1,ru=0;function Er(){return(Ke&6)!==0?Pt():tu!==-1?tu:tu=Pt()}function js(e){return(e.mode&1)===0?1:(Ke&2)!==0&&sr!==0?sr&-sr:fF.transition!==null?(ru===0&&(ru=mC()),ru):(e=nt,e!==0||(e=window.event,e=e===void 0?16:kC(e.type)),e)}function Dn(e,t,r,n){if(50<$a)throw $a=0,f0=null,Error(de(185));Ul(e,r,n),((Ke&2)===0||e!==qt)&&(e===qt&&((Ke&2)===0&&(Ah|=r),jt===4&&Ps(e,sr)),Br(e,n),r===1&&Ke===0&&(t.mode&1)===0&&($o=Pt()+500,Th&&si()))}function Br(e,t){var r=e.callbackNode;fE(e,t);var n=Su(e,e===qt?sr:0);if(n===0)r!==null&&vm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&vm(r),t===1)e.tag===0?dF(cv.bind(null,e)):GC(cv.bind(null,e)),lF(function(){(Ke&6)===0&&si()}),r=null;else{switch(vC(n)){case 1:r=ag;break;case 4:r=gC;break;case 16:r=yu;break;case 536870912:r=pC;break;default:r=yu}r=Ww(r,Iw.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Iw(e,t){if(tu=-1,ru=0,(Ke&6)!==0)throw Error(de(327));var r=e.callbackNode;if(Ao()&&e.callbackNode!==r)return null;var n=Su(e,e===qt?sr:0);if(n===0)return null;if((n&30)!==0||(n&e.expiredLanes)!==0||t)t=Wu(e,n);else{t=n;var s=Ke;Ke|=2;var i=Mw();(qt!==e||sr!==t)&&(rs=null,$o=Pt()+500,Si(e,t));do try{IF();break}catch(a){Lw(e,a)}while(1);wg(),Nu.current=i,Ke=s,Ht!==null?t=0:(qt=null,sr=0,t=jt)}if(t!==0){if(t===2&&(s=Wf(e),s!==0&&(n=s,t=g0(e,s))),t===1)throw r=Sl,Si(e,0),Ps(e,n),Br(e,Pt()),r;if(t===6)Ps(e,n);else{if(s=e.current.alternate,(n&30)===0&&!AF(s)&&(t=Wu(e,n),t===2&&(i=Wf(e),i!==0&&(n=i,t=g0(e,i))),t===1))throw r=Sl,Si(e,0),Ps(e,n),Br(e,Pt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(de(345));case 2:gi(e,Ir,rs);break;case 3:if(Ps(e,n),(n&130023424)===n&&(t=Mg+500-Pt(),10<t)){if(Su(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Er(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Xf(gi.bind(null,e,Ir,rs),t);break}gi(e,Ir,rs);break;case 4:if(Ps(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-_n(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=Pt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*DF(n/1960))-n,10<n){e.timeoutHandle=Xf(gi.bind(null,e,Ir,rs),n);break}gi(e,Ir,rs);break;case 5:gi(e,Ir,rs);break;default:throw Error(de(329))}}}return Br(e,Pt()),e.callbackNode===r?Iw.bind(null,e):null}function g0(e,t){var r=ja;return e.current.memoizedState.isDehydrated&&(Si(e,t).flags|=256),e=Wu(e,t),e!==2&&(t=Ir,Ir=r,t!==null&&p0(t)),e}function p0(e){Ir===null?Ir=e:Ir.push.apply(Ir,e)}function AF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ps(e,t){for(t&=~Lg,t&=~Ah,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-_n(t),n=1<<r;e[r]=-1,t&=~n}}function cv(e){if((Ke&6)!==0)throw Error(de(327));Ao();var t=Su(e,0);if((t&1)===0)return Br(e,Pt()),null;var r=Wu(e,t);if(e.tag!==0&&r===2){var n=Wf(e);n!==0&&(t=n,r=g0(e,n))}if(r===1)throw r=Sl,Si(e,0),Ps(e,t),Br(e,Pt()),r;if(r===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gi(e,Ir,rs),Br(e,Pt()),null}function Og(e,t){var r=Ke;Ke|=1;try{return e(t)}finally{Ke=r,Ke===0&&($o=Pt()+500,Th&&si())}}function Oi(e){Ms!==null&&Ms.tag===0&&(Ke&6)===0&&Ao();var t=Ke;Ke|=1;var r=mn.transition,n=nt;try{if(mn.transition=null,nt=1,e)return e()}finally{nt=n,mn.transition=r,Ke=t,(Ke&6)===0&&si()}}function Ng(){Vr=yo.current,ft(yo)}function Si(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,aF(r)),Ht!==null)for(r=Ht.return;r!==null;){var n=r;switch(vg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Tu();break;case 3:Uo(),ft(Or),ft(vr),Fg();break;case 5:Eg(n);break;case 4:Uo();break;case 13:ft(yt);break;case 19:ft(yt);break;case 10:yg(n.type._context);break;case 22:case 23:Ng()}r=r.return}if(qt=e,Ht=e=$s(e.current,null),sr=Vr=t,jt=0,Sl=null,Lg=Ah=Mi=0,Ir=ja=null,xi!==null){for(t=0;t<xi.length;t++)if(r=xi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}xi=null}return e}function Lw(e,t){do{var r=Ht;try{if(wg(),qc.current=Ou,Mu){for(var n=bt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Mu=!1}if(Li=0,Xt=zt=bt=null,za=!1,Cl=0,Ig.current=null,r===null||r.return===null){jt=1,Sl=t,Ht=null;break}e:{var i=e,o=r.return,a=r,l=t;if(t=sr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if((u.mode&1)===0&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Qm(o);if(f!==null){f.flags&=-257,Zm(f,o,a,i,t),f.mode&1&&Ym(i,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break e}else{if((t&1)===0){Ym(i,c,t),Bg();break e}l=Error(de(426))}}else if(xt&&a.mode&1){var m=Qm(o);if(m!==null){(m.flags&65536)===0&&(m.flags|=256),Zm(m,o,a,i,t),xg(jo(l,a));break e}}i=l=jo(l,a),jt!==4&&(jt=2),ja===null?ja=[i]:ja.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=vw(i,l,t);zm(i,v);break e;case 1:a=l;var C=i.type,x=i.stateNode;if((i.flags&128)===0&&(typeof C.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Us===null||!Us.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=xw(i,a,t);zm(i,w);break e}}i=i.return}while(i!==null)}Nw(r)}catch(k){t=k,Ht===r&&r!==null&&(Ht=r=r.return);continue}break}while(1)}function Mw(){var e=Nu.current;return Nu.current=Ou,e===null?Ou:e}function Bg(){(jt===0||jt===3||jt===2)&&(jt=4),qt===null||(Mi&268435455)===0&&(Ah&268435455)===0||Ps(qt,sr)}function Wu(e,t){var r=Ke;Ke|=2;var n=Mw();(qt!==e||sr!==t)&&(rs=null,Si(e,t));do try{PF();break}catch(s){Lw(e,s)}while(1);if(wg(),Ke=r,Nu.current=n,Ht!==null)throw Error(de(261));return qt=null,sr=0,jt}function PF(){for(;Ht!==null;)Ow(Ht)}function IF(){for(;Ht!==null&&!sE();)Ow(Ht)}function Ow(e){var t=Hw(e.alternate,e,Vr);e.memoizedProps=e.pendingProps,t===null?Nw(e):Ht=t,Ig.current=null}function Nw(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=EF(r,t,Vr),r!==null){Ht=r;return}}else{if(r=FF(r,t),r!==null){r.flags&=32767,Ht=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{jt=6,Ht=null;return}}if(t=t.sibling,t!==null){Ht=t;return}Ht=t=e}while(t!==null);jt===0&&(jt=5)}function gi(e,t,r){var n=nt,s=mn.transition;try{mn.transition=null,nt=1,LF(e,t,r,n)}finally{mn.transition=s,nt=n}return null}function LF(e,t,r,n){do Ao();while(Ms!==null);if((Ke&6)!==0)throw Error(de(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(gE(e,i),e===qt&&(Ht=qt=null,sr=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||Ec||(Ec=!0,Ww(yu,function(){return Ao(),null})),i=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||i){i=mn.transition,mn.transition=null;var o=nt;nt=1;var a=Ke;Ke|=4,Ig.current=null,RF(e,r),Aw(r,e),eF($f),ku=!!jf,$f=jf=null,e.current=r,_F(r),iE(),Ke=a,nt=o,mn.transition=i}else e.current=r;if(Ec&&(Ec=!1,Ms=e,Hu=s),i=e.pendingLanes,i===0&&(Us=null),lE(r.stateNode),Br(e,Pt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Bu)throw Bu=!1,e=d0,d0=null,e;return(Hu&1)!==0&&e.tag!==0&&Ao(),i=e.pendingLanes,(i&1)!==0?e===f0?$a++:($a=0,f0=e):$a=0,si(),null}function Ao(){if(Ms!==null){var e=vC(Hu),t=mn.transition,r=nt;try{if(mn.transition=null,nt=16>e?16:e,Ms===null)var n=!1;else{if(e=Ms,Ms=null,Hu=0,(Ke&6)!==0)throw Error(de(331));var s=Ke;for(Ke|=4,ke=e.current;ke!==null;){var i=ke,o=i.child;if((ke.flags&16)!==0){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ke=c;ke!==null;){var u=ke;switch(u.tag){case 0:case 11:case 15:Ua(8,u,i)}var h=u.child;if(h!==null)h.return=u,ke=h;else for(;ke!==null;){u=ke;var d=u.sibling,f=u.return;if(Rw(u),u===c){ke=null;break}if(d!==null){d.return=f,ke=d;break}ke=f}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}ke=i}}if((i.subtreeFlags&2064)!==0&&o!==null)o.return=i,ke=o;else e:for(;ke!==null;){if(i=ke,(i.flags&2048)!==0)switch(i.tag){case 0:case 11:case 15:Ua(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ke=v;break e}ke=i.return}}var C=e.current;for(ke=C;ke!==null;){o=ke;var x=o.child;if((o.subtreeFlags&2064)!==0&&x!==null)x.return=o,ke=x;else e:for(o=C;ke!==null;){if(a=ke,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:Dh(9,a)}}catch(k){Ft(a,a.return,k)}if(a===o){ke=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,ke=w;break e}ke=a.return}}if(Ke=s,si(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(Sh,e)}catch{}n=!0}return n}finally{nt=r,mn.transition=t}}return!1}function uv(e,t,r){t=jo(r,t),t=vw(e,t,1),e=zs(e,t,1),t=Er(),e!==null&&(Ul(e,1,t),Br(e,t))}function Ft(e,t,r){if(e.tag===3)uv(e,e,r);else for(;t!==null;){if(t.tag===3){uv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Us===null||!Us.has(n))){e=jo(r,e),e=xw(t,e,1),t=zs(t,e,1),e=Er(),t!==null&&(Ul(t,1,e),Br(t,e));break}}t=t.return}}function MF(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Er(),e.pingedLanes|=e.suspendedLanes&r,qt===e&&(sr&r)===r&&(jt===4||jt===3&&(sr&130023424)===sr&&500>Pt()-Mg?Si(e,0):Lg|=r),Br(e,t)}function Bw(e,t){t===0&&((e.mode&1)===0?t=1:(t=pc,pc<<=1,(pc&130023424)===0&&(pc=4194304)));var r=Er();e=ms(e,t),e!==null&&(Ul(e,t,r),Br(e,r))}function OF(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Bw(e,r)}function NF(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(de(314))}n!==null&&n.delete(t),Bw(e,r)}var Hw;Hw=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Or.current)Lr=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return Lr=!1,bF(e,t,r);Lr=(e.flags&131072)!==0}else Lr=!1,xt&&(t.flags&1048576)!==0&&zC(t,Du,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;eu(e,t),e=t.pendingProps;var s=Vo(t,vr.current);Do(t,r),s=Rg(null,t,n,e,s,r);var i=_g();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nr(n)?(i=!0,Ru(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,kg(t),s.updater=_h,t.stateNode=s,s._reactInternals=t,t0(t,n,e,r),t=s0(null,t,n,!0,i,r)):(t.tag=0,xt&&i&&mg(t),Sr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(eu(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=HF(n),e=bn(n,e),s){case 0:t=n0(null,t,n,e,r);break e;case 1:t=ev(null,t,n,e,r);break e;case 11:t=qm(null,t,n,e,r);break e;case 14:t=Jm(null,t,n,bn(n.type,e),r);break e}throw Error(de(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),n0(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),ev(e,t,n,s,r);case 3:e:{if(Sw(t),e===null)throw Error(de(387));n=t.pendingProps,i=t.memoizedState,s=i.element,YC(e,t),Iu(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=jo(Error(de(423)),t),t=tv(e,t,n,r,s);break e}else if(n!==s){s=jo(Error(de(424)),t),t=tv(e,t,n,r,s);break e}else for($r=Gs(t.stateNode.containerInfo.firstChild),Kr=t,xt=!0,Fn=null,r=KC(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Go(),n===s){t=vs(e,t,r);break e}Sr(e,t,n,r)}t=t.child}return t;case 5:return QC(t),e===null&&qf(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Kf(n,s)?o=null:i!==null&&Kf(n,i)&&(t.flags|=32),yw(e,t),Sr(e,t,o,r),t.child;case 6:return e===null&&qf(t),null;case 13:return kw(e,t,r);case 4:return bg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=zo(t,null,n,r):Sr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),qm(e,t,n,s,r);case 7:return Sr(e,t,t.pendingProps,r),t.child;case 8:return Sr(e,t,t.pendingProps.children,r),t.child;case 12:return Sr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,lt(Au,n._currentValue),n._currentValue=o,i!==null)if(In(i.value,o)){if(i.children===s.children&&!Or.current){t=vs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=cs(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Jf(i.return,r,t),a.lanes|=r;break}l=l.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(de(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Jf(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Sr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Do(t,r),s=xn(s),n=n(s),t.flags|=1,Sr(e,t,n,r),t.child;case 14:return n=t.type,s=bn(n,t.pendingProps),s=bn(n.type,s),Jm(e,t,n,s,r);case 15:return Cw(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:bn(n,s),eu(e,t),t.tag=1,Nr(n)?(e=!0,Ru(t)):e=!1,Do(t,r),mw(t,n,s),t0(t,n,s,r),s0(null,t,n,!0,e,r);case 19:return bw(e,t,r);case 22:return ww(e,t,r)}throw Error(de(156,t.tag))};function Ww(e,t){return fC(e,t)}function BF(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(e,t,r,n){return new BF(e,t,r,n)}function Hg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function HF(e){if(typeof e=="function")return Hg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sg)return 11;if(e===ig)return 14}return 2}function $s(e,t){var r=e.alternate;return r===null?(r=fn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function nu(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")Hg(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case uo:return ki(r.children,s,i,t);case ng:o=8,s|=8;break;case Ef:return e=fn(12,r,t,s|2),e.elementType=Ef,e.lanes=i,e;case Ff:return e=fn(13,r,t,s),e.elementType=Ff,e.lanes=i,e;case Tf:return e=fn(19,r,t,s),e.elementType=Tf,e.lanes=i,e;case Qx:return Ph(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xx:o=10;break e;case Yx:o=9;break e;case sg:o=11;break e;case ig:o=14;break e;case Ts:o=16,n=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=fn(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function ki(e,t,r,n){return e=fn(7,e,n,t),e.lanes=r,e}function Ph(e,t,r,n){return e=fn(22,e,n,t),e.elementType=Qx,e.lanes=r,e.stateNode={isHidden:!1},e}function Ld(e,t,r){return e=fn(6,e,null,t),e.lanes=r,e}function Md(e,t,r){return t=fn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function WF(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pd(0),this.expirationTimes=pd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pd(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wg(e,t,r,n,s,i,o,a,l){return e=new WF(e,t,r,a,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},kg(i),e}function VF(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:co,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Vw(e){if(!e)return Zs;e=e._reactInternals;e:{if($i(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var r=e.type;if(Nr(r))return VC(e,r,t)}return t}function Gw(e,t,r,n,s,i,o,a,l){return e=Wg(r,n,!0,e,s,i,o,a,l),e.context=Vw(null),r=e.current,n=Er(),s=js(r),i=cs(n,s),i.callback=t!=null?t:null,zs(r,i,s),e.current.lanes=s,Ul(e,s,n),Br(e,n),e}function Ih(e,t,r,n){var s=t.current,i=Er(),o=js(s);return r=Vw(r),t.context===null?t.context=r:t.pendingContext=r,t=cs(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zs(s,t,o),e!==null&&(Dn(e,s,o,i),Zc(e,s,o)),o}function Vu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Vg(e,t){hv(e,t),(e=e.alternate)&&hv(e,t)}function GF(){return null}var zw=typeof reportError=="function"?reportError:function(e){console.error(e)};function Gg(e){this._internalRoot=e}Lh.prototype.render=Gg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));Ih(e,t,null,null)};Lh.prototype.unmount=Gg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Oi(function(){Ih(null,e,null,null)}),t[ps]=null}};function Lh(e){this._internalRoot=e}Lh.prototype.unstable_scheduleHydration=function(e){if(e){var t=wC();e={blockedOn:null,target:e,priority:t};for(var r=0;r<As.length&&t!==0&&t<As[r].priority;r++);As.splice(r,0,e),r===0&&SC(e)}};function zg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Mh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function dv(){}function zF(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Vu(o);i.call(c)}}var o=Gw(t,n,e,0,null,!1,!1,"",dv);return e._reactRootContainer=o,e[ps]=o.current,gl(e.nodeType===8?e.parentNode:e),Oi(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var c=Vu(l);a.call(c)}}var l=Wg(e,0,!1,null,null,!1,!1,"",dv);return e._reactRootContainer=l,e[ps]=l.current,gl(e.nodeType===8?e.parentNode:e),Oi(function(){Ih(t,l,r,n)}),l}function Oh(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Vu(o);a.call(l)}}Ih(t,o,e,s)}else o=zF(r,t,e,s,n);return Vu(o)}xC=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Da(t.pendingLanes);r!==0&&(lg(t,r|1),Br(t,Pt()),(Ke&6)===0&&($o=Pt()+500,si()))}break;case 13:Oi(function(){var n=ms(e,1);if(n!==null){var s=Er();Dn(n,e,1,s)}}),Vg(e,1)}};cg=function(e){if(e.tag===13){var t=ms(e,134217728);if(t!==null){var r=Er();Dn(t,e,134217728,r)}Vg(e,134217728)}};CC=function(e){if(e.tag===13){var t=js(e),r=ms(e,t);if(r!==null){var n=Er();Dn(r,e,t,n)}Vg(e,t)}};wC=function(){return nt};yC=function(e,t){var r=nt;try{return nt=e,t()}finally{nt=r}};Nf=function(e,t,r){switch(t){case"input":if(Df(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Fh(n);if(!s)throw Error(de(90));qx(n),Df(n,s)}}}break;case"textarea":eC(e,r);break;case"select":t=r.value,t!=null&&Fo(e,!!r.multiple,t,!1)}};aC=Og;lC=Oi;var UF={usingClientEntryPoint:!1,Events:[$l,po,Fh,iC,oC,Og]},ka={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jF={bundleType:ka.bundleType,version:ka.version,rendererPackageName:ka.rendererPackageName,rendererConfig:ka.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hC(e),e===null?null:e.stateNode},findFiberByHostInstance:ka.findFiberByHostInstance||GF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fc.isDisabled&&Fc.supportsFiber)try{Sh=Fc.inject(jF),Kn=Fc}catch{}}Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UF;Zr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zg(t))throw Error(de(200));return VF(e,t,null,r)};Zr.createRoot=function(e,t){if(!zg(e))throw Error(de(299));var r=!1,n="",s=zw;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Wg(e,1,!1,null,null,r,!1,n,s),e[ps]=t.current,gl(e.nodeType===8?e.parentNode:e),new Gg(t)};Zr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=hC(t),e=e===null?null:e.stateNode,e};Zr.flushSync=function(e){return Oi(e)};Zr.hydrate=function(e,t,r){if(!Mh(t))throw Error(de(200));return Oh(null,e,t,!0,r)};Zr.hydrateRoot=function(e,t,r){if(!zg(e))throw Error(de(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=zw;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Gw(t,null,e,1,r!=null?r:null,s,!1,i,o),e[ps]=t.current,gl(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Lh(t)};Zr.render=function(e,t,r){if(!Mh(t))throw Error(de(200));return Oh(null,e,t,!1,r)};Zr.unmountComponentAtNode=function(e){if(!Mh(e))throw Error(de(40));return e._reactRootContainer?(Oi(function(){Oh(null,null,e,!1,function(){e._reactRootContainer=null,e[ps]=null})}),!0):!1};Zr.unstable_batchedUpdates=Og;Zr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Mh(r))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return Oh(e,t,r,!1,n)};Zr.version="18.3.1-next-f1338f8080-20240426";(function(e){function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}t(),e.exports=Zr})(ea);const Uw=Ox(ea.exports),$F=Mx({__proto__:null,default:Uw},[ea.exports]);var jw,fv=ea.exports;jw=fv.createRoot,fv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kl.apply(this,arguments)}var Os;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Os||(Os={}));const gv="popstate";function KF(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:o,hash:a}=n.location;return m0("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Gu(s)}return YF(t,r,null,e)}function Wt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $w(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function XF(){return Math.random().toString(36).substr(2,8)}function pv(e,t){return{usr:e.state,key:e.key,idx:t}}function m0(e,t,r,n){return r===void 0&&(r=null),kl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?na(t):t,{state:r,key:t&&t.key||n||XF()})}function Gu(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function na(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function YF(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a=Os.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(kl({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Os.Pop;let m=u(),v=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:v})}function d(m,v){a=Os.Push;let C=m0(g.location,m,v);r&&r(C,m),c=u()+1;let x=pv(C,c),w=g.createHref(C);try{o.pushState(x,"",w)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(w)}i&&l&&l({action:a,location:g.location,delta:1})}function f(m,v){a=Os.Replace;let C=m0(g.location,m,v);r&&r(C,m),c=u();let x=pv(C,c),w=g.createHref(C);o.replaceState(x,"",w),i&&l&&l({action:a,location:g.location,delta:0})}function p(m){let v=s.location.origin!=="null"?s.location.origin:s.location.href,C=typeof m=="string"?m:Gu(m);return C=C.replace(/ $/,"%20"),Wt(v,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,v)}let g={get action(){return a},get location(){return e(s,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(gv,h),l=m,()=>{s.removeEventListener(gv,h),l=null}},createHref(m){return t(s,m)},createURL:p,encodeLocation(m){let v=p(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(m){return o.go(m)}};return g}var mv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mv||(mv={}));function QF(e,t,r){return r===void 0&&(r="/"),ZF(e,t,r,!1)}function ZF(e,t,r,n){let s=typeof t=="string"?na(t):t,i=Ug(s.pathname||"/",r);if(i==null)return null;let o=Kw(e);qF(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=cT(i);a=aT(o[l],c,n)}return a}function Kw(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Wt(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ks([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(Wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Kw(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:iT(c,i.index),routesMeta:u})};return e.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of Xw(i.path))s(i,o,l)}),t}function Xw(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=Xw(n.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>e.startsWith("/")&&l===""?"/":l)}function qF(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:oT(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const JF=/^:[\w-]+$/,eT=3,tT=2,rT=1,nT=10,sT=-2,vv=e=>e==="*";function iT(e,t){let r=e.split("/"),n=r.length;return r.some(vv)&&(n+=sT),t&&(n+=tT),r.filter(s=>!vv(s)).reduce((s,i)=>s+(JF.test(i)?eT:i===""?rT:nT),n)}function oT(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function aT(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},i="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=xv({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=xv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ks([i,h.pathname]),pathnameBase:fT(Ks([i,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(i=Ks([i,h.pathnameBase]))}return o}function xv(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=lT(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?c[d]=void 0:c[d]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:e}}function lT(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),$w(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function cT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return $w(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ug(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function uT(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?na(e):e;return{pathname:r?r.startsWith("/")?r:hT(r,t):t,search:gT(n),hash:pT(s)}}function hT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Od(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Yw(e,t){let r=dT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Qw(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=na(e):(s=kl({},e),Wt(!s.pathname||!s.pathname.includes("?"),Od("?","pathname","search",s)),Wt(!s.pathname||!s.pathname.includes("#"),Od("#","pathname","hash",s)),Wt(!s.search||!s.search.includes("#"),Od("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=r;else{let h=t.length-1;if(!n&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}a=h>=0?t[h]:"/"}let l=uT(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ks=e=>e.join("/").replace(/\/\/+/g,"/"),fT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gT=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,pT=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function mT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const vT=["post","put","patch","delete"];[...vT];var Nh={exports:{}},Bh={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xT=S.exports,CT=Symbol.for("react.element"),wT=Symbol.for("react.fragment"),yT=Object.prototype.hasOwnProperty,ST=xT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kT={key:!0,ref:!0,__self:!0,__source:!0};function Zw(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)yT.call(t,n)&&!kT.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:CT,type:e,key:i,ref:o,props:s,_owner:ST.current}}Bh.Fragment=wT;Bh.jsx=Zw;Bh.jsxs=Zw;(function(e){e.exports=Bh})(Nh);const qw=Nh.exports.Fragment,ge=Nh.exports.jsx,$e=Nh.exports.jsxs;/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bl.apply(this,arguments)}const jg=S.exports.createContext(null),bT=S.exports.createContext(null),Ki=S.exports.createContext(null),Hh=S.exports.createContext(null),ii=S.exports.createContext({outlet:null,matches:[],isDataRoute:!1}),Jw=S.exports.createContext(null);function ET(e,t){let{relative:r}=t===void 0?{}:t;Xl()||Wt(!1);let{basename:n,navigator:s}=S.exports.useContext(Ki),{hash:i,pathname:o,search:a}=ty(e,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:Ks([n,o])),s.createHref({pathname:l,search:a,hash:i})}function Xl(){return S.exports.useContext(Hh)!=null}function Wh(){return Xl()||Wt(!1),S.exports.useContext(Hh).location}function ey(e){S.exports.useContext(Ki).static||S.exports.useLayoutEffect(e)}function FT(){let{isDataRoute:e}=S.exports.useContext(ii);return e?WT():TT()}function TT(){Xl()||Wt(!1);let e=S.exports.useContext(jg),{basename:t,future:r,navigator:n}=S.exports.useContext(Ki),{matches:s}=S.exports.useContext(ii),{pathname:i}=Wh(),o=JSON.stringify(Yw(s,r.v7_relativeSplatPath)),a=S.exports.useRef(!1);return ey(()=>{a.current=!0}),S.exports.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let h=Qw(c,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ks([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,o,i,e])}function RT(){let{matches:e}=S.exports.useContext(ii),t=e[e.length-1];return t?t.params:{}}function ty(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=S.exports.useContext(Ki),{matches:s}=S.exports.useContext(ii),{pathname:i}=Wh(),o=JSON.stringify(Yw(s,n.v7_relativeSplatPath));return S.exports.useMemo(()=>Qw(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function _T(e,t){return DT(e,t)}function DT(e,t,r,n){Xl()||Wt(!1);let{navigator:s}=S.exports.useContext(Ki),{matches:i}=S.exports.useContext(ii),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Wh(),u;if(t){var h;let m=typeof t=="string"?na(t):t;l==="/"||((h=m.pathname)==null?void 0:h.startsWith(l))||Wt(!1),u=m}else u=c;let d=u.pathname||"/",f=d;if(l!=="/"){let m=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let p=QF(e,{pathname:f}),g=MT(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:Ks([l,s.encodeLocation?s.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:Ks([l,s.encodeLocation?s.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,r,n);return t&&g?ge(Hh.Provider,{value:{location:bl({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Os.Pop},children:g}):g}function AT(){let e=HT(),t=mT(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null;return $e(qw,{children:[ge("h2",{children:"Unexpected Application Error!"}),ge("h3",{style:{fontStyle:"italic"},children:t}),r?ge("pre",{style:{padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},children:r}):null,null]})}const PT=ge(AT,{});class IT extends S.exports.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ge(ii.Provider,{value:this.props.routeContext,children:ge(Jw.Provider,{value:this.state.error,children:this.props.component})}):this.props.children}}function LT(e){let{routeContext:t,match:r,children:n}=e,s=S.exports.useContext(jg);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),ge(ii.Provider,{value:t,children:n})}function MT(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,a=(s=r)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Wt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=r,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let f,p=!1,g=null,m=null;r&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||PT,l&&(c<0&&d===0?(VT("route-fallback",!1),p=!0,m=null):c===d&&(p=!0,m=h.route.hydrateFallbackElement||null)));let v=t.concat(o.slice(0,d+1)),C=()=>{let x;return f?x=g:p?x=m:h.route.Component?x=S.exports.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,ge(LT,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:x})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?ge(IT,{location:r.location,revalidation:r.revalidation,component:g,error:f,children:C(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):C()},null)}var ry=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ry||{}),zu=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(zu||{});function OT(e){let t=S.exports.useContext(jg);return t||Wt(!1),t}function NT(e){let t=S.exports.useContext(bT);return t||Wt(!1),t}function BT(e){let t=S.exports.useContext(ii);return t||Wt(!1),t}function ny(e){let t=BT(),r=t.matches[t.matches.length-1];return r.route.id||Wt(!1),r.route.id}function HT(){var e;let t=S.exports.useContext(Jw),r=NT(zu.UseRouteError),n=ny(zu.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function WT(){let{router:e}=OT(ry.UseNavigateStable),t=ny(zu.UseNavigateStable),r=S.exports.useRef(!1);return ey(()=>{r.current=!0}),S.exports.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,bl({fromRouteId:t},i)))},[e,t])}const Cv={};function VT(e,t,r){!t&&!Cv[e]&&(Cv[e]=!0)}function GT(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}const zT="startTransition";J0[zT];function su(e){Wt(!1)}function UT(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Os.Pop,navigator:i,static:o=!1,future:a}=e;Xl()&&Wt(!1);let l=t.replace(/^\/*/,"/"),c=S.exports.useMemo(()=>({basename:l,navigator:i,static:o,future:bl({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof n=="string"&&(n=na(n));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=n,g=S.exports.useMemo(()=>{let m=Ug(u,l);return m==null?null:{location:{pathname:m,search:h,hash:d,state:f,key:p},navigationType:s}},[l,u,h,d,f,p,s]);return g==null?null:ge(Ki.Provider,{value:c,children:ge(Hh.Provider,{children:r,value:g})})}function jT(e){let{children:t,location:r}=e;return _T(v0(t),r)}new Promise(()=>{});function v0(e,t){t===void 0&&(t=[]);let r=[];return S.exports.Children.forEach(e,(n,s)=>{if(!S.exports.isValidElement(n))return;let i=[...t,s];if(n.type===S.exports.Fragment){r.push.apply(r,v0(n.props.children,i));return}n.type!==su&&Wt(!1),!n.props.index||!n.props.children||Wt(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=v0(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $T(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function KT(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function XT(e,t){return e.button===0&&(!t||t==="_self")&&!KT(e)}const YT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],QT="6";try{window.__reactRouterVersion=QT}catch{}const ZT="startTransition",wv=J0[ZT],qT="flushSync";$F[qT];const JT="useId";J0[JT];function eR(e){let{basename:t,children:r,future:n,window:s}=e,i=S.exports.useRef();i.current==null&&(i.current=KF({window:s,v5Compat:!0}));let o=i.current,[a,l]=S.exports.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},u=S.exports.useCallback(h=>{c&&wv?wv(()=>l(h)):l(h)},[l,c]);return S.exports.useLayoutEffect(()=>o.listen(u),[o,u]),S.exports.useEffect(()=>GT(n),[n]),ge(UT,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const tR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,So=S.exports.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=t,d=$T(t,YT),{basename:f}=S.exports.useContext(Ki),p,g=!1;if(typeof c=="string"&&rR.test(c)&&(p=c,tR))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),k=Ug(w.pathname,f);w.origin===x.origin&&k!=null?c=k+w.search+w.hash:g=!0}catch{}let m=ET(c,{relative:s}),v=nR(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function C(x){n&&n(x),x.defaultPrevented||v(x)}return ge("a",{...d,href:p||m,onClick:g||i?n:C,ref:r,target:l})});var yv;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(yv||(yv={}));var Sv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Sv||(Sv={}));function nR(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:a}=t===void 0?{}:t,l=FT(),c=Wh(),u=ty(e,{relative:o});return S.exports.useCallback(h=>{if(XT(h,r)){h.preventDefault();let d=n!==void 0?n:Gu(c)===Gu(u);l(e,{replace:d,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,n,s,r,e,i,o,a])}const sR=({title:e,excerpt:t,slug:r,date:n})=>$e("div",{className:"card",style:{padding:"24px",cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:i=>{i.currentTarget.style.transform="translateY(-4px)",i.currentTarget.style.boxShadow="0 8px 24px rgba(37, 66, 82, 0.15)"},onMouseLeave:i=>{i.currentTarget.style.transform="translateY(0)",i.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)"},children:[n&&ge("div",{style:{color:"#F9982F",fontSize:"14px",fontWeight:"600",marginBottom:"12px"},children:(i=>i?new Date(i).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"}):"")(n)}),ge("h2",{style:{color:"#254252",fontSize:"24px",marginBottom:"12px",fontWeight:"600"},children:e}),ge("p",{style:{color:"#666",lineHeight:"1.6",marginBottom:"16px"},children:t}),ge(So,{to:`/post/${r}`,style:{color:"#E37239",textDecoration:"none",fontWeight:"600",fontSize:"15px",display:"inline-flex",alignItems:"center",gap:"8px"},onMouseEnter:i=>{i.currentTarget.style.color="#F9982F"},onMouseLeave:i=>{i.currentTarget.style.color="#E37239"},children:"Czytaj wi\u0119cej \u2192"})]}),sy=[{id:"1",slug:"sample-post",title:"Sample Post \u2014 Getting started",date:"2025-10-27",excerpt:"Kr\xF3tki wpis pokazowy u\u017Cywany do test\xF3w aplikacji.",content:"To jest przyk\u0142adowy wpis \u2014 mo\u017Cesz podmieni\u0107 zawarto\u015B\u0107 na w\u0142asn\u0105."},{id:"2",slug:"raport-budzetu-2025",title:"Raport bud\u017Cetu 2025 \u2013 wydatki i dochody",date:"2025-10-20",excerpt:"Raport za ostatnie 9 miesiecy",content:"teksast tekst ",excel:{file:"/data/analiza.xlsx"}}];async function iR(){return sy}async function oR(e){return sy.find(t=>t.slug===e)}const aR=()=>{const[e,t]=S.exports.useState([]),[r,n]=S.exports.useState(""),[s,i]=S.exports.useState("newest"),[o,a]=S.exports.useState(!1);S.exports.useEffect(()=>{(async()=>{const u=await iR();t(u)})()},[]);const l=e.filter(c=>{var h;if(!r.trim())return!0;const u=r.toLowerCase();return c.title.toLowerCase().includes(u)||((h=c.excerpt)==null?void 0:h.toLowerCase().includes(u))||c.content.toLowerCase().includes(u)}).sort((c,u)=>{const h=new Date(c.date||"").getTime(),d=new Date(u.date||"").getTime();return s==="newest"?d-h:h-d});return $e("div",{className:"container",children:[$e("div",{style:{marginBottom:"32px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"24px",flexWrap:"wrap"},children:[$e("div",{children:[ge("h1",{style:{fontSize:"32px",marginBottom:"8px",color:"#254252"},children:"Raporty i Analizy"}),ge("p",{style:{color:"#666",fontSize:"16px",margin:0},children:"Przejrzyste dane publiczne z interaktywnymi tabelami"})]}),$e("div",{style:{minWidth:"300px",maxWidth:"400px",display:"flex",gap:"8px",alignItems:"center"},children:[ge("input",{type:"text",placeholder:"Szukaj raport\xF3w...",value:r,onChange:c=>n(c.target.value),style:{flex:1,padding:"12px 16px",border:"1px solid #E0E0E0",borderRadius:"8px",fontSize:"15px",outline:"none",transition:"border-color 0.2s"},onFocus:c=>c.target.style.borderColor="#E37239",onBlur:c=>c.target.style.borderColor="#E0E0E0"}),$e("div",{style:{position:"relative"},children:[$e("button",{onClick:()=>a(!o),style:{padding:"12px 16px",border:"1px solid #E0E0E0",borderRadius:"8px",background:"white",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},onMouseEnter:c=>{c.currentTarget.style.borderColor="#E37239",c.currentTarget.style.color="#E37239"},onMouseLeave:c=>{c.currentTarget.style.borderColor="#E0E0E0",c.currentTarget.style.color="#666"},children:["Filtruj",ge("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:ge("path",{d:"M6 8L3 5h6z"})})]}),o&&$e("div",{style:{position:"absolute",top:"calc(100% + 4px)",right:0,background:"white",border:"1px solid #E0E0E0",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",zIndex:100,minWidth:"150px"},children:[ge("button",{onClick:()=>{i("newest"),a(!1)},style:{width:"100%",padding:"12px 16px",border:"none",background:s==="newest"?"#FFF4ED":"transparent",color:s==="newest"?"#E37239":"#666",fontWeight:s==="newest"?"600":"500",cursor:"pointer",fontSize:"14px",textAlign:"left",borderRadius:"8px 8px 0 0",transition:"background 0.2s"},onMouseEnter:c=>{s!=="newest"&&(c.currentTarget.style.background="#f5f5f5")},onMouseLeave:c=>{s!=="newest"&&(c.currentTarget.style.background="transparent")},children:"Najnowsze"}),ge("button",{onClick:()=>{i("oldest"),a(!1)},style:{width:"100%",padding:"12px 16px",border:"none",background:s==="oldest"?"#FFF4ED":"transparent",color:s==="oldest"?"#E37239":"#666",fontWeight:s==="oldest"?"600":"500",cursor:"pointer",fontSize:"14px",textAlign:"left",borderRadius:"0 0 8px 8px",transition:"background 0.2s"},onMouseEnter:c=>{s!=="oldest"&&(c.currentTarget.style.background="#f5f5f5")},onMouseLeave:c=>{s!=="oldest"&&(c.currentTarget.style.background="transparent")},children:"Najstarsze"})]})]})]})]}),l.length===0?ge("div",{className:"card",style:{textAlign:"center",padding:"40px"},children:ge("p",{style:{color:"#666",margin:0},children:"Nie znaleziono raport\xF3w pasuj\u0105cych do wyszukiwania."})}):ge("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:"24px"},children:l.map(c=>ge(sR,{...c,excerpt:c.excerpt||""},c.id))})]})};var Yl=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const n=t?this.allAsyncListeners:this.allSyncListeners;let s=n.get(e);return!s&&r&&(s=new Set,n.set(e,s)),s}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const n=this.getListeners(e,r,!1);!n||(n.delete(t),n.size===0&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){var a;const r=e.type;if(t&&"event"in e){const l=e.event;l instanceof Event&&(e.eventPath=l.composedPath())}const{frameworkOverrides:n}=this,s=l=>{const c=n?()=>n.wrapIncoming(l):l;t?this.dispatchAsync(c):c()},i=this.getListeners(r,t,!1);if(((a=i==null?void 0:i.size)!=null?a:0)>0){const l=new Set(i);for(const c of l)!(i!=null&&i.has(c))||s(()=>c(e))}const o=this.getGlobalListeners(t);if(o.size>0){const l=new Set(o);for(const c of l)s(()=>c(r,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(const t of e)t()}};function bi(e){return e==null||e===""?null:e}function Be(e){return e!=null&&e!==""}function Jt(e){return!Be(e)}function x0(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function lR(e,t,r=!1){const n=e==null,s=t==null;if(e!=null&&e.toNumber&&(e=e.toNumber()),t!=null&&t.toNumber&&(t=t.toNumber()),n&&s)return 0;if(n)return-1;if(s)return 1;function i(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!r)return i(e,t);try{return e.localeCompare(t)}catch{return i(e,t)}}var cR=/[&<>"']/g,uR={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Vh(e){var t;return(t=e==null?void 0:e.toString().toString())!=null?t:null}function Ka(e){var t,r;return(r=(t=Vh(e))==null?void 0:t.replace(cR,n=>uR[n]))!=null?r:null}function Vn(e){return e.eRootDiv.getRootNode()}function xr(e){return Vn(e).activeElement}function Ln(e){const{gos:t,eRootDiv:r}=e;let n=null;const s=t.get("getDocument");return s&&Be(s)?n=s():r&&(n=r.ownerDocument),n&&Be(n)?n:document}function hR(e){const t=xr(e);return t===null||t===Ln(e).body}function iy(e){return Ln(e).defaultView||window}function $g(e){let t=null,r=null;try{t=Ln(e).fullscreenElement}catch{}finally{t||(t=Vn(e));const n=t.querySelector("body");n?r=n:t instanceof ShadowRoot?r=t:t instanceof Document?r=t==null?void 0:t.documentElement:r=t}return r}function dR(e){var r;const t=$g(e);return(r=t==null?void 0:t.clientWidth)!=null?r:window.innerWidth||-1}function fR(e){var r;const t=$g(e);return(r=t==null?void 0:t.clientHeight)!=null?r:window.innerHeight||-1}function Xi(e,t,r){r==null||typeof r=="string"&&r==""?oy(e,t):oi(e,t,r)}function oi(e,t,r){e.setAttribute(ay(t),r.toString())}function oy(e,t){e.removeAttribute(ay(t))}function ay(e){return`aria-${e}`}function kv(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function gR(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function pR(e){return e.getAttribute("aria-label")}function Uu(e,t){Xi(e,"label",t)}function ju(e,t){Xi(e,"labelledby",t)}function ly(e,t){Xi(e,"live",t)}function mR(e,t){Xi(e,"atomic",t)}function vR(e,t){Xi(e,"relevant",t)}function xR(e,t){Xi(e,"invalid",t)}function cy(e,t){Xi(e,"hidden",t)}function CR(e,t){oi(e,"expanded",t)}function wR(e,t){oi(e,"rowcount",t)}function yR(e,t){oi(e,"rowindex",t)}function SR(e,t){oi(e,"colcount",t)}function uy(e,t){oi(e,"colindex",t)}function kR(e,t){oi(e,"colspan",t)}function bR(e,t){oi(e,"sort",t)}function ER(e){oy(e,"sort")}function FR(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var TR="[tabindex], input, select, button, textarea, [href]",hy="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Xa(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(hy)?!1:sa(e)}function Yt(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-hidden",!t),n||cy(e,!t)}function RR(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-invisible",!t),n||cy(e,!t)}function dy(e,t){var i;const r="disabled",n=t?o=>o.setAttribute(r,""):o=>o.removeAttribute(r);n(e);const s=(i=e.querySelectorAll("input"))!=null?i:[];for(const o of s)n(o)}function Po(e,t,r){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof r=="number"){if(++n>r)break}else if(e===r)break}return!1}function Gh(e){const{height:t,width:r,borderTopWidth:n,borderRightWidth:s,borderBottomWidth:i,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:h,marginRight:d,marginBottom:f,marginLeft:p,boxSizing:g}=window.getComputedStyle(e),m=Number.parseFloat;return{height:m(t||"0"),width:m(r||"0"),borderTopWidth:m(n||"0"),borderRightWidth:m(s||"0"),borderBottomWidth:m(i||"0"),borderLeftWidth:m(o||"0"),paddingTop:m(a||"0"),paddingRight:m(l||"0"),paddingBottom:m(c||"0"),paddingLeft:m(u||"0"),marginTop:m(h||"0"),marginRight:m(d||"0"),marginBottom:m(f||"0"),marginLeft:m(p||"0"),boxSizing:g}}function fy(e){const t=Gh(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function $u(e){const t=Gh(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function _R(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:n,borderRightWidth:s,borderBottomWidth:i}=Gh(e);return{top:t.top+(r||0),left:t.left+(n||0),right:t.right+(s||0),bottom:t.bottom+(i||0)}}function Ku(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r)),r}function Xu(e,t,r){r&&(t*=-1),e.scrollLeft=t}function Ql(e){for(;e!=null&&e.firstChild;)e.firstChild.remove()}function C0(e){e!=null&&e.parentNode&&e.remove()}function gy(e){return!!e.offsetParent}function sa(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!gy(e)||window.getComputedStyle(e).visibility!=="visible")}function Kg(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function DR(e){return e.clientWidth<e.scrollWidth}function AR(e){return e.clientHeight<e.scrollHeight}function py(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Xs(e,t)}function Xs(e,t){t=my(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Nd(e,t){t=my(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function my(e){return typeof e=="number"?`${e}px`:e}function vy(e){return e instanceof Node||e instanceof HTMLElement}function wi(e,t,r){r==null||r===""?e.removeAttribute(t):e.setAttribute(t,r.toString())}function ia(e,t,r){const s=iy(e).ResizeObserver,i=s?new s(r):null;return i==null||i.observe(t),()=>i==null?void 0:i.disconnect()}function ai(e,t){const r=iy(e);r.requestAnimationFrame?r.requestAnimationFrame(t):r.webkitRequestAnimationFrame?r.webkitRequestAnimationFrame(t):r.setTimeout(t,0)}var xy="data-ref",ba;function bv(){return ba!=null||(ba=document.createTextNode(" ")),ba.cloneNode()}function zh(e){const{attrs:t,children:r,cls:n,ref:s,role:i,tag:o}=e,a=document.createElement(o);if(n&&(a.className=n),s&&a.setAttribute(xy,s),i&&a.setAttribute("role",i),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(r)if(typeof r=="string")a.textContent=r;else{let l=!0;for(const c of r)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(bv()),l=!1),a.append(zh(c)),a.appendChild(bv())))}return a}var PR=["touchstart","touchend","touchmove","touchcancel","scroll"],IR=["wheel"],Bd={},Cy=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if(typeof Bd[r]=="boolean")return Bd[r];const n=document.createElement(e[r]||"div");return r="on"+r,Bd[r]=r in n}})();function LR(e,t,r){const n=MR(t);let s;n!=null&&(s={passive:n}),e.addEventListener(t,r,s)}var MR=e=>{const t=PR.includes(e),r=IR.includes(e);if(t)return!0;if(r)return!1};function wy(e,t,r){if(r===0)return!1;const n=Math.abs(e.clientX-t.clientX),s=Math.abs(e.clientY-t.clientY);return Math.max(n,s)<=r}var Ya=(e,t)=>{const r=e.identifier;for(let n=0,s=t.length;n<s;++n){const i=t[n];if(i.identifier===r)return i}return null};function El(e,t){return e.gos.isElementInThisInstance(t.target)}function OR(e,t,r){const s=e.getBoundingClientRect().height,i=dR(r)-2,o=fR(r)-2;if(!e.offsetParent)return;const l=_R(e.offsetParent),{clientY:c,clientX:u}=t;let h=c-l.top-s/2,d=u-l.left-10;const f=Ln(r),p=f.defaultView||window,g=p.pageYOffset||f.documentElement.scrollTop,m=p.pageXOffset||f.documentElement.scrollLeft;i>0&&d+e.clientWidth>i+m&&(d=i+m-e.clientWidth),d<0&&(d=0),o>0&&h+e.clientHeight>o+g&&(h=o+g-e.clientHeight),h<0&&(h=0),e.style.left=`${d}px`,e.style.top=`${h}px`}var iu=(e,...t)=>{for(const r of t){const[n,s,i,o]=r;n.addEventListener(s,i,o),e.push(r)}},Xg=e=>{if(e){for(const[t,r,n,s]of e)t.removeEventListener(r,n,s);e.length=0}},_s=e=>{e.cancelable&&e.preventDefault()};function NR(e,t){return t}function yy(e){var t;return(t=e==null?void 0:e.getLocaleTextFunc())!=null?t:NR}var Yi=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new Yl),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){var n;(n=this.localEventService)==null||n.removeEventListener(e,t,r)}dispatchLocalEvent(e){var t;(t=this.localEventService)==null||t.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const n of Object.keys(t)){const s=t[n];s&&r.push(this._setupListener(e,n,s))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;let n;if(BR(e))e.__addEventListener(t,r),n=()=>(e.__removeEventListener(t,r),null);else{const s=HR(e);e instanceof HTMLElement?LR(e,t,r):s?e.addListener(t,r):e.addEventListener(t,r),n=s?()=>(e.removeListener(t,r),null):()=>(e.removeEventListener(t,r),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==n),null)}setupPropertyListener(e,t){const{gos:r}=this;r.addPropertyEventListener(e,t);const n=()=>(r.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(s=>s!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,n=s=>{if(s.changeSet){if(s.changeSet&&s.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=s.changeSet.id}const i={type:"propertyChanged",changeSet:s.changeSet,source:s.source};t(i)};for(const s of e)this.setupPropertyListener(s,n)}getLocaleTextFunc(){return yy(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function BR(e){return e.__addEventListener!==void 0}function HR(e){return e.eventServiceType==="global"}var we=class extends Yi{},Ev={};function Sy(e,t){Ev[t]||(e(),Ev[t]=!0)}var WR={pending:!1,funcs:[]},VR={pending:!1,funcs:[]};function w0(e,t="setTimeout",r){const n=t==="raf"?VR:WR;if(n.funcs.push(e),n.pending)return;n.pending=!0;const s=()=>{const i=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(const o of i)o()};t==="raf"?ai(r,s):window.setTimeout(s,0)}function Pa(e,t,r){let n;return function(...s){const i=this;window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(i,s)},r)}}function Fv(e,t){let r=0;return function(...n){const s=this,i=Date.now();i-r<t||(r=i,e.apply(s,n))}}function GR(e,t,r,n=100){const s=Date.now();let i=null,o=!1;const a=()=>{i!=null&&(window.clearInterval(i),i=null)};e.addDestroyFunc(a);const l=()=>{const c=Date.now()-s>n;(t()||c)&&(r(),o=!0,a())};l(),o||(i=window.setInterval(l,10))}var zR=new Set(["__proto__","constructor","prototype"]);function UR(e,t){if(e!=null){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const r of Object.keys(e).filter(n=>!zR.has(n)))t(r,e[r])}}function Xr(e,t,r=!0,n=!1){!Be(t)||UR(t,(s,i)=>{let o=e[s];o!==i&&(n&&o==null&&i!=null&&typeof i=="object"&&i.constructor===Object&&(o={},e[s]=o),Tv(i)&&Tv(o)&&!Array.isArray(o)?Xr(o,i,r,n):(r||i!==void 0)&&(e[s]=i))})}function Tv(e){return typeof e=="object"&&e!==null}var Yg=class ts{static applyGlobalGridOptions(t){if(!ts.gridOptions)return{...t};let r={};return Xr(r,ts.gridOptions,!0,!0),ts.mergeStrategy==="deep"?Xr(r,t,!0,!0):r={...r,...t},ts.gridOptions.context&&(r.context=ts.gridOptions.context),t.context&&(ts.mergeStrategy==="deep"&&r.context&&Xr(t.context,r.context,!0,!0),r.context=t.context),r}static applyGlobalGridOption(t,r){if(ts.mergeStrategy==="deep"){const n=ky(t);if(n&&typeof n=="object"&&typeof r=="object")return ts.applyGlobalGridOptions({[t]:r})[t]}return r}};Yg.gridOptions=void 0;Yg.mergeStrategy="shallow";var Qg=Yg;function ky(e){var t;return(t=Qg.gridOptions)==null?void 0:t[e]}var by={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},Ey="https://www.ag-grid.com";function Yu(e,t,...r){e.get("debug")&&console.log("AG Grid: "+t,...r)}function jR(e,...t){Sy(()=>console.warn("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}function Qa(e,...t){Sy(()=>console.error("AG Grid: "+e,...t),e+(t==null?void 0:t.join("")))}var Fy=new Set,Qu={},Ei={},ou,Ty=!1,Ry=!1,$R=!1;function KR(e){const[t,r]=e.version.split(".")||[],[n,s]=ou.split(".")||[];return t===n&&r===s}function XR(e){var n;ou||(ou=e.version);const t=s=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${s} Please update all modules to the same version.`;e.version?KR(e)||Qa(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${ou}.`)):Qa(t(`'${e.moduleName}' is incompatible.`));const r=(n=e.validate)==null?void 0:n.call(e);r&&!r.isValid&&Qa(`${r.message}`)}function y0(e,t,r=!1){var i;r||(Ty=!0),XR(e);const n=(i=e.rowModels)!=null?i:["all"];Fy.add(e);let s;t!==void 0?(Ry=!0,Ei[t]===void 0&&(Ei[t]={}),s=Ei[t]):s=Qu;for(const o of n)s[o]===void 0&&(s[o]={}),s[o][e.moduleName]=e;if(e.dependsOn)for(const o of e.dependsOn)y0(o,t,r)}function YR(e){delete Ei[e]}function S0(e,t,r){const n=s=>{var i,o,a;return!!((i=Qu[s])!=null&&i[e])||!!((a=(o=Ei[t])==null?void 0:o[s])!=null&&a[e])};return n(r)||n("all")}function _y(){return Ry}function QR(e,t){var n,s,i,o,a;const r=(n=Ei[e])!=null?n:{};return[...Object.values((s=Qu.all)!=null?s:{}),...Object.values((i=r.all)!=null?i:{}),...Object.values((o=Qu[t])!=null?o:{}),...Object.values((a=r[t])!=null?a:{})]}function ZR(){return new Set(Fy)}function qR(e,t){var n,s,i;const r=(n=Ei[e])!=null?n:{};return[...Object.values((s=r.all)!=null?s:{}),...Object.values((i=r[t])!=null?i:{})]}function JR(){return Ty}function e_(){return $R}var ut="34.3.0",Rv=2e3,_v=100,Dy="_version_",Hd=null,Ay=`${Ey}/javascript-data-grid`;function t_(e){Ay=e}function Py(e,t,r){var n;return(n=Hd==null?void 0:Hd(e,t))!=null?n:[o_(e,t,r)]}function Zg(e,t,r,n,s){e(`${n?"warning":"error"} #${t}`,...Py(t,r,s))}function r_(e){if(!e)return String(e);const t={};for(const r of Object.keys(e))typeof e[r]!="object"&&typeof e[r]!="function"&&(t[r]=e[r]);return JSON.stringify(t)}function n_(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=r_(e)),t}function k0(e,t){return`${e}?${t.toString()}`}function s_(e,t,r){const n=Array.from(t.entries()).sort((i,o)=>o[1].length-i[1].length);let s=k0(e,t);for(const[i,o]of n){if(i===Dy)continue;const a=s.length-r;if(a<=0)break;const l="...",c=a+l.length,u=o.length-c>_v?o.slice(0,o.length-c)+l:o.slice(0,_v)+l;t.set(i,u),s=k0(e,t)}return s}function i_(e,t){const r=new URLSearchParams;if(r.append(Dy,ut),t)for(const i of Object.keys(t))r.append(i,n_(t[i]));const n=`${Ay}/errors/${e}`,s=k0(n,r);return s.length<=Rv?s:s_(n,r,Rv)}var o_=(e,t,r)=>{const n=i_(e,t);return`${`${r?r+` 
`:""}Visit ${n}`}${r?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function Ge(...e){Zg(jR,e[0],e[1],!0)}function gn(...e){Zg(Qa,e[0],e[1],!1)}function Ia(e,t,r){Zg(Qa,e,t,!1,r)}function a_(e,t){const r=t[0];return`error #${r} `+Py(r,t[1],e).join(" ")}function b0(...e){return a_(void 0,e)}function Iy(e,t){return e.get("rowModelType")===t}function Uh(e,t){return Iy(e,"clientSide")}function qg(e,t){return Iy(e,"serverSide")}function Fr(e,t){return e.get("domLayout")===t}function Ly(e){return g_(e)!==void 0}function My(e){return typeof e.get("getRowHeight")=="function"}function l_(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function c_(e,t,r=!1,n){const{gos:s,environment:i}=e;if(n==null&&(n=i.getDefaultRowHeight()),My(s)){if(r)return{height:n,estimated:!0};const l={node:t,data:t.data},c=s.getCallback("getRowHeight")(l);if(E0(c))return c===0&&Ge(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&s.get("masterDetail"))return u_(s);const o=s.get("rowHeight");return{height:o&&E0(o)?o:n,estimated:!1}}function u_(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return E0(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function Oy(e){const{environment:t,gos:r}=e,n=r.get("rowHeight");if(!n||Jt(n))return t.getDefaultRowHeight();const s=t.refreshRowHeightVariable();return s!==-1?s:(Ge(24),t.getDefaultRowHeight())}function E0(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function Ny(e,t,r){const n=t[e.getDomDataKey()];return n?n[r]:void 0}function Ko(e,t,r,n){const s=e.getDomDataKey();let i=t[s];Jt(i)&&(i={},t[s]=i),i[r]=n}function Jg(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function By(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Fr(e,"print"))}function ss(e){const t=e.get("autoGroupColumnDef");return!(t!=null&&t.comparator)&&!e.get("treeData")}function Hy(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function h_(e,t,r){return!!t.group&&!t.footer&&Hy(e,r)}function d_(e){var t;return(t=e==null?void 0:e.checkboxes)!=null?t:!0}function f_(e){var t;if(typeof e=="object")return(t=e.checkboxLocation)!=null?t:"selectionColumn"}function Fl(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function g_(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t==null?void 0:t.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function p_(e,t=!0){const r=e.get("rowSelection");return typeof r!="object"?t?"all":void 0:r.mode==="multiRow"?r.selectAll:"all"}function m_(e){var r;const t=e.get("rowSelection");return typeof t=="string"?!1:(t==null?void 0:t.mode)==="multiRow"&&(r=t.ctrlASelectsRows)!=null?r:!1}function Zu(e){return e.get("columnMenu")==="legacy"}function v_(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function x_(e,t,r){typeof e!="object"&&(e={});const n={...e};for(const s of r){const i=t[s];typeof i<"u"&&(n[s]=i)}return n}function C_(e,t){if(!e)return;const r={};let n=!1;for(const o of Object.keys(e))r[o]=e[o],n=!0;if(!n)return;const s={type:"gridOptionsChanged",options:r};t.dispatchEvent(s);const i={type:"componentStateChanged",...r};t.dispatchEvent(i)}function ot(e,t){return e.addCommon(t)}function au(e,t){var r,n,s,i;return(i=(s=(n=e[t])!=null?n:(r=e.gridOptions)==null?void 0:r[t])!=null?s:ky(t))!=null?i:by[t]}function Dv({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var w_={resizable:!0,sortable:!0},y_=0;function Wy(){return y_++}function Ni(e){return e instanceof oa}var oa=class extends we{constructor(e,t,r,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=n,this.isColumn=!0,this.instanceId=Wy(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new Yl,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Ka(r)}destroy(){var e;super.destroy(),(e=this.beans.rowSpanSvc)==null||e.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:r,colFlex:n}}=this;t==null||t.initCol(this);const s=e.hide;s!==void 0?this.visible=!s:this.visible=!e.initialHide,r==null||r.initCol(this),n==null||n.initCol(this)}setColDef(e,t,r){var s;const n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&((s=this.beans.rowSpanSvc)==null||s.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",r)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:r}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=Be(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=Be(r)&&r.includes(".")&&!n}initMinAndMaxWidths(){var t,r;const e=this.colDef;this.minWidth=(t=e.minWidth)!=null?t:this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=(r=e.maxWidth)!=null?r:Number.MAX_SAFE_INTEGER}initTooltip(){var e;(e=this.beans.tooltipSvc)==null||e.initCol(this)}initRowSpan(){var e;this.colDef.spanRows&&((e=this.beans.rowSpanSvc)==null||e.register(this))}addPivotListener(){const e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:r=>{const n=e.recreateColDef(this.colDef);this.setColDef(n,n,r.source)}})}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=e.width,n=e.initialWidth;return r!=null?t=r:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){var t,r;return(r=(t=this.beans.showRowGroupCols)==null?void 0:t.isRowGroupDisplayed(this,e))!=null?r:!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){var n,s,i,o;this.frameworkEventListenerService=(s=(n=this.beans.frameworkOverrides).createLocalEventListenerWrapper)==null?void 0:s.call(n,this.frameworkEventListenerService,this.colEventSvc);const r=(o=(i=this.frameworkEventListenerService)==null?void 0:i.wrap(e,t))!=null?o:t;this.colEventSvc.addEventListener(e,r)}removeEventListener(e,t){var n,s;const r=(s=(n=this.frameworkEventListenerService)==null?void 0:n.unwrap(e,t))!=null?s:t;this.colEventSvc.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return ot(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){var t,r;return(r=(t=this.beans.cellNavigation)==null?void 0:t.isSuppressNavigable(this,e))!=null?r:!1}isCellEditable(e){var t,r;return(r=(t=this.beans.editSvc)==null?void 0:t.isCellEditable({rowNode:e,column:this}))!=null?r:!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){var t,r;return(r=(t=this.beans.selectionSvc)==null?void 0:t.isCellCheckboxSelection(this,e))!=null?r:!1}isSuppressPaste(e){var t,r;return this.isColumnFunc(e,(r=(t=this.colDef)==null?void 0:t.suppressPaste)!=null?r:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){var t;return(t=this.colDef[e])!=null?t:w_[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const r=this.createColumnFunctionCallbackParams(e);return t(r)}return!1}createColumnEvent(e,t){return ot(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return Jt(this.sort)}isSorting(){return Be(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){var e;return Ge(261),!!((e=this.beans.colHover)!=null&&e.isHovered(this))}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const r=e===!0;this.visible!==r&&(this.visible=r,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e!=null&&e.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!(e!=null&&e.isPadding()))return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return ot(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Jt(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(Jt(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,r){const n=this.createColumnEvent(e,t);r&&Xr(n,r),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function ur(e){return e instanceof lu}var lu=class extends we{constructor(e,t,r,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=r,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=Wy(),this.expandableListenerRemoveCallback=null,this.expanded=!!(e!=null&&e.openByDefault)}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(!!this.children)for(const t of this.children)Ni(t)?e(t):ur(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(!!this.children)for(const t of this.children)Ni(t)?e.push(t):ur(t)&&t.addLeafColumns(e)}getColumnGroupShow(){const e=this.colGroupDef;if(!!e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);for(const t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(const t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const n=this.findChildrenRemovingPadding();for(let i=0,o=n.length;i<o;i++){const a=n[i];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,r=!0):l==="closed"?(t=!0,r=!0):(e=!0,t=!0)}const s=e&&t&&r;this.expandable!==s&&(this.expandable=s,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{for(const n of r)ur(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},S_={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function Av(e,t,r){const n={},s=e.gos;return Object.assign(n,s.get("defaultColGroupDef")),Object.assign(n,t),s.validateColDef(n,r),n}var k_=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=x0(e);let r=0;for(;;){let n=e!=null?e:t;if(n?r!==0&&(n+="_"+r):n=r,!this.existingKeys[n]){const s=String(n);return e&&r>0&&Ge(273,{providedId:e,usedId:s}),this.existingKeys[s]=!0,s}r++}}};Object.freeze([]);function ct(e){if(!!(e!=null&&e.length))return e[e.length-1]}function jh(e,t,r){if(e===t)return!0;if(!e||!t)return e==null&&t==null;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s]&&!(r!=null&&r(e[s],t[s])))return!1;return!0}function Ea(e,t){if(!!e)for(const r of e)t(r)}function Bi(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function Pv(e,t,r){for(let n=0;n<t.length;n++)Bi(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(r,0,t[n])}var $h="ag-Grid-AutoColumn",b_="ag-Grid-SelectionColumn",E_="ag-Grid-RowNumbersColumn";function F_(e){const t=[],r=n=>{for(let s=0;s<n.length;s++){const i=n[s];Ni(i)?t.push(i):ur(i)&&r(i.getChildren())}};return r(e),t}function no(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function Iv(e,t,r){const n={};if(!t)return;us(null,t,i=>{n[i.getInstanceId()]=i}),r&&us(null,r,i=>{n[i.getInstanceId()]=null});const s=Object.values(n).filter(i=>i!=null);e.context.destroyBeans(s)}function T_(e){return e.getId().startsWith($h)}function ep(e){var r;const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(r=t==null?void 0:t.startsWith(b_))!=null?r:!1}function Io(e){var r;const t=typeof e=="string"?e:"getColId"in e?e.getColId():e.colId;return(r=t==null?void 0:t.startsWith(E_))!=null?r:!1}function qu(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function cu(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function R_(e,t){const r=e===t,n=e.getColDef()===t,s=e.getColId()==t;return r||n||s}var __=(e,t)=>(r,n)=>{const s={value1:void 0,value2:void 0};let i=!1;return e&&(e[r]!==void 0&&(s.value1=e[r],i=!0),Be(n)&&e[n]!==void 0&&(s.value2=e[n],i=!0)),!i&&t&&(t[r]!==void 0&&(s.value1=t[r]),Be(n)&&t[n]!==void 0&&(s.value2=t[n])),s},D_=(e,t)=>{ur(e)&&e.setupExpandable(),e.originalParent=t};function A_(e,t=null,r,n,s){var f;const i=new k_,{existingCols:o,existingGroups:a,existingColKeys:l}=P_(n);i.addExistingKeys(l);const c=Vy(e,t,0,r,o,i,a,s),{colGroupSvc:u}=e,h=(f=u==null?void 0:u.findMaxDepth(c,0))!=null?f:0,d=u?u.balanceColumnTree(c,0,h,i):c;return us(null,d,D_),{columnTree:d,treeDepth:h}}function P_(e){const t=[],r=[],n=[];return e&&us(null,e,s=>{if(ur(s)){const i=s;r.push(i)}else{const i=s;n.push(i.getId()),t.push(i)}}),{existingCols:t,existingGroups:r,existingColKeys:n}}function Vy(e,t,r,n,s,i,o,a){if(!t)return[];const{colGroupSvc:l}=e,c=new Array(t.length);for(let u=0;u<c.length;u++){const h=t[u];l&&B_(h)?c[u]=l.createProvidedColumnGroup(n,h,r,s,i,o,a):c[u]=I_(e,n,h,s,i,a)}return c}function I_(e,t,r,n,s,i){var l;const o=M_(r,n);o&&(n==null||n.splice(o.idx,1));let a=o==null?void 0:o.column;if(a){const c=F0(e,r,a.getColId());a.setColDef(c,r,i),L_(e,a,c,i)}else{const c=s.getUniqueKey(r.colId,r.field),u=F0(e,r,c);a=new oa(u,r,c,t),e.context.createBean(a)}return(l=e.dataTypeSvc)==null||l.addColumnListeners(a),a}function Gy(e,t,r,n,s,i,o,a){const{sortSvc:l,pinnedCols:c,colFlex:u}=e;r!==void 0&&t.setVisible(!r,a),l&&(l.updateColSort(t,n,a),s!==void 0&&l.setColSortIndex(t,s)),i!==void 0&&(c==null||c.setColPinned(t,i)),o!==void 0&&(u==null||u.setColFlex(t,o))}function L_(e,t,r,n){Gy(e,t,r.hide,r.sort,r.sortIndex,r.pinned,r.flex,n);const s=t.getFlex();if(!(s!=null&&s>0))if(r.width!=null)t.setActualWidth(r.width,n);else{const i=t.getActualWidth();t.setActualWidth(i,n)}}function M_(e,t){if(!!t)for(let r=0;r<t.length;r++){const n=t[r].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(e.field!=null){if(n.field===e.field)return{idx:r,column:t[r]};continue}if(n===e)return{idx:r,column:t[r]}}}function F0(e,t,r,n){const{gos:s,dataTypeSvc:i}=e,o={},a=s.get("defaultColDef");Xr(o,a,!1,!0);const l=O_(e,o,t,r);l&&N_(e,l,o);const c=o.cellDataType;Xr(o,t,!1,!0),c!==void 0&&(o.cellDataType=c);const u=s.get("autoGroupColumnDef"),h=ss(s);return t.rowGroup&&u&&h&&Xr(o,{sort:u.sort,initialSort:u.initialSort},!1,!0),i&&(i.postProcess(o),i.validateColDef(o)),s.validateColDef(o,r,n),o}function O_(e,t,r,n){var o,a,l;const s=(o=e.dataTypeSvc)==null?void 0:o.updateColDefAndGetColumnType(t,r,n),i=(l=(a=r.type)!=null?a:s)!=null?l:t.type;return t.type=i,i?qu(i):void 0}function N_(e,t,r){if(!t.length)return;const n=Object.assign({},S_),s=e.gos.get("columnTypes")||{};for(const i of Object.keys(s)){const o=s[i];i in n?Ge(34,{key:i}):(o.type&&Ge(35),n[i]=o)}for(const i of t){const o=n[i.trim()];o?Xr(r,o,!1,!0):Ge(36,{t:i})}}function B_(e){return e.children!==void 0}function us(e,t,r){if(!!t)for(let n=0;n<t.length;n++){const s=t[n];ur(s)&&us(s,s.getChildren(),r),r(s,e)}}function zy(e,t){const r=[],n=[],s=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?s.push(o):a==="left"||a===!0?r.push(o):n.push(o)}),t.get("enableRtl")?[...s,...n,...r]:[...r,...n,...s]}function Uy(e,t){let r=!0;return us(null,t,n=>{if(!ur(n))return;const s=n,i=s.getColGroupDef();if(!(i==null?void 0:i.marryChildren))return;const a=[];for(const d of s.getLeafColumns()){const f=e.indexOf(d);a.push(f)}const l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),u=l-c,h=s.getLeafColumns().length-1;u>h&&(r=!1)}),r}function jy(e,t){if(!e||e.length==0)return;const r=t(e[0]);for(let n=1;n<e.length;n++)if(r!==t(e[n]))return;return r}function $y(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,s=jy(t,i=>i.getPinned());e.dispatchEvent({type:"columnPinned",pinned:s!=null?s:null,columns:t,column:n,source:r})}function H_(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,s=jy(t,i=>i.isVisible());e.dispatchEvent({type:"columnVisible",visible:s,columns:t,column:n,source:r})}function W_(e,t,r,n){e.dispatchEvent({type:t,columns:r,column:r&&r.length==1?r[0]:null,source:n})}function Ju(e,t,r,n,s=null){t!=null&&t.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:s,finished:r,source:n})}function Ky(e,t,r){var k,E,y;const{colModel:n,rowGroupColsSvc:s,pivotColsSvc:i,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:u,environment:h,valueColsSvc:d,eventSvc:f,gos:p}=e,g=(k=n.getColDefCols())!=null?k:[],m=a==null?void 0:a.getColumns();if(!g.length&&!(m!=null&&m.length))return!1;if((t==null?void 0:t.state)&&!t.state.forEach)return Ge(32),!1;const v=(R,D,N,O,A)=>{var z;if(!R)return;const G=__(D,t.defaultState),q=G("flex").value1;if(Gy(e,R,G("hide").value1,G("sort").value1,G("sortIndex").value1,G("pinned").value1,q,r),q==null){const se=G("width").value1;if(se!=null){const te=(z=R.getColDef().minWidth)!=null?z:h.getDefaultColumnMinWidth();te!=null&&se>=te&&R.setActualWidth(se,r)}}A||!R.isPrimary()||(d==null||d.syncColumnWithState(R,r,G),s==null||s.syncColumnWithState(R,r,G,N),i==null||i.syncColumnWithState(R,r,G,O))},C=(R,D,N)=>{var W,B,V,X;const O=Xy(e,r),A=D.slice(),G={},q={},z=[],se=[],te=[];let Z=0;const H=(W=s==null?void 0:s.columns.slice())!=null?W:[],Q=(B=i==null?void 0:i.columns.slice())!=null?B:[];for(const ne of R){const le=ne.colId;if(le.startsWith($h)){z.push(ne),te.push(ne);continue}if(ep(le)){se.push(ne),te.push(ne);continue}const ee=N(le);ee?(v(ee,ne,G,q,!1),Bi(A,ee)):(te.push(ne),Z+=1)}const ie=ne=>v(ne,null,G,q,!1);A.forEach(ie),s==null||s.sortColumns(Mv.bind(s,G,H)),i==null||i.sortColumns(Mv.bind(i,q,Q)),n.refreshCols(!1,r);const F=(ne,le,ce=[])=>{for(const ee of le){const Ee=ne(ee.colId);Bi(ce,Ee),v(Ee,ee,null,null,!0)}ce.forEach(ie)};return F(ne=>{var le;return(le=o==null?void 0:o.getColumn(ne))!=null?le:null},z,(V=o==null?void 0:o.getColumns())==null?void 0:V.slice()),F(ne=>{var le;return(le=a==null?void 0:a.getColumn(ne))!=null?le:null},se,(X=a==null?void 0:a.getColumns())==null?void 0:X.slice()),G_(t,n,p),c.refresh(r),f.dispatchEvent({type:"columnEverythingChanged",source:r}),O(),{unmatchedAndAutoStates:te,unmatchedCount:Z}};l==null||l.start();let{unmatchedAndAutoStates:x,unmatchedCount:w}=C(t.state||[],g,R=>n.getColDefCol(R));if(x.length>0||Be(t.defaultState)){const R=(y=(E=u==null?void 0:u.getPivotResultCols())==null?void 0:E.list)!=null?y:[];w=C(x,R,D=>{var N;return(N=u==null?void 0:u.getPivotResultCol(D))!=null?N:null}).unmatchedCount}return l==null||l.finish(),w===0}function Xy(e,t){var h,d,f;const{rowGroupColsSvc:r,pivotColsSvc:n,valueColsSvc:s,colModel:i,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:(h=r==null?void 0:r.columns.slice())!=null?h:[],pivotColumns:(d=n==null?void 0:n.columns.slice())!=null?d:[],valueColumns:(f=s==null?void 0:s.columns.slice())!=null?f:[]},c=Lv(e),u={};for(const p of c)u[p.colId]=p;return()=>{var D,N;const p=(O,A,G,q)=>{const z=A.map(q),se=G.map(q);if(jh(z,se))return;const Z=new Set(A);for(const Q of G)Z.delete(Q)||Z.add(Q);const H=[...Z];a.dispatchEvent({type:O,columns:H,column:H.length===1?H[0]:null,source:t})},g=O=>{const A=[];return i.forAllCols(G=>{const q=u[G.getColId()];q&&O(q,G)&&A.push(G)}),A},m=O=>O.getColId();p("columnRowGroupChanged",l.rowGroupColumns,(D=r==null?void 0:r.columns)!=null?D:[],m),p("columnPivotChanged",l.pivotColumns,(N=n==null?void 0:n.columns)!=null?N:[],m);const C=g((O,A)=>{const G=O.aggFunc!=null,q=G!=A.isValueActive(),z=G&&O.aggFunc!=A.getAggFunc();return q||z});C.length>0&&W_(a,"columnValueChanged",C,t),Ju(a,g((O,A)=>O.width!=A.getActualWidth()),!0,t),$y(a,g((O,A)=>O.pinned!=A.getPinned()),t),H_(a,g((O,A)=>O.hide==A.isVisible()),t);const y=g((O,A)=>O.sort!=A.getSort()||O.sortIndex!=A.getSortIndex());y.length>0&&(o==null||o.dispatchSortChangedEvents(t,y));const R=Lv(e);U_(c,R,t,i,a)}}function Lv(e){const{colModel:t,rowGroupColsSvc:r,pivotColsSvc:n}=e,s=t.getColDefCols();if(Jt(s)||!t.isAlive())return[];const i=r==null?void 0:r.columns,o=n==null?void 0:n.columns,a=[],l=u=>{var m;const h=u.isRowGroupActive()&&i?i.indexOf(u):null,d=u.isPivotActive()&&o?o.indexOf(u):null,f=u.isValueActive()?u.getAggFunc():null,p=u.getSort()!=null?u.getSort():null,g=u.getSortIndex()!=null?u.getSortIndex():null;a.push({colId:u.getColId(),width:u.getActualWidth(),hide:!u.isVisible(),pinned:u.getPinned(),sort:p,sortIndex:g,aggFunc:f,rowGroup:u.isRowGroupActive(),rowGroupIndex:h,pivot:u.isPivotActive(),pivotIndex:d,flex:(m=u.getFlex())!=null?m:null})};t.forAllCols(u=>l(u));const c=new Map(t.getCols().map((u,h)=>[u.getColId(),h]));return a.sort((u,h)=>{const d=c.has(u.colId)?c.get(u.colId):-1,f=c.has(h.colId)?c.get(h.colId):-1;return d-f}),a}function V_(e){const t=(p,g)=>p!=null?p:g!=null?g:null,r=e.getColDef(),n=t(r.sort,r.initialSort),s=t(r.sortIndex,r.initialSortIndex),i=t(r.hide,r.initialHide),o=t(r.pinned,r.initialPinned),a=t(r.width,r.initialWidth),l=t(r.flex,r.initialFlex);let c=t(r.rowGroupIndex,r.initialRowGroupIndex),u=t(r.rowGroup,r.initialRowGroup);c==null&&!u&&(c=null,u=null);let h=t(r.pivotIndex,r.initialPivotIndex),d=t(r.pivot,r.initialPivot);h==null&&!d&&(h=null,d=null);const f=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:s,hide:i,pinned:o,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:d,pivotIndex:h,aggFunc:f}}function G_(e,t,r){if(!e.applyOrder||!e.state)return;const n=[];for(const s of e.state)s.colId!=null&&n.push(s.colId);z_(t.cols,n,t,r)}function z_(e,t,r,n){if(e==null)return;let s=[];const i={};for(const a of t){if(i[a])continue;const l=e.map[a];l&&(s.push(l),i[a]=!0)}let o=0;for(const a of e.list){const l=a.getColId();if(i[l]!=null)continue;l.startsWith($h)?s.splice(o++,0,a):s.push(a)}if(s=zy(s,n),!Uy(s,r.getColTree())){Ge(39);return}e.list=s}function U_(e,t,r,n,s){const i={};for(const u of t)i[u.colId]=u;const o={};for(const u of e)i[u.colId]&&(o[u.colId]=!0);const a=e.filter(u=>o[u.colId]),l=t.filter(u=>o[u.colId]),c=[];l.forEach((u,h)=>{const d=a==null?void 0:a[h];if(d&&d.colId!==u.colId){const f=n.getCol(d.colId);f&&c.push(f)}}),c.length&&s.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:r})}var Mv=(e,t,r,n)=>{const s=e[r.getId()],i=e[n.getId()],o=s!=null,a=i!=null;if(o&&a)return s-i;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(n),u=l>=0,h=c>=0;return u&&h?l-c:u?-1:1},j_=class extends we{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(cu(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),cu(e.source)))}createColsFromColDefs(e){var C,x,w;const{beans:t}=this,{valueCache:r,colAutosize:n,rowGroupColsSvc:s,pivotColsSvc:i,valueColsSvc:o,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,u=this.colDefs?Xy(t,e):void 0;r==null||r.expire();const h=(C=this.colDefCols)==null?void 0:C.list,d=(x=this.colDefCols)==null?void 0:x.tree,f=A_(t,this.colDefs,!0,d,e);Iv(t,(w=this.colDefCols)==null?void 0:w.tree,f.columnTree);const p=f.columnTree,g=f.treeDepth,m=F_(p),v={};for(const k of m)v[k.getId()]=k;this.colDefCols={tree:p,treeDepth:g,list:m,map:v},this.createColumnsForService([c],this.colDefCols,e),s==null||s.extractCols(e,h),i==null||i.extractCols(e,h),o==null||o.extractCols(e,h),this.ready=!0,this.refreshCols(!0,e),a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),u&&(this.changeEventsDispatching=!0,u(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&(n==null||n.applyAutosizeStrategy())}refreshCols(e,t){var m;if(!this.colDefCols)return;const r=(m=this.cols)==null?void 0:m.tree;this.saveColOrder();const{autoColSvc:n,selectionColSvc:s,rowNumbersSvc:i,quickFilter:o,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:u,colViewport:h,eventSvc:d}=this.beans,f=this.selectCols(a,this.colDefCols);this.createColumnsForService([n,s,i],f,t);const p=l_(this.gos,this.showingPivotResult);(!e||p)&&this.restoreColOrder(f),this.positionLockedCols(f),l==null||l.refresh(),o==null||o.refreshCols(),this.setColSpanActive(),c==null||c.setAutoHeightActive(f),u.clear(),h.clear(),!jh(r,this.cols.tree)&&d.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,r){for(const n of e)!n||(n.createColumns(t,s=>{this.lastOrder=s(this.lastOrder),this.lastPivotOrder=s(this.lastPivotOrder)},r),n.addColumns(t))}selectCols(e,t){var a;const r=(a=e==null?void 0:e.getPivotResultCols())!=null?a:null;this.showingPivotResult=r!=null;const{map:n,list:s,tree:i,treeDepth:o}=r!=null?r:t;return this.cols={list:s.slice(),map:{...n},tree:i.slice(),treeDepth:o},r&&(r.list.some(c=>{var u;return((u=this.cols)==null?void 0:u.map[c.getColId()])!==void 0})||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const{valueColsSvc:e,selectionColSvc:t,gos:r}=this.beans,n=this.isPivotMode()&&!this.showingPivotResult,s=t==null?void 0:t.isSelectionColumnEnabled(),i=r.get("rowNumbers"),o=e==null?void 0:e.columns;return this.cols.list.filter(l=>{const c=T_(l);if(n){const u=o==null?void 0:o.includes(l);return c||u||s&&ep(l)||i&&Io(l)}else return c||l.isVisible()})}refreshAll(e){!this.ready||(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,r){Ky(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},r)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const r=t.filter(h=>e.map[h.getId()]!=null);if(r.length===0)return;if(r.length===e.list.length){e.list=r;return}const n=h=>{const d=h.getOriginalParent();return d?d.getChildren().length>1?!0:n(d):!1};if(!r.some(h=>n(h))){const h=new Set(r);for(const d of e.list)h.has(d)||r.push(d);e.list=r;return}const s=new Map;for(let h=0;h<r.length;h++){const d=r[h];s.set(d,h)}const i=e.list.filter(h=>!s.has(h));if(i.length===0){e.list=r;return}const o=(h,d)=>{const f=d?d.getOriginalParent():h.getOriginalParent();if(!f)return null;let p=null,g=null;for(const m of f.getChildren())if(!(m===d||m===h)){if(m instanceof oa){const v=s.get(m);if(v==null)continue;(p==null||p<v)&&(p=v,g=m);continue}m.forEachLeafColumn(v=>{const C=s.get(v);C!=null&&(p==null||p<C)&&(p=C,g=v)})}return g==null?o(h,f):g},a=[],l=new Map;for(const h of i){const d=o(h,null);if(d==null){a.push(h);continue}const f=l.get(d);f===void 0?l.set(d,h):Array.isArray(f)?f.push(h):l.set(d,[f,h])}const c=new Array(e.list.length);let u=c.length-1;for(let h=a.length-1;h>=0;h--)c[u--]=a[h];for(let h=r.length-1;h>=0;h--){const d=r[h],f=l.get(d);if(f)if(Array.isArray(f))for(let p=f.length-1;p>=0;p--){const g=f[p];c[u--]=g}else c[u--]=f;c[u--]=d}e.list=c}positionLockedCols(e){e.list=zy(e.list,this.gos)}saveColOrder(){var e,t,r,n;this.showingPivotResult?this.lastPivotOrder=(t=(e=this.cols)==null?void 0:e.list)!=null?t:null:this.lastOrder=(n=(r=this.cols)==null?void 0:r.list)!=null?n:null}getColumnDefs(e){var t,r,n;return this.colDefCols&&((n=this.beans.colDefFactory)==null?void 0:n.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,(r=(t=this.cols)==null?void 0:t.list)!=null?r:[],e))}setColSpanActive(){var e;this.colSpanActive=!!((e=this.cols)!=null&&e.list.some(t=>t.getColDef().colSpan!=null))}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);const{visibleCols:r,eventSvc:n}=this.beans;r.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){var t;const e=(t=this.beans.pivotColsSvc)==null?void 0:t.columns;return this.pivotMode&&!!(e!=null&&e.length)}recreateColumnDefs(e){var r;if(!this.cols)return;(r=this.beans.autoColSvc)==null||r.updateColumns(e);const t=cu(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){var e;Iv(this.beans,(e=this.colDefCols)==null?void 0:e.tree),super.destroy()}getColTree(){var e,t;return(t=(e=this.cols)==null?void 0:e.tree)!=null?t:[]}getColDefColTree(){var e,t;return(t=(e=this.colDefCols)==null?void 0:e.tree)!=null?t:[]}getColDefCols(){var e,t;return(t=(e=this.colDefCols)==null?void 0:e.list)!=null?t:null}getCols(){var e,t;return(t=(e=this.cols)==null?void 0:e.list)!=null?t:[]}forAllCols(e){var i,o,a,l,c;const{pivotResultCols:t,autoColSvc:r,selectionColSvc:n,groupHierarchyColSvc:s}=this.beans;Ea((i=this.colDefCols)==null?void 0:i.list,e),Ea((o=r==null?void 0:r.columns)==null?void 0:o.list,e),Ea((a=n==null?void 0:n.columns)==null?void 0:a.list,e),Ea((l=s==null?void 0:s.columns)==null?void 0:l.list,e),Ea((c=t==null?void 0:t.getPivotResultCols())==null?void 0:c.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){var t;return(t=this.colDefCols)!=null&&t.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){var t,r;return(r=(t=this.cols)==null?void 0:t.map[e])!=null?r:null}getColFromCollection(e,t){var a,l,c;if(t==null)return null;const{map:r,list:n}=t;if(typeof e=="string"&&r[e])return r[e];for(let u=0;u<n.length;u++)if(R_(n[u],e))return n[u];const{autoColSvc:s,selectionColSvc:i,groupHierarchyColSvc:o}=this.beans;return(c=(l=(a=s==null?void 0:s.getColumn(e))!=null?a:i==null?void 0:i.getColumn(e))!=null?l:o==null?void 0:o.getColumn(e))!=null?c:null}},$_=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return typeof t!="number"?r=0:r=t+1,this.existingIds[e]=r,r}},aa=class extends we{};function Kh(e,t,r){return r&&e.addDestroyFunc(()=>t.destroyBean(r)),r!=null?r:e}var qe=null,Zl=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){var n;if(!e)return;if(e.indexOf(" ")>=0){const s=(e||"").split(" ");if(s.length>1){for(const i of s)this.toggleCss(i,t);return}}this.cssClassStates[e]!==t&&e.length&&((n=this.getGui())==null||n.classList.toggle(e,t),this.cssClassStates[e]=t)}},K_=0,Yy=class extends Yi{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=K_++,this.cssManager=new Zl(()=>this.eGui),this.componentSelectors=new Map((t!=null?t:[]).map(r=>[r.selector,r])),e&&this.setTemplate(e)}preConstruct(){var t,r,n;this.wireTemplate(this.getGui());const e="component-"+((r=(t=Object.getPrototypeOf(this))==null?void 0:t.constructor)==null?void 0:r.name);for(const s of(n=this.css)!=null?n:[])this.beans.environment.addGlobalCSS(s,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(xy):null}applyElementsToComponent(e,t,r,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const s=this[t];if(s===qe)this[t]=n!=null?n:e;else{const i=r==null?void 0:r[t];if(!this.suppressDataRefValidation&&!i)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${s}`)}}}createChildComponentsFromTags(e,t){var n;const r=[];for(const s of(n=e.childNodes)!=null?n:[])r.push(s);for(const s of r){if(!(s instanceof HTMLElement))continue;const i=this.createComponentFromElement(s,o=>{var l;const a=o.getGui();if(a)for(const c of(l=s.attributes)!=null?l:[])a.setAttribute(c.name,c.value)},t);if(i){if(i.addItems&&s.children.length){this.createChildComponentsFromTags(s,t);const o=Array.prototype.slice.call(s.children);i.addItems(o)}this.swapComponentForNode(i,e,s)}else s.childNodes&&this.createChildComponentsFromTags(s,t)}}createComponentFromElement(e,t,r){const n=e.nodeName,s=this.getDataRefAttribute(e),i=n.indexOf("AG-")===0,o=i?this.componentSelectors.get(n):null;let a=null;if(o){const l=r&&s?r[s]:void 0;a=new o.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(i)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,s,r,a),a}swapComponentForNode(e,t,r){const n=e.getGui();t.replaceChild(n,r),t.insertBefore(document.createComment(r.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(const r of e)r.setAttribute("tabindex",t.toString())}setTemplate(e,t,r){let n;typeof e=="string"||e==null?n=Kg(e):n=zh(e),this.setTemplateFromElement(n,t,r)}setTemplateFromElement(e,t,r,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let s=0;s<t.length;s++){const i=t[s];this.componentSelectors.set(i.selector,i)}this.wireTemplate(e,r)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let r=t;return e==null?null:(r||(r=this.eGui),vy(e)?{element:e,parent:r}:{element:e.getGui(),parent:r})}prependChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.insertAdjacentElement("afterbegin",r)}appendChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.appendChild(r)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:r}=t;RR(this.eGui,e,{skipAriaHidden:r})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:r}=t;Yt(this.eGui,e,{skipAriaHidden:r});const n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,r){this.eGui.addEventListener(e,t,r),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},ws=class extends Yy{},Tr=class La{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new La(r=>{let n=t.length;const s=new Array(n);t.forEach((i,o)=>{i.then(a=>{s[o]=a,n--,n===0&&r(s)})})}):La.resolve()}static resolve(t=null){return new La(r=>r(t))}then(t){return new La(r=>{this.status===1?r(t(this.resolution)):this.waiters.push(n=>r(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(const r of this.waiters)r(t)}onReject(t){}};function X_(e){return e?e.prototype&&"getGui"in e.prototype:!1}function Y_(e,t,r,n){const{name:s}=r;let i,o,a,l,c,u;if(t){const h=t,d=h[s+"Selector"],f=d?d(n):null,p=g=>{typeof g=="string"?i=g:g!=null&&g!==!0&&(e.isFrameworkComponent(g)?a=g:o=g)};f?(p(f.component),l=f.params,c=f.popup,u=f.popupPosition):p(h[s])}return{compName:i,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}var Q_=class extends we{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,r,n=!1){return this.getCompDetails(this.gridOptions,e,t,r,n)}getCompDetails(e,t,r,n,s=!1){var x;const{name:i,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:h,popupPositionFromSelector:d}=Y_(this.beans.frameworkOverrides,e,t,n),f,p;const g=w=>{const k=this.registry.getUserComponent(i,w);k&&(l=k.componentFromFramework?void 0:k.component,c=k.componentFromFramework?k.component:void 0,f=k.params,p=k.processParams)};if(a!=null&&g(a),l==null&&c==null&&r!=null&&g(r),l&&o&&!X_(l)&&(l=(x=this.agCompUtils)==null?void 0:x.adaptFunction(t,l)),!l&&!c){const{validation:w}=this.beans;s&&(a!==r||!r)?a?w!=null&&w.isProvidedUserComp(a)||gn(50,{compName:a}):r?w||gn(260,{...this.gos.getModuleErrorParams(),propName:i,compName:r}):gn(216,{name:i}):r&&!w&&gn(146,{comp:r});return}const m=this.mergeParams(e,t,n,u,f,p),v=l==null,C=l!=null?l:c;return{componentFromFramework:v,componentClass:C,params:m,type:t,popupFromSelector:h,popupPositionFromSelector:d,newAgStackInstance:()=>this.newAgStackInstance(C,v,m,t)}}newAgStackInstance(e,t,r,n){var a;const s=!t;let i;s?i=new e:i=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(i);const o=(a=i.init)==null?void 0:a.call(i,r);return o==null?Tr.resolve(i):o.then(()=>i)}mergeParams(e,t,r,n=null,s,i){const o={...r,...s},a=e,l=a==null?void 0:a[t.name+"Params"];if(typeof l=="function"){const c=l(r);Xr(o,c)}else typeof l=="object"&&Xr(o,l);return Xr(o,n),i?i(o):o}},Z_={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},q_={name:"headerComponent",optionalMethods:["refresh"]},J_={name:"innerHeaderComponent"},eD={name:"innerHeaderGroupComponent"},tD={name:"headerGroupComponent"},rD={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},nD={name:"loadingCellRenderer",cellRenderer:!0},sD={name:"loadingOverlayComponent",optionalMethods:["refresh"]},iD={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},oD={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},aD={name:"loadingCellRenderer",cellRenderer:!0},lD={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},cD={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function uD(e,t){return e.getCompDetailsFromGridOptions(Z_,"agDragAndDropImage",t,!0)}function hD(e,t,r){return e.getCompDetails(t,q_,"agColumnHeader",r)}function dD(e,t,r){return e.getCompDetails(t,J_,void 0,r)}function fD(e,t){const r=t.columnGroup.getColGroupDef();return e.getCompDetails(r,tD,"agColumnGroupHeader",t)}function gD(e,t,r){return e.getCompDetails(t,eD,void 0,r)}function pD(e,t){return e.getCompDetailsFromGridOptions(oD,void 0,t,!0)}function mD(e,t){return e.getCompDetailsFromGridOptions(aD,"agLoadingCellRenderer",t,!0)}function vD(e,t){return e.getCompDetailsFromGridOptions(lD,"agGroupRowRenderer",t,!0)}function xD(e,t){return e.getCompDetailsFromGridOptions(cD,"agDetailCellRenderer",t,!0)}function Ov(e,t,r){return e.getCompDetails(t,rD,void 0,r)}function Nv(e,t,r){return e.getCompDetails(t,nD,"agSkeletonCellRenderer",r,!0)}function CD(e,t){return e.getCompDetailsFromGridOptions(sD,"agLoadingOverlay",t,!0)}function wD(e,t){return e.getCompDetailsFromGridOptions(iD,"agNoRowsOverlay",t,!0)}function yD(e){const t=e;return(t==null?void 0:t.getFrameworkComponentInstance)!=null?t.getFrameworkComponentInstance():e}function SD(e){return typeof e=="object"&&!!e.getComp}var ve={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},Wd,Vd,Gd,zd,T0,R0,Ud;function tp(){return Wd===void 0&&(Wd=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Wd}function Qy(){return Vd===void 0&&(Vd=/(firefox)/i.test(navigator.userAgent)),Vd}function Zy(){return Gd===void 0&&(Gd=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Gd}function Za(){return zd===void 0&&(zd=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),zd}function Bv(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return t===-1&&(r===null||r===""&&!Qy())?null:t.toString()}function kD(){if(Ud!==void 0)return Ud;if(!document.body)return-1;let e=1e6;const t=Qy()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const n=e*2;if(r.style.height=n+"px",n>t||r.clientHeight!==n)break;e=n}return r.remove(),Ud=e,e}function bD(){return R0==null&&qy(),R0}function qy(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;r===0&&t.clientWidth===0&&(r=null),t.parentNode&&t.remove(),r!=null&&(R0=r,T0=r===0)}function Jy(){return T0==null&&qy(),T0}var rp="T",ED=new RegExp(`[${rp} ]`),FD=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${rp}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function Hv(e,t){return e.toString().padStart(t,"0")}function Wv(e,t=!0,r=rp){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(s=>Hv(s,2)).join("-");return t&&(n+=r+[e.getHours(),e.getMinutes(),e.getSeconds()].map(s=>Hv(s,2)).join(":")),n}function uu(e,t=!1){return!!_0(e,t)}function TD(e){return uu(e,!0)}function _0(e,t=!1,r){if(!e||!r&&!FD.test(e))return null;const[n,s]=e.split(ED);if(!n)return null;const i=n.split("-").map(f=>Number.parseInt(f,10));if(i.filter(f=>!isNaN(f)).length!==3)return null;const[o,a,l]=i,c=new Date(o,a-1,l);if(c.getFullYear()!==o||c.getMonth()!==a-1||c.getDate()!==l||!s&&t)return null;if(!s||s==="00:00:00")return c;const[u,h,d]=s.split(":").map(f=>Number.parseInt(f,10));if(u>=0&&u<24)c.setHours(u);else if(t)return null;if(h>=0&&h<60)c.setMinutes(h);else if(t)return null;if(d>=0&&d<60)c.setSeconds(d);else if(t)return null;return c}function RD(e){var r;return e.altKey||e.ctrlKey||e.metaKey?!1:((r=e.key)==null?void 0:r.length)===1}var D0=!1,eh=0;function _D(e){eh>0||(e.addEventListener("keydown",th),e.addEventListener("mousedown",th))}function DD(e){eh>0||(e.removeEventListener("keydown",th),e.removeEventListener("mousedown",th))}function th(e){const t=D0,r=e.type==="keydown";r&&(e.ctrlKey||e.metaKey||e.altKey)||t!==r&&(D0=r)}function AD(e){const t=Ln(e);return _D(t),eh++,()=>{eh--,DD(t)}}function PD(){return D0}function Lo(e,t,r=!1){const n=TR;let s=hy;t&&(s+=", "+t),r&&(s+=', [tabindex="-1"]');const i=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>sa(l)),o=Array.prototype.slice.apply(e.querySelectorAll(s));return o.length?((l,c)=>l.filter(u=>c.indexOf(u)===-1))(i,o):i}function rh(e,t=!1,r=!1,n=!1){const s=Lo(e,n?".ag-tab-guard":null,r),i=t?ct(s):s[0];return i?(i.focus({preventScroll:!0}),!0):!1}function Xh(e,t,r,n){const s=Lo(t,r?':not([tabindex="-1"])':null),i=xr(e);let o;r?o=s.findIndex(l=>l.contains(i)):o=s.indexOf(i);const a=o+(n?-1:1);return a<0||a>=s.length?null:s[a]}function ID(e,t=5){let r=0;for(;e&&Bv(e)===null&&++r<=t;)e=e.parentElement;return Bv(e)===null?null:e}var LD=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",MD=class extends Yy{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(LD)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:n,disabled:s}=this.config;s!=null&&this.setDisabled(s),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),r!=null&&this.setLabelWidth(r),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;Ql(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Yt(t,!1),kv(t,"presentation")):(Yt(t,!0),kv(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left",e==="left"),r.toggle("ag-label-align-right",e==="right"),r.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(py(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return dy(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},OD=class extends MD{constructor(e,t,r,n){super(e,t,r),this.className=n}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),r!=null&&this.onValueChange(r),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();r==null||r==""||pR(e)!==null?ju(e,""):ju(e,t!=null?t:"")}setAriaLabel(e){return Uu(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Xs(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function ND(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var BD=class extends OD{constructor(e,t,r="text",n="input"){var s;super(e,(s=e==null?void 0:e.template)!=null?s:ND(n),[],t),this.inputType=r,this.displayFieldTag=n,this.eLabel=qe,this.eWrapper=qe,this.eInput=qe}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);const{eLabel:e,eWrapper:t,eInput:r,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),r.classList.add(`${n}-input`),this.addCss("ag-input-field"),r.id=r.id||`ag-${this.getCompId()}-input`;const{inputName:s,inputWidth:i}=this.config;s!=null&&this.setInputName(s),i!=null&&this.setInputWidth(i),this.addInputListeners(),this.activateTabIndex([r])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,wi(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return py(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return wi(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Uu(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return dy(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)wi(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";wi(this.eInput,"autocomplete",t)}return this}},HD=class extends BD{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const r=this.eInput;r.checked=e,r.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},WD={selector:"AG-CHECKBOX",component:HD},VD=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',Ax,Px,np=typeof window!="object"||!((Px=(Ax=window==null?void 0:window.document)==null?void 0:Ax.fonts)!=null&&Px.forEach),Xo=(e,t,r,n,s,i)=>{if(np)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let o=Mo.map.get(t);if(o||(o=[],Mo.map.set(t,o)),o.some(u=>u.css===e))return;const a=document.createElement("style");i&&a.setAttribute("nonce",i),a.dataset.agGlobalCss=r,a.textContent=e;const l={css:e,el:a,priority:s};let c;for(const u of o){if(u.priority>s)break;c=u}if(c){c.el.insertAdjacentElement("afterend",a);const u=o.indexOf(c);o.splice(u+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},eS=(e,t,r,n)=>{Xo(VD,e,"shared",t,0,r),n==null||n.forEach((s,i)=>s.forEach(o=>Xo(o,e,i,t,0,r)))},GD=e=>{Mo.grids.add(e)},zD=e=>{if(Mo.grids.delete(e),Mo.grids.size===0){Mo.map=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},Vv,Ix,Mo=(Ix=(Vv=typeof window=="object"?window:{}).agStyleInjectionState)!=null?Ix:Vv.agStyleInjectionState={map:new WeakMap,grids:new Set},Yn=e=>new tS(e),Ds="$default",UD=0,tS=class{constructor({feature:e,params:t,modeParams:r={},css:n,cssImports:s}){var i;this.feature=e,this.css=n,this.cssImports=s,this.modeParams={[Ds]:{...(i=r[Ds])!=null?i:{},...t!=null?t:{}},...r}}use(e,t,r){var s,i;let n=this._inject;if(n==null){let{css:o}=this;if(o){const a=`ag-theme-${(s=this.feature)!=null?s:"part"}-${++UD}`;typeof o=="function"&&(o=o()),o=`:where(.${a}) {
${o}
}
`;for(const l of(i=this.cssImports)!=null?i:[])o=`@import url(${JSON.stringify(l)});
${o}`;n={css:o,class:a}}else n=!1;this._inject=n}return n&&e&&Xo(n.css,e,n.class,t,1,r),n?n.class:!1}},jD=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),rS=e=>`--ag-${jD(e)}`,Qn=e=>`var(${rS(e)})`,$D=(e,t,r)=>Math.max(t,Math.min(r,e)),KD=e=>{const t=new Map;return r=>{const n=r;return t.has(n)||t.set(n,e(r)),t.get(n)}},Gn=e=>({ref:"accentColor",mix:e}),on=e=>({ref:"foregroundColor",mix:e}),dn=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),XD=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),Mr={ref:"backgroundColor"},ko={ref:"foregroundColor"},is={ref:"accentColor"},nh={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:on(.15),chromeBackgroundColor:dn(.02),browserColorScheme:"light"},YD={...nh,textColor:ko,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:Gn(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:Mr,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:is,toggleButtonOffBackgroundColor:dn(.3),toggleButtonSwitchBackgroundColor:Mr,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}},QD=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],ZD=KD(e=>{var t;return e=e.toLowerCase(),(t=QD.find(r=>e.endsWith(r.toLowerCase())))!=null?t:"length"}),Yh=e=>typeof e=="object"&&(e==null?void 0:e.ref)?Qn(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,sp=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=Qn(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?Qn(e.onto):"transparent"}, ${t} ${$D(e.mix*100,0,100)}%)`}return!1},qD=Yh,bo=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,r=>r[0]==="-"?r:" "+Qn(r)+" ")})`:e&&"ref"in e?Qn(e.ref):!1,JD=Yh,A0=(e,t)=>{var r,n,s;return typeof e=="string"?e:e===!0?A0({},t):e===!1?t==="columnBorder"?A0({color:"transparent"},t):"none":e&&"ref"in e?Qn(e.ref):nS((r=e.style)!=null?r:"solid")+" "+bo((n=e.width)!=null?n:{ref:"borderWidth"})+" "+sp((s=e.color)!=null?s:{ref:"borderColor"})},eA=e=>{var t,r,n,s,i;return typeof e=="string"?e:e===!1?"none":e&&"ref"in e?Qn(e.ref):[bo((t=e.offsetX)!=null?t:0),bo((r=e.offsetY)!=null?r:0),bo((n=e.radius)!=null?n:0),bo((s=e.spread)!=null?s:0),sp((i=e.color)!=null?i:{ref:"foregroundColor"})].join(" ")},nS=Yh,sS=e=>typeof e=="string"?e.includes(",")?e:Gv(e):e&&"googleFont"in e?sS(e.googleFont):e&&"ref"in e?Qn(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),Gv(t))).join(", "):!1,Gv=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),tA=Yh,iS=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?iS({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?Qn(e.ref):!1,rA=(e,t,r)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&r.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?Qn(e.ref):!1,nA={color:sp,colorScheme:qD,length:bo,scale:JD,border:A0,borderStyle:nS,shadow:eA,image:iS,fontFamily:sS,fontWeight:tA,duration:rA},sA=(e,t,r)=>{const n=ZD(e);return nA[n](t,e,r)},iA=e=>new oS(e),oS=class aS{constructor(t,r=[]){this.themeLogger=t,this.parts=r}withPart(t){return typeof t=="function"&&(t=t()),t instanceof tS?new aS(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(Yn({feature:t}))}withParams(t,r=Ds){return this.withPart(Yn({modeParams:{[r]:t}}))}_startUse({styleContainer:t,cssLayer:r,nonce:n,loadThemeGoogleFonts:s,moduleCss:i}){if(np)return;aA(),eS(t,r,n,i);const o=oA(this);if(o.length>0)for(const a of o)s&&lA(a,n);for(const a of this.parts)a.use(t,r,n)}_getCssClass(){var t;return(t=this._cssClassCache)!=null?t:this._cssClassCache=zv(this.parts).map(r=>r.use(void 0,void 0,void 0)).filter(Boolean).join(" ")}_getModeParams(){var r;let t=this._paramsCache;if(!t){const n={[Ds]:{...YD}};for(const s of zv(this.parts))for(const i of Object.keys(s.modeParams)){const o=s.modeParams[i];if(o){const a=(r=n[i])!=null?r:n[i]={},l=new Set;for(const c of Object.keys(o)){const u=o[c];u!==void 0&&(a[c]=u,l.add(c))}if(i===Ds)for(const c of Object.keys(n)){const u=n[c];if(c!==Ds)for(const h of l)delete u[h]}}}this._paramsCache=t=n}return t}_getPerInstanceCss(t){const r="##SELECTOR##";let n=this._paramsCssCache;if(!n){let s="",i="";const o=this._getModeParams();for(const l of Object.keys(o)){const c=o[l];if(l!==Ds){const h=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;s+=h,i+=h}for(const u of Object.keys(c).sort()){const h=c[u],d=sA(u,h,this.themeLogger);if(d===!1)this.themeLogger.error(107,{key:u,value:h});else{const f=rS(u),p=f.replace("--ag-","--ag-inherited-");s+=`	${f}: var(${p}, ${d});
`,i+=`	${p}: var(${f});
`}}l!==Ds&&(s+=`}
`,i+=`}
`)}let a=`${r} {
${s}}
`;a+=`:has(> ${r}):not(${r}) {
${i}}
`,this._paramsCssCache=n=a}return n.replaceAll(r,`:where(.${t})`)}},zv=e=>{const t=new Map;for(const n of e)t.set(n.feature,n);const r=[];for(const n of e)(!n.feature||t.get(n.feature)===n)&&r.push(n);return r},oA=e=>{const t=new Set,r=i=>{if(Array.isArray(i))i.forEach(r);else{const o=i==null?void 0:i.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(i=>Object.values(i)).forEach(r),Array.from(t).sort()},Uv=!1,aA=()=>{if(!Uv){Uv=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},lA=async(e,t)=>{const r=`@import url('https://${cA}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Xo(r,document.head,`googleFont:${e}`,void 0,0,t)},cA="fonts.googleapis.com",uA=1,hA=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=uA++,e!=null&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){var t;this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(const r of Object.keys(e.providedBeanInstances))this.beans[r]=e.providedBeanInstances[r];for(const r of e.beanClasses){const n=new r;n.beanName?this.beans[n.beanName]=n:console.error(`Bean ${r.name} is missing beanName`),this.createdBeans.push(n)}for(const r of(t=e.derivedBeans)!=null?t:[]){const{beanName:n,bean:s}=r(this);this.beans[n]=s,this.createdBeans.push(s)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){var n,s,i,o;const r=this.beans;for(const a of e)(n=a.preWireBeans)==null||n.call(a,r),(s=a.wireBeans)==null||s.call(a,r);for(const a of e)(i=a.preConstruct)==null||i.call(a);t&&e.forEach(t);for(const a of e)(o=a.postConstruct)==null||o.call(a)}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){var t;if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],(t=this.destroyCallback)==null||t.call(this)}destroyBean(e){var t;(t=e==null?void 0:e.destroy)==null||t.call(e)}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},dA=0,fA=class extends Yi{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++dA}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){var r;const{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=(r=e.get("themeStyleContainer"))!=null?r:t.getRootNode()===document?document.head:t,this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>zD(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){const{theme:r}=this;let n;r?n=`${this.paramsClass} ${r._getCssClass()}`:n=this.applyLegacyThemeClasses();for(const s of Array.from(e.classList))s.startsWith("ag-theme-")&&e.classList.remove(s);if(n){const s=e.className;e.className=`${s}${s?" ":""}${n}${t!=null&&t.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let r=!1;for(const n of Array.from(t.classList))n.startsWith("ag-theme-")&&(r=!0,e=e?`${e} ${n}`:n);r&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?Xo(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){const{gos:e,theme:t}=this,r=e.get("theme");let n;if(r==="legacy")n=void 0;else{const s=r!=null?r:this.getDefaultTheme();s instanceof oS?n=s:this.themeError(s)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,r)}handleNewTheme(e){const{gos:t,eRootDiv:r,globalCSS:n}=this,s=this.getAdditionalCss();if(e){GD(this),eS(this.eStyleContainer,this.cssLayer,this.styleNonce,s);for(const[o,a]of n)Xo(o,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e==null||e._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:s});let i=this.eParamsStyle;if(!i){i=this.eParamsStyle=zh({tag:"style"});const o=t.get("styleNonce");o&&i.setAttribute("nonce",o),r.appendChild(i)}np||(i.textContent=(e==null?void 0:e._getPerInstanceCss(this.paramsClass))||""),this.applyThemeClasses(r),this.fireStylesChangedEvent("themeChanged")}},gA=class extends Yi{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){var t;if(e){(t=this.dynamicBeans)!=null||(this.dynamicBeans={});for(const r of Object.keys(e))this.dynamicBeans[r]=e[r]}}createDynamicBean(e,t,...r){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));const n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...r)}},pA=class extends Yi{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new Yl}addListener(e,t,r){this.globalSvc.addEventListener(e,t,r)}removeListener(e,t,r){this.globalSvc.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},lS=(e,t)=>{if(t!=null&&(e==null?void 0:e.setPointerCapture))try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},mA=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;const r=t.pointerId;if(!lS(e,r))return null;const n={eElement:e,pointerId:r,onLost(s){xA(n,s)}};return e.addEventListener("lostpointercapture",n.onLost),n},vA=e=>{if(!e)return;cS(e);const{eElement:t,pointerId:r}=e;if(!!t){try{t.releasePointerCapture(r)}catch{}e.eElement=null}},cS=e=>{const{eElement:t,onLost:r}=e;t&&r&&(t.removeEventListener("lostpointercapture",r),e.onLost=null)},xA=(e,t)=>{cS(e);const{eElement:r,pointerId:n}=e;r&&t.pointerId===n&&lS(r,n)},Ar,zn,es=e=>{if(!zn)zn=new WeakSet;else if(zn.has(e))return!1;return zn.add(e),!0},CA=class extends Yi{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){var e,t;return(t=(e=this.drag)==null?void 0:e.start.target)!=null?t:null}isPointer(){return!!(Ar!=null&&Ar.has(Vn(this.beans)))}hasPointerCapture(){var t,r,n;const e=(t=this.drag)==null?void 0:t.pointerCapture;return!!(e&&((n=(r=this.beans.eRootDiv).hasPointerCapture)==null?void 0:n.call(r,e.pointerId)))}destroy(){this.drag&&this.cancelDrag();const e=this.dragSources;for(const t of e)jv(t);e.length=0,super.destroy()}removeDragSource(e){const t=this.dragSources;for(let r=0,n=t.length;r<n;++r){const s=t[r];if(s.params===e){t.splice(r,1),jv(s);break}}}addDragSource(e){if(!this.isAlive())return;const{eElement:t,includeTouch:r}=e,n=[];let s;if(r){const c=t.style;c&&(s=c.touchAction,c.touchAction="none")}const i={handlers:n,params:e,oldTouchAction:s};this.dragSources.push(i),iu(n,[t,"pointerdown",c=>this.onPointerDown(e,c),{passive:!1}],[t,"mousedown",c=>this.onMouseDown(e,c)]);const l=this.gos.get("suppressTouch");r&&!l&&iu(n,[t,"touchstart",u=>this.onTouchStart(e,u),{passive:!1}])}cancelDrag(e){var r,n;const t=this.drag;e!=null||(e=t==null?void 0:t.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),(n=t==null?void 0:(r=t.params).onDragCancel)==null||n.call(r),this.destroyDrag()}shouldPreventMouseEvent(e){const t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&El(this.beans,e)&&!Xa($d(e))}initDrag(e,...t){this.drag=e;const r=this.beans,n=a=>this.onScroll(a),s=a=>this.onKeyDown(a),i=Vn(r),o=Ln(r);iu(e.handlers,[i,"contextmenu",_s],[i,"keydown",s],[o,"scroll",n,{capture:!0}],[o.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;const e=this.drag;if(e){const t=e.rootEl;(Ar==null?void 0:Ar.get(t))===e&&(Ar==null||Ar.delete(t)),this.drag=null,vA(e.pointerCapture),Xg(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;const r=this.beans;if(zn!=null&&zn.has(t))return;const n=t.pointerType;if(n==="touch"&&(r.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),Xa($d(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();const s=Vn(r),i=e.eElement,o=t.pointerId,a=new jd(s,e,t,o);Ar!=null||(Ar=new WeakMap),Ar.set(s,a);const l=h=>{h.pointerId===o&&this.onMouseOrPointerMove(h)},c=h=>{h.pointerId===o&&this.onMouseOrPointerUp(h)},u=h=>{h.pointerId===o&&es(h)&&this.cancelDrag()};this.initDrag(a,[s,"pointerup",c],[s,"pointercancel",u],[s,"pointermove",l,{passive:!1}],[s,"touchmove",_s,{passive:!1}],[i,"mousemove",_s,{passive:!1}]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):es(t)}onTouchStart(e,t){var c;if(this.gos.get("suppressTouch")||!e.includeTouch||!es(t)||Xa($d(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){_s(t);return}this.destroyDrag();const n=this.beans,s=Vn(n),i=new jd(s,e,t.touches[0]),o=u=>this.onTouchMove(u),a=u=>this.onTouchUp(u),l=(c=t.target)!=null?c:e.eElement;this.initDrag(i,[Vn(n),"touchmove",_s,{passive:!1}],[l,"touchmove",o,{passive:!0}],[l,"touchend",a,{passive:!0}],[l,"touchcancel",a,{passive:!0}]),e.dragStartPixels===0&&this.onMove(i.start)}onMouseDown(e,t){if(t.button!==0||zn!=null&&zn.has(t)||this.isPointer())return;const r=this.beans;this.destroyDrag();const n=new jd(Vn(r),e,t),s=a=>this.onMouseOrPointerMove(a),i=a=>this.onMouseOrPointerUp(a),o=Vn(r);this.initDrag(n,[o,"mousemove",s],[o,"mouseup",i]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):es(t)}onScroll(e){var n;if(!es(e))return;const t=this.drag,r=t==null?void 0:t.lastDrag;r&&this.dragging&&((n=t.params)==null||n.onDragging(r))}onMouseOrPointerMove(e){var t;!es(e)||(tp()&&((t=Ln(this.beans).getSelection())==null||t.removeAllRanges()),this.shouldPreventMouseEvent(e)&&_s(e),this.onMove(e))}onTouchMove(e){const t=this.drag;if(!t||!es(e))return;const r=Ya(t.start,e.touches);r&&(e.preventDefault(),this.onMove(r))}onMove(e){const t=this.drag;if(!t)return;t.lastDrag=e;const r=t.params;if(!this.dragging){const n=t.start,s=r.dragStartPixels,i=s!=null?s:4;if(wy(e,n,i)||(this.dragging=!0,r.capturePointer&&(t.pointerCapture=mA(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:r.eElement}),r.onDragStart(n),this.drag!==t)||(r.onDragging(n),this.drag!==t))return}r.onDragging(e)}onTouchUp(e){const t=this.drag;t&&es(e)&&this.onUp(Ya(t.start,e.changedTouches))}onMouseOrPointerUp(e){es(e)&&this.onUp(e)}onUp(e){const t=this.drag;!t||(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===ve.ESCAPE&&this.cancelDrag()}},jv=e=>{Xg(e.handlers);const t=e.oldTouchAction;if(t!=null){const r=e.params.eElement.style;r&&(r.touchAction=t)}},jd=class{constructor(e,t,r,n=null){this.rootEl=e,this.params=t,this.start=r,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},$d=e=>{const t=e.target;return t instanceof Element?t:null},wA=class extends Yi{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){const r={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(r),this.beans.dragSvc.addDragSource(r)}setDragImageCompIcon(e,t=!1){const r=this.dragImageComp;r&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,r.setIcon(e,t))}removeDragSource(e){var s;const{dragSourceAndParamsList:t,beans:r}=this,n=t.find(i=>i.dragSource===e);n&&((s=r.dragSvc)==null||s.removeDragSource(n),Bi(t,n))}destroy(){const{dragSourceAndParamsList:e,dropTargets:t,beans:r}=this,n=r.dragSvc;for(const s of e)n==null||n.removeDragSource(s);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){const e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){var n;this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();const r=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-r.left,this.dragInitialSourcePointerOffsetY=t.clientY-r.top,(n=e.onDragStarted)==null||n.call(e),this.createAndUpdateDragImageComp(e)}onDragStop(e){var n,s;const{dragSource:t,lastDropTarget:r}=this;if((n=t==null?void 0:t.onDragStopped)==null||n.call(t),r){const i=this.dropTargetEvent(r,e,!1);(s=r.onDragStop)==null||s.call(r,i)}this.clearDragAndDropProperties()}onDragCancel(){var n,s;const{dragSource:e,lastDropTarget:t,lastMouseEvent:r}=this;if((n=e==null?void 0:e.onDragCancelled)==null||n.call(e),t&&r){const i=this.dropTargetEvent(t,r,!1);(s=t.onDragCancel)==null||s.call(t,i)}this.clearDragAndDropProperties()}onDragging(e,t=!1){var a,l,c;this.positionDragImageComp(e);const r=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:s,dragItem:i}=this;let o=!1;if(r!==n){if(o=!0,n){const u=this.dropTargetEvent(n,e,t);(a=n.onDragLeave)==null||a.call(n,u)}if(n!==null&&!r?this.handleExit(s,i):n===null&&r&&this.handleEnter(s,i),r){const u=this.dropTargetEvent(r,e,t);(l=r.onDragEnter)==null||l.call(r,u)}this.lastDropTarget=r}else if(r){const u=this.dropTargetEvent(r,e,t);(c=r.onDragging)==null||c.call(r,u),u!=null&&u.changed&&(o=!0)}this.lastMouseEvent=e,o&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,r=[[e.getContainer()]];return t?r.concat(t):r}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let n=!1;const s=(a,l)=>{for(const c of l){const{width:u,height:h,left:d,right:f,top:p,bottom:g}=c.getBoundingClientRect();if(u===0||h===0)return!1;const m=a.clientX>=d&&a.clientX<f,v=a.clientY>=p&&a.clientY<g;if(!m||!v)return!1}return!0};for(const a of r)if(s(e,a)){n=!0;break}const{eElement:i,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(i)?!1:n&&t.isInterestedIn(o,i)}findCurrentDropTarget(e){const t=this.dropTargets.filter(i=>this.isMouseOnDropTarget(e,i)),r=t.length;if(r===0)return null;if(r===1)return t[0];const s=Vn(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const i of s)for(const o of t)if(this.getAllContainersFromDropTarget(o).flatMap(l=>l).indexOf(i)!==-1)return o;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,r){var m;const{dragSource:n,dragItem:s,lastDraggingEvent:i,lastMouseEvent:o,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),u=c.getBoundingClientRect(),{clientX:h,clientY:d}=t,f=h-((o==null?void 0:o.clientX)||0),p=d-((o==null?void 0:o.clientY)||0),g=this.createEvent({event:t,x:h-u.left,y:d-u.top,vDirection:p>0?"down":p<0?"up":null,hDirection:f<0?"left":f>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:r,dragItem:s,dropZoneTarget:c,dropTarget:(m=i==null?void 0:i.dropTarget)!=null?m:null,changed:!!(i!=null&&i.changed)});return this.lastDraggingEvent=g,g}positionDragImageComp(e){var r;const t=(r=this.dragImageComp)==null?void 0:r.getGui();t&&OR(t,e,this.beans)}removeDragImageComp(e){var t;this.dragImageComp===e&&(this.dragImageComp=null),e&&((t=e.getGui())==null||t.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){var r;const t=(r=this.createDragImageComp(e))!=null?r:null;this.dragImageCompPromise=t,t==null||t.then(n=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(n);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;const s=this.dragImageComp;s!==n&&(this.dragImageComp=n,this.removeDragImageComp(s)),n&&(this.appendDragImageComp(n),this.updateDragImageComp())})}appendDragImageComp(e){var s;const t=e.getGui(),r=t.style;r.position="absolute",r.zIndex="9999",(s=this.beans.dragSvc)!=null&&s.hasPointerCapture()&&(r.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),r.top="20px",r.left="20px";const n=$g(this.beans);this.dragImageParent=n,n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){var o,a;const{dragImageComp:e,dragSource:t,lastDropTarget:r,lastDraggingEvent:n,dragImageLastLabel:s}=this;if(!e)return;this.setDragImageCompIcon((a=(o=r==null?void 0:r.getIconName)==null?void 0:o.call(r,n))!=null?a:null);let i=t==null?void 0:t.dragItemName;typeof i=="function"&&(i=i(n)),i||(i=""),s!==i&&(this.dragImageLastLabel=i,e.setLabel(i))}},yA=class extends wA{createEvent(e){return ot(this.gos,e)}createDragImageComp(e){const{gos:t,beans:r}=this,n=uD(r.userCompFactory,ot(t,{dragSource:e}));return n==null?void 0:n.newAgStackInstance()}handleEnter(e,t){var r;(r=e==null?void 0:e.onGridEnter)==null||r.call(e,t)}handleExit(e,t){var r;(r=e==null?void 0:e.onGridExit)==null||r.call(e,t)}warnNoBody(){Ge(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){const r={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(r),t.addDestroyFunc(()=>this.removeDropTarget(r))}};function uS(e,t){return e+"_"+t}function Bt(e){return e instanceof Tl}var Tl=class extends we{constructor(e,t,r,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=r,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Ka(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return uS(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(const e of this.displayedChildren)Bt(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=ct(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){var t;let e=0;for(const r of(t=this.displayedChildren)!=null?t:[])e+=r.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(const t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(const t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){var e;return!!((e=this.getColGroupDef())!=null&&e.autoHeaderHeight)}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){var t;for(const r of(t=this.displayedChildren)!=null?t:[])Ni(r)?e.push(r):Bt(r)&&r.addDisplayedLeafColumns(e)}addLeafColumns(e){var t;for(const r of(t=this.children)!=null?t:[])Ni(r)?e.push(r):Bt(r)&&r.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!(e!=null&&e.isPadding())?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){var r,n;this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(const s of(r=this.children)!=null?r:[]){if(Bt(s)&&!((n=s.displayedChildren)!=null&&n.length))continue;switch(s.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(s);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(s);break;default:this.displayedChildren.push(s);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},SA=e=>{for(;e!=null&&e.length;){const t=e[0];if(t.data)return t;e=t.childrenAfterGroup}},kA={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"};new Set(Object.values(kA));function Yo(e){return zh(e)}var hS="__ag_Grid_Stop_Propagation";function sh(e){e[hS]=!0}function Ys(e){return e[hS]===!0}var bA="ag-focus-managed",Qh=class extends we{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:r=>{if(r.defaultPrevented)return;const n=Xh(this.beans,this.eFocusable,!1,r.shiftKey);!n||(n.focus(),r.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:r}}=this;e.classList.add(bA),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),r&&this.addManagedElementListeners(e,{focusout:r})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||Ys(t))return;const{callbacks:r}=this;if(r.shouldStopEventPropagation(t)){sh(t);return}t.key===ve.TAB?r.onTabKeyDown(t):r.handleKeyDown&&r.handleKeyDown(t)}})}},hu={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},ip=class extends we{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},r=t.autoHeight?hu.AUTO_HEIGHT:t.print?hu.PRINT:hu.NORMAL;this.view.updateLayoutClasses(r,t)}},Es="Viewport",$v="fakeVScrollComp",Kd=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],Kv=100,Xd=150,EA=class extends we{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=Pa(this,()=>this.lastScrollSource[1]=null,Xd),this.resetLastVScrollDebounced=Pa(this,()=>this.lastScrollSource[0]=null,Xd)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,r=>{this.centerRowsCtrl=r.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Es)});for(const e of Kd){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?Pa(this,this.onVScroll.bind(this,Es),Kv):this.onVScroll.bind(this,Es),n=t?Pa(this,this.onVScroll.bind(this,$v),Kv):this.onVScroll.bind(this,$v);this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...Kd,Es]){if(this.lastScrollSource[1]===t)continue;const r=this.getViewportForSource(t);Xu(r,e,this.enableRtl)}}getViewportForSource(e){return e===Es?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const n=Ku(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Es?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:r}=this;r==null||r.setScrollTop(t),this.nextScrollTop=t,e===Es?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,r!=null&&r.active?r.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},Xd)}shouldBlockScrollUpdate(e,t,r=!1){return r&&!Za()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=fy(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){const e=this.scrollLeft;let t=!1;for(const r of Kd)if(this.getViewportForSource(r).scrollLeft!==e){t=!0;break}t&&this.onHScroll(Es)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),Xu(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:r,lastScrollTop:n}=this;return{top:n,bottom:n+r}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:r}=this.beans,n=r.getRowCount();let s=-1;for(let i=0;i<n;i++){const o=r.getRow(i);if(typeof e=="function"){if(o&&e(o)){s=i;break}}else if(e===o||e===o.data){s=i;break}}s>=0&&this.ensureIndexVisible(s,t)}ensureIndexVisible(e,t,r=0){if(Fr(this.gos,"print"))return;const{rowModel:n}=this.beans,s=n.getRowCount();if(typeof e!="number"||e<0||e>=s){Ge(88,{index:e});return}this.clearRetryListeners();const{frameworkOverrides:i,pageBounds:o,rowContainerHeight:a,rowRenderer:l}=this.beans;i.wrapIncoming(()=>{var p,g;const c=this.ctrlsSvc.getGridBodyCtrl(),u=n.getRow(e);let h,d,f=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:m,stickyBottomHeight:v}=c,C=u.rowTop,x=u.rowHeight,w=o.getPixelOffset(),k=u.rowTop-w,E=k+u.rowHeight,y=this.getVScrollPosition(),R=a.divStretchOffset,D=y.top+R,N=y.bottom+R,O=N-D,A=a.getScrollPositionForPixel(k),G=a.getScrollPositionForPixel(E-O),q=Math.min((A+G)/2,k),z=D+m>k,se=N-v<E;let te=null;t==="top"?te=A-m:t==="bottom"?te=G+v:t==="middle"?te=q:z?te=A-m:se&&(G-A>O?te=A-m:te=G+v),te!==null&&(this.setVerticalScrollPosition(te),l.redraw({afterScroll:!0})),h=C!==u.rowTop||x!==u.rowHeight,d=m!==c.stickyTopHeight||v!==c.stickyBottomHeight,f++}while((h||d)&&f<10);if((p=this.animationFrameSvc)==null||p.flushAllFrames(),r<10&&((u==null?void 0:u.stub)||!((g=this.beans.rowAutoHeight)!=null&&g.areRowsMeasured()))){const m=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{const v=this.getVScrollPosition().top;m!==v&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,r+1)}})}})}clearRetryListeners(){for(const e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){const{colModel:r,frameworkOverrides:n}=this.beans,s=r.getCol(e);if(!s||s.isPinned()||!this.visibleCols.isColDisplayed(s))return;const i=this.getPositionedHorizontalScroll(s,t);n.wrapIncoming(()=>{var o;i!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),(o=this.animationFrameSvc)==null||o.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:n}=this.isColumnOutsideViewport(e),s=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),i=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:n)||s,l=o?n:r;t!=="auto"&&(a=t==="start",l=t==="end");const c=t==="middle";if(a||l||c){const{colLeft:u,colMiddle:h,colRight:d}=this.getColumnBounds(e);return c?h-i/2:a?o?d:u:o?u-i:d-i}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:n,colRight:s}=this.getColumnBounds(e),i=this.enableRtl,o=i?t>s:r<s,a=i?r<n:t>n;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleCols.bodyWidth,n=e.getActualWidth(),s=e.getLeft(),i=t?-1:1,o=t?r-s:s,a=o+n*i,l=o+n/2*i;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),r=t,n=e+t;return{start:r,end:n,width:e}}},op=class extends we{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=Fr(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:r}=this.beans,n=t.bodyWidth,s=t.getColsLeftWidth(),i=t.getDisplayedColumnsRightWidth();let o;e?o=n+s+i:(o=n,this.addSpacer&&(this.gos.get("enableRtl")?s:i)===0&&r.verticalScrollShowing&&(o+=r.getScrollbarWidth())),this.callback(o)}},FA=class extends we{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:r}=this,n=()=>{ai(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),r.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e==null||e.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const r=this.centerContainerCtrl.getCenterWidth();r!==this.centerWidth&&(this.centerWidth=r,t==null||t.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=fy(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function du(e,t,r,n){var i;const s=(i=t.getColDef().cellRendererParams)==null?void 0:i.suppressMouseEventHandling;return dS(e,t,r,n,s)}function TA(e,t,r,n){const s=t==null?void 0:t.suppressMouseEventHandling;return dS(e,void 0,r,n,s)}function dS(e,t,r,n,s){return s?s(ot(e,{column:t,node:r,event:n})):!1}function fS(e,t,r){let n=t;for(;n;){const s=Ny(e,n,r);if(s)return s;n=n.parentElement}return null}var ih="cellCtrl";function ap(e,t){return fS(e,t,ih)}var oh="renderedRow";function RA(e,t){return fS(e,t,oh)}function Xv(e,t,r,n,s){const i=n?n.getColDef().suppressKeyboardEvent:void 0;if(!i)return!1;const o=ot(e,{event:t,editing:s,column:n,node:r,data:r.data,colDef:n.getColDef()});return!!(i&&i(o))}function _A(e){var h,d,f;const{pinnedRowModel:t,rowModel:r}=e,[n,s]=[(h=t==null?void 0:t.isEmpty("top"))!=null?h:!0,(d=t==null?void 0:t.isEmpty("bottom"))!=null?d:!0],i=n?null:"top";let o,a;s?(o=null,a=r.getRowCount()-1):(o="bottom",a=(f=t==null?void 0:t.getPinnedBottomRowCount())!=null?f:0-1);const{visibleCols:l,rangeSvc:c}=e,u=l.allCols;!c||!(u!=null&&u.length)||c.setCellRange({rowStartIndex:0,rowStartPinned:i,rowEndIndex:a,rowEndPinned:o})}var DA=65,AA=67,PA=86,IA=68,LA=90,MA=89;function OA(e){const{keyCode:t}=e;let r;switch(t){case DA:r=ve.A;break;case AA:r=ve.C;break;case PA:r=ve.V;break;case IA:r=ve.D;break;case LA:r=ve.Z;break;case MA:r=ve.Y;break;default:r=e.code}return r}var NA=class extends we{constructor(e){super(),this.element=e}postConstruct(){var e;this.addKeyboardListeners(),this.addMouseListeners(),(e=this.beans.touchSvc)==null||e.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){const t=["dblclick","contextmenu","mouseover","mouseout","click",Cy("touchstart")?"touchstart":"mousedown"];for(const r of t){const n=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:n})}}processMouseEvent(e,t){var s;if(!El(this.beans,t)||Ys(t))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(r!=null&&r.column&&r.dispatchCellContextMenuEvent(t),(s=this.beans.contextMenuSvc)==null||s.handleContextMenuMouseEvent(t,void 0,n,r)):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:ap(t,e),rowCtrl:RA(t,e)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):n!=null&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,r){var i,o,a;const n=(o=(i=this.editSvc)==null?void 0:i.isEditing(e,{withOpenEditor:!0}))!=null?o:!1;!Xv(this.gos,r,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&((a=this.beans.navigation)==null?void 0:a.handlePageScrollingKey(r))||e.onKeyDown(r),this.doGridOperations(r,n),RD(r)&&e.processCharacter(r)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const{rowNode:n}=e,{focusSvc:s,navigation:i}=this.beans,o=s.getFocusedCell(),a=o==null?void 0:o.column;if(!Xv(this.gos,r,n,a,!1)){const c=r.key;if(t==="keydown")switch(c){case ve.PAGE_HOME:case ve.PAGE_END:case ve.PAGE_UP:case ve.PAGE_DOWN:i==null||i.handlePageScrollingKey(r,!0);break;case ve.LEFT:case ve.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case ve.UP:case ve.DOWN:e.onKeyboardNavigate(r);break;case ve.TAB:e.onTabKeyDown(r);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!El(this.beans,e))return;const r=OA(e),{clipboardSvc:n,undoRedo:s}=this.beans;if(r===ve.A)return this.onCtrlAndA(e);if(r===ve.C)return this.onCtrlAndC(n,e);if(r===ve.D)return this.onCtrlAndD(n,e);if(r===ve.V)return this.onCtrlAndV(n,e);if(r===ve.X)return this.onCtrlAndX(n,e);if(r===ve.Y)return this.onCtrlAndY(s);if(r===ve.Z)return this.onCtrlAndZ(s,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:r,selectionSvc:n},gos:s}=this;r&&Fl(s)&&!m_(s)&&t.isRowsToRender()?_A(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:p_(s)}),e.preventDefault()}onCtrlAndC(e,t){var n;if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(n=this.editSvc)!=null&&n.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){var n;if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(n=this.editSvc)!=null&&n.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){var n;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);(n=this.editSvc)!=null&&n.isEditing(r,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e==null||e.redo("ui")}},gS=class extends we{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,r=t!=null?`${t}px`:"";this.eContainer.style.height=r,this.eViewport&&(this.eViewport.style.height=r)}},Tc=e=>e.topRowCtrls,Rc=e=>e.getStickyTopRowCtrls(),_c=e=>e.getStickyBottomRowCtrls(),Dc=e=>e.bottomRowCtrls,Ac=e=>e.allRowCtrls,Yd=e=>e.getCtrls("top"),Qd=e=>e.getCtrls("center"),Zd=e=>e.getCtrls("bottom"),BA={center:{type:"center",name:"center-cols",getRowCtrls:Ac,getSpannedRowCtrls:Qd},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Ac,getSpannedRowCtrls:Qd},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Ac,getSpannedRowCtrls:Qd},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Ac},topCenter:{type:"center",name:"floating-top",getRowCtrls:Tc,getSpannedRowCtrls:Yd},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Tc,getSpannedRowCtrls:Yd},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Tc,getSpannedRowCtrls:Yd},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:Tc},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Rc},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Rc},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Rc},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Rc},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:_c},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:_c},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:_c},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:_c},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Dc,getSpannedRowCtrls:Zd},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Dc,getSpannedRowCtrls:Zd},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Dc,getSpannedRowCtrls:Zd},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Dc}};function pS(e){return`ag-${ql(e).name}-viewport`}function fu(e){var r;const t=ql(e);return(r=t.container)!=null?r:`ag-${t.name}-container`}function HA(e){return`ag-${ql(e).name}-spanned-cells-container`}function ql(e){return BA[e]}var WA=["topCenter","topLeft","topRight"],VA=["bottomCenter","bottomLeft","bottomRight"],GA=["center","left","right"],zA=["center","left","right","fullWidth"],UA=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],jA=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],$A=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],mS=["stickyTopCenter","stickyTopLeft","stickyTopRight"],vS=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],KA=[...mS,"stickyTopFullWidth",...vS,"stickyBottomFullWidth"],XA=[...WA,...VA,...GA,...mS,...vS],YA=class extends we{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=ql(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new FA(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,r,n){var a;this.comp=e,this.eContainer=t,this.eSpannedContainer=r,this.eViewport=n,this.createManagedBean(new NA((a=this.eViewport)!=null?a:this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:s,rangeSvc:i}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(jA,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(s==null?void 0:s.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers($A,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(s==null?void 0:s.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(zA,()=>this.createManagedBean(new gS(this.eContainer,this.name==="center"?n:void 0))),i&&this.forContainers(XA,()=>this.createManagedBean(i.createDragListenerFeature(this.eContainer))),this.forContainers(UA,()=>this.createManagedBean(new op(l=>this.comp.setContainerWidth(`${l}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans,r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:r,displayedColumnsWidthChanged:r,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),r(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const n=this.options.getSpannedRowCtrls(e);!n||this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(KA.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const r=this.gos.get("ensureDomOrder"),n=Fr(this.gos,"print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=r=>{e.dragging&&r.cancelable&&r.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return $u(this.eViewport)}getCenterViewportScrollLeft(){return Ku(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=ia(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return gy(this.eViewport)}getViewportScrollLeft(){return Ku(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||DR(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Xu(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const r=Fr(this.gos,"print"),s=this.gos.get("embedFullWidthRows")||r,i=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!s&&a:s||!a});this.comp.setRowCtrls({rowCtrls:i,useFlushSync:e})}},QA="ag-force-vertical-scroll",ZA="ag-selectable",qA="ag-column-moving",JA=class extends we{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,r,n,s,i,o){var a,l;this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=n,this.eBottom=s,this.eStickyTop=i,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${pS("center")}`),this.eFullWidthContainer=r.querySelector(`.${fu("fullWidth")}`),this.eStickyTopFullWidthContainer=i.querySelector(`.${fu("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${fu("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",c=>this.setCellTextSelection(c.currentValue)),this.createManagedBean(new ip(this.comp)),this.scrollFeature=this.createManagedBean(new EA(r)),(a=this.beans.rowDragSvc)==null||a.setupRowDrag(r,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,r,s,i,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),(l=this.filterManager)==null||l.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),r=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:r,rowResizeEnded:r}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){const t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const r=t&&e.getScrollbarWidth()||0,n=Jy()?16:0,s=`calc(100% + ${r+n}px)`;ai(this.beans,()=>this.comp.setBodyViewportWidth(s)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let r=this.gos.get("treeData");if(!r){const n=t.isPivotMode();r=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(r?"treegrid":"grid")}addFocusListeners(e){for(const t of e)this.addManagedElementListeners(t,{focusin:r=>{const{target:n}=r,s=Po(n,"ag-root",t);t.classList.toggle("ag-has-focus",!s)},focusout:r=>{const{target:n,relatedTarget:s}=r,i=t.contains(s),o=Po(s,"ag-root",t);Po(n,"ag-root",t)||(!i||o)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(qA,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(ZA,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){var e;(e=this.beans.editSvc)==null||e.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){var s,i,o,a;const e=((i=(s=this.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:s.getRowCount())!=null?i:0)+((a=(o=this.filterManager)==null?void 0:o.getHeaderRowCount())!=null?a:0),{rowModel:t}=this.beans,r=t.isLastRowIndexKnown()?t.getRowCount():-1,n=r===-1?-1:e+r;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?QA:null,r=Fr(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&AR(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let r=t.sizesMeasured;const n=()=>{const s=r&&Jg(this.gos)&&!e.stretching,i=s?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(i,s)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!r&&t.sizesMeasured&&(r=!0,n())}})}addBodyViewportListener(){const{eBodyViewport:e,eStickyTop:t,eStickyBottom:r,eTop:n,eBottom:s,beans:{popupSvc:i,touchSvc:o}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),o==null||o.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,i)});const l=this.onStickyWheel.bind(this);for(const u of[t,r,n,s])this.addManagedElementListeners(u,{wheel:l});const c=this.onHorizontalWheel.bind(this);for(const u of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(u).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&El(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;!(n||Math.abs(t)>Math.abs(r))||this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){var s;if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&((s=this.beans.contextMenuSvc)==null||s.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody,source:"ui"}))}onBodyViewportWheel(e,t){!this.gos.get("suppressScrollWhenPopupsAreOpen")||e!=null&&e.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e,beans:{environment:t}}=this,r=e==null?void 0:e.getPinnedTopTotalHeight(),n=e==null?void 0:e.getPinnedBottomTotalHeight(),s=t.getPinnedRowBorderWidth(),i=t.getRowBorderWidth(),o=s-i,a=r?o+r:0,l=n?o+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){var s,i,o,a;const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+((i=(s=this.filterManager)==null?void 0:s.getHeaderHeight())!=null?i:0),r=(a=(o=this.pinnedRowModel)==null?void 0:o.getPinnedTopTotalHeight())!=null?a:0;let n=0;t>0&&(n+=t),r>0&&(n+=r),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){var a;const{pinnedRowModel:e,scrollVisibleSvc:t,comp:r}=this,n=(a=e==null?void 0:e.getPinnedBottomTotalHeight())!=null?a:0,i=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=n+i;r.setStickyBottomBottom(`${o}px`)}};function eP(e,t){var r,n;return(n=(r=ap(e,t.target))==null?void 0:r.getFocusedCellPosition())!=null?n:null}var xS=class extends ws{constructor(e,t){super(),this.direction=t,this.eViewport=qe,this.eContainer=qe,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",Zy()||Za())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=Jy(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),r=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),ai(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;GR(this,()=>sa(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},tP={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},rP=class extends xS{constructor(){super(tP,"horizontal"),this.eLeftSpacer=qe,this.eRightSpacer=qe,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new op(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){var t,r;if(!this.invisibleScrollbar)return;const e=(r=(t=this.beans.pinnedRowModel)==null?void 0:t.getPinnedBottomTotalHeight())!=null?r:0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();r&&(t+=n),Xs(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let s=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(s+=n),Xs(this.eLeftSpacer,s),this.eLeftSpacer.classList.toggle("ag-scroller-corner",s<=n)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,i=r?0:n===0&&t?16:n,o=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Nd(this.getGui(),i),Nd(this.eViewport,i),Nd(this.eContainer,i),i||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return Ku(this.eViewport,this.enableRtl)}setScrollPosition(e){sa(this.eViewport)||this.attemptSettingScrollPosition(e),Xu(this.eViewport,e,this.enableRtl)}},nP={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},sP=class extends xS{constructor(){super(nP,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new gS(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,r=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,s=n===0&&r?16:n;this.toggleCss("ag-scrollbar-invisible",r),Xs(this.getGui(),s),Xs(this.eViewport,s),Xs(this.eContainer,s),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const r=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),s=r.scrollTop;n!=s&&this.setScrollPosition(s,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!sa(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},iP="ag-column-first",oP="ag-column-last";function CS(e,t,r,n){return Jt(e)?[]:lP(e.headerClass,e,t,r,n)}function wS(e,t,r){e.toggleCss(iP,r.isColAtEdge(t,"first")),e.toggleCss(oP,r.isColAtEdge(t,"last"))}function aP(e,t,r,n){return ot(t,{colDef:e,column:r,columnGroup:n})}function lP(e,t,r,n,s){if(Jt(e))return[];let i;if(typeof e=="function"){const o=aP(t,r,n,s);i=e(o)}else i=e;return typeof i=="string"?[i]:Array.isArray(i)?[...i]:[]}function Fi(e){var t;return e.gos.get("suppressHeaderFocus")||!!((t=e.overlays)!=null&&t.isExclusive())}function lp(e){var t;return e.gos.get("suppressCellFocus")||!!((t=e.overlays)!=null&&t.isExclusive())}function Rl(e,t,r=!1){const n=e.ctrlsSvc.get("gridCtrl");return!r&&n.focusNextInnerContainer(t)?!0:((r||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function jn(e){var t,r;return(r=(t=e.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:t.getRowCount())!=null?r:0}function cp(e){const t=[],r=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const n of r){if(!n)continue;const s=n.getGroupRowCount()||0;for(let i=0;i<s;i++){const o=n.getGroupRowCtrlAtIndex(i),a=t[i];if(o){const l=cP(e,o);(a==null||l>a)&&(t[i]=l)}}}return t}function cP(e,t){let n=e.colModel.isPivotMode()?hP(e):SS(e);const s=t.getHeaderCellCtrls();for(const i of s){const{column:o}=i,a=o.getAutoHeaderHeight();a!=null&&a>n&&o.isAutoHeaderHeight()&&(n=a)}return n}function up(e){let r=e.colModel.isPivotMode()?uP(e):Zh(e);return e.colModel.forAllCols(n=>{const s=n.getAutoHeaderHeight();s!=null&&s>r&&n.isAutoHeaderHeight()&&(r=s)}),r}function Zh(e){var t;return(t=e.gos.get("headerHeight"))!=null?t:e.environment.getDefaultHeaderHeight()}function yS(e){var t;return(t=e.gos.get("floatingFiltersHeight"))!=null?t:Zh(e)}function SS(e){var t;return(t=e.gos.get("groupHeaderHeight"))!=null?t:Zh(e)}function uP(e){var t;return(t=e.gos.get("pivotHeaderHeight"))!=null?t:Zh(e)}function hP(e){var t;return(t=e.gos.get("pivotGroupHeaderHeight"))!=null?t:SS(e)}function dP(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var fP=class extends we{setComp(e,t,r){this.comp=e,this.eGui=t;const{beans:n}=this,{headerNavigation:s,touchSvc:i,ctrlsSvc:o}=n;s&&this.createManagedBean(new Qh(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),i==null||i.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>ai(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){var i;const{beans:e}=this;let t=0;const r=cp(e).reduce((o,a)=>o+a,0),n=up(e);if((i=e.filterManager)!=null&&i.hasFloatingFilters()&&(t+=yS(e)),t+=r,t+=n,this.headerHeight===t)return;this.headerHeight=t;const s=`${t+1}px`;this.comp.setHeightAndMinHeight(s),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const r=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",r)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey,n=r!==t?"LEFT":"RIGHT",{beans:s}=this,{headerNavigation:i,focusSvc:o}=s;(i.navigateHorizontally(n,!0,e)||!r&&o.focusOverlay(!1)||Rl(s,r,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:r}=this.beans;switch(e.key){case ve.LEFT:t="LEFT";case ve.RIGHT:{Be(t)||(t="RIGHT"),r.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case ve.UP:t="UP";case ve.DOWN:{Be(t)||(t="DOWN"),r.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:r,beans:n}=this;!t&&r.contains(xr(n))||r.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,r){var o;const{menuSvc:n,ctrlsSvc:s}=this.beans;if(!e&&!r||!(n!=null&&n.isHeaderContextMenuEnabled()))return;const{target:i}=e!=null?e:t;(i===this.eGui||i===((o=s.getHeaderRowContainerCtrl())==null?void 0:o.eViewport))&&n.showHeaderContextMenu(void 0,e,r)}},kS=class extends we{constructor(e,t,r,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?ct(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,r=e.get("suppressColumnMoveAnimation"),n=Be(this.columnOrGroup.getOldLeft());(t==null?void 0:t.isActive())&&n&&!r?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),r=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=r,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:r,visibleCols:n}=this.beans;if(!Fr(r,"print")||e.getPinned()==="left")return t;const i=n.getColsLeftWidth();if(e.getPinned()==="right"){const o=n.bodyWidth;return i+o+t}return i+t}setLeft(e){if(Be(e)&&(this.eCell.style.left=`${e}px`),Bt(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&kR(this.ariaEl,t.length)}}},gP=0,bS="headerCtrl",ES=class extends we{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+gP++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,r,n,s){var i;t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,r,n,s),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus((i=this.lastFocusEvent)!=null?i:void 0))}shouldStopEventPropagation(e){const{headerRowIndex:t,column:r}=this.beans.focusSvc.focusedHeader,n=r.getDefinition(),s=n==null?void 0:n.suppressHeaderKeyboardEvent;if(!Be(s))return!1;const i=ot(this.gos,{colDef:n,column:r,headerRowIndex:t,event:e});return!!s(i)}getWrapperHasFocus(){return xr(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let r;if(typeof t=="function"){const n=this.getHeaderClassParams();r=t(n)}else r=t;r&&this.comp.setUserStyles(r)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:r,compBean:n}=e,{beans:s}=this,i=h=>{if(!this.isAlive()||!n.isAlive())return;const{paddingTop:d,paddingBottom:f,borderBottomWidth:p,borderTopWidth:g}=Gh(this.eGui),m=d+f+p+g,C=t.offsetHeight+m;if(h<5){const x=Ln(s),w=!(x!=null&&x.contains(t)),k=C==0;if(w||k){w0(()=>i(h+1),"raf",s);return}}this.setColHeaderHeight(this.column,C)};let o=!1,a;const l=()=>{const h=this.column.isAutoHeaderHeight();h&&!o&&c(),!h&&o&&u()},c=()=>{o=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),i(0),a=ia(this.beans,t,()=>i(0))},u=()=>{o=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>u()),n.addManagedListeners(this.column,{widthChanged:()=>o&&i(0)}),n.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>i(0))}}),r&&r(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:r,eGui:n}=this;!e||!t||!n||(wS(e,t,r.visibleCols),uy(n,r.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=Fi(this.beans);this.eGui&&wi(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){var i;const t=xr(this.beans),r=e.key===ve.LEFT||e.key===ve.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),!r))return;const s=e.key===ve.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const o=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(o,e.shiftKey),(i=this.resizeFeature)==null||i.toggleColumnResizing(!0)}else this.moveHeader(s)}moveHeader(e){var t;(t=this.beans.colMoves)==null||t.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:r}=this.beans;return r?r.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:r}=this;let n=e.key===ve.LEFT!==t.get("enableRtl");const s=r.getPinned(),i=t.get("enableRtl");return s&&i!==(s==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){!this.isResizing||(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{var e;(e=this.resizeFeature)==null||e.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case ve.PAGE_DOWN:case ve.PAGE_UP:case ve.PAGE_HOME:case ve.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=bS,{eGui:r,gos:n}=this;Ko(n,r,t,this),e.addDestroyFunc(()=>Ko(n,r,t,null))}focus(e){if(!this.isAlive())return!1;const{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){var e;this.dragSource&&((e=this.beans.dragAndDrop)==null||e.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,r){const n=e!=null?e:t,{menuSvc:s,gos:i}=this.beans;i.get("preventDefaultOnContextMenu")&&n.preventDefault(),s!=null&&s.isHeaderContextMenuEnabled(r)&&s.showHeaderContextMenu(r,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",r)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:r}=this;e.isColumn?r.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):r.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},pP=class extends ES{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,r,n,s){this.comp=e;const{rowCtrl:i,column:o,beans:a}=this,{colResize:l,context:c,colHover:u,rangeSvc:h}=a,d=Kh(this,c,s);this.setGui(t,d),this.updateState(),this.setupWidth(d),this.setupMovingCss(d),this.setupMenuClass(d),this.setupSortableClass(d),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:p=>this.setRefreshFunction("measuring",p),compBean:d}),this.addColumnHoverListener(d),this.setupFilterClass(d),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(d),this.setupSelectAll(d),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=d.createManagedBean(l.createResizeFeature(i.pinned,o,r,e,this)):Yt(r,!1),u==null||u.createHoverFeature(d,[o],t),h==null||h.createRangeHighlightFeature(d,o,e),d.createManagedBean(new kS(o,t,a)),d.createManagedBean(new Qh(t,{shouldStopEventPropagation:p=>this.shouldStopEventPropagation(p),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(d),d.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),d.addManagedListeners(o,{colDefChanged:()=>this.refresh()}),d.addManagedListeners(o,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const f=()=>this.checkDisplayName();d.addManagedEventListeners({columnValueChanged:f,columnRowGroupChanged:f,columnPivotChanged:f,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),d.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){var r;(r=this.beans.colResize)==null||r.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return ot(t.gos,{colDef:r,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return hD(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:r,gos:n}=this.beans;return ot(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!(e!=null&&e.isHeaderFilterButtonEnabled(this.column)),enableFilterIcon:!!r&&(!this.openFilterEnabled||Zu(this.gos)),showColumnMenu:(i,o)=>{e==null||e.showColumnMenu({column:this.column,buttonElement:i,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(i,o)=>{e==null||e.showColumnMenu({column:this.column,mouseEvent:i,positionBy:"mouse",onClosedCallback:o})},showFilter:i=>{e==null||e.showFilterMenu({column:this.column,buttonElement:i,containerType:"columnFilter",positionBy:"button"})},progressSort:i=>{t==null||t.progressSort(this.column,!!i,"uiColumnSorted")},setSort:(i,o)=>{t==null||t.setSortForColumn(this.column,i,!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(i,o)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(i,o)}})}setupSelectAll(e){var r;const{selectionSvc:t}=this.beans;!t||(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),(r=this.selectAllFeature)==null||r.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{var s;const n=t.createSelectAllFeature(this.column);n&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(n),(s=this.selectAllFeature)==null||s.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!n&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){var e;return(e=this.selectAllFeature)==null?void 0:e.getCheckboxGui()}handleKeyDown(e){var t;super.handleKeyDown(e),e.key===ve.SPACE&&((t=this.selectAllFeature)==null||t.onSpaceKeyDown(e)),e.key===ve.ENTER&&this.onEnterKeyDown(e),e.key===ve.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){var t;e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&((t=this.beans.sortSvc)==null||t.progressSort(this.column,e.shiftKey,"uiColumnSorted"))}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();!Yv(r)||r.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),PD()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),r=CS(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(r);for(const s of r)n.has(s)?n.delete(s):this.comp.toggleCss(s,!0);for(const s of n)this.comp.toggleCss(s,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){var t,r;this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=(r=(t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))!=null?r:null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!(e!=null&&e.isColumnMenuInHeaderEnabled(this.column)),this.openFilterEnabled=!!(e!=null&&e.isFilterMenuInHeaderEnabled(this.column)),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(const e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const r=this.column.getActualWidth();this.comp.setWidth(`${r}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{var r;(r=this.comp)==null||r.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const r=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",r),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,r=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){var d,f;const{eGui:e,column:t,comp:r,beans:n}=this,s=cp(this.beans),i=s.reduce((p,g)=>p+g,0)===0;if(r.toggleCss("ag-header-parent-hidden",i),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),r.toggleCss("ag-header-span-height",!1),r.toggleCss("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();r.toggleCss("ag-header-span-height",o>0);const l=up(n);if(o===0){r.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}r.toggleCss("ag-header-span-total",a);const c=((f=(d=this.column.getFirstRealParent())==null?void 0:d.getLevel())!=null?f:-1)+1,u=s.length-c;let h=0;for(let p=0;p<u;p++)h+=s[s.length-1-p];e.style.setProperty("top",`${-h}px`),e.style.setProperty("height",`${l+h}px`)}refreshAriaSort(){var e;if(this.sortable){const t=this.getLocaleTextFunc(),r=((e=this.beans.sortSvc)==null?void 0:e.getDisplaySortForColumn(this.column))||null;this.comp.setAriaSort(gR(r)),this.setAriaDescriptionProperty("sort",t("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Zu(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){var t;if(!this.eGui.contains(xr(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((r,n)=>r==="filter"?-1:n.charCodeAt(0)-r.charCodeAt(0)).map(r=>this.ariaDescriptionProperties.get(r)).join(". ");(t=this.beans.ariaAnnounce)==null||t.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){var t;(t=this.beans.colHover)==null||t.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=s=>this.handleMouseOverChange(s.type==="mouseenter"),r=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=s=>this.handleContextMenuMouseEvent(s,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return Yv(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function Yv(e){return typeof(e==null?void 0:e.getAnchorElementForMenu)=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var mP=0,qd=class extends we{constructor(e,t,r){super(),this.rowIndex=e,this.pinned=t,this.type=r,this.instanceId=mP++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";r==="group"?n="ag-header-row-group":r==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){var t;this.rowIndex=e,(t=this.comp)==null||t.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=Fr(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,r=!0){this.comp=e,t=Kh(this,this.beans.context,t),r&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),r=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:r,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",r),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=Fr(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0;const t=cp(this.beans);for(let s=0;s<t.length;s++){if(s===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[s]};e+=t[s]}const r=up(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:r};e+=r;const n=yS(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;const t=this.getUpdatedHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);const r=n=>{const{focusSvc:s,visibleCols:i}=this.beans;return s.isHeaderWrapperFocused(n)?i.isVisible(n.column):!1};if(e)for(const[n,s]of e)r(s)?this.ctrlsById.set(n,s):this.destroyBean(s);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,r){if(e.isEmptyGroup())return;const n=e.getUniqueId();let s;if(r&&(s=r.get(n),r.delete(n)),s&&s.column!=e&&(this.destroyBean(s),s=void 0),s==null)switch(this.type){case"filter":{s=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":s=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:s=this.createBean(new pP(e,this));break}t.set(n,s)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];const e=[];for(const t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){const r=this.allCtrls.find(s=>s.column==e);return r?r.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},vP=class extends we{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:r,ctrlsSvc:n,colModel:s,colMoves:i}=this.beans;this.setupCenterWidth(),r==null||r.setupHeaderPinnedWidth(this),this.setupDragAndDrop(i,this.eViewport);const o=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:o,advancedFilterEnabledChanged:o});const a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),s.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,filterManager:r,visibleCols:n}=this.beans;let s=0;const i=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const h=n.headerGroupRowCount;s=h,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));const d=this.groupsRowCtrls.length;if(d!==h){if(d>h){for(let f=h;f<d;f++)this.destroyBean(this.groupsRowCtrls[f]);this.groupsRowCtrls.length=h;return}for(let f=d;f<h;f++){const p=this.createBean(new qd(f,this.pinned,"group"));this.groupsRowCtrls.push(p)}}},a=()=>{const h=s++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new qd(h,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==h&&this.columnsRowCtrl.setRowIndex(h)},l=()=>{this.includeFloatingFilter=!!(r!=null&&r.hasFloatingFilters())&&!this.hidden;const h=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){h();return}e||h();const d=s++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==d&&this.filtersRowCtrl.setRowIndex(d):this.filtersRowCtrl=this.createBean(new qd(d,this.pinned,"filter"))},c=this.getAllCtrls();o(),a(),l();const u=this.getAllCtrls();this.comp.setCtrls(u),this.restoreFocusOnHeader(t,i),c.length!==u.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){const t=r=>r==null?void 0:r.getHeaderCellCtrls().find(n=>n.column===e);if(Ni(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let r=0;r<this.groupsRowCtrls.length;r++){const n=t(this.groupsRowCtrls[r]);if(n)return n}}getHtmlElementForColumnHeader(e){var t,r;return(r=(t=this.getHeaderCtrlForColumn(e))==null?void 0:t.eGui)!=null?r:null}getRowType(e){var t;return(t=this.getAllCtrls()[e])==null?void 0:t.type}focusHeader(e,t,r){const s=this.getAllCtrls()[e];return s?s.focusHeader(t,r):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const r=e==null?void 0:e.createBodyDropTarget(this.pinned,t);r&&this.createManagedBean(r)}restoreFocusOnHeader(e,t){if(!t)return;const{column:r}=t;r.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new op(e=>this.comp.setCenterWidth(`${e}px`),!0))}},FS=class extends ws{constructor(){super()}},xP={tag:"span",cls:"ag-overlay-loading-center"},CP=class extends FS{init(){var t;const e=bi((t=this.gos.get("overlayLoadingTemplate"))==null?void 0:t.trim());if(this.setTemplate(e!=null?e:xP),!e){const n=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=n,this.beans.ariaAnnounce.announceValue(n,"overlay")}}},wP={tag:"span",cls:"ag-overlay-no-rows-center"},yP=class extends FS{init(){var t;const e=bi((t=this.gos.get("overlayNoRowsTemplate"))==null?void 0:t.trim());if(this.setTemplate(e!=null?e:wP),!e){const n=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=n,this.beans.ariaAnnounce.announceValue(n,"overlay")}}};function SP(e,t,r){const n=Jl(e,t,r);if(n){const{className:i}=n;if(typeof i=="string"&&i.includes("ag-icon")||typeof i=="object"&&i["ag-icon"])return n}const s=Yo({tag:"span"});return s.appendChild(n),s}function Jl(e,t,r){var i;let n=null;e==="smallDown"?Ge(262):e==="smallLeft"?Ge(263):e==="smallRight"&&Ge(264);const s=r==null?void 0:r.getColDef().icons;if(s&&(n=s[e]),t.gos&&!n){const o=t.gos.get("icons");o&&(n=o[e])}if(n){let o;if(typeof n=="function")o=n();else if(typeof n=="string")o=n;else{Ge(38,{iconName:e});return}if(typeof o=="string")return Kg(o);if(vy(o))return o;Ge(133,{iconName:e});return}else{const o=t.registry.getIcon(e);return o||(i=t.validation)==null||i.validateIcon(e),Yo({tag:"span",cls:`ag-icon ag-icon-${o!=null?o:e}`,role:"presentation",attrs:{unselectable:"on"}})}}var kP=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",bP={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},EP=class extends ws{constructor(){super(),this.dragSource=null,this.eIcon=qe,this.eLabel=qe,this.eGhost=qe,this.registerCSS(kP)}postConstruct(){const e=t=>SP(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(bP),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eGhost:r,eIcon:n,dragSource:s,dropIconMap:i,gos:o}=this;Ql(n);let a=null;e||(e=s!=null&&s.getDefaultIconName?s.getDefaultIconName():"notAllowed"),a=i[e],r.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===i.hide&&o.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},FP=".ag-checkbox-cell{height:100%}",TP={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},RP=class extends ws{constructor(){super(TP,[WD]),this.eCheckbox=qe,this.registerCSS(FP)}init(e){this.refresh(e);const{eCheckbox:t,beans:r}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),ly(n,"polite"),this.addManagedListeners(n,{click:s=>{if(sh(s),t.isDisabled())return;const i=t.getValue();this.onCheckboxChanged(i)},dblclick:s=>{sh(s)}}),this.addManagedElementListeners(e.eGridCell,{keydown:s=>{if(s.key===ve.SPACE&&!t.isDisabled()){e.eGridCell===xr(r)&&t.toggle();const i=t.getValue();this.onCheckboxChanged(i),s.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var h;let t,r=!0;const{value:n,column:s,node:i}=e;if(i.group&&s)if(typeof n=="boolean")t=n;else{const d=s.getColId();d.startsWith($h)?t=n==null||n===""?void 0:n==="true":i.aggData&&i.aggData[d]!==void 0||i.sourceRowIndex>=0?t=n!=null?n:void 0:r=!1}else t=n!=null?n:void 0;const{eCheckbox:o}=this;if(!r){o.setDisplayed(!1);return}o.setValue(t);const a=(h=e.disabled)!=null?h:!(s!=null&&s.isCellEditable(i));o.setDisabled(a);const l=this.getLocaleTextFunc(),c=FR(l,t),u=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;o.setInputAriaLabel(u)}onCheckboxChanged(e){var o,a,l,c;const{params:t}=this,{column:r,node:n,value:s}=t;(a=(o=this.beans)==null?void 0:o.editSvc)==null||a.setEditingCells([{column:r,colId:r.getColId(),rowIndex:n.rowIndex,rowPinned:n.rowPinned,state:"changed",oldValue:s,newValue:s}],{update:!0,forceRefreshOfEditCellsOnly:!0});const i=n.setDataValue(r,e,"renderer");(c=this.beans.editSvc)==null||c.stopEditing({rowNode:n,column:r},{source:(l=this.beans.editSvc)!=null&&l.isBatchEditing()?"ui":"api"}),i||this.updateCheckbox(t)}};function _P(e){return!!(e.rowPinned&&e.pinnedSibling)}var Jd={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},DP=class extends we{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:r,eBottomGuard:n,focusTrapActive:s,forceFocusOutWhenTabGuardsAreEmpty:i,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:h,handleKeyDown:d,isEmpty:f,eFocusableElement:p}=e;this.comp=t,this.eTopGuard=r,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=p,this.focusTrapActive=!!s,this.forceFocusOutWhenTabGuardsAreEmpty=!!i,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=d,this.providedIsEmpty=f}postConstruct(){this.createManagedBean(new Qh(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(const e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Lo(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){var l;const t=Ln(this.beans),r=Lo(t.body,null,!0),n=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let s,i;e?(s=0,i=n):(s=n+1,i=r.length);const o=r.slice(s,i),a=this.gos.get("tabIndex");o.sort((c,u)=>{const h=Number.parseInt(c.getAttribute("tabindex")||"0"),d=Number.parseInt(u.getAttribute("tabindex")||"0");return d===a?1:h===a?-1:h===0?1:d===0?-1:h-d}),(l=o[e?o.length-1:0])==null||l.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Lo(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return Xh(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t!=null?t:!0)}setAllowFocus(e){this.allowFocus=e}},AP=500,PP=550,Pc,IP=e=>{if(!Pc)Pc=new WeakSet;else if(Pc.has(e))return!1;return Pc.add(e),!0},so=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let r=this.eventSvc;if(!r){if(r===null)return;this.eventSvc=r=new Yl;const n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}r.addEventListener(e,t)}removeEventListener(e,t){var r;(r=this.eventSvc)==null||r.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!IP(e))return;const t=e.touches[0];this.touchStart=t;const r=this.handlers;if(!r.length){const n=this.eElement,s=n.ownerDocument,i=this.onTouchMove.bind(this),o=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};iu(r,[n,"touchmove",i,l],[s,"touchcancel",a,l],[s,"touchend",o,c],[s,"contextmenu",_s,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{var n;this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,(n=this.eventSvc)==null||n.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},PP)}onTouchMove(e){const{moved:t,touchStart:r}=this;if(!t&&r){const n=Ya(r,e.touches);n&&!wy(n,r,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){var r;const t=this.touchStart;!t||!Ya(t,e.changedTouches)||(this.moved||((r=this.eventSvc)==null||r.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&_s(e),this.cancel())}onTouchCancel(e){const t=this.touchStart;!t||!Ya(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){var n;let t=Date.now();const r=this.lastTapTime;r&&t-r>AP&&((n=this.eventSvc)==null||n.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),Xg(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){const e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}},TS=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${Ey}/${this.frameworkName}-data-grid`,t_(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function LP(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var MP=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],Qv=Object.fromEntries(MP.map((e,t)=>[e,t]));function OP(e,t){var s,i;const r=(s=e.beanName?Qv[e.beanName]:void 0)!=null?s:Number.MAX_SAFE_INTEGER,n=(i=t.beanName?Qv[t.beanName]:void 0)!=null?i:Number.MAX_SAFE_INTEGER;return r-n}function NP(e,t){return(e==null?void 0:e.beanName)==="gridDestroySvc"?-1:(t==null?void 0:t.beanName)==="gridDestroySvc"?1:0}var BP=class extends we{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getId());const{dragAndDrop:n,ctrlsSvc:s}=this.beans;n==null||n.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new ip(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const i=ia(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>i()),s.register("gridCtrl",this)}isDetailGrid(){var t;const e=ID(this.getGui());return((t=e==null?void 0:e.getAttribute("row-id"))==null?void 0:t.startsWith("detail"))||!1}getOptionalSelectors(){var t,r,n,s,i;const e=this.beans;return{paginationSelector:(t=e.pagination)==null?void 0:t.getPaginationSelector(),gridHeaderDropZonesSelector:(r=e.registry)==null?void 0:r.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:(n=e.sideBar)==null?void 0:n.getSelector(),statusBarSelector:(s=e.registry)==null?void 0:s.getSelector("AG-STATUS-BAR"),watermarkSelector:(i=e.licenseManager)==null?void 0:i.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){const{view:t}=this;if(e===!1)t.setCursor(null);else{const r=e===1?"ew-resize":"ns-resize";t.setCursor(r)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(r>0){const{visibleCols:s,focusSvc:i}=this.beans,o=s.allCols,a=ct(o);if(i.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t!=null&&t({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),{focusSvc:n,visibleCols:s}=this.beans,i=s.allCols;if(e){if(r.length>1)return this.focusContainer(ct(r),e);const o=ct(i);if(n.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||Fi(this.beans)){if(n.focusGridView({column:i[0],backwards:e}))return!0;for(let o=1;o<r.length;o++)if(rh(r[o].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){var i;const t=this.view.getFocusableContainers(),{nextIndex:r,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(n===-1||r<0||r>=t.length)return;const s=t[r];(i=s.setAllowFocus)==null||i.call(s,!0),setTimeout(()=>{var o;(o=s.setAllowFocus)==null||o.call(s,!1)})}isFocusable(){var t,r;const e=this.beans;return!lp(e)||!Fi(e)||!!((r=(t=e.sideBar)==null?void 0:t.comp)!=null&&r.isDisplayed())}getNextFocusableIndex(e,t){const r=xr(this.beans),n=e.findIndex(i=>i.getGui().contains(r)),s=n+(t?-1:1);return{indexWithFocus:n,nextIndex:s}}focusContainer(e,t){var n,s;(n=e.setAllowFocus)==null||n.call(e,!0);const r=rh(e.getGui(),t,!1,!0);return(s=e.setAllowFocus)==null||s.call(e,!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},Te=(e,t)=>{for(const r of Object.keys(t))t[r]=e;return t},Zv={dispatchEvent:"CommunityCore",...Te("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0}),...Te("GridState",{getState:0,setState:0}),...Te("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...Te("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...Te("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...Te("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...Te("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...Te("ValueCache",{expireValueCache:0}),...Te("CellApi",{getCellValue:0}),...Te("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...Te("Sort",{onSortChanged:0}),...Te("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0}),...Te("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...Te("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...Te("HighlightChanges",{flashCells:0}),...Te("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0}),...Te("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...Te("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...Te("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...Te("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...Te("ColumnResize",{setColumnWidths:0}),...Te("ColumnHover",{isColumnHovered:0}),...Te("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0}),...Te("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0}),...Te("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...Te("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...Te("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0}),...Te("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...Te("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...Te("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...Te("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0}),...Te("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...Te("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0}),...Te("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...Te("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...Te("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...Te("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...Te("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...Te("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...Te("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...Te("ContextMenu",{showContextMenu:0}),...Te("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...Te("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...Te("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...Te("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...Te("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...Te("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0}),...Te("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...Te("StatusBar",{getStatusPanel:0}),...Te("AiToolkit",{getStructuredSchema:0})},ef={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},HP=(e,t)=>e.eventSvc.dispatchEvent(t),RS=class{};Reflect.defineProperty(RS,"name",{value:"GridApi"});var WP=class extends we{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new RS,this.fns={...ef,dispatchEvent:HP},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(Zv))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){var s,i;const{fns:r,beans:n}=this;r!==ef&&(r[e]=(i=(s=n==null?void 0:n.validation)==null?void 0:s.validateApiFunction(e,t))!=null?i:t)}makeApi(e){return{[e]:(...t)=>{const{beans:r,fns:{[e]:n}}=this;return n?n(r,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:n}=this;if(!t)Ge(26,{fnName:e,preDestroyLink:n});else{const s=Zv[e];r.assertModuleRegistered(s,`api.${e}`)&&Ge(27,{fnName:e,module:s})}}destroy(){super.destroy(),this.fns=ef,this.beans=null}};function VP(e){return e.context.getId()}function GP(e){e.gridDestroySvc.destroy()}function zP(e){return e.gridDestroySvc.destroyCalled}function UP(e,t){return e.gos.get(t)}function jP(e,t,r){_S(e,{[t]:r})}function _S(e,t){e.gos.updateGridOptions({options:t})}function $P(e,t){const r=t.replace(/Module$/,"");return e.gos.isModuleRegistered(r)}var KP=class extends CA{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},XP=class extends we{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:r}=this.beans;return r.addDragSource(t),()=>r.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(r)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}};function YP(e,t){const r=e.column===t.column,n=e.rowPinned===t.rowPinned,s=e.rowIndex===t.rowIndex;return r&&n&&s}function QP(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(Be(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function ZP(e){let t=0,r;const{pinnedRowModel:n,rowModel:s,pageBounds:i}=e;return n!=null&&n.getPinnedTopRowCount()?r="top":s.getRowCount()?(r=null,t=i.getFirstRow()):n!=null&&n.getPinnedBottomRowCount()&&(r="bottom"),r===void 0?null:{rowIndex:t,rowPinned:r}}function qP(e){let t,r=null;const{pinnedRowModel:n,pageBounds:s}=e,i=n==null?void 0:n.getPinnedBottomRowCount(),o=n==null?void 0:n.getPinnedTopRowCount();return i?(r="bottom",t=i-1):e.rowModel.getRowCount()?t=s.getLastRow():o&&(r="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:r}}function DS(e,t){var r,n;switch(t.rowPinned){case"top":return(r=e.pinnedRowModel)==null?void 0:r.getPinnedTopRow(t.rowIndex);case"bottom":return(n=e.pinnedRowModel)==null?void 0:n.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Ic(e,t){var s;const r=(s=e.spannedRowRenderer)==null?void 0:s.getCellByPosition(t);if(r)return r;const n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function JP(e,t,r){const{rowModel:n,pinnedRowModel:s}=e;let i;return i!=null||(i=n==null?void 0:n.getRowNode(t)),r?i!=null||(i=s==null?void 0:s.getPinnedRowById(t,r)):(i!=null||(i=s==null?void 0:s.getPinnedRowById(t,"top")),i!=null||(i=s==null?void 0:s.getPinnedRowById(t,"bottom"))),i}function ah(e,t,r=!1){var l;const{rowIndex:n,rowPinned:s}=t,{pageBounds:i,pinnedRowModel:o,rowModel:a}=e;if(n===0)return s==="top"?null:s==="bottom"&&a.isRowsToRender()?{rowIndex:i.getLastRow(),rowPinned:null}:o!=null&&o.isRowsToRender("top")?{rowIndex:o.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(r){const c=s?void 0:a.getRow(n);return(l=AS(e,c,!0))!=null?l:{rowIndex:n-1,rowPinned:s}}return{rowIndex:n-1,rowPinned:s}}function qv(e,t,r=!1){var l;const{rowIndex:n,rowPinned:s}=t,{pageBounds:i,pinnedRowModel:o,rowModel:a}=e;if(eI(e,t))return s==="bottom"?null:s==="top"&&a.isRowsToRender()?{rowIndex:i.getFirstRow(),rowPinned:null}:o!=null&&o.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(r){const c=s?void 0:a.getRow(n);return(l=AS(e,c))!=null?l:{rowIndex:n+1,rowPinned:s}}return{rowIndex:n+1,rowPinned:s}}function AS(e,t,r=!1){const{gos:n,rowRenderer:s}=e;if(!(t!=null&&t.sticky)||!By(n))return;const i=s.getStickyTopRowCtrls(),o=s.getStickyBottomRowCtrls(),a=!o.some(h=>h.rowNode.rowIndex===t.rowIndex),l=a?i:o,c=(r?-1:1)*(a?-1:1);let u;for(let h=0;h<l.length;h++)if(l[h].rowNode.rowIndex===t.rowIndex){u=l[h+c];break}return u?{rowIndex:u.rowNode.rowIndex,rowPinned:null}:void 0}function eI(e,t){var a,l;const{rowPinned:r,rowIndex:n}=t,{pinnedRowModel:s,pageBounds:i}=e;return r==="top"?((a=s==null?void 0:s.getPinnedTopRowCount())!=null?a:0)-1<=n:r==="bottom"?((l=s==null?void 0:s.getPinnedBottomRowCount())!=null?l:0)-1<=n:i.getLastRow()<=n}var tI=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:r,children:n}=e;if(n)for(let s=0;s<n.length;++s)this.depthFirstSearchChangedPath(n[s],t);t(r)}depthFirstSearchEverything(e,t,r){const n=e.childrenAfterGroup;if(n)for(let s=0,i=n.length;s<i;++s){const o=n[s];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,r):r&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const n={rowNode:t,children:null};this.mapToItems[t.id]=n,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;){this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={});for(const n of t)this.nodeIdsToColumns[r.id][n.getId()]=!0;r=r.parent}}linkPathItems(e,t){let r=e;for(let n=0;n<t;n++){const s=this.mapToItems[r.id],i=this.mapToItems[r.parent.id];i.children||(i.children=[]),i.children.push(s),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>r[s.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(s=>!r[s.getId()])}},PS={moduleName:"Drag",version:ut,beans:[KP]},rI={moduleName:"SharedDragAndDrop",version:ut,beans:[yA],dependsOn:[PS],userComponents:{agDragAndDropImage:EP},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},nI={moduleName:"HorizontalResize",version:ut,beans:[XP],dependsOn:[PS]},sI=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",iI=class extends we{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){!this.active||this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:r,executeLaterFuncs:n}=this;if(r.length===0&&n.length===0){e(),t();return}const s=i=>{for(;i.length;){const o=i.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),s(r)},0),window.setTimeout(()=>{t(),s(n)},200)})}};function oI(e,t,r){var n;(n=e.colMoves)==null||n.moveColumnByIndex(t,r,"api")}function aI(e,t,r){var n;(n=e.colMoves)==null||n.moveColumns(t,r,"api")}var lI=class extends we{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;if(!!t)for(const r of t)!r.isPrimary()||r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:r,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&(t==null||t.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop")),this.columnsToGroup.length>0&&(r==null||r.addColumns(this.columnsToGroup,"toolPanelDragAndDrop")),this.columnsToPivot.length>0&&(n==null||n.addColumns(this.columnsToPivot,"toolPanelDragAndDrop"))}onDragCancel(){this.clearColumnsList()}};function cI(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,s)=>{const i=e.indexOf(n),o=e.indexOf(s);return i-o})}function uI(e){var r;const t=[...e];for(const n of e){let s=null,i=n.getParent();for(;i!=null&&i.getDisplayedLeafColumns().length===1;)s=i,i=i.getParent();if(s!=null){const a=!!((r=s.getColGroupDef())!=null&&r.marryChildren)?s.getProvidedColumnGroup().getLeafColumns():s.getLeafColumns();for(const l of a)t.includes(l)||t.push(l)}}return t}function hI(e,t,r,n){const s=n.allCols;let i=null,o=null;for(let a=0;a<e.length;a++){const l=e[a],c=r.getProposedColumnOrder(t,l);if(!r.doesOrderPassRules(c))continue;const u=c.filter(d=>s.includes(d));if(o===null)o=u;else if(!jh(u,o))break;const h=fI(c);(i===null||h<i.fragCount)&&(i={move:l,fragCount:h})}return i}function IS(e){const{isFromHeader:t,fromLeft:r,xPosition:n,fromEnter:s,fakeEvent:i,pinned:o,gos:a,colModel:l,colMoves:c,visibleCols:u}=e;let{allMovingColumns:h}=e;t&&(h=uI(h));const d=h.slice();cI(l.getCols(),d);const f=pI({movingCols:d,draggingRight:r,xPosition:n,pinned:o,gos:a,colModel:l,visibleCols:u}),p=dI(d,l);if(f.length===0)return;const g=f[0];if(p!==null&&(t||!s)&&!i&&(!r&&g>=p||r&&g<=p))return;const v=hI(f,d,c,u);if(!v)return;const C=v.move;if(!(C>l.getCols().length-d.length))return{columns:d,toIndex:C}}function LS(e){const{columns:t,toIndex:r}=IS(e)||{},{finished:n,colMoves:s}=e;return!t||r==null?null:(s.moveColumns(t,r,"uiColumnMoved",n),n?null:{columns:t,toIndex:r})}function dI(e,t){const r=t.getCols(),n=e.map(l=>r.indexOf(l)).sort((l,c)=>l-c),s=n[0];return ct(n)-s!==n.length-1?null:s}function fI(e){function t(n){const s=[];let i=n.getOriginalParent();for(;i!=null;)s.push(i),i=i.getOriginalParent();return s}let r=0;for(let n=0;n<e.length-1;n++){let s=t(e[n]),i=t(e[n+1]);[s,i]=s.length>i.length?[s,i]:[i,s];for(const o of s)i.indexOf(o)===-1&&r++}return r}function gI(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function pI(e){const{movingCols:t,draggingRight:r,xPosition:n,pinned:s,gos:i,colModel:o,visibleCols:a}=e;if(i.get("suppressMovableColumns")||t.some(x=>x.getColDef().suppressMovable))return[];const c=gI(a,s),u=o.getCols(),h=c.filter(x=>t.includes(x)),d=c.filter(x=>!t.includes(x)),f=u.filter(x=>!t.includes(x));let p=0,g=n;if(r){let x=0;for(const w of h)x+=w.getActualWidth();g-=x}if(g>0){for(let x=0;x<d.length;x++){const w=d[x];if(g-=w.getActualWidth(),g<0)break;p++}r&&p++}let m;if(p>0){const x=d[p-1];m=f.indexOf(x)+1}else m=f.indexOf(d[0]),m===-1&&(m=0);const v=[m],C=(x,w)=>x-w;if(r){let x=m+1;const w=u.length-1;for(;x<=w;)v.push(x),x++;v.sort(C)}else{let x=m;const w=u.length-1;let k=u[x];for(;x<=w&&c.indexOf(k)<0;)x++,v.push(x),k=u[x];x=m-1;const E=0;for(;x>=E;)v.push(x),x--;v.sort(C).reverse()}return v}function P0(e){var c;const{pinned:t,fromKeyboard:r,gos:n,ctrlsSvc:s,useHeaderRow:i,skipScrollPadding:o}=e;let a=(c=s.getHeaderRowContainerCtrl(t))==null?void 0:c.eViewport,{x:l}=e;return a?(r&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(i&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!o&&(l+=s.get("center").getCenterViewportScrollLeft()),l):0}function tf(e,t){for(const r of e)r.moving=t,r.dispatchColEvent("movingChanged","uiColumnMoved")}var Jv=7,I0=100,Lc=I0/2,mI=5,vI=100,xI=class extends we{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!Be(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){var s;const{pinned:e,lastDraggingEvent:t}=this,{dragItem:r}=t||{},n=(s=r==null?void 0:r.columns)!=null?s:[];for(const i of n){const o=i.getPinned();if(i.getColDef().lockPinned){if(o==e)return"move";continue}const a=r==null?void 0:r.containerType;if(a===e||!e)return"move";if(e&&(!o||a!==e))return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,r=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(r,!0,"uiColumnDragged");else{const s=t.visibleState,i=(r||[]).filter(o=>s[o.getId()]&&!o.isVisible());this.setColumnsVisible(i,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(r,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,n=!1){const{gos:s,ctrlsSvc:i}=this.beans,o=s.get("suppressMoveWhenColumnDragging");if(n&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&Jt(e.hDirection))return;const a=P0({x:e.x,pinned:this.pinned,gos:s,ctrlsSvc:i});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,r,a,n):this.handleColumnDragWhileAllowingMovement(e,t,r,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!(e!=null&&e.length))return;const n=e.filter(s=>!s.getColDef().lockVisible);!n.length||this.beans.colModel.setColsVisible(n,t,r)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:r}=e;this.beans.colMoves.moveColumns(t,r,"uiColumnMoved",!0)}updateDragItemContainerType(){const{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;const t=e.dragItem;!t||(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,r,n,s){const i=this.getAllMovingColumns(e,!0);if(s){const o=this.isAttemptingToPin(i);o&&this.attemptToPinColumns(i,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(i,o)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:i,xPosition:l,fromEnter:t,fakeEvent:r,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(i,n)}}handleColumnDragWhileAllowingMovement(e,t,r,n,s){const i=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:i,isFromHeader:a,xPosition:n,fromLeft:o,fromEnter:t,fakeEvent:r}),c=LS({...l,finished:s});c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){const r=e.dragSource.getDragItem();let n=null;t?(n=r.columnsInSplit,n||(n=r.columns)):n=r.columns;const s=i=>i.getColDef().lockPinned?i.getPinned()==this.pinned:!0;return n?n.filter(s):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:n,fromLeft:s,fromEnter:i,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:c,visibleCols:u}=this.beans;return{allMovingColumns:t,isFromHeader:r,fromLeft:s,xPosition:n,pinned:this.pinned,fromEnter:i,fakeEvent:o,gos:a,colModel:l,colMoves:c,visibleCols:u}}highlightHoveredColumn(e,t){var u;const{gos:r,colModel:n}=this.beans,s=r.get("enableRtl"),i=n.getCols().filter(h=>h.isVisible()&&h.getPinned()===this.pinned);let o=null,a=null,l=null;for(const h of i){if(a=h.getActualWidth(),o=this.getNormalisedColumnLeft(h,0,s),o!=null){const d=o+a;if(o<=t&&d>=t){l=h;break}}o=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let h=i.length-1;h>=0;h--){const d=i[h],f=i[h].getParent();if(!f){l=d;break}const p=f==null?void 0:f.getDisplayedLeafColumns();if(p.length){l=ct(p);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,s),a=l.getActualWidth()}if(((u=this.lastHighlightedColumn)==null?void 0:u.column)!==l&&this.clearHighlighted(),l==null||o==null||a==null)return;let c;t-o<a/2!==s?c=0:c=1,e1(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){const{gos:r,visibleCols:n}=this.beans,s=r.get("enableRtl"),{firstMovingCol:i,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,s);if(!i||!o||a==null)return;const l=n.allCols,c=l.indexOf(i),u=l.indexOf(o),h=a===0!==s,d=c<u||c===u&&!h;let f=0;if(h?d&&(f-=1):d||(f+=1),u+f===c)return;const p=l[u+f];if(!p)return;const g=this.getNormalisedColumnLeft(p,20,s);return{fromLeft:d,xPosition:g}}getColumnMoveAndTargetInfo(e,t,r){const n=this.lastHighlightedColumn||{},{firstMovingCol:s,lastMovingCol:i}=CI(e);if(!s||!i||n.column||!t)return{firstMovingCol:s,...n};const a=this.getPinDirection()==="left";return{firstMovingCol:s,position:a?1:0,column:a!==r?s:i}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,r){const{gos:n,ctrlsSvc:s}=this.beans,i=e.getLeft();if(i==null)return null;const o=e.getActualWidth();return P0({x:r?i+o-t:i+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:n,ctrlsSvc:s})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,r=this.failedMoveAttempts>Jv;return t&&r||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:n,fakeEvent:s,fromLeft:i}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:i,fromEnter:n,fakeEvent:s}),{columns:a,toIndex:l}=IS(o)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;!e||(e1(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),r=t.getCenterViewportScrollLeft(),n=r+t.getCenterWidth();let s,i;this.gos.get("enableRtl")?(s=e<r+Lc,i=e>n-Lc):(i=e<r+Lc,s=e>n-Lc),this.needToMoveRight=s,this.needToMoveLeft=i,i||s?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),vI),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){!this.movingIntervalId||(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){var n;let e;this.intervalCount++,e=10+this.intervalCount*mI,e>I0&&(e=I0);let t=null;const r=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:s,dragAndDrop:i,gos:o}=this.beans;if(this.failedMoveAttempts<=Jv+1||!s)return;if(i.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){const a=(n=this.lastDraggingEvent)==null?void 0:n.dragItem.columns;this.attemptToPinColumns(a,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,r=!1){const n=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!n.length)return 0;r&&(t=this.getPinDirection());const{pinnedCols:s,dragAndDrop:i}=this.beans;return s==null||s.setColsPinned(n,t,"uiColumnDragged"),r&&i.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function e1(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function CI(e){const t=e.length;let r,n;for(let s=0;s<t;s++){if(!r){const i=e[s];i.getLeft()!=null&&(r=i)}if(!n){const i=e[t-1-s];i.getLeft()!=null&&(n=i)}if(r&&n)break}return{firstMovingCol:r,lastMovingCol:n}}var wI=class extends we{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,r=this.pinned;e.whenReady(this,n=>{let s;const i=n.gridBodyCtrl.eBodyViewport;switch(r){case"left":s=[[i,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":s=[[i,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:s=[[i,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=s}),this.moveColumnFeature=this.createManagedBean(new xI(r)),this.bodyDropPivotTarget=this.createManagedBean(new lI(r)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},yI=class extends we{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,r){const n=this.beans.colModel.getCols();if(!n)return;const s=n[e];this.moveColumns([s],t,r)}moveColumns(e,t,r,n=!0){const{colModel:s,colAnimation:i,visibleCols:o,eventSvc:a}=this.beans,l=s.getCols();if(!l)return;if(t>l.length-e.length){Ge(30,{toIndex:t});return}i==null||i.start();const c=s.getColsForKeys(e);this.doesMovePassRules(c,t)&&(Pv(s.getCols(),c,t),o.refresh(r),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:n,source:r})),i==null||i.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){const{colModel:t,gos:r}=this.beans;return!(!Uy(e,t.getColTree())||!(s=>{const i=c=>c?c==="left"||c===!0?-1:1:0,o=r.get("enableRtl");let a=o?1:-1,l=!0;for(const c of s){const u=i(c.getColDef().lockPosition);o?u>a&&(l=!1):u<a&&(l=!1),a=u}return l})(e))}getProposedColumnOrder(e,t){const n=this.beans.colModel.getCols().slice();return Pv(n,e,t),n}createBodyDropTarget(e,t){return new wI(e,t)}moveHeader(e,t,r,n,s){const{ctrlsSvc:i,gos:o,colModel:a,visibleCols:l,focusSvc:c}=this.beans,u=t.getBoundingClientRect(),h=u.left,d=Bt(r),f=d?u.width:r.getActualWidth(),p=e==="left"!==o.get("enableRtl"),g=P0({x:p?h-20:h+f+20,pinned:n,fromKeyboard:!0,gos:o,ctrlsSvc:i}),m=c.focusedHeader;LS({allMovingColumns:d?r.getLeafColumns():[r],isFromHeader:!0,fromLeft:e==="right",xPosition:g,pinned:n,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0});let v;if(d){const C=r.getDisplayedLeafColumns();v=p?C[0]:ct(C)}else v=r;if(i.getScrollFeature().ensureColumnVisible(v,"auto"),(!s.isAlive()||o.get("ensureDomOrder"))&&m){let C;if(d){const x=r.getGroupId(),w=r.getLeafColumns();if(!w.length)return;const k=w[0].getParent();if(!k)return;C=SI(k,x)}else C=r;C&&c.focusHeaderPosition({headerPosition:{...m,column:C}})}}setDragSourceForHeader(e,t,r){const{gos:n,colModel:s,dragAndDrop:i,visibleCols:o}=this.beans;let a=!n.get("suppressDragLeaveHidesColumns");const l=Bt(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],h={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>bI(t,o.allCols):()=>kI(t),dragItemName:r,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),tf(c,!0)},onDragStopped:()=>tf(c,!1),onDragCancelled:()=>tf(c,!1),onGridEnter:d=>{if(a){const{columns:f=[],visibleState:p}=d!=null?d:{},g=l?v=>!p||p[v.getColId()]:()=>!0,m=f.filter(v=>!v.getColDef().lockVisible&&g(v));s.setColsVisible(m,!0,"uiColumnMoved")}},onGridExit:d=>{var f;if(a){const p=((f=d==null?void 0:d.columns)==null?void 0:f.filter(g=>!g.getColDef().lockVisible))||[];s.setColsVisible(p,!1,"uiColumnMoved")}}};return i.addDragSource(h,!0),h}};function SI(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function kI(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function bI(e,t){var a;const r=e.getProvidedColumnGroup().getLeafColumns(),n={};for(const l of r)n[l.getId()]=l.isVisible();const s=[];for(const l of t)r.indexOf(l)>=0&&(s.push(l),Bi(r,l));for(const l of r)s.push(l);const i=[],o=e.getLeafColumns();for(const l of s)o.indexOf(l)!==-1&&i.push(l);return{columns:s,columnsInSplit:i,visibleState:n,containerType:(a=i[0])==null?void 0:a.pinned}}var EI={moduleName:"ColumnMove",version:ut,beans:[yI,iI],apiFunctions:{moveColumnByIndex:oI,moveColumns:aI},dependsOn:[rI],css:[sI]},FI=class extends we{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(r),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const r=document.createElement("form");r.style.position="fixed";const n=this.centerRowContainerCtrl.eContainer;for(const i of e)this.cloneItemIntoDummy(i,r);n.appendChild(r);const s=r.offsetWidth;return r.remove(),t=t!=null?t:this.gos.get("autoSizePadding"),s+t}getHeaderCellForColumn(e){let t=null;for(const r of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){const n=r.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const n=document.createElement("div"),s=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(s.add("ag-header","ag-header-row"),n.style.position="static"):s.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const c=o.classList[l];c!="ag-row-position-absolute"&&s.add(c)}break}o=o.parentElement}n.appendChild(r),t.appendChild(n)}},TI={moduleName:"AutoWidth",version:ut,beans:[FI]};function RI(e,t,r=!0,n="api"){var s;(s=e.colResize)==null||s.setColumnWidths(t,!1,r,n)}var _I=class extends we{constructor(e,t,r,n){super(),this.comp=e,this.eResize=t,this.pinned=r,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:r}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&r&&this.addDestroyFunc(r.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:n,groupAfterColumns:s,groupAfterStartWidth:i,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=n,this.resizeTakeFromCols=s,this.resizeTakeFromStartWidth=i,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const n=this.normaliseDragChange(t),s=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(s,r,e)}getInitialValues(e){var l,c;const t=u=>u.reduce((h,d)=>h+d.getActualWidth(),0),r=(u,h)=>u.map(d=>d.getActualWidth()/h),n=this.getColumnsToResize(),s=t(n),i=r(n,s),o={columnsToResize:n,resizeStartWidth:s,resizeRatios:i};let a=null;if(e&&(a=(c=(l=this.beans.colGroupSvc)==null?void 0:l.getGroupAtDirection(this.columnGroup,"After"))!=null?c:null),a){const u=a.getDisplayedLeafColumns(),h=o.groupAfterColumns=u.filter(f=>f.isResizable()),d=o.groupAfterStartWidth=t(h);o.groupAfterRatios=r(h,d)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){if(!this.resizeCols||!this.resizeRatios)return;const n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,r)}resizeColumns(e,t,r,n=!0){var h;const{columnsToResize:s,resizeStartWidth:i,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:s,ratios:o,width:t}),a){const d=t-i;u.push({columns:a,ratios:c,width:l-d})}(h=this.beans.colResize)==null||h.resizeColumnSets({resizeSets:u,finished:n,source:r}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},DI=class extends we{constructor(e,t,r,n,s){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=n,this.ctrl=s}postConstruct(){const e=[];let t,r;const n=()=>{if(Yt(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,l=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),r&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},s=()=>{for(const o of e)o();e.length=0},i=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,s(),n())};i(),this.addDestroyFunc(s),this.ctrl.setRefreshFunction("resize",i)}onResizing(e,t){var d,f;const{column:r,lastResizeAmount:n,resizeStartWidth:s,beans:i}=this,o=this.normaliseResizeAmount(t),a=s+o,l=[{key:r,newWidth:a}],{pinnedCols:c,ctrlsSvc:u,colResize:h}=i;if(this.column.getPinned()){const p=(d=c==null?void 0:c.leftWidth)!=null?d:0,g=(f=c==null?void 0:c.rightWidth)!=null?f:0,m=$u(u.getGridBodyCtrl().eBodyViewport)-50;if(p+g+(o-n)>m)return}this.lastResizeAmount=o,h==null||h.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?r&&(t*=-1):n&&(t*=-1),t}},AI=class extends we{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,r,n){const s=[],{colModel:i,gos:o,visibleCols:a}=this.beans;for(const l of e){const c=i.getColDefCol(l.key)||i.getCol(l.key);if(!c)continue;if(s.push({width:l.newWidth,ratios:[1],columns:[c]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const h=a.getColAfter(c);if(!h)continue;const d=c.getActualWidth()-l.newWidth,f=h.getActualWidth()+d;s.push({width:f,ratios:[1],columns:[h]})}}s.length!==0&&this.resizeColumnSets({resizeSets:s,finished:r,source:n})}resizeColumnSets(e){var u;const{resizeSets:t,finished:r,source:n}=e;if(!(!t||t.every(h=>PI(h)))){if(r){const h=t&&t.length>0?t[0].columns:null;Ju(this.eventSvc,h,r,n)}return}const i=[],o=[];for(const h of t){const{width:d,columns:f,ratios:p}=h,g={},m={};for(const x of f)o.push(x);let v=!0,C=0;for(;v;){if(C++,C>1e3){gn(31);break}v=!1;const x=[];let w=0,k=d;f.forEach((y,R)=>{if(m[y.getId()])k-=g[y.getId()];else{x.push(y);const N=p[R];w+=N}});const E=1/w;x.forEach((y,R)=>{const D=R===x.length-1;let N;D?N=k:(N=Math.round(p[R]*d*E),k-=N);const O=y.getMinWidth(),A=y.getMaxWidth();N<O?(N=O,m[y.getId()]=!0,v=!0):A>0&&N>A&&(N=A,m[y.getId()]=!0,v=!0),g[y.getId()]=N})}for(const x of f){const w=g[x.getId()];x.getActualWidth()!==w&&(x.setActualWidth(w,n),i.push(x))}}const a=i.length>0;let l=[];if(a){const{colFlex:h,visibleCols:d,colViewport:f}=this.beans;l=(u=h==null?void 0:h.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}))!=null?u:[],d.setLeftValues(n),d.updateBodyWidths(),f.checkViewportColumns()}const c=o.concat(l);(a||r)&&Ju(this.eventSvc,c,r,n,l)}resizeHeader(e,t,r){if(!e.isResizable())return;const n=e.getActualWidth(),s=e.getMinWidth(),i=e.getMaxWidth(),o=Math.min(Math.max(n+t,s),i);this.setColumnWidths([{key:e,newWidth:o}],r,!0,"uiColumnResized")}createResizeFeature(e,t,r,n,s){return new DI(e,t,r,n,s)}createGroupResizeFeature(e,t,r,n){return new _I(e,t,r,n)}};function PI(e){const{columns:t,width:r}=e;let n=0,s=0,i=!0;for(const l of t){const c=l.getMinWidth();n+=c||0;const u=l.getMaxWidth();u>0?s+=u:i=!1}const o=r>=n,a=!i||r<=s;return o&&a}var II={moduleName:"ColumnResize",version:ut,beans:[AI],apiFunctions:{setColumnWidths:RI},dependsOn:[nI,TI]},LI=class extends we{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);for(const t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(const e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},MI=class extends ES{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,r,n,s){const{column:i,beans:o}=this,{context:a,colNames:l,colHover:c,rangeSvc:u,colResize:h}=o;this.comp=e,s=Kh(this,a,s),this.setGui(t,s),this.displayName=l.getDisplayNameForColumnGroup(i,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(s),this.setupExpandable(s),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:s}),this.setupUserComp(),this.addHeaderMouseListeners(s),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const d=this.rowCtrl.pinned,f=i.getProvidedColumnGroup().getLeafColumns();c==null||c.createHoverFeature(s,f,t),u==null||u.createRangeHighlightFeature(s,i,e),s.createManagedBean(new kS(i,t,o)),s.createManagedBean(new LI(e,i)),h?this.resizeFeature=s.createManagedBean(h.createGroupResizeFeature(e,r,d,i)):e.setResizableDisplayed(!1),s.createManagedBean(new Qh(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(s,f),s.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(s),s.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.getDefinition();return ot(t.gos,{colDef:r,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,r=e.get("groupHeaderHeight");r!=null?r===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(r):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(!!this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,n=ct(t)===e;if(!r&&!n)return;const s=e.getHighlighted(),i=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let o=!1,a=!1;if(i){const l=this.beans.gos.get("enableRtl"),c=s===1,u=s===0;r&&(l?a=c:o=u),n&&(l?o=u:a=c)}this.comp.toggleCss("ag-header-highlight-before",o),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:r}=this;if(!r)return;const n=r.getInitialValues(t);r.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){var t;(t=this.resizeFeature)==null||t.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:r,enterpriseMenuFactory:n}=this.beans,s=this.column,i=s.getProvidedColumnGroup(),o=ot(r,{displayName:this.displayName,columnGroup:s,setExpanded:l=>{e.setColumnGroupOpened(i,l,"gridInitializing")},setTooltip:(l,c)=>{r.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>n==null?void 0:n.showMenuAfterButtonClick(i,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>n==null?void 0:n.showMenuAfterMouseEvent(i,l,"columnMenu",c),eGridHeader:this.eGui}),a=fD(t,o);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e){const t=s=>this.handleMouseOverChange(s.type==="mouseenter"),r=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),n=s=>this.handleContextMenuMouseEvent(s,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:n})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),r=CS(t,this.gos,null,e);e.isPadding()?(r.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(s=>s.isSpanHeaderHeight())&&r.push("ag-header-span-height")):(r.push("ag-header-group-cell-with-group"),t!=null&&t.wrapHeaderText&&r.push("ag-header-cell-wrap-text"));for(const n of r)this.comp.toggleCss(n,!0)}setupMovingCss(e){const{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),s=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(const i of n)e.addManagedListeners(i,{movingChanged:s});s()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===ve.ENTER){const r=this.column,n=!r.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),n,"uiColumnExpanded")}}setDragSource(e){var t,r;!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=(r=(t=this.beans.colMoves)==null?void 0:t.setDragSourceForHeader(e,this.column,this.displayName))!=null?r:null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function OI(e,t,r){var n;(n=e.colGroupSvc)==null||n.setColumnGroupOpened(t,r,"api")}function NI(e,t,r){var n,s;return(s=(n=e.colGroupSvc)==null?void 0:n.getColumnGroup(t,r))!=null?s:null}function BI(e,t){var r,n;return(n=(r=e.colGroupSvc)==null?void 0:r.getProvidedColGroup(t))!=null?n:null}function HI(e,t,r){return e.colNames.getDisplayNameForColumnGroup(t,r)||""}function WI(e){var t,r;return(r=(t=e.colGroupSvc)==null?void 0:t.getColumnGroupState())!=null?r:[]}function VI(e,t){var r;(r=e.colGroupSvc)==null||r.setColumnGroupState(t,"api")}function GI(e){var t;(t=e.colGroupSvc)==null||t.resetColumnGroupState("api")}function zI(e){return e.visibleCols.treeLeft}function UI(e){return e.visibleCols.treeCenter}function jI(e){return e.visibleCols.treeRight}function $I(e){return e.visibleCols.getAllTrees()}function KI(e,t){for(let r=0;r<t.length;r++){const n=e.indexOf(t[r]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var XI=class extends we{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colFlex:r,colModel:n,colGroupSvc:s,colViewport:i,selectionColSvc:o}=this.beans;t||this.buildTrees(n,s),s==null||s.updateOpenClosedVisibility(),this.leftCols=rf(this.treeLeft),this.centerCols=rf(this.treeCenter),this.rightCols=rf(this.treeRight),o==null||o.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),r==null||r.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),i.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(const t of this.allCols){let r=t.getParent();for(;r;){if(!r.isPadding()){const n=r.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}r=r.getParent()}}return e}updateBodyWidths(){const e=no(this.centerCols),t=no(this.leftCols),r=no(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,r,n){let s,i;this.gos.get("enableRtl")?(s=t?t[0]:null,i=r?ct(r):null):(s=t?ct(t):null,i=r?r[0]:null);for(const o of e.getCols())o.setLastLeftPinned(o===s,n),o.setFirstRightPinned(o===i,n)}buildTrees(e,t){const r=e.getColsToShow(),n=r.filter(l=>l.getPinned()=="left"),s=r.filter(l=>l.getPinned()=="right"),i=r.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),o=new $_,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:s,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:i,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),r=[],n=[],s=[];for(const i of t){const o=i.getPinned();o?o===!0||o==="left"?r.push(i):s.push(i):n.push(i)}this.ariaOrderColumns=r.concat(n).concat(s)}getAriaColIndex(e){let t;return Bt(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(const e of[this.treeLeft,this.treeRight,this.treeCenter])for(const t of e)Bt(t)&&t.checkLeft()}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const n=t.getCols().slice(0),s=this.gos.get("enableRtl");for(const i of[this.leftCols,this.rightCols,this.centerCols]){if(s){let o=no(i);for(const a of i)o-=a.getActualWidth(),a.setLeft(o,e)}else{let o=0;for(const a of i)a.setLeft(o,e),o+=a.getActualWidth()}KI(n,i)}for(const i of n)i.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,r,n){const s=[];let i=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const d=c-1;for(let f=1;f<=d;f++)u.push(t[o+f]);o+=d}let h;if(r){h=!1;for(const d of u)r(d)&&(h=!0)}else h=!0;h&&(s.length===0&&i&&(n?n(a):!1)&&s.push(i),s.push(a)),i=a}return s}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,r=t.indexOf(e);return r>0?t[r-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};Ti(this.treeCenter,!1,e),Ti(this.treeLeft,!1,e),Ti(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const n=this[t[r]];if(n.length)return e?ct(n):n[0]}return null}getColAfter(e){const t=this.allCols,r=t.indexOf(e);return r<t.length-1?t[r+1]:null}getColsLeftWidth(){return no(this.leftCols)}getDisplayedColumnsRightWidth(){return no(this.rightCols)}isColAtEdge(e,t){const r=this.allCols;if(!r.length)return!1;const n=t==="first";let s;if(Bt(e)){const i=e.getDisplayedLeafColumns();if(!i.length)return!1;s=n?i[0]:ct(i)}else s=e;return(n?r[0]:ct(r))===s}};function Ti(e,t,r){if(!!e)for(let n=0;n<e.length;n++){const s=e[n];if(Bt(s)){const i=t?s.getDisplayedChildren():s.getChildren();Ti(i,t,r)}r(s)}}function rf(e){const t=[];return Ti(e,!0,r=>{Ni(r)&&t.push(r)}),t}var YI=class extends we{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return us(null,t,r=>{ur(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const r=[];us(null,t,n=>{if(ur(n)){const s=n.getColGroupDef(),i={groupId:n.getGroupId(),open:s?s.openByDefault:void 0};r.push(i)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){const{colModel:r,colAnimation:n,visibleCols:s,eventSvc:i}=this.beans;if(!r.getColTree().length)return;n==null||n.start();const a=[];for(const l of e){const c=l.groupId,u=l.open,h=this.getProvidedColGroup(c);!h||h.isExpanded()!==u&&(h.setExpanded(u),a.push(h))}s.refresh(t,!0),a.length&&i.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n==null||n.finish()}setColumnGroupOpened(e,t,r){let n;ur(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],r)}getProvidedColGroup(e){let t=null;return us(null,this.beans.colModel.getColTree(),r=>{ur(r)&&r.getId()===e&&(t=r)}),t}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),s=t==="After"?ct(n):n[0],i=`getCol${t}`;for(;;){const o=this.beans.visibleCols[i](s);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let r=e.getParent(),n,s;for(;n=r.getProvidedColumnGroup().getLevel(),s=r.getPaddingLevel(),!(n+s<=t);)r=r.getParent();return r}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();Ti(e,!1,t=>{Bt(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(Bt(e))return e;const r=this.beans.visibleCols.getAllTrees(),n=typeof t=="number";let s=null;return Ti(r,!1,i=>{if(Bt(i)){const o=i;let a;n?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(s=o)}}),s}createColumnGroups(e){const{columns:t,idCreator:r,pinned:n,oldDisplayedGroups:s,isStandaloneStructure:i}=e,o=this.mapOldGroupsById(s),a=[];let l=t;for(;l.length;){const c=l;l=[];let u=0;const h=d=>{const f=u;u=d;const p=c[f],m=(Bt(p)?p.getProvidedColumnGroup():p).getOriginalParent();if(m==null){for(let C=f;C<d;C++)a.push(c[C]);return}const v=this.createColumnGroup(m,r,o,n,i);for(let C=f;C<d;C++)v.addChild(c[C]);l.push(v)};for(let d=1;d<c.length;d++){const f=c[d],g=(Bt(f)?f.getProvidedColumnGroup():f).getOriginalParent(),m=c[u],C=(Bt(m)?m.getProvidedColumnGroup():m).getOriginalParent();g!==C&&h(d)}u<c.length&&h(c.length)}return i||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,r,n,s,i,o){const a=s.getUniqueKey(t.groupId||null,null),l=Av(this.beans,t,a),c=new lu(l,a,!1,r);this.createBean(c);const u=this.findExistingGroup(t,i);u&&i.splice(u.idx,1);const h=u==null?void 0:u.group;h&&c.setExpanded(h.isExpanded());const d=Vy(this.beans,l.children,r+1,e,n,s,i,o);return c.setChildren(d),c}balanceColumnTree(e,t,r,n){const s=[];for(let i=0;i<e.length;i++){const o=e[i];if(ur(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,r,n);a.setChildren(l),s.push(a)}else{let a,l;for(let c=t;c<r;c++){const u=n.getUniqueKey(null,null),h=Av(this.beans,null,u),d=new lu(h,u,!0,c);this.createBean(d),l&&l.setChildren([d]),l=d,a||(a=l)}if(a&&l)if(s.push(a),e.some(u=>ur(u))){l.setChildren([o]);continue}else{l.setChildren(e);break}s.push(o)}}return s}findDepth(e){let t=0,r=e;for(;(r==null?void 0:r[0])&&ur(r[0]);)t++,r=r[0].getChildren();return t}findMaxDepth(e,t){let r=t;for(let n=0;n<e.length;n++){const s=e[n];if(ur(s)){const i=s,o=this.findMaxDepth(i.getChildren(),t+1);r<o&&(r=o)}}return r}balanceTreeForAutoCols(e,t){const r=[];for(const n of e){let s=n;for(let i=t-1;i>=0;i--){const o=new lu(null,`FAKE_PATH_${n.getId()}}_${i}`,!0,i);this.createBean(o),o.setChildren([s]),s.originalParent=o,s=o}t===0&&(n.originalParent=null),r.push(s)}return r}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){const s=t[n];if(!!s.getColGroupDef()&&s.getId()===e.groupId)return{idx:n,group:s}}}createColumnGroup(e,t,r,n,s){const i=e.getGroupId(),o=t.getInstanceIdForKey(i),a=uS(i,o);let l=r[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),Be(l)?l.reset():(l=new Tl(e,i,o,n),s||this.createBean(l)),l}mapOldGroupsById(e){const t={},r=n=>{for(const s of n)if(Bt(s)){const i=s;t[s.getUniqueId()]=i,r(i.getChildren())}};return e&&r(e),t}setupParentsIntoCols(e,t){for(const r of e!=null?e:[])if(r.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),r.parent=t,Bt(r)){const n=r;this.setupParentsIntoCols(n.getChildren(),n)}}},QI={moduleName:"ColumnGroup",version:ut,dynamicBeans:{headerGroupCellCtrl:MI},beans:[YI],apiFunctions:{getAllDisplayedColumnGroups:$I,getCenterDisplayedColumnGroups:UI,getColumnGroup:NI,getColumnGroupState:WI,getDisplayNameForColumnGroup:HI,getLeftDisplayedColumnGroups:zI,getProvidedColumnGroup:BI,getRightDisplayedColumnGroups:jI,resetColumnGroupState:GI,setColumnGroupOpened:OI,setColumnGroupState:VI}},ZI={tag:"div",cls:"ag-skeleton-container"},qI=class extends ws{constructor(){super(ZI)}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>ju(e.eParentOfValue)),ju(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");Uu(this.getGui(),t)}setupLoading(e){const t=Yo({tag:"div",cls:"ag-skeleton-effect"}),r=e.node.rowIndex;if(r!=null){const i=75+25*(r%2===0?Math.sin(r):Math.cos(r));t.style.width=`${i}%`}this.getGui().appendChild(t);const n=this.getLocaleTextFunc(),s=e.deferRender?n("ariaDeferSkeletonCellLoading","Cell is loading"):n("ariaSkeletonCellLoading","Row data is loading");Uu(this.getGui(),s)}refresh(e){return!1}},JI={moduleName:"CheckboxCellRenderer",version:ut,userComponents:{agCheckboxCellRenderer:RP}},e4={moduleName:"SkeletonCellRenderer",version:ut,userComponents:{agSkeletonCellRenderer:qI}},t4=class extends we{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){var g;const t=(g=e.source)!=null?g:"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const r=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:s}=this.beans,i=n.centerCols;let o=-1;if(e.resizingCols){const m=new Set(e.resizingCols);for(let v=i.length-1;v>=0;v--)if(m.has(i[v])){o=v;break}}let a=!1;const l=i.map((m,v)=>{const C=m.getFlex(),x=C!=null&&C>0&&v>o;return a||(a=x),{col:m,isFlex:x,flex:Math.max(0,C!=null?C:0),initialSize:m.getActualWidth(),min:m.getMinWidth(),max:m.getMaxWidth(),targetSize:0}});if(a?(s==null||s.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(s),!r||!a)return[];let c=l.length,u=l.reduce((m,v)=>m+v.flex,0),h=r;const d=(m,v)=>{m.frozenSize=v,m.col.setActualWidth(v,t),h-=v,u-=m.flex,c-=1},f=m=>m.frozenSize!=null;for(const m of l)m.isFlex||d(m,m.initialSize);for(;c>0;){const m=Math.round(u<1?h*u:h);let v,C=0,x=0;for(const E of l){if(f(E))continue;v=E,x+=m*(E.flex/u);const y=x-C,R=Math.round(y);E.targetSize=R,C+=R}v&&(v.targetSize+=m-C);let w=0;for(const E of l){if(f(E))continue;const y=E.targetSize,R=Math.min(Math.max(y,E.min),E.max);w+=R-y,E.violationType=R===y?void 0:R<y?"max":"min",E.targetSize=R}const k=w===0?"all":w>0?"min":"max";for(const E of l)f(E)||(k==="all"||E.violationType===k)&&d(E,E.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();const p=l.filter(m=>m.isFlex&&!m.violationType).map(m=>m.col);if(e.fireResizedEvent){const m=l.filter(C=>C.initialSize!==C.frozenSize).map(C=>C.col),v=l.filter(C=>C.flex).map(C=>C.col);Ju(this.eventSvc,m,!0,t,v)}return this.revealColumns(s),p}revealColumns(e){this.columnsHidden&&(e==null||e.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){const{flex:t,initialFlex:r}=e.colDef;t!==void 0?e.flex=t:r!==void 0&&(e.flex=r)}setColFlex(e,t){e.flex=t!=null?t:null,e.dispatchStateUpdatedEvent("flex")}};function gu(e,t,r){if(!t||!e)return;if(!r)return e[t];const n=t.split(".");let s=e;for(let i=0;i<n.length;i++){if(s==null)return;s=s[n[i]]}return s}var r4=["dateTimeString","dateString","text","number","boolean","date"],n4=class extends we{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===ve.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:r}){return{cellEditorParams:{useFormatter:!0},comparator:(n,s)=>{const i=t.getColDefCol(r),o=i==null?void 0:i.getColDef();if(!i||!o)return 0;const a=n==null?"":e({column:i,node:null,value:n}),l=s==null?"":e({column:i,node:null,value:s});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){var u;const e=this.getDefaultDataTypes(),t={},r={},n=h=>d=>{const{column:f,node:p,value:g}=d;let m=f.getColDef().valueFormatter;return m===h.groupSafeValueFormatter&&(m=h.valueFormatter),this.beans.valueSvc.formatValue(f,p,g,m)};for(const h of Object.keys(e)){const d=e[h],f={...d,groupSafeValueFormatter:n1(d,this.gos)};t[h]=f,r[h]=n(f)}const s=(u=this.gos.get("dataTypeDefinitions"))!=null?u:{},i={};for(const h of Object.keys(s)){const d=s[h],f=this.processDataTypeDefinition(d,s,[h],e);f&&(t[h]=f,d.dataTypeMatcher&&(i[h]=d.dataTypeMatcher),r[h]=n(f))}const{valueParser:o,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==o,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=r,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(i,e)}sortKeysInMatchers(e,t){var n;const r={...e};for(const s of r4)delete r[s],r[s]=(n=e[s])!=null?n:t[s].dataTypeMatcher;return r}processDataTypeDefinition(e,t,r,n){let s;const i=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=n[i];const a=t[i];if(o&&a&&(o=a),!r1(e,o,i))return;s=t1(o,e)}else{if(r.includes(i)){Ge(44);return}const o=t[i];if(!r1(e,o,i))return;const a=this.processDataTypeDefinition(o,t,[...r,i],n);if(!a)return;s=t1(a,e)}return{...s,groupSafeValueFormatter:n1(s,this.gos)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:n}=t;const{field:s}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(s,r):!1),!n){e.cellDataType=!1;return}const i=this.dataTypeDefinitions[n];if(!i){Ge(47,{cellDataType:n});return}return e.cellDataType=n,i.groupSafeValueFormatter&&(e.valueFormatter=i.groupSafeValueFormatter),i.valueParser&&(e.valueParser=i.valueParser),i.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,i,r),i.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){var i;const{gos:r}=this;if(!Uh(r))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(nf(t,n))return!1;const s=t.type===null?e.type:t.type;if(s){const o=(i=r.get("columnTypes"))!=null?i:{};if(qu(s).some(l=>{const c=o[l.trim()];return c&&nf(c,n)}))return!1}return!nf(e,n)}inferCellDataType(e,t){if(!e)return;let r;const n=this.getInitialData();if(n){const i=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");r=gu(n,e,i)}else this.initWaitForRowData(t);if(r==null)return;const s=Object.keys(this.dataTypeMatchers).find(i=>this.dataTypeMatchers[i](r));return s!=null?s:"object"}getInitialData(){var t;const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const r=(t=this.beans.rowModel.rootNode)==null?void 0:t._leafs;if(r!=null&&r.length)return r[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:r,eventSvc:n}=this.beans;t&&r&&(r.shouldQueueResizeOperations=!0);const[s]=this.addManagedEventListeners({rowDataUpdateStarted:i=>{const{firstRowData:o}=i;!o||(s==null||s(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&(r==null||r.processResizeOperations()),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const n={},s={};for(const i of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[i],a=this.colModel.getCol(i);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const u=i4(a,o);u.rowGroup&&u.rowGroupIndex==null&&(n[i]=u),u.pivot&&u.pivotIndex==null&&(s[i]=u),r.push(u)}}t&&r.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,s)),r.length&&Ky(this.beans,{state:r},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},{rowGroupColsSvc:n,pivotColsSvc:s}=this.beans;return n==null||n.restoreColumnOrder(r,e),s==null||s.restoreColumnOrder(r,t),Object.values(r)}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const n=F0(this.beans,r,e.getColId());return e.setColDef(n,r,t),!0}getDateStringTypeDefinition(e){var r;const{dateString:t}=this.dataTypeDefinitions;return e&&(r=this.getDataTypeDefinition(e))!=null?r:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){const t=e.getColDef();if(!!t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var n;if(t==null)return!0;const r=(n=this.getDataTypeDefinition(e))==null?void 0:n.dataTypeMatcher;return r?r(t):!0}validateColDef(e){const t=r=>Ge(48,{property:r});if(e.cellDataType==="object"){const{object:r}=this.dataTypeDefinitions;e.valueFormatter===r.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===r.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){var o;const t=e.cellDataType;if(!t||typeof t!="string")return;const{dataTypeDefinitions:r,beans:n,formatValueFuncs:s}=this,i=r[t];!i||(o=n.colFilter)==null||o.setColDefPropsForDataType(e,i,s[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,r,n){const s=this.formatValueFuncs[t],i=this.columnDefinitionPropsPerDataType[r.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:r,colId:n,formatValue:s});Object.assign(e,i)}getDateObjectTypeDef(e){const t=this.getLocaleTextFunc(),r=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>_0(n.newValue&&String(n.newValue)),valueFormatter:n=>{var s;return n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):(s=Wv(n.value,r))!=null?s:""},dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){const t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:r=>{var n;return(n=_0(r))!=null?n:void 0},dateFormatter:r=>{var n;return(n=Wv(r!=null?r:null,t))!=null?n:void 0},valueParser:r=>uu(String(r.newValue))?r.newValue:null,valueFormatter:r=>uu(String(r.value))?String(r.value):"",dataTypeMatcher:r=>typeof r=="string"&&uu(r)}}getDefaultDataTypes(){const e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>{var r,n;return((n=(r=t.newValue)==null?void 0:r.trim)==null?void 0:n.call(r))===""?null:Number(t.newValue)},valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:x0(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>{var r,n;return t.newValue==null?t.newValue:((n=(r=t.newValue)==null?void 0:r.trim)==null?void 0:n.call(r))===""?null:String(t.newValue).toLowerCase()==="true"},valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:{...this.getDateStringTypeDef("dateTimeString"),dataTypeMatcher:t=>typeof t=="string"&&TD(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>{var r;return(r=x0(t.value))!=null?r:""}}}}destroyColumnStateUpdateListeners(){for(const e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function t1(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...qu(e.columnTypes),...qu(t.columnTypes)]),r}function r1(e,t,r){return t?t.baseDataType!==e.baseDataType?(Ge(46),!1):!0:(Ge(45,{parentCellDataType:r}),!1)}function n1(e,t){if(!!e.valueFormatter)return r=>{var n,s,i;if((n=r.node)!=null&&n.group){const o=((s=r.colDef.pivotValueColumn)!=null?s:r.column).getAggFunc();if(o){if(o==="first"||o==="last")return e.valueFormatter(r);if(e.baseDataType==="number"&&o!=="count"){if(typeof r.value=="number")return e.valueFormatter(r);if(typeof r.value=="object"){if(!r.value)return;if("toNumber"in r.value)return e.valueFormatter({...r,value:r.value.toNumber()});if("value"in r.value)return e.valueFormatter({...r,value:r.value.value})}}return}}else if(t.get("groupHideOpenParents")&&r.column.isRowGroupActive()&&typeof r.value=="string"&&!((i=e.dataTypeMatcher)!=null&&i.call(e,r.value)))return;return e.valueFormatter(r)}}function s4(e,t,r,n){if(!t[r])return!1;const s=e[r];return s===null?(t[r]=!1,!1):n===void 0?!!s:s===n}function nf(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,n])=>s4(e,t,r,n))}function i4(e,t){const r=V_(e);for(const n of t)delete r[n],n==="rowGroup"?delete r.rowGroupIndex:n==="pivot"&&delete r.pivotIndex;return r}var o4={moduleName:"DataType",version:ut,beans:[n4],dependsOn:[JI]},a4={moduleName:"ColumnFlex",version:ut,beans:[t4]};function l4(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,r=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(r,"$1 $2$3").replace(/\./g," ").split(" ").map(s=>s.substring(0,1).toUpperCase()+(s.length>1?s.substring(1,s.length):"")).join(" ")}var c4=class extends we{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:s}=this.beans;return r&&s?s.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,r){const n=t==null?void 0:t.getColGroupDef();return n?this.getHeaderName(n,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,n,s){var o,a;const i=e.headerValueGetter;if(i){const l=ot(this.gos,{colDef:e,column:t,columnGroup:r,providedColumnGroup:n,location:s});return typeof i=="function"?i(l):typeof i=="string"?(a=(o=this.beans.expressionSvc)==null?void 0:o.evaluate(i,l))!=null?a:null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return l4(e.field)}return""}},u4=class extends we{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const{visibleCols:n}=this,s=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!s)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=n.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(r)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t];break}return r!=null?r:[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||h4(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),n=this.viewportLeft-200,s=this.viewportRight+200,i=t<n&&r<n,o=t>s&&r>s;return!i&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=i=>{const o=i.getLeft();return Be(o)&&o>this.viewportLeft},r=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,s=n.centerCols;return n.getColsForRow(e,s,r,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){const{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;const r=n=>{var o;const s=new Set,i={};for(const a of n){let l=a.getParent();const c=a.isSpanHeaderHeight();for(;l&&!s.has(l);){if(c&&l.isPadding()){l=l.getParent();continue}const h=l.getProvidedColumnGroup().getLevel();(o=i[h])!=null||(i[h]=[]),i[h].push(l),s.add(l),l=l.getParent()}}return i};this.rowsOfHeadersToRenderLeft=r(e),this.rowsOfHeadersToRenderRight=r(t),this.rowsOfHeadersToRenderCenter=r(this.headerColsWithinViewport)}extractViewport(){const e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}};function h4(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var d4=class extends we{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class r{refresh(){return!1}getGui(){return this.eGui}init(s){const i=t(s),o=typeof i;if(o==="string"||o==="number"||o==="boolean"){this.eGui=Kg("<span>"+i+"</span>");return}if(i==null){this.eGui=Yo({tag:"span"});return}this.eGui=i}}return r}},f4={moduleName:"CellRendererFunction",version:ut,beans:[d4]},g4=class extends gA{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:r,dynamicBeans:n,selectors:s}=e;if(r){const i=(o,a,l,c)=>{this.agGridDefaults[o]=a,(l||c)&&(this.agGridDefaultOverrides[o]={params:l,processParams:c})};for(const o of Object.keys(r)){let a=r[o];if(SD(a)&&(a=a.getComp(this.beans)),typeof a=="object"){const{classImp:l,params:c,processParams:u}=a;i(o,l,c,u)}else i(o,a)}}this.registerDynamicBeans(n);for(const i of s!=null?s:[])this.selectors[i.selector]=i;if(t)for(const i of Object.keys(t))this.icons[i]=t[i]}getUserComponent(e,t){var a;const r=(l,c,u,h)=>({componentFromFramework:c,component:l,params:u,processParams:h}),{frameworkOverrides:n}=this.beans,s=n.frameworkComponent(t,this.gos.get("components"));if(s!=null)return r(s,!0);const i=this.jsComps[t];if(i){const l=n.isFrameworkComponent(i);return r(i,l)}const o=this.agGridDefaults[t];if(o){const l=this.agGridDefaultOverrides[t];return r(o,!1,l==null?void 0:l.params,l==null?void 0:l.processParams)}return(a=this.beans.validation)==null||a.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){var r,n;return t?b0(279,{name:e}):(n=(r=this.beans.validation)==null?void 0:r.missingDynamicBean(e))!=null?n:b0(256)}},p4=23,m4=class extends we{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){var e,t,r;this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(const n of this.readyCallbacks)n(this.params);this.readyCallbacks.length=0}},(r=(t=(e=this.beans.frameworkOverrides).runWhenReadyAsync)==null?void 0:t.call(e))!=null?r:!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===p4&&e.every(t=>{var r;return(r=t==null?void 0:t.isAlive())!=null?r:!1})}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const r=this.readyCallbacks.indexOf(t);r>=0&&this.readyCallbacks.splice(r,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},v4='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',x4={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Mr,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:is,rangeSelectionBackgroundColor:Gn(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Gn(.5),rangeHeaderHighlightColor:XD(.08),rowNumbersSelectedColor:Gn(.5),rowHoverColor:Gn(.08),columnHoverColor:Gn(.05),selectedRowBackgroundColor:Gn(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:Mr,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:on(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:on(.1),iconButtonActiveColor:is,iconButtonActiveBackgroundColor:Gn(.28),iconButtonActiveIndicatorColor:is,menuBorder:{color:on(.2)},menuBackgroundColor:dn(.03),menuTextColor:dn(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:on(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:is},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:on(.2)},panelBackgroundColor:Mr,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:on(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:on(.13)},selectCellBackgroundColor:on(.07),selectCellBorder:{color:on(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:Mr,filterPanelApplyButtonBackgroundColor:is,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:ko,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:ko,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:on(.15),statusBarLabelColor:ko,statusBarLabelFontWeight:500,statusBarValueColor:ko,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"}},C4=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",MS={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},w4={...MS,cellBatchEditTextColor:"#f3d0b3"},y4=()=>Yn({feature:"batchEditStyle",params:MS,css:C4}),S4=y4(),k4=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",b4={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},E4=()=>Yn({feature:"buttonStyle",params:{...b4,buttonBackgroundColor:Mr,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:is}},css:k4}),F4=E4(),T4=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",R4=()=>Yn({feature:"columnDropStyle",css:T4}),OS=R4(),_4={warn:(...e)=>{Ge(e[0],e[1])},error:(...e)=>{gn(e[0],e[1])},preInitErr:(...e)=>{Ia(e[0],e[2],e[1])}},D4=()=>iA(_4).withParams(x4).withPart(F4).withPart(OS).withPart(S4),A4='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',P4=()=>Yn({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Mr,checkboxUncheckedBorderColor:dn(.3),checkboxCheckedBackgroundColor:is,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Mr,checkboxIndeterminateBackgroundColor:dn(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Mr,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:A4}),I4=P4(),NS=()=>({...nh,...w4,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:dn(.05),rowHoverColor:Gn(.15),selectedRowBackgroundColor:Gn(.2),menuBackgroundColor:dn(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:ko,findMatchColor:Mr,findActiveMatchColor:Mr,checkboxUncheckedBorderColor:dn(.4),toggleButtonOffBackgroundColor:dn(.4),rowBatchEditBackgroundColor:dn(.1)}),L4=()=>({...NS(),backgroundColor:"#1f2836"}),M4=()=>Yn({feature:"colorScheme",params:nh,modeParams:{light:nh,dark:NS(),"dark-blue":L4()}}),O4=M4(),BS={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},HS={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},N4=(e={})=>{let t="";for(const r of[...Object.keys(BS),...Object.keys(HS)]){const n=B4(r,e.strokeWidth);t+=`.ag-icon-${r}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},B4=(e,t=1.5)=>{const r=HS[e];if(r)return r;const n=BS[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},H4=(e={})=>Yn({feature:"iconSet",css:()=>N4(e)}),W4=H4(),V4=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',G4=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}",z4={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4},U4=()=>Yn({feature:"inputStyle",params:{...z4,inputBackgroundColor:Mr,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:is},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:dn(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>V4+G4}),j4=U4(),$4='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',K4={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},X4=()=>Yn({feature:"tabStyle",params:{...K4,tabBarBorder:!0,tabBarBackgroundColor:on(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Mr},css:$4}),Y4=X4(),Q4=()=>D4().withPart(I4).withPart(O4).withPart(W4).withPart(Y4).withPart(j4).withPart(OS).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),Z4=Q4(),q4={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},J4={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},eL={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},s1={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},i1={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},o1={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},sf={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},a1={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function tL(e,t){for(const r of t.sort((n,s)=>n.moduleName.localeCompare(s.moduleName))){const n=r.css;n&&e.set(`module-${r.moduleName}`,n)}}var rL=class extends fA{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(s1),this.getSizeEl(i1),this.getSizeEl(o1),this.getSizeEl(sf),this.getSizeEl(a1),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(a1)}getRowBorderWidth(){return this.getCSSVariablePixelValue(sf)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(s1)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(i1)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(q4)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(J4),r=this.getCSSVariablePixelValue(eL);return e-1+r*t}getCellPadding(){const e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(o1)}refreshRowHeightVariable(){const{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),r=this.gos.get("rowHeight");if(r==null||isNaN(r)||!isFinite(r))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const n=`${r}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),r):t!=""?Number.parseFloat(t):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const r=this.measureSizeEl(e);return r==="detached"||r==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const r=t.offsetWidth;return r===of?"no-styles":(this.sizesMeasured=!0,r)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=Yo({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const r=this.getMeasurementContainer();t=Yo({tag:"div"});const{border:n,noWarn:s}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${of}px)`)):t.style.width=`var(${e.cssName}, ${of}px)`,r.appendChild(t),this.sizeEls.set(e,t);let i=this.measureSizeEl(e);i==="no-styles"&&!s&&Ge(9,{variable:e});const o=ia(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==i&&(i=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(sf);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&gn(t?106:239)}getAdditionalCss(){const e=new Map;return e.set("core",[v4]),tL(e,Array.from(ZR())),e}getDefaultTheme(){return Z4}themeError(e){gn(240,{theme:e})}},of=15538,nL=class extends pA{postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function WS(e,t,r){const n=e.visibleCols.headerGroupRowCount;if(r>=n)return{column:t,headerRowIndex:r};let s=t.getParent();for(;s&&s.getProvidedColumnGroup().getLevel()>r;)s=s.getParent();const i=t.isSpanHeaderHeight();return!s||i&&s.isPadding()?{column:t,headerRowIndex:n}:{column:s,headerRowIndex:s.getProvidedColumnGroup().getLevel()}}var sL=class extends we{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,r=>{this.gridBodyCon=r.gridBodyCtrl});const t=Ln(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){var f;let r;const{colModel:n,colGroupSvc:s,ctrlsSvc:i}=this.beans;if(typeof e=="string"?(r=n.getCol(e),r||(r=(f=s==null?void 0:s.getColumnGroup(e))!=null?f:null)):r=e,!r)return null;const o=i.getHeaderRowContainerCtrl(),a=o==null?void 0:o.getAllCtrls(),l=ct(a||[]).type==="filter",c=jn(this.beans)-1;let u=-1,h=r;for(;h;)u++,h=h.getParent();let d=u;return t&&l&&d===c-1&&d++,d===-1?null:{headerRowIndex:d,column:r}}navigateVertically(e,t){const{focusSvc:r,visibleCols:n}=this.beans,{focusedHeader:s}=r;if(!s)return!1;const{headerRowIndex:i}=s,o=s.column,a=jn(this.beans),l=this.getHeaderRowType(i),c=n.headerGroupRowCount;let{headerRowIndex:u,column:h,headerRowIndexWithoutSpan:d}=e==="UP"?iL(l,o,i):oL(o,i,c),f=!1;return u<0&&(u=0,h=o,f=!0),u>=a?(u=-1,this.currentHeaderRowWithoutSpan=-1):d!==void 0&&(this.currentHeaderRowWithoutSpan=d),!f&&!h?!1:r.focusHeaderPosition({headerPosition:{headerRowIndex:u,column:h},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,r){const{focusSvc:n,gos:s}=this.beans,i={...n.focusedHeader};let o,a;this.currentHeaderRowWithoutSpan!==-1?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,e==="LEFT"!==s.get("enableRtl")?(a="Before",o=this.findHeader(i,a)):(a="After",o=this.findHeader(i,a));const l=s.getCallback("tabToNextHeader");if(t&&l){const c=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(c){const{headerRowIndex:u}=n.focusedHeader||{};u!=null&&u!=i.headerRowIndex&&(this.currentHeaderRowWithoutSpan=u)}return c}return o||!t?n.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r}):this.focusNextHeaderRow(i,a,r)}focusNextHeaderRow(e,t,r){const n=this.beans,s=e.headerRowIndex;let i=null,o;const a=jn(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(s<=0)return!1;i=ct(l),o=s-1,this.currentHeaderRowWithoutSpan-=1}else i=l[0],o=s+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:u}=WS(this.beans,i,o);return u>=a&&(u=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:u},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(Bt(e)){const n=e.getDisplayedLeafColumns();r=t==="Before"?ct(n):n[0]}else r=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(r)}findHeader(e,t){const{colGroupSvc:r,visibleCols:n}=this.beans;let s=e.column;if(s instanceof Tl){const l=s.getDisplayedLeafColumns();s=t==="Before"?l[0]:l[l.length-1]}const i=t==="Before"?n.getColBefore(s):n.getColAfter(s);if(!i)return;const o=n.headerGroupRowCount;if(e.headerRowIndex>=o)return{headerRowIndex:e.headerRowIndex,column:i};const a=r==null?void 0:r.getColGroupAtLevel(i,e.headerRowIndex);return a?a.isPadding()&&i.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:i}:{headerRowIndex:e.headerRowIndex,column:a!=null?a:i}:{headerRowIndex:i instanceof oa&&i.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:i}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function iL(e,t,r){const n=r-1;if(e!=="filter"){const s=t instanceof oa&&t.isSpanHeaderHeight();let i=t.getParent();for(;i&&(i.getProvidedColumnGroup().getLevel()>n||s&&i.isPadding());)i=i.getParent();if(i)return s?{column:i,headerRowIndex:i.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:i,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function oL(e,t,r){const n=t+1,s={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof Tl){if(n>=r)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:r,headerRowIndexWithoutSpan:n};let o=e.getDisplayedChildren()[0];if(o instanceof Tl&&o.isPadding()){const l=o.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(o=l)}s.column=o,o instanceof oa&&o.isSpanHeaderHeight()&&(s.headerRowIndex=r,s.headerRowIndexWithoutSpan=n)}return s}var aL=class extends we{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(AD(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(xr(this.beans),bS)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=xr(this.beans);return this.isDomDataPresentInHierarchy(e,ih)?!0:this.isDomDataPresentInHierarchy(e,oh)}isDomDataPresentInHierarchy(e,t){let r=e;for(;r;){if(Ny(this.gos,r,t))return!0;r=r.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:r,column:n}=e,s={rowIndex:t,rowPinned:r,column:n,isFullWidthCell:!1},i=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return i&&(s.isFullWidthCell=i.isFullWidth()),s}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:r,rowPinned:n,forceBrowserFocus:s=!1,preventScrollOnBrowserFocus:i=!1,sourceEvent:o}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:r,rowPinned:bi(n),column:a};const l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent({type:"cellFocused",...l,...this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams},forceBrowserFocus:s,preventScrollOnBrowserFocus:i,sourceEvent:o}),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:YP(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:r,pinned:n}}=e,{column:s,headerRowIndex:i}=this.focusedHeader;return t===s&&r===i&&n==s.getPinned()}focusHeaderPosition(e){var c;if(this.setFocusRecovered(),Fi(this.beans))return!1;const{direction:t,fromTab:r,allowUserOverride:n,event:s,fromCell:i,rowWithoutSpanValue:o,scroll:a=!0}=e;let{headerPosition:l}=e;if(i&&((c=this.filterManager)==null?void 0:c.isAdvFilterHeaderActive()))return this.focusAdvancedFilter(l);if(n){const u=this.focusedHeader,h=jn(this.beans);if(r){const d=this.gos.getCallback("tabToNextHeader");d&&(l=this.getHeaderPositionFromUserFunc({userFunc:d,direction:t,currentPosition:u,headerPosition:l,headerRowCount:h}))}else{const d=this.gos.getCallback("navigateToNextHeader");if(d&&s){const f={key:s.key,previousHeaderPosition:u,nextHeaderPosition:l,headerRowCount:h,event:s};l=d(f)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:s,fromCell:i,rowWithoutSpanValue:o,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(Fi(this.beans))return!1;const{userFunc:t,headerPosition:r,direction:n,event:s}=e,i=this.focusedHeader,o=jn(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:i,headerPosition:r,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:s})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:r,currentPosition:n,headerPosition:s,headerRowCount:i}=e,a=t({backwards:r==="Before",previousHeaderPosition:n,nextHeaderPosition:s,headerRowCount:i});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:r,fromCell:n,rowWithoutSpanValue:s,event:i,scroll:o=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:u,headerNavigation:h}=this.beans;if(this.focusedHeader&&dP(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c!=null&&c.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:i});o&&(h==null||h.scrollToColumn(a,r));const d=u.getHeaderRowContainerCtrl(a.getPinned()),f=(d==null?void 0:d.focusHeader(t.headerRowIndex,a,i))||!1;return h&&f&&(s!=null||n)&&(h.currentHeaderRowWithoutSpan=s!=null?s:-1),f}focusFirstHeader(){var r;if(((r=this.overlays)==null?void 0:r.isExclusive())&&this.focusOverlay())return!0;const e=this.visibleCols.allCols[0];if(!e)return!1;const t=WS(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){var n;if(((n=this.overlays)==null?void 0:n.isExclusive())&&this.focusOverlay(!0))return!0;const t=jn(this.beans)-1,r=ct(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:r},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){var t;return(t=this.filterManager)!=null&&t.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===bi(t)}focusOverlay(e){var r,n;const t=((r=this.overlays)==null?void 0:r.isVisible())&&((n=this.overlays.eWrapper)==null?void 0:n.getGui());return!!t&&rh(t,e)}focusGridView(e){var i,o,a,l,c,u,h;const{backwards:t=!1,canFocusOverlay:r=!0,event:n}=e;if((i=this.overlays)!=null&&i.isExclusive())return r&&this.focusOverlay(t);if(lp(this.beans))return t&&!Fi(this.beans)?this.focusLastHeader():r&&this.focusOverlay(t)?!0:t?!1:Rl(this.beans,t);const s=t?qP(this.beans):ZP(this.beans);if(s){const d=(a=e.column)!=null?a:(o=this.focusedHeader)==null?void 0:o.column,{rowIndex:f,rowPinned:p}=s,g=DS(this.beans,s);if(!d||!g||f==null)return!1;if(d.isSuppressNavigable(g)){const m=this.gos.get("enableRtl");let v;return!n||n.key===ve.TAB?v=m?ve.LEFT:ve.RIGHT:v=n.key,(l=this.beans.navigation)==null||l.navigateToNextCell(null,v,{rowIndex:f,column:d,rowPinned:p||null},!0),!0}if((c=this.navigation)==null||c.ensureCellVisible({rowIndex:f,column:d,rowPinned:p}),t){const m=this.rowRenderer.getRowByPosition(s);if((m==null?void 0:m.isFullWidth())&&((u=this.navigation)==null?void 0:u.tryToFocusFullWidthRow(s,t)))return!0}return this.setFocusedCell({rowIndex:f,column:d,rowPinned:bi(p),forceBrowserFocus:!0}),(h=this.beans.rangeSvc)==null||h.setRangeToCell({rowIndex:f,rowPinned:p,column:d}),!0}return!!(r&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){var t,r;return this.advFilterFocusColumn=e==null?void 0:e.column,(r=(t=this.beans.advancedFilter)==null?void 0:t.getCtrl().focusHeaderComp())!=null?r:!1}focusNextFromAdvancedFilter(e,t){var n,s;const r=(s=t?void 0:this.advFilterFocusColumn)!=null?s:(n=this.visibleCols.allCols)==null?void 0:n[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:jn(this.beans)-1}}):this.focusGridView({column:r})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},lL=class extends we{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e!=null&&e.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){var r;const e=this.ctrlsSvc.get("center");if(!e||((r=this.colAnimation)==null?void 0:r.isActive()))return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),r=typeof e=="number"&&e>=0?e:bD();r!=null&&(this.scrollbarWidth=r,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},cL=class extends we{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){var n,s;if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:r}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:(n=e==null?void 0:e.getState())!=null?n:{}}),this.destroyCalled=!0,(s=t.get("gridCtrl"))==null||s.destroyGridUi(),r.destroy(),super.destroy()}},uL=new Set(["gridPreDestroyed","fillStart","pasteStart"]),hL=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"],VS=hL.reduce((e,t)=>(e[t]=v_(t),e),{}),Fa=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),dL={tag:"span",cls:"ag-sort-indicator-container",children:[Fa("Order","order"),Fa("Asc","ascending-icon"),Fa("Desc","descending-icon"),Fa("Mixed","mixed-icon"),Fa("None","none-icon")]},hp=class extends ws{constructor(e){super(),this.eSortOrder=qe,this.eSortAsc=qe,this.eSortDesc=qe,this.eSortMixed=qe,this.eSortNone=qe,e||this.setTemplate(dL)}attachCustomElements(e,t,r,n,s){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=n,this.eSortNone=s}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const r=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,r){if(t==null)return;const n=Jl(e,this.beans,r);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:r,column:n,gos:s,beans:i}=this,o=i.sortSvc.getDisplaySortForColumn(n);if(e&&Yt(e,o==="asc",{skipAriaHidden:!0}),t&&Yt(t,o==="desc",{skipAriaHidden:!0}),r){const a=!n.getColDef().unSortIcon&&!s.get("unSortIcon"),l=o==null;Yt(r,!a&&l,{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:r}=this;this.addInIcon("sortUnSort",e,t);const n=t.getColDef().showRowGroup;ss(r)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:r}=this;if(e){const n=t.sortSvc.getDisplaySortForColumn(r)==="mixed";Yt(e,n,{skipAriaHidden:!0})}}updateSortOrder(){var a;const{eSortOrder:e,column:t,beans:{sortSvc:r}}=this;if(!e)return;const n=r.getColumnsWithSortingOrdered(),s=(a=r.getDisplaySortIndexForColumn(t))!=null?a:-1,i=n.some(l=>{var c;return(c=r.getDisplaySortIndexForColumn(l))!=null?c:-1>=1}),o=s>=0&&i;Yt(e,o,{skipAriaHidden:!0}),s>=0?e.textContent=(s+1).toString():Ql(e)}},fL={selector:"AG-SORT-INDICATOR",component:hp},gL=["asc","desc",null],pL=class extends we{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,r){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,r)}progressSortFromEvent(e,t){const n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,r,n){var u;t!=="asc"&&t!=="desc"&&(t=null);const{gos:s,showRowGroupCols:i}=this.beans,o=ss(s);let a=[e];if(o&&e.getColDef().showRowGroup){const h=(u=i==null?void 0:i.getSourceColumnsForGroupColumn)==null?void 0:u.call(i,e),d=h==null?void 0:h.filter(f=>f.isSortable());d&&(a=[e,...d])}for(const h of a)this.setColSort(h,t,n);const l=(r||s.get("alwaysMultiSort"))&&!s.get("suppressMultiSort"),c=[];if(!l){const h=this.clearSortBarTheseColumns(a,n);c.push(...h)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(n,c)}updateSortIndex(e){const{gos:t,colModel:r,showRowGroupCols:n}=this.beans,s=ss(t),i=n==null?void 0:n.getShowRowGroupCol(e.getId()),o=s&&i||e,a=this.getColumnsWithSortingOrdered();r.forAllCols(u=>this.setColSortIndex(u,null));const l=a.filter(u=>s&&u.getColDef().showRowGroup?!1:u!==o);(o.getSort()?[...l,o]:l).forEach((u,h)=>this.setColSortIndex(u,h))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventSvc.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSort()&&r.push(n),this.setColSort(n,void 0,t))}),r}getNextSortDirection(e){var i,o;const t=(o=(i=e.getColDef().sortingOrder)!=null?i:this.gos.get("sortingOrder"))!=null?o:gL,r=t.indexOf(e.getSort()),n=r<0,s=r==t.length-1;return n||s?t[0]:t[r+1]}getIndexedSortMap(){var c;const{gos:e,colModel:t,showRowGroupCols:r,rowGroupColsSvc:n}=this.beans;let s=[];if(t.forAllCols(u=>{u.getSort()&&s.push(u)}),t.isPivotMode()){const u=ss(e);s=s.filter(h=>{const d=!!h.getAggFunc(),f=!h.isPrimary(),p=u?r==null?void 0:r.getShowRowGroupCol(h.getId()):h.getColDef().showRowGroup;return d||f||p})}const i=(c=n==null?void 0:n.columns.filter(u=>!!u.getSort()))!=null?c:[],o={};s.forEach((u,h)=>o[u.getId()]=h),s.sort((u,h)=>{const d=u.getSortIndex(),f=h.getSortIndex();if(d!=null&&f!=null)return d-f;if(d==null&&f==null){const p=o[u.getId()],g=o[h.getId()];return p>g?1:-1}else return f==null?-1:1});const a=ss(e)&&!!i.length;a&&(s=[...new Set(s.map(u=>{var h;return(h=r==null?void 0:r.getShowRowGroupCol(u.getId()))!=null?h:u}))]);const l=new Map;if(s.forEach((u,h)=>l.set(u,h)),a)for(const u of i){const h=r.getShowRowGroupCol(u.getId());l.set(u,l.get(h))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=ss(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){var o;const t=(o=this.beans.showRowGroupCols)==null?void 0:o.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSort();const n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,s=n[0].getSort();return n.every(a=>a.getSort()==s)?s:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,r){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),r&&e.addManagedElementListeners(r,{click:i=>{const o=t.isMoving(),l=Date.now()-n<50;o||l||this.progressSortFromEvent(t,i)}});const s=()=>{var o;const i=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",i==="asc"),e.toggleCss("ag-header-cell-sorted-desc",i==="desc"),e.toggleCss("ag-header-cell-sorted-none",!i),t.getColDef().showRowGroup){const a=(o=this.beans.showRowGroupCols)==null?void 0:o.getSourceColumnsForGroupColumn(t),c=!(a==null?void 0:a.every(u=>t.getSort()==u.getSort()));e.toggleCss("ag-header-cell-sorted-mixed",c)}};e.addManagedEventListeners({sortChanged:s,columnRowGroupChanged:s})}initCol(e){const{sort:t,initialSort:r,sortIndex:n,initialSortIndex:s}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(r==="asc"||r==="desc")&&(e.sort=r),n!==void 0?n!==null&&(e.sortIndex=n):s!==null&&(e.sortIndex=s)}updateColSort(e,t,r){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,r):this.setColSort(e,void 0,r))}setColSort(e,t,r){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",r)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new hp(e)}getSortIndicatorSelector(){return fL}},af={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"},mL={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>{var r;return t?typeof e=="string"&&(r=af[e])!=null?r:"CustomEditor":null},cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:af[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>{var t;return e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"&&(t=af[e])!=null?t:"ColumnFilter"},floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{var r;const t=["columnsMenuTab","generalMenuTab"];return(r=e.menuTabs)!=null&&r.some(n=>t.includes(n))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},vL={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},xL=0,CL=0,l1="__ag_grid_instance",wL=class extends we{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=CL++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new Yl,this.globalEventHandlerFactory=e=>(t,r)=>{if(!this.isAlive())return;const n=uL.has(t);if(n&&!e||!n&&e||!yL(t))return;const s=(i,o)=>{const a=VS[i],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(o))};if(this.gridReadyFired)s(t,r);else if(t==="gridReady"){s(t,r),this.gridReadyFired=!0;for(const i of this.queueEvents)s(i.eventName,i.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:r})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){var t;return(t=this.gridOptions[e])!=null?t:by[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return Be(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(r=>e(this.addCommon(r)))}updateGridOptions({options:e,force:t,source:r="api"}){const n={id:xL++,properties:[]},s=[],{gridOptions:i,validation:o}=this;for(const a of Object.keys(e)){const l=Qg.applyGlobalGridOption(a,e[a]);o==null||o.warnOnInitialPropertyUpdate(r,a);const c=t||typeof l=="object"&&r==="api",u=i[a];if(c||u!==l){i[a]=l;const h={type:a,currentValue:l,previousValue:u,changeSet:n,source:r};s.push(h)}}this.validateGridOptions(this.gridOptions),n.properties=s.map(a=>a.type);for(const a of s)Yu(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(const r of Object.keys(e)){const n=e[r];if(n==null||n===!1)continue;let s=t[r];typeof s=="function"&&(s=s(e,this.gridOptions,this.beans)),s&&this.assertModuleRegistered(s,r)}}validateGridOptions(e){var t;this.validateOptions(e,vL),(t=this.validation)==null||t.processGridOptions(e)}validateColDef(e,t,r){var n,s;(r||!((n=this.beans.dataTypeSvc)!=null&&n.isColPendingInference(t)))&&(this.validateOptions(e,mL),(s=this.validation)==null||s.validateColDef(e))}assertModuleRegistered(e,t){const r=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return r||gn(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),r}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:_y(),rowModelType:this.get("rowModelType"),isUmd:e_()}}isModuleRegistered(e){return S0(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[l1]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){const r=t[l1];if(Be(r))return r===this.instanceId;t=t.parentElement}return!1}};function yL(e){return!!VS[e]}function GS(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var SL=GS(!0),kL=GS(!1),bL=class extends ws{constructor(){super(...arguments),this.eFilter=qe,this.eFilterButton=qe,this.eSortIndicator=qe,this.eMenu=qe,this.eLabel=qe,this.eText=qe,this.eSortOrder=qe,this.eSortAsc=qe,this.eSortDesc=qe,this.eSortMixed=qe,this.eSortNone=qe,this.isLoadingInnerComponent=!1}refresh(e){var r,n,s;const t=this.params;if(this.params=e,this.workOutTemplate(e,!!((r=this.beans)!=null&&r.sortSvc))!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const i={...e};Xr(i,e.innerHeaderComponentParams),(s=(n=this.innerHeaderComponent).refresh)==null||s.call(n,i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const r=e.template;return r?r!=null&&r.trim?r.trim():r:t?SL:kL}init(e){this.params=e;const{sortSvc:t,touchSvc:r,rowNumbersSvc:n,userCompFactory:s}=this.beans,i=t==null?void 0:t.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!i),this.setTemplate(this.currentTemplate,i?[i]:void 0),r==null||r.setupForHeader(this),this.setMenu(),this.setupSort(),n==null||n.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(s,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const r=dD(e,t,t);!r||(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){const{displayName:t}=e,r=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||r===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Vh(t))}addInIcon(e,t,r){const n=Jl(e,this.beans,r);n&&t.appendChild(n)}workOutShowMenu(){var e;return this.params.enableMenu&&!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonEnabled())}shouldSuppressMenuHide(){var e;return!!((e=this.beans.menuSvc)!=null&&e.isHeaderMenuButtonAlwaysShowEnabled())}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){C0(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:r}=this,n=Zu(e);this.addInIcon(n?"menu":"menuAlt",t,r.column),t.classList.toggle("ag-header-menu-icon",!n);const s=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=s,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(s)}toggleMenuAlwaysShow(e){var t;(t=this.eMenu)==null||t.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:r}=this;t||this.toggleMenuAlwaysShow(!0),r.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){var l,c,u;const{params:t,gos:r,beans:n,eMenu:s,eFilterButton:i}=this,o=t.column,a=Zu(r);if(e&&!a){if((l=n.menuSvc)!=null&&l.isFilterMenuInHeaderEnabled(o))return t.showFilter((c=i!=null?i:s)!=null?c:this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu((u=s!=null?s:i)!=null?u:this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:r}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:n,eSortOrder:s,eSortAsc:i,eSortDesc:o,eSortMixed:a,eSortNone:l}=this;n.attachCustomElements(s,i,o,a,l)}this.eSortIndicator.setupSort(r),this.currentSort&&e.setupHeader(this,r,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;if(!e)return;const r=()=>{const n=t.column.isFilterActive();Yt(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,r,"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,r,n){if(!e)return C0(t),!1;const s=this.params.column;return this.addInIcon(n,t,s),this.addManagedListeners(s,{filterChanged:r}),r(),!0}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){var n,s;const{eFilterButton:t,eMenu:r}=this;return e?(n=t!=null?t:r)!=null?n:this.getGui():(s=r!=null?r:t)!=null?s:this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},EL={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},FL=class extends ws{constructor(){super(EL),this.agOpened=qe,this.agClosed=qe,this.agLabel=qe,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t,touchSvc:r}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),r==null||r.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&Ge(89)}workOutInnerHeaderGroupComponent(e,t){const r=gD(e,t,t);!r||(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:r},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const s=l=>{if(Ys(l))return;const c=!r.isExpanded();n.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,s),this.addTouchAndClickListeners(n,e,s);const i=l=>{sh(l)};this.addManagedElementListeners(t,{dblclick:i}),this.addManagedElementListeners(e,{dblclick:i}),this.addManagedElementListeners(this.getGui(),{dblclick:s}),this.updateIconVisibility();const o=r.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,r){var n;(n=e.touchSvc)==null||n.setupForHeaderGroupElement(this,t,r),this.addManagedElementListeners(t,{click:r})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:r}}=this;if(r.isExpandable()){const n=r.isExpanded();Yt(e,n),Yt(t,!n)}else Yt(e,!1),Yt(t,!1)}addInIcon(e,t){const r=Jl(e,this.beans,null);r&&t.appendChild(r)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:r}=this;Yt(t,!1),Yt(r,!1)}}setupLabel(e){var s;const{displayName:t,columnGroup:r}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;Be(t)&&!n&&(this.agLabel.textContent=Vh(t)),this.toggleCss("ag-sticky-label",!((s=r.getColGroupDef())!=null&&s.suppressStickyLabel))}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},TL={moduleName:"ColumnHeaderComp",version:ut,userComponents:{agColumnHeader:bL},icons:{menu:"menu",menuAlt:"menu-alt"}},RL={moduleName:"ColumnGroupHeaderComp",version:ut,userComponents:{agColumnGroupHeader:FL},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},_L=class extends we{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&Ge(92)}createTask(e,t,r,n,s=!1){this.verify();let i=r;n&&this.batchFrameworkComps&&(i="f1");const o={task:e,index:t,createOrder:++this.taskCount,deferred:s};this.addTaskToList(this[i],o),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,n)=>r.deferred!==n.deferred?r.deferred?-1:1:r.index!==n.index?t*(n.index-r.index):n.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:r,f1:n,destroyTasks:s,beans:i}=this,{ctrlsSvc:o,frameworkOverrides:a}=i,l=t.list,c=r.list,u=n.list,h=Date.now();let d=0;const f=e<=0,p=o.getScrollFeature();for(;f||d<e;){if(!p.scrollGridIfNeeded()){let m;if(l.length)this.sortTaskList(t),m=l.pop().task;else if(c.length)this.sortTaskList(r),m=c.pop().task;else if(u.length)a.wrapOutgoing(()=>{for(;(f||d<e)&&!p.scrollGridIfNeeded();){if(u.length)this.sortTaskList(n),m=u.pop().task,m();else break;d=Date.now()-h}}),m=()=>{};else if(s.length)m=s.pop();else break;m()}d=Date.now()-h}l.length||c.length||u.length||s.length?this.requestFrame():this.ticking=!1}flushAllFrames(){!this.active||this.executeFrame(-1)}schedule(){!this.active||this.ticking||(this.ticking=!0,this.requestFrame())}requestFrame(){const e=this.executeFrame.bind(this,60);ai(this.beans,e)}isQueueEmpty(){return!this.ticking}},DL={moduleName:"AnimationFrame",version:ut,beans:[_L]},AL=class extends we{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return Jl(e,this.beans,t==null?void 0:t.column)}},PL=class extends we{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!Za())return;const t=(r,n,s)=>{var a,l;const{rowCtrl:i,cellCtrl:o}=e.getControlsForEventTarget((a=s==null?void 0:s.target)!=null?a:null);o!=null&&o.column&&o.dispatchCellContextMenuEvent(s!=null?s:null),(l=this.beans.contextMenuSvc)==null||l.handleContextMenuMouseEvent(void 0,s,i,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!Za()||Cy("dblclick"))return!1;const n=Date.now(),s=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,s})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:r,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;const{params:s,eMenu:i,eFilterButton:o}=e,a=new so(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());const l=e.shouldSuppressMenuHide(),c=l&&Be(i)&&s.enableMenu;let u=a;if(c&&(u=new so(i,!0),e.addDestroyFunc(()=>u.destroy())),s.enableMenu||(n==null?void 0:n.isHeaderContextMenuEnabled(s.column))){const h=c?"tap":"longTap",d=f=>s.showColumnMenuAfterMouseClick(f.touchStart);e.addManagedListeners(u,{[h]:d}),e.addManagedListeners(a,{longTap:d})}if(s.enableSorting){const h=d=>{const f=d.touchStart.target;l&&((i==null?void 0:i.contains(f))||(o==null?void 0:o.contains(f)))||r==null||r.progressSort(s.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:h})}if(s.enableFilterButton&&o){const h=new so(o,!0);e.addManagedListeners(h,{tap:()=>s.showFilter(o)}),e.addDestroyFunc(()=>h.destroy())}}setupForHeaderGroup(e){var r;const t=e.params;if((r=this.beans.menuSvc)!=null&&r.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){const n=new so(t.eGridHeader,!0),s=i=>t.showColumnMenuAfterMouseClick(i.touchStart);e.addManagedListeners(n,{longTap:s}),e.addDestroyFunc(()=>n.destroy())}}setupForHeaderGroupElement(e,t,r){const n=new so(t,!0);e.addManagedListeners(n,{tap:r}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,r){if(!Za())return;const n=new so(t),s=i=>{!El(this.beans,i.touchEvent)||r(void 0,i.touchStart,i.touchEvent)};e.addManagedListeners(n,{longTap:s}),e.addDestroyFunc(()=>n.destroy())}},IL={moduleName:"Touch",version:ut,beans:[PL]},LL=class extends we{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===ve.UP,n=e===ve.DOWN,s=e===ve.LEFT;let i,o;const{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:u}=this.beans,{rowPinned:h}=t;if(r||n)h&&u?r?o=0:o=h==="top"?u.getPinnedTopRowCount()-1:u.getPinnedBottomRowCount()-1:o=r?a.getFirstRow():a.getLastRow(),i=t.column;else{const d=l.get("enableRtl");o=t.rowIndex,i=(s!==d?c.allCols:[...c.allCols].reverse()).find(p=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:p}))}return i?{rowIndex:o,rowPinned:h,column:i}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,n=!1;for(;!n;){switch(e){case ve.UP:r=this.getCellAbove(r);break;case ve.DOWN:r=this.getCellBelow(r);break;case ve.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case ve.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,Ge(8,{key:e});break}r?n=this.isCellGoodToFocusOn(r):n=!0}return r}isCellGoodToFocusOn(e){const t=e.column;let r;const{pinnedRowModel:n,rowModel:s}=this.beans;switch(e.rowPinned){case"top":r=n==null?void 0:n.getPinnedTopRow(e.rowIndex);break;case"bottom":r=n==null?void 0:n.getPinnedBottomRow(e.rowIndex);break;default:r=s.getRow(e.rowIndex);break}return r?!this.isSuppressNavigable(t,r):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){var n,s;if(!e)return null;const t=(s=(n=this.rowSpanSvc)==null?void 0:n.getCellEnd(e))!=null?s:e,r=qv(this.beans,t,!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getCellAbove(e){var n,s;if(!e)return null;const t=(s=(n=this.rowSpanSvc)==null?void 0:n.getCellStart(e))!=null?s:e,r=ah(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){var a;const{visibleCols:t,pagination:r}=this.beans,n=t.allCols;let s=e.rowIndex,i=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=n[0];const l=qv(this.beans,e,!0);if(Jt(l)||!l.rowPinned&&!((a=r==null?void 0:r.isRowInPage(l.rowIndex))==null||a))return null;s=l?l.rowIndex:null,i=l?l.rowPinned:null}return{rowIndex:s,column:o,rowPinned:i}}getNextTabbedCellBackwards(e){var l;const{beans:t}=this,{visibleCols:r,pagination:n}=t,s=r.allCols;let i=e.rowIndex,o=e.rowPinned,a=r.getColBefore(e.column);if(!a){a=ct(s);const c=ah(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(Jt(c)||!c.rowPinned&&!((l=n==null?void 0:n.isRowInPage(c.rowIndex))==null||l))return null;i=c?c.rowIndex:null,o=c?c.rowPinned:null}return{rowIndex:i,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:r}=e.colDef;if(typeof r=="boolean")return r;if(typeof r=="function"){const n=e.createColumnFunctionCallbackParams(t);return r(n)}return!1}};function ML(e){return e.focusSvc.getFocusedCell()}function OL(e){return e.focusSvc.clearFocusedCell()}function NL(e,t,r,n){e.focusSvc.setFocusedCell({rowIndex:t,column:r,rowPinned:n,forceBrowserFocus:!0})}function BL(e,t){var r,n;return(n=(r=e.navigation)==null?void 0:r.tabToNextCell(!1,t))!=null?n:!1}function HL(e,t){var r,n;return(n=(r=e.navigation)==null?void 0:r.tabToNextCell(!0,t))!=null?n:!1}function WL(e,t,r=!1){var s;const n=(s=e.headerNavigation)==null?void 0:s.getHeaderPositionForColumn(t,r);!n||e.focusSvc.focusHeaderPosition({headerPosition:n})}var VL=class{constructor(){this.cellValidations=new Map}getCellValidation(e){var n,s;const{rowNode:t,column:r}=e||{};return(s=(n=this.cellValidations)==null?void 0:n.get(t))==null?void 0:s.get(r)}hasCellValidation(e){return!(e!=null&&e.rowNode)||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){const{rowNode:r,column:n}=e;this.cellValidations.has(r)||this.cellValidations.set(r,new Map),this.cellValidations.get(r).set(n,t)}clearCellValidation(e){var n;const{rowNode:t,column:r}=e;(n=this.cellValidations.get(t))==null||n.delete(r)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},GL=class{constructor(){this.rowValidations=new Map}getRowValidation(e){const{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e!=null&&e.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function zL(e,t={}){var c;const{rowIndex:r,rowId:n,rowCtrl:s,rowPinned:i}=t;if(s)return s;const{rowModel:o,rowRenderer:a}=e;let{rowNode:l}=t;return l||(n?l=JP(e,n,i):r!=null&&(l=o.getRow(r))),(c=a.getRowCtrls(l?[l]:[]))==null?void 0:c[0]}function UL(e,t={}){var u,h,d,f,p;const{cellCtrl:r,colId:n,columnId:s,column:i}=t;if(r)return r;const o=e.colModel.getCol((u=n!=null?n:s)!=null?u:jL(i)),a=(h=t.rowCtrl)!=null?h:zL(e,t),l=(d=a==null?void 0:a.getCellCtrl(o))!=null?d:void 0;if(l)return l;const c=(f=t.rowNode)!=null?f:a==null?void 0:a.rowNode;if(c)return(p=e.rowRenderer.getCellCtrls([c],[o]))==null?void 0:p[0]}function jL(e){if(!!e)return typeof e=="string"?e:e.getColId()}var zS=Symbol("unedited");function $L(e,t={}){var s;const r=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(const i of n){const o=(s=i.comp)==null?void 0:s.getCellEditor();o&&r.push({ctrl:i,editor:yD(o)})}return r}function KL(e,t,r){var i,o,a;const n={editorValueExists:!1};if(US(e)){const l=(i=t.getValidationErrors)==null?void 0:i.call(t);if(((o=l==null?void 0:l.length)!=null?o:0)>0)return n}if(r!=null&&r.isCancelling)return n;if(r!=null&&r.isStopping){const l=(a=t==null?void 0:t.isCancelAfterEnd)==null?void 0:a.call(t);if(l)return{...n,isCancelAfterEnd:l}}return{editorValue:t.getValue(),editorValueExists:!0}}function XL(e,t){var r,n,s,i;for(const o of(n=(r=e.editModelSvc)==null?void 0:r.getEditPositions())!=null?n:[]){const a=UL(e,o);if(!a)continue;const l=(s=a.comp)==null?void 0:s.getCellEditor();if(!l)continue;const{editorValue:c,editorValueExists:u,isCancelAfterEnd:h}=KL(e,l,t);h&&((i=e.editModelSvc)==null||i.setEdit(o,{editorState:{isCancelAfterEnd:h}})),YL(e,o,c,void 0,!u,t)}}function YL(e,t,r,n,s,i){const{editModelSvc:o,valueSvc:a}=e;if(!o)return;const{rowNode:l,column:c}=t;if(!(l&&c))return;let u=o.getEdit(t,!0);u!=null&&u.sourceValue||(u=o.setEdit(t,{sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:u?u.editorValue:zS})),o.setEdit(t,{editorValue:s?u.sourceValue:r}),i!=null&&i.persist&&QL(e,t)}function QL(e,t){const{editModelSvc:r}=e,n=r==null?void 0:r.getEdit(t,!0);r==null||r.setEdit(t,{pendingValue:n==null?void 0:n.editorValue})}function US(e){var o;const{gos:t,colModel:r}=e,n=!!t.get("getFullRowEditValidationErrors"),s=(o=r.getColumnDefs())==null?void 0:o.filter(a=>a.editable).some(({cellEditorParams:a})=>{const{minLength:l,maxLength:c,getValidationErrors:u,min:h,max:d}=a||{};return l!==void 0||c!==void 0||u!==void 0||h!==void 0||d!==void 0}),i=e.gridApi.getCellEditorInstances().some(a=>a.getValidationElement||a.getValidationErrors);return s||n||i}function L0(e,t){var d,f,p,g,m,v,C,x,w;if(!(t||US(e)))return;const r=$L(e),n=new VL,{ariaAnnounce:s,localeSvc:i,editModelSvc:o,gos:a}=e,l=a.get("editType")==="fullRow",u=yy(i)("ariaValidationErrorPrefix","Cell Editor Validation");for(const k of r){const{ctrl:E,editor:y}=k,{rowNode:R,column:D}=E,N=(f=(d=y.getValidationErrors)==null?void 0:d.call(y))!=null?f:[],O=((p=y.getValidationElement)==null?void 0:p.call(y,!1))||!((g=y.isPopup)!=null&&g.call(y))&&E.eGui;if(O){const A=N!=null&&N.length>0,G=A?N.join(". "):"";xR(O,A),A&&s.announceValue(`${u} ${N}`,"editorValidation"),O instanceof HTMLInputElement?O.setCustomValidity(G):O.classList.toggle("invalid",A)}(N==null?void 0:N.length)>0&&n.setCellValidation({rowNode:R,column:D},{errorMessages:N})}XL(e,{persist:!1}),o==null||o.setCellValidationModel(n);const h=new Set;for(const{ctrl:k}of r)h.add(k.rowCtrl);if(l){const k=ZL(e);o==null||o.setRowValidationModel(k)}for(const k of h.values()){(m=k.rowEditStyleFeature)==null||m.applyRowStyles();for(const E of k.getAllCellCtrls())(v=E.tooltipFeature)==null||v.refreshTooltip(!0),(C=E.editorTooltipFeature)==null||C.refreshTooltip(!0),(w=(x=E.editStyleFeature)==null?void 0:x.applyCellStyles)==null||w.call(x)}}var ZL=e=>{var s,i,o;const t=new GL,r=e.gos.get("getFullRowEditValidationErrors"),n=(s=e.editModelSvc)==null?void 0:s.getEditMap();if(!n)return t;for(const a of n.keys()){const l=n.get(a);if(!l)continue;const c=[],{rowIndex:u,rowPinned:h}=a;for(const f of l.keys()){const p=l.get(f);if(!p)continue;const{editorValue:g,pendingValue:m,sourceValue:v}=p,C=(i=g!=null?g:m===zS?void 0:m)!=null?i:v;c.push({column:f,colId:f.getColId(),rowIndex:u,rowPinned:h,oldValue:v,newValue:C})}const d=(o=r==null?void 0:r({editorsState:c}))!=null?o:[];d.length>0&&t.setRowValidation({rowNode:a},{errorMessages:d})}return t};function qL(e,t,r,{rowNode:n,column:s},i){return ot(e.gos,{type:r,node:n,data:n.data,value:i,column:s,colDef:s.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function JL(e,t=!1){return e===ve.DELETE?!0:!t&&e===ve.BACKSPACE?Zy():!1}var eM=class extends we{constructor(e,t,r,n){super(),this.cellCtrl=e,this.rowNode=r,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case ve.ENTER:this.onEnterKeyDown(e);break;case ve.F2:this.onF2KeyDown(e);break;case ve.ESCAPE:this.onEscapeKeyDown(e);break;case ve.TAB:this.onTabKeyDown(e);break;case ve.BACKSPACE:case ve.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case ve.DOWN:case ve.UP:case ve.RIGHT:case ve.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){var s,i;const{cellCtrl:r,beans:n}=this;if(!((s=n.editSvc)!=null&&s.isEditing(r,{withOpenEditor:!0}))){if(e.shiftKey&&r.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const o=r.getFocusedCellPosition();(i=n.navigation)==null||i.navigateToNextCell(e,t,o,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:r}=this.beans;if(!t)return;const n=t.extendLatestRangeInDirection(e);!n||(e.key===ve.LEFT||e.key===ve.RIGHT?r==null||r.ensureColumnVisible(n.column):r==null||r.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){var t;(t=this.beans.navigation)==null||t.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){var c;const{cellCtrl:r,beans:n,rowNode:s}=this,{gos:i,rangeSvc:o,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),JL(e,i.get("enableCellEditingOnBackspace"))&&!(l!=null&&l.isEditing(r,{withOpenEditor:!0}))){if(o&&Fl(i))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const{column:u}=r,h=this.beans.valueSvc.getDeleteValue(u,s);s.setDataValue(u,h,"cellClear")}}else l!=null&&l.isEditing(r,{withOpenEditor:!0})||(c=n.editSvc)==null||c.startEditing(r,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){var c;const{cellCtrl:t,beans:r}=this,{editSvc:n,navigation:s}=r,i=n==null?void 0:n.isEditing(t,{withOpenEditor:!0}),o=t.rowNode,a=n==null?void 0:n.isRowEditing(o,{withOpenEditor:!0}),l=u=>{(n==null?void 0:n.startEditing(u,{startedEdit:!0,event:e,source:"edit"}))&&e.preventDefault()};if(i||a){if(this.isCtrlEnter(e)){n==null||n.applyBulkEdit(t,((c=r==null?void 0:r.rangeSvc)==null?void 0:c.getCellRanges())||[]);return}if(L0(r),(n==null?void 0:n.checkNavWithValidation(void 0,e))==="block-stop")return;n!=null&&n.isEditing(t,{withOpenEditor:!0})?n==null||n.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n==null||n.stopEditing({rowNode:o},{event:e,source:"edit"}):l(t)}else if(r.gos.get("enterNavigatesVertically")){const u=e.shiftKey?ve.UP:ve.DOWN;s==null||s.navigateToNextCell(null,u,t.cellPosition,!1)}else{if(n!=null&&n.hasValidationErrors())return;n!=null&&n.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===ve.ENTER}onF2KeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;(r==null?void 0:r.isEditing())&&(L0(this.beans),(r==null?void 0:r.checkNavWithValidation(void 0,e))==="block-stop")||r==null||r.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;(r==null?void 0:r.checkNavWithValidation(t,e))==="block-stop"&&r.revertSingleCellEdit(t),r==null||r.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){var o;const r=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:s}=this;if(r||n!=null&&n.isEditing(s,{withOpenEditor:!0}))return;if(e.key===ve.SPACE)this.onSpaceKeyDown(e);else if(n!=null&&n.isCellEditable(s,"ui")){if((n==null?void 0:n.hasValidationErrors())&&!(n!=null&&n.hasValidationErrors(s)))return;n==null||n.startEditing(s,{startedEdit:!0,event:e,source:"api"});const a=s.editCompDetails;!((o=a==null?void 0:a.params)!=null&&o.suppressPreventDefault)&&e.preventDefault()}}onSpaceKeyDown(e){var s;const{gos:t,editSvc:r}=this.beans,{rowNode:n}=this.cellCtrl;!(r!=null&&r.isEditing(this.cellCtrl,{withOpenEditor:!0}))&&Ly(t)&&((s=this.beans.selectionSvc)==null||s.handleSelectionEvent(e,n,"spaceKey")),e.preventDefault()}},tM=class extends we{constructor(e,t,r){super(),this.cellCtrl=e,this.column=r,this.beans=t}onMouseEvent(e,t){if(!Ys(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){var g,m,v;if((g=this.beans.touchSvc)!=null&&g.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:r,editSvc:n,editModelSvc:s,frameworkOverrides:i,gos:o}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:u,rowNode:h}=l,d=du(o,c,h,e);r&&a&&!d&&r.getCellRangeCount(u)>1&&r.intersectLastRange(!0);const f=l.createEvent(e,"cellClicked");f.isEventHandlingSuppressed=d,t.dispatchEvent(f);const p=c.getColDef();if(p.onCellClicked&&window.setTimeout(()=>{i.wrapOutgoing(()=>{p.onCellClicked(f)})},0),!d&&(s==null?void 0:s.getState(l))!=="editing"){const C=n==null?void 0:n.isEditing(),x=(m=s==null?void 0:s.getCellValidationModel().getCellValidationMap().size)!=null?m:0,w=(v=s==null?void 0:s.getRowValidationModel().getRowValidationMap().size)!=null?v:0;if(C&&(x>0||w>0))return;n!=null&&n.shouldStartEditing(l,e)?n==null||n.startEditing(l,{event:e}):n!=null&&n.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n==null||n.stopEditing(l,{event:e,source:"edit"}):n==null||n.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){var d,f;const{column:t,beans:r,cellCtrl:n}=this,{eventSvc:s,frameworkOverrides:i,editSvc:o,editModelSvc:a,gos:l}=r,c=du(l,n.column,n.rowNode,e),u=t.getColDef(),h=n.createEvent(e,"cellDoubleClicked");if(h.isEventHandlingSuppressed=c,s.dispatchEvent(h),typeof u.onCellDoubleClicked=="function"&&window.setTimeout(()=>{i.wrapOutgoing(()=>{u.onCellDoubleClicked(h)})},0),!c&&(o==null?void 0:o.shouldStartEditing(n,e))&&(a==null?void 0:a.getState(n))!=="editing"){const p=o==null?void 0:o.isEditing(),g=(d=a==null?void 0:a.getCellValidationModel().getCellValidationMap().size)!=null?d:0,m=(f=a==null?void 0:a.getRowValidationModel().getRowValidationMap().size)!=null?f:0;if(p&&(g>0||m>0))return;o==null||o.startEditing(n,{event:e})}}onMouseDown(e){const{ctrlKey:t,metaKey:r,shiftKey:n}=e,s=e.target,{cellCtrl:i,beans:o}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:c,focusSvc:u,gos:h,editSvc:d}=o,{column:f,rowNode:p,cellPosition:g}=i,m=du(h,f,p,e),v=()=>{const k=i.createEvent(e,"cellMouseDown");k.isEventHandlingSuppressed=m,a.dispatchEvent(k)};if(m){v();return}if(this.isRightClickInExistingRange(e))return;const C=l&&!l.isEmpty(),x=this.containsWidget(s),w=Io(f);if(c&&w&&!c.handleMouseDownOnCell(g,e)){l&&e.preventDefault(),e.stopImmediatePropagation();return}if(!n||!C){const k=d==null?void 0:d.isEditing(i),y=h.get("enableCellTextSelection")&&e.defaultPrevented,R=(tp()||y)&&!k&&!Xa(s)&&!x;i.focusCell(R,e)}if(n&&C&&!u.isCellFocused(g)){e.preventDefault();const k=u.getFocusedCell();if(k){const{column:E,rowIndex:y,rowPinned:R}=k;d!=null&&d.isEditing(k)&&(d==null||d.stopEditing(k)),u.setFocusedCell({column:E,rowIndex:y,rowPinned:R,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!x){if(l){w&&e.preventDefault();const k=Dv(o,e)&&w;if(n)l.extendLatestRangeToCell(g);else if(!k){const E=t||r;l.setRangeToCell(g,E)}}v()}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=Dv(this.beans,e);if(r&&n)return!0}return!1}containsWidget(e){return Po(e,"ag-selection-checkbox",3)||Po(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),r==null||r.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),r==null||r.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,r=t.contains(e.target),n=t.contains(e.relatedTarget);return r&&n}},rM=class extends we{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){const t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();jh(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,r=e.getColSpan(t),n=[];if(r===1)n.push(e);else{let s=e;const i=e.getPinned();for(let o=0;s&&o<r&&(n.push(s),s=this.beans.visibleCols.getColAfter(s),!(!s||Jt(s)||i!==s.getPinned()));o++);}return n}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=ct(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,r=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const n=t.bodyWidth;return r+n+(e||0)}return r+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const r=Oy(this.beans)*this.rowSpan;this.eContent.style.height=`${r}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},nM="ag-cell",sM="ag-cell-auto-height",iM="ag-cell-normal-height",oM="ag-cell-focus",aM="ag-cell-first-right-pinned",lM="ag-cell-last-left-pinned",cM="ag-cell-not-inline-editing",uM="ag-cell-wrap-text",hM=0,pu=class extends we{constructor(e,t,r,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=r,this.gos=r.gos,this.editSvc=r.editSvc,this.hasEdit=!!r.editSvc;const{colId:s}=e;this.instanceId=s+"-"+hM++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){var n,s;const{beans:e}=this;this.positionFeature=new rM(this,e),this.customStyleFeature=(n=e.cellStyles)==null?void 0:n.createCellCustomStyleFeature(this,e),this.editStyleFeature=(s=e.editSvc)==null?void 0:s.createCellStyleFeature(this,e),this.mouseListener=new tM(this,e,this.column),this.keyboardListener=new eM(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();const{rangeSvc:t}=e;t&&Fl(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),Io(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){var r;this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){var t;this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=(t=this.beans.tooltipSvc)==null?void 0:t.setupCellEditorTooltip(this,e),L0(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,r,n,s,i,o){var a,l,c,u,h,d,f,p,g;if(this.comp=e,this.eGui=t,this.printLayout=s,o!=null||(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(a=this.positionFeature)==null||a.init(),(l=this.customStyleFeature)==null||l.setComp(e),(c=this.editStyleFeature)==null||c.setComp(e),(u=this.tooltipFeature)==null||u.refreshTooltip(),(h=this.keyboardListener)==null||h.init(),(d=this.rangeFeature)==null||d.setComp(e),(f=this.rowResizeFeature)==null||f.refreshRowResizer(),i&&this.isCellEditable()||this.hasEdit&&((p=this.editSvc)==null?void 0:p.isEditing(this,{withOpenEditor:!0}))?(g=this.editSvc)==null||g.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(const m of this.onCompAttachedFuncs)m();this.onCompAttachedFuncs=[]}}setupAutoHeight(e,t){var r,n;this.isAutoHeight=(n=(r=this.beans.rowAutoHeight)==null?void 0:r.setupCellAutoHeight(this,e,t))!=null?n:!1}getCellAriaRole(){var e;return(e=this.column.getColDef().cellAriaRole)!=null?e:"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){var e;return(e=this.valueFormatted)!=null?e:this.value}getDeferLoadingCellRenderer(){var l,c;const{beans:e,column:t}=this,{userCompFactory:r,ctrlsSvc:n,eventSvc:s}=e,i=t.getColDef(),o=this.createCellRendererParams();o.deferRender=!0;const a=Nv(r,i,o);if((c=(l=n.getGridBodyCtrl())==null?void 0:l.scrollFeature)!=null&&c.isScrolling()){let u;const h=new Tr(f=>{u=f}),[d]=this.addManagedListeners(s,{bodyScrollEnd:()=>{u(),d()}});return{loadingComp:a,onReady:h}}return{loadingComp:a,onReady:Tr.resolve()}}showValue(e,t){var h,d,f,p;const{beans:r,column:n,rowNode:s,rangeFeature:i}=this,{userCompFactory:o}=r;let a=this.getValueToDisplay(),l;const c=s.stub&&((h=s.groupData)==null?void 0:h[n.getId()])==null,u=n.getColDef();if(c||this.isCellRenderer()){const g=this.createCellRendererParams();!c||Io(n)?l=Ov(o,u,g):l=Nv(o,u,g)}if(!l&&!c&&((d=r.findSvc)==null?void 0:d.isMatch(s,n))){const g=this.createCellRendererParams();l=Ov(o,{...n.getColDef(),cellRenderer:"agFindCellRenderer"},g)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(s,{checkSiblings:!0})){const g=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});g&&(g.compDetails?l=g.compDetails:g.valueToDisplay&&(a=g.valueToDisplay))}this.comp.setRenderDetails(l,a,e),(f=this.customRowDragComp)==null||f.refreshVisibility(),!t&&i&&ai(r,()=>i==null?void 0:i.refreshHandle()),(p=this.rowResizeFeature)==null||p.refreshRowResizer()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){const e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer";let r="";return t&&(r=" ag-allow-overflow"),`${e}${r}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&_P(this.rowNode))&&!!e}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:r}=this.beans.gridOptions,n=f_(t),s=ep(this.column);return r==="custom"&&n!=="selectionColumn"&&s?!1:e.checkboxSelection||s&&typeof t=="object"&&d_(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),r=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),s=this.isAutoHeight!=this.column.isAutoHeight();return t||r||n||s}onPopupEditorClosed(){const{editSvc:e}=this.beans;!(e!=null&&e.isEditing(this,{withOpenEditor:!0}))||e==null||e.stopEditing(this,{source:e!=null&&e.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){var r;const{editSvc:t}=this.beans;return(r=t==null?void 0:t.stopEditing(this,{cancel:e,source:t!=null&&t.isBatchEditing()?"ui":"api"}))!=null?r:!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:r,rowNode:n,comp:s,eGui:i,beans:{valueSvc:o,gos:a,editSvc:l}}=this;return ot(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay(r,n).value,setValue:u=>(l==null?void 0:l.setDataValue({rowNode:n,column:r},u))||n.setDataValue(r,u),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:r.getPinned(),colDef:r.getColDef(),column:r,refreshCell:this.refreshCell.bind(this),eGridCell:i,eParentOfValue:s.getParentOfValue(),registerRowDragger:(u,h,d,f)=>this.registerRowDragger(u,h,f),setTooltip:(u,h)=>{var d;a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(u,h),(d=this.tooltipFeature)==null||d.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){var t;if(this.refreshShouldDestroy()?(t=this.rowCtrl)==null||t.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){const{editSvc:r,comp:n}=this;!(n!=null&&n.getCellEditor())&&r.isEditing(this,{withOpenEditor:!0})&&r.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:r}={}){var k;const{editStyleFeature:n,customStyleFeature:s,rowCtrl:{rowEditStyleFeature:i},beans:{cellFlashSvc:o,filterManager:a},column:l,comp:c,suppressRefreshCell:u,tooltipFeature:h}=this;if(u)return;const{field:d,valueGetter:f,showRowGroup:p,enableCellChangeFlash:g}=l.getColDef(),m=d==null&&f==null&&p==null,v=e||m||r,C=!!c,x=this.updateAndFormatValue(C),w=v||x;if(!!C){if(w){this.showValue(!!r,!1);const E=a==null?void 0:a.isSuppressFlashingCellsBecauseFiltering();!t&&!E&&g&&(o==null||o.flashCell(this)),(k=n==null?void 0:n.applyCellStyles)==null||k.call(n),s==null||s.applyUserStyles(),s==null||s.applyClassesFromColDef(),i==null||i.applyRowStyles()}h==null||h.refreshTooltip(),s==null||s.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){var t;return(t=this.callValueFormatter(e))!=null?t:e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,r=this.valueFormatted,{value:n,valueFormatted:s}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=n,this.valueFormatted=s,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=r:!0}valuesAreEqual(e,t){const r=this.column.getColDef();return r.equals?r.equals(e,t):e===t}addDomData(e){const t=this.eGui;Ko(this.beans.gos,t,ih,this),e.addDestroyFunc(()=>Ko(this.beans.gos,t,ih,null))}createEvent(e,t){const{rowNode:r,column:n,value:s,beans:i}=this;return qL(i,e,t,{rowNode:r,column:n},s)}processCharacter(e){var t;(t=this.keyboardListener)==null||t.processCharacter(e)}onKeyDown(e){var t;(t=this.keyboardListener)==null||t.onKeyDown(e)}onMouseEvent(e,t){var r;(r=this.mouseListener)==null||r.onMouseEvent(e,t)}getColSpanningList(){var e,t;return(t=(e=this.positionFeature)==null?void 0:e.getColSpanningList())!=null?t:[]}onLeftChanged(){var e;!this.comp||(e=this.positionFeature)==null||e.onLeftChanged()}onDisplayedColumnsChanged(){!this.eGui||(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:r}=this;wS(e,t,r.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);uy(this.eGui,e)}onWidthChanged(){var e;return(e=this.positionFeature)==null?void 0:e.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){var e;!this.comp||(e=this.rangeFeature)==null||e.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){var e;!this.comp||(e=this.rangeFeature)==null||e.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){var n;const r=(n=this.editSvc)==null?void 0:n.allowedFocusTargetOnValidation(this);r&&r!==this||this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e,sourceEvent:t})}restoreFocus(e=!1){const{beans:{editSvc:t,focusSvc:r},comp:n}=this;if(!n||(t==null?void 0:t.isEditing(this))||!this.isCellFocused()||!r.shouldTakeFocus())return;const s=()=>{if(!this.isAlive())return;const i=n.getFocusableElement();this.isCellFocused()&&i.focus({preventScroll:!0})};if(e){setTimeout(s,0);return}s()}onRowIndexChanged(){var e,t;this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),(e=this.rangeFeature)==null||e.onCellSelectionChanged(),(t=this.rowResizeFeature)==null||t.refreshRowResizer()}onSuppressCellFocusChanged(e){const t=this.eGui;!t||(Io(this.column)&&(e=!0),wi(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.toggleCss(aM,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.toggleCss(lM,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){var e;this.restoreFocus(!0),this.onCellFocused((e=this.focusEventWhileNotReady)!=null?e:void 0)}onCellFocused(e){var s,i;const{beans:t}=this;if(lp(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const r=this.isCellFocused(),n=(i=(s=t.editSvc)==null?void 0:s.isEditing(this))!=null?i:!1;if(this.comp.toggleCss(oM,r),r&&(e==null?void 0:e.forceBrowserFocus)){let o=this.comp.getFocusableElement();if(n){const a=Lo(o,null,!0);a.length&&(o=a[0])}o.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}r&&e&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:bi(t),column:this.column}}applyStaticCssClasses(){const{comp:e}=this;e.toggleCss(nM,!0),e.toggleCss(cM,!0);const t=this.column.isAutoHeight()==!0;e.toggleCss(sM,t),e.toggleCss(iM,!t)}onColumnHover(){var e;(e=this.beans.colHover)==null||e.onCellColumnHover(this.column,this.comp)}onColDefChanged(){var e,t;!this.comp||(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),(e=this.editSvc)!=null&&e.isEditing(this)?(t=this.editSvc)==null||t.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(uM,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),r=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(r),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(r)})},0)}getCellRenderer(){var e,t;return(t=(e=this.comp)==null?void 0:e.getCellRenderer())!=null?t:null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){var e,t;return(t=(e=this.eGui)==null?void 0:e.contains(xr(this.beans)))!=null?t:!1}createSelectionCheckbox(){var t;const e=(t=this.beans.selectionSvc)==null?void 0:t.createCheckboxSelectionComponent();if(!!e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,r){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const n=this.createRowDragComp(e,t,r);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,r){var s;const n=(s=this.beans.rowDragSvc)==null?void 0:s.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,r);if(!!n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(const e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function c1(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var dM=0,M0=class extends we{constructor(e,t,r,n,s){var i,o,a;super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=s,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=(o=(i=t.pagination)==null?void 0:i.getCurrentPage())!=null?o:0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+dM++,this.rowId=Ka(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=c1(this.rowNode),this.setRowType(),this.setAnimateFlags(r),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=(a=t.editSvc)==null?void 0:a.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Ka(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,r,n){var h,d;const{context:s,focusSvc:i}=this.beans;n=Kh(this,s,n);const o={rowComp:e,element:t,containerType:r,compBean:n};this.allRowGuis.push(o),this.updateGui(r,o),this.initialiseRowComp(o);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const u=(h=this.fullWidthGui)==null?void 0:h.element;u&&!((d=this.beans.editSvc)==null?void 0:d.isEditing(this))&&i.isRowFocused(a.rowIndex,a.rowPinned)&&i.shouldTakeFocus()&&setTimeout(()=>u.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";for(const r of this.allRowGuis)r.element.style.display=t}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),Ly(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(const s of n)r.toggleCss(s,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&CR(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),Ko(t,e.element,oh,this),e.compBean.addDestroyFunc(()=>Ko(t,e.element,oh,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{!this.isAlive()||e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Ka(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(w0(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(w0(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){var n;const t=(n=this.beans.rowDragSvc)==null?void 0:n.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const r=this.createBean(t,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(s=>s!==r),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(r,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),r=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(r)}getFullWidthCellRenderers(){var e,t;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(r=>{var n;return(n=r==null?void 0:r.rowComp)==null?void 0:n.getFullWidthCellRenderer()}):[(t=(e=this.fullWidthGui)==null?void 0:e.rowComp)==null?void 0:t.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:r,beans:{visibleCols:n}}=this,s=!!e||!n.isPinningLeft(),i=!!t,o=!!r||!n.isPinningRight();return s&&i&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),r=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),s=h_(this.gos,this.rowNode,n);e?this.rowType="FullWidthLoading":r?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":s?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:r}=this.beans;if(!(r!=null&&r.active)||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(r.createTask(()=>{!this.active||this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){var r;if(!((r=this.beans.rowSpanSvc)==null?void 0:r.isCellSpanning(e,this.rowNode)))return new pu(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){var t;return!((t=this.beans.rowSpanSvc)!=null&&t.isCellSpanning(e.column,this.rowNode))}createCellCtrls(e,t,r=null){const n={list:[],map:{}},s=(c,u,h)=>{h!=null?n.list.splice(h,0,u):n.list.push(u),n.map[c]=u},i=[];for(const c of t){const u=c.getInstanceId();let h=e.map[u];h&&!this.isCorrectCtrlForSpan(h)&&(h.destroy(),h=void 0),h||(h=this.getNewCellCtrl(c)),h&&s(u,h)}for(const c of e.list){const u=c.column.getInstanceId();if(n.map[u]!=null)continue;!this.isCellEligibleToBeRemoved(c,r)?i.push([u,c]):c.destroy()}if(i.length)for(const[c,u]of i){const h=n.list.findIndex(f=>f.column.getLeft()>u.column.getLeft()),d=h===-1?void 0:Math.max(h-1,0);s(c,u,d)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==r){const c=l.column.getInstanceId();if(!n.map[c]&&a.allCols.includes(l.column)){const h=this.createFocusedCellCtrl();if(h){const d=n.list.findIndex(p=>p.column.getLeft()>h.column.getLeft()),f=d===-1?void 0:Math.max(d-1,0);s(c,h,f)}}}return n}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,r=e.getFocusedCell();if(!r)return;const n=t==null?void 0:t.getCellSpan(r.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(r))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(r.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(const t of this.allRowGuis){const r=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(r,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const r=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);const n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");const s=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,s,"right")}}isCellEligibleToBeRemoved(e,t){const{column:s}=e;if(s.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{visibleCols:i,editSvc:o}=this.beans,a=o==null?void 0:o.isEditing(e),l=e.isCellFocused();return a||l?!(i.allCols.indexOf(s)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Fr(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=Be(this.rowNode.oldRowTop),{visibleCols:r}=this.beans,n=r.isPinningLeft(),s=r.isPinningRight();if(t){const{slideInAnimation:i}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){i.fullWidth=!0;return}i.center=!0,i.left=n,i.right=s}else{const{fadeInAnimation:i}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){i.fullWidth=!0;return}i.center=!0,i.left=n,i.right=s}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),r=e(this.centerGui,null),n=e(this.leftGui,"left"),s=e(this.rightGui,"right");return t&&r&&n&&s}addListeners(){var a;const{beans:e,gos:t,rowNode:r}=this,{expansionSvc:n,eventSvc:s,context:i,rowSpanSvc:o}=e;this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...(a=n==null?void 0:n.getRowExpandedListeners(this))!=null?a:{}}),r.detail&&this.addManagedListeners(r.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(r,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(s,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),o&&this.addManagedListeners(o,{spannedCellsUpdated:({pinned:l})=>{l&&!r.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,i),this.tooltipFeature=this.destroyBean(this.tooltipFeature,i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,i)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(const c of this.allRowGuis)this.addRowDraggerToRow(c);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,i)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(const e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(const t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(const e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(const r of this.getAllCellCtrls())r.refreshCell(e);for(const r of this.allRowGuis)this.setRowCompRowId(r.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(r.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){var e;this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),(e=this.rowEditStyleFeature)==null||e.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.beans.rowDropHighlightSvc,t=(e==null?void 0:e.row)===this.rowNode?e.position:"none",r=t==="above",n=t==="inside",s=t==="below",o=this.gos.get("treeData")&&(s||r),a=this.rowNode.uiLevel.toString();for(const l of this.allRowGuis){const c=l.rowComp;c.toggleCss("ag-row-highlight-above",r),c.toggleCss("ag-row-highlight-inside",n),c.toggleCss("ag-row-highlight-below",s),c.toggleCss("ag-row-highlight-indent",o),o?l.element.style.setProperty("--ag-row-highlight-level",a):l.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){const e=this.rowNode.dragging;for(const t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){var e;this.updateColumnLists(!0),(e=this.beans.rowAutoHeight)==null||e.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:bi(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){var h;const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:r,column:n}=t;if(!(r.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),u={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:(h=c==null?void 0:c.column)!=null?h:n};l==null||l.navigateToNextCell(e,e.key,u,!0),e.preventDefault()}onTabKeyDown(e){var a;if(e.defaultPrevented||Ys(e))return;const t=this.allRowGuis.find(l=>l.element.contains(e.target)),r=t?t.element:null,n=r===e.target,s=xr(this.beans);let i=!1;r&&s&&(i=r.contains(s)&&s.classList.contains("ag-cell"));let o=null;!n&&!i&&(o=Xh(this.beans,r,!1,e.shiftKey)),(this.isFullWidth()&&n||!o)&&((a=this.beans.navigation)==null||a.onTabKeyDown(this,e))}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var t;const e=(t=this.allRowGuis.find(r=>sa(r.element)))==null?void 0:t.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(const r of this.allRowGuis)wi(r.element,"tabindex",t)}onFullWidthRowFocused(e){var s,i,o;const t=this.rowNode,r=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{const a=this.beans.colModel.getCol(e==null?void 0:e.column),l=a==null?void 0:a.pinned;l?n=l==="right"?(s=this.rightGui)==null?void 0:s.element:(i=this.leftGui)==null?void 0:i.element:n=(o=this.centerGui)==null?void 0:o.element}!n||(n.classList.toggle("ag-full-width-focus",r),r&&(e==null?void 0:e.forceBrowserFocus)&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const r={list:[],map:{}};for(const n of e.list)n!==t&&(r.list.push(n),r.map[n.column.getInstanceId()]=n);return r}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:r}=this;return ot(this.gos,{type:e,node:r,data:r.data,rowIndex:r.rowIndex,rowPinned:r.rowPinned,event:t})}createRowEventWithSource(e,t){const r=this.createRowEvent(e,t);return r.source=this,r}onRowDblClick(e){if(Ys(e))return;const t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),r=this.getColumnForFullWidth(t);if(!(!t||!r))return{rowGui:t,column:r}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e==null?void 0:e.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Po(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;const{rangeSvc:t,focusSvc:r}=this.beans;t==null||t.removeAllCellRanges();const n=this.findFullWidthInfoForEvent(e);if(!n)return;const{rowGui:s,column:i}=n,o=s.element,a=e.target,l=this.rowNode;let c=e.defaultPrevented||tp();o&&o.contains(a)&&Xa(a)&&(c=!1),r.setFocusedCell({rowIndex:l.rowIndex,column:i,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){const{gos:t,rowNode:r}=this;if(this.isFullWidth()){const s=this.findFullWidthRowGui(e.target);return TA(t,s==null?void 0:s.rowComp.getFullWidthCellRendererParams(),r,e)}const n=ap(t,e.target);return n!=null&&du(t,n.column,r,e)}onRowClick(e){if(Ys(e)||this.lastMouseDownOnDragger)return;const r=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:s}=this.beans,i=this.createRowEventWithSource("rowClicked",e);i.isEventHandlingSuppressed=r,n.dispatchEvent(i),!r&&(s==null||s.handleSelectionEvent(e,this.rowNode,"rowClicked"))}setupDetailRowAutoHeight(e){var t;this.rowType==="FullWidthDetail"&&((t=this.beans.masterDetailSvc)==null||t.setupDetailRowAutoHeight(this,e))}createFullWidthCompDetails(e,t){const{gos:r,rowNode:n}=this,s=ot(r,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,l,c)=>this.addFullWidthRowDragging(o,a,l,c),setTooltip:(o,a)=>{r.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(o,a)}}),i=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return xD(i,s);case"FullWidthGroup":{const{value:o,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return s.value=o,s.valueFormatted=a,vD(i,s)}case"FullWidthLoading":return mD(i,s);default:return pD(i,s)}}setupFullWidthRowTooltip(e,t){var r;!this.fullWidthGui||(this.tooltipFeature=(r=this.beans.tooltipSvc)==null?void 0:r.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,r="",n){const{rowDragSvc:s,context:i}=this.beans;if(!s||!this.isFullWidth())return;const o=s.createRowDragComp(()=>r,this.rowNode,void 0,e,t,n);this.createBean(o,i),this.addDestroyFunc(()=>{this.destroyBean(o,i)})}onUiLevelChanged(){const e=c1(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,r="ag-row-level-"+this.rowLevel;for(const n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(r,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){var t;const e=[];if((t=this.beans.rowStyleSvc)==null||t.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(const r of e)for(const n of this.allRowGuis)n.rowComp.toggleCss(r,!0)}postProcessRowClassRules(){var e;(e=this.beans.rowStyleSvc)==null||e.processRowClassRules(this.rowNode,t=>{for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!0)},t=>{for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,r=>r.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){var a,l;const t=this.getPinnedForContainer(e),r=this.isFullWidth(),{rowNode:n,beans:s}=this,i=[];i.push("ag-row"),i.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&i.push("ag-opacity-zero"),i.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(i.push("ag-row-pinned"),(a=s.pinnedRowModel)!=null&&a.isManual()&&i.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&i.push("ag-row-pinned-source"),n.isSelected()&&i.push("ag-row-selected"),n.footer&&i.push("ag-row-footer"),i.push("ag-row-level-"+this.rowLevel),n.stub&&i.push("ag-row-loading"),r&&i.push("ag-full-width-row"),(l=s.expansionSvc)==null||l.addExpandedCss(i,n),n.dragging&&i.push("ag-row-dragging");const{rowStyleSvc:o}=s;return o&&(o.processClassesFromGridOptions(i,n),o.preProcessRowClassRules(i,n)),i.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&i.push("ag-row-first"),this.isLastRowOnPage()&&i.push("ag-row-last"),r&&(t==="left"&&i.push("ag-cell-last-left-pinned"),t==="right"&&i.push("ag-cell-first-right-pinned")),i}processStylesFromGridOptions(){var e,t;return(t=(e=this.beans.rowStyleSvc)==null?void 0:e.processStylesFromGridOptions(this.rowNode))!=null?t:this.emptyStyle}onRowSelected(e){var t;(t=this.beans.selectionSvc)==null||t.onRowCtrlSelected(this,r=>{(r===this.centerGui||r===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){var e;(e=this.beans.selectionSvc)==null||e.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:r}=e,{rowNode:n,beans:s,gos:i}=this;r.addManagedListeners(t,{pointerenter:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),r.addManagedListeners(n,{mouseEnter:()=>{var o;!((o=s.dragSvc)!=null&&o.dragging)&&!i.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(r=>r.element);for(const r of t)r.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),r=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(r,e),n)}forEachGui(e,t){if(e)t(e);else for(const r of this.allRowGuis)t(r)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,r=this.beans.environment.getDefaultRowHeight(),s=My(this.gos)?c_(this.beans,this.rowNode).height:void 0,i=s?`${Math.min(r,s)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,i&&o.element.style.setProperty("--ag-line-height",i)})}destroyFirstPass(e=!1){var n;this.active=!1;const{rowNode:t}=this;if(!e&&Jg(this.gos)&&!t.sticky)if(t.rowTop!=null){const i=this.roundRowTopToBounds(t.rowTop);this.setRowTop(i)}else for(const i of this.allRowGuis)i.rowComp.toggleCss("ag-opacity-zero",!0);(n=this.fullWidthGui)!=null&&n.element.contains(xr(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventSvc.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;const e=t=>{for(const r of t.list)r.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){var t,r;const e=(r=(t=this.beans.pagination)==null?void 0:t.getCurrentPage())!=null?r:0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const r=this.beans.pageBounds.getPixelOffset();return e+r*(t?1:-1)}setRowTop(e){if(!this.printLayout&&Be(e)){const t=this.applyPaginationOffset(e),s=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(s)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let r;if(t.sticky)r=t.stickyRowTop;else{const n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,s=this.applyPaginationOffset(n);r=t.isRowPinned()?s:this.beans.rowContainerHeight.getRealPixelPosition(s)}return r+"px"}setRowTopStyle(e){for(const t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let r=null;for(const n of this.getAllCellCtrls())n.column==e&&(r=n);if(r!=null||t)return r;for(const n of this.getAllCellCtrls())(n==null?void 0:n.getColSpanningList().indexOf(e))>=0&&(r=n);return r}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){var i,o,a,l;const t=this.rowNode.getRowIndexString();if(t===null)return;const r=((o=(i=this.beans.ctrlsSvc.getHeaderRowContainerCtrl())==null?void 0:i.getRowCount())!=null?o:0)+((l=(a=this.beans.filterManager)==null?void 0:a.getHeaderRowCount())!=null?l:0),n=this.rowNode.rowIndex%2===0,s=r+this.rowNode.rowIndex+1;this.forEachGui(e,c=>{c.rowComp.setRowIndex(t),c.rowComp.toggleCss("ag-row-even",n),c.rowComp.toggleCss("ag-row-odd",!n),yR(c.element,s)})}},fM=class extends we{constructor(){super(),this.beanName="navigation",this.onPageDown=Fv(this.onPageDown,100),this.onPageUp=Fv(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,n=e.altKey,s=e.ctrlKey||e.metaKey,i=!!this.beans.rangeSvc&&e.shiftKey,o=eP(this.gos,e);let a=!1;switch(r){case ve.PAGE_HOME:case ve.PAGE_END:!s&&!n&&(this.onHomeOrEndKey(r),a=!0);break;case ve.LEFT:case ve.RIGHT:case ve.UP:case ve.DOWN:if(!o)return!1;s&&!n&&!i&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case ve.PAGE_DOWN:case ve.PAGE_UP:!s&&!n&&(a=this.handlePageUpDown(r,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===ve.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:r,focusIndex:n,focusColumn:s,isAsync:i,rowPinned:o}){const{scrollFeature:a}=this.gridBodyCon;Be(r)&&!r.isPinned()&&a.ensureColumnVisible(r),Be(e)&&a.ensureIndexVisible(e,t),i||a.ensureIndexVisible(n);const{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:n,column:s,rowPinned:o,forceBrowserFocus:!0}),c==null||c.setRangeToCell({rowIndex:n,rowPinned:o,column:s})}onPageDown(e){const t=this.beans,r=lf(t),n=this.getViewportHeight(),{pageBounds:s,rowModel:i,rowAutoHeight:o}=t,a=s.getPixelOffset(),l=r.top+n,c=i.getRowIndexAtPixel(l+a);o!=null&&o.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){const t=this.beans,r=lf(t),{pageBounds:n,rowModel:s,rowAutoHeight:i}=t,o=n.getPixelOffset(),a=r.top,l=s.getRowIndexAtPixel(a+o);i!=null&&i.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,r=!1){const{pageBounds:n,rowModel:s}=this.beans,i=this.getViewportHeight(),o=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=s.getRow(e.rowIndex),u=r?(c==null?void 0:c.rowHeight)-i-l:i-l,h=(c==null?void 0:c.rowTop)+u;let d=s.getRowIndexAtPixel(h+l);if(d===e.rowIndex){const p=r?-1:1;t=d=e.rowIndex+p}let f;r?(f="bottom",d<o&&(d=o),t<o&&(t=o)):(f="top",d>a&&(d=a),t>a&&(t=a)),this.isRowTallerThanView(s.getRow(d))&&(t=d,f="top"),this.navigateTo({scrollIndex:t,scrollType:f,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const n=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){var c;const r=t?-1:1,n=this.getViewportHeight(),{pageBounds:s,rowModel:i}=this.beans,o=s.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=o;){const u=i.getRow(l);if(u){const h=(c=u.rowHeight)!=null?c:0;if(a+h>n)break;a+=h}l+=r}return Math.max(0,Math.min(l,o))}getViewportHeight(){const e=this.beans,t=lf(e),r=this.beans.scrollVisibleSvc.getScrollbarWidth();let n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=r),n}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(r),{rowIndex:s,rowPinned:i,column:o}=n!=null?n:r,a=o;this.navigateTo({scrollIndex:s,scrollType:null,scrollColumn:a,focusIndex:s,focusColumn:a,rowPinned:i})}onHomeOrEndKey(e){const t=e===ve.PAGE_HOME,{visibleCols:r,pageBounds:n,rowModel:s}=this.beans,i=r.allCols,o=t?n.getFirstRow():n.getLastRow(),a=s.getRow(o);if(!a)return;const l=(t?i:[...i].reverse()).find(c=>!c.isSuppressNavigable(a));!l||this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const r=t.shiftKey,n=this.tabToNextCellCommon(e,r,t),s=this.beans,{ctrlsSvc:i,pageBounds:o,focusSvc:a,gos:l}=s;if(n!==!1){n?t.preventDefault():n===null&&i.get("gridCtrl").allowFocusForNextCoreContainer(r);return}if(r){const{rowIndex:c,rowPinned:u}=e.getRowPosition();(u?c===0:c===o.getFirstRow())&&(l.get("headerHeight")===0||Fi(s)?Rl(s,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof pu&&e.focusCell(!0),(a.focusOverlay(!1)||Rl(s,r))&&t.preventDefault()}tabToNextCell(e,t){const r=this.beans,{focusSvc:n,rowRenderer:s}=r,i=n.getFocusedCell();if(!i)return!1;let o=Ic(r,i);return!o&&(o=s.getRowByPosition(i),!(o!=null&&o.isFullWidth()))?!1:!!this.tabToNextCellCommon(o,e,t,"api")}tabToNextCellCommon(e,t,r,n="ui"){var l;const{editSvc:s,focusSvc:i}=this.beans;let o;const a=e instanceof pu?e:(l=e.getAllCellCtrls())==null?void 0:l[0];return s!=null&&s.isEditing()?o=s==null?void 0:s.moveToNextCell(a,t,r,n):o=this.moveToNextCellNotEditing(e,t,r),o===null?o:o||!!i.focusedHeader}moveToNextCellNotEditing(e,t,r){const n=this.beans.visibleCols.allCols;let s;if(e instanceof M0){if(s={...e.getRowPosition(),column:t?n[0]:ct(n)},this.gos.get("embedFullWidthRows")&&r){const o=e.findFullWidthInfoForEvent(r);o&&(s.column=o.column)}}else s=e.getFocusedCellPosition();const i=this.findNextCellToFocusOn(s,{backwards:t,startEditing:!1});if(i===!1)return null;if(i instanceof pu)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i,t);return Be(i)}findNextCellToFocusOn(e,{backwards:t,startEditing:r,skipToNextEditableCell:n}){let s=e;const i=this.beans,{cellNavigation:o,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:u}=i;for(;;){e!==s&&(e=s),t||(s=this.getLastCellOfColSpan(s)),s=o.getNextTabbedCell(s,t);const h=a.getCallback("tabToNextCell");if(Be(h)){const g=h({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:s||null});if(g===!0)s=e;else{if(g===!1)return!1;s={rowIndex:g.rowIndex,column:g.column,rowPinned:g.rowPinned}}}if(!s)return null;if(s.rowIndex<0){const p=jn(i);return l.focusHeaderPosition({headerPosition:{headerRowIndex:p+s.rowIndex,column:s.column},fromCell:!0}),null}const d=a.get("editType")==="fullRow";if(r&&(!d||n)&&!this.isCellEditable(s))continue;this.ensureCellVisible(s);const f=Ic(i,s);if(!f){const p=c.getRowByPosition(s);if(!p||!p.isFullWidth()||r)continue;return{...p.getRowPosition(),column:s==null?void 0:s.column}}if(!o.isSuppressNavigable(f.column,f.rowNode))return f.setFocusedCellPosition(s),u==null||u.setRangeToCell(s),f}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:r,rowModel:n}=this.beans;return t==="top"?r==null?void 0:r.getPinnedTopRow(e):t==="bottom"?r==null?void 0:r.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,r,n){let s=r,i=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=o;for(;s&&(s===r||!this.isValidNavigateCell(s));)c.get("enableRtl")?t===ve.LEFT&&(s=this.getLastCellOfColSpan(s)):t===ve.RIGHT&&(s=this.getLastCellOfColSpan(s)),s=a.getNextCellToFocus(t,s),i=Jt(s);if(i&&e&&e.key===ve.UP&&(s={rowIndex:-1,rowPinned:null,column:r.column}),n){const h=c.getCallback("navigateToNextCell");if(Be(h)){const f=h({key:t,previousCellPosition:r,nextCellPosition:s||null,event:e});Be(f)?s={rowPinned:f.rowPinned,rowIndex:f.rowIndex,column:f.column}:s=null}}if(!s)return;if(s.rowIndex<0){const h=jn(o);l.focusHeaderPosition({headerPosition:{headerRowIndex:h+s.rowIndex,column:r.column},event:e||void 0,fromCell:!0});return}const u=this.getNormalisedPosition(s);u?this.focusPosition(u):this.tryToFocusFullWidthRow(s)}getNormalisedPosition(e){var n;if(!!((n=this.beans.spannedRowRenderer)!=null&&n.getCellByPosition(e)))return e;this.ensureCellVisible(e);const r=Ic(this.beans,e);return r?(e=r.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:r,rowRenderer:n,focusSvc:s,eventSvc:i}=this.beans,o=r.allCols,a=n.getRowByPosition(e);if(!(a!=null&&a.isFullWidth()))return!1;const l=s.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?ct(o):o[0])};this.focusPosition(c);const u=t==null?l!=null&&QP(c,l):t;return i.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:u}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:r}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),r==null||r.setRangeToCell(e)}isValidNavigateCell(e){return!!DS(this.beans,e)}getLastCellOfColSpan(e){const t=Ic(this.beans,e);if(!t)return e;const r=t.getColSpanningList();return r.length===1?e:{rowIndex:e.rowIndex,column:ct(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=By(this.gos),r=this.beans.rowModel.getRow(e.rowIndex),n=t&&(r==null?void 0:r.sticky),{scrollFeature:s}=this.gridBodyCon;!n&&Jt(e.rowPinned)&&s.ensureIndexVisible(e.rowIndex),e.column.isPinned()||s.ensureColumnVisible(e.column)}ensureColumnVisible(e){const t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function lf(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var gM={moduleName:"KeyboardNavigation",version:ut,beans:[fM,LL,sL],apiFunctions:{getFocusedCell:ML,clearFocusedCell:OL,setFocusedCell:NL,setFocusedHeader:WL,tabToNextCell:BL,tabToPreviousCell:HL}},pM=class extends we{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){var t,r,n,s,i;this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:(t=e==null?void 0:e.animate)!=null?t:!1,newData:(r=e==null?void 0:e.newData)!=null?r:!1,newPage:(n=e==null?void 0:e.newPage)!=null?n:!1,newPageSize:(s=e==null?void 0:e.newPageSize)!=null?s:!1,keepRenderedRows:(i=e==null?void 0:e.keepRenderedRows)!=null?i:!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:r}=this.beans;t?t.calculatePages():e.calculateBounds(0,r.getRowCount()-1)}},mM=class extends we{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){var e,t;return(t=(e=this.topRowBounds)==null?void 0:e.rowIndex)!=null?t:-1}getLastRow(){var e,t;return(t=(e=this.bottomRowBounds)==null?void 0:e.rowIndex)!=null?t:-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){var s;const{topRowBounds:e,bottomRowBounds:t}=this,r=(s=e==null?void 0:e.rowTop)!=null?s:0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:r,pageLastPixel:n}}calculateBounds(e,t){const{rowModel:r}=this.beans,n=r.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;const s=r.getRowBounds(t);s&&(s.rowIndex=t),this.bottomRowBounds=s,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){var t,r;const e=(r=(t=this.topRowBounds)==null?void 0:t.rowTop)!=null?r:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},vM=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",xM=class extends we{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const r of this.elements)r&&(Yt(r,t),Xs(r,e))}},CM=class extends we{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:r}=this.beans,n=Fr(e,"print"),s=n?0:t.getColsLeftWidth(),i=n?0:t.getDisplayedColumnsRightWidth();s!=this.leftWidth&&(this.leftWidth=s,r.dispatchEvent({type:"leftPinnedWidthChanged"})),i!=this.rightWidth&&(this.rightWidth=i,r.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=$u(e);if(t<=50)return;const r=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:s,hasLockedPinned:i}=r;let o=s;!o.length&&!i||(n&&(o=n({columns:o,viewportWidth:t})),o!=null&&o.length&&(o=o.filter(a=>!Io(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new xM(e,t)}setColsPinned(e,t,r){const{colModel:n,colAnimation:s,visibleCols:i,gos:o}=this.beans;if(!n.cols||!(e!=null&&e.length))return;if(Fr(o,"print")){Ge(37);return}s==null||s.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];for(const c of e){if(!c)continue;const u=n.getCol(c);!u||u.getPinned()!==a&&(this.setColPinned(u,a),l.push(u))}l.length&&(i.refresh(r),$y(this.eventSvc,l,r)),s==null||s.finish()}initCol(e){const{pinned:t,initialPinned:r}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,r)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const r=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;const s=()=>{const i=r?this.leftWidth:this.rightWidth;if(i==null)return;const o=i==0,a=e.hidden!==o,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),h=t.verticalScrollShowing&&(l&&r||!l&&n)?i+c:i;e.comp.setPinnedContainerWidth(`${h}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:s,rightPinnedWidthChanged:s,scrollVisibilityChanged:s,scrollbarWidthChanged:s})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:n,rightWidth:s}=this,i=$u(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+s+e>i)if(i>n+s)e=i-n-s;else return 0}return e}getPinnedColumnsOverflowingViewport(e){var f,p;const t=(f=this.rightWidth)!=null?f:0,r=(p=this.leftWidth)!=null?p:0,n=t+r;let s=!1;if(n<e)return{columns:[],hasLockedPinned:s};const{visibleCols:i}=this.beans,o=[...i.leftCols],a=[...i.rightCols];let l=0,c=0;const u=0,h=[];let d=n-u-e;for(;(c<o.length||l<a.length)&&d>0;){if(l<a.length){const g=a[l++];if(g.colDef.lockPinned){s=!0;continue}d-=g.getActualWidth(),h.push(g)}if(c<o.length&&d>0){const g=o[c++];if(g.colDef.lockPinned){s=!0;continue}d-=g.getActualWidth(),h.push(g)}}return{columns:h,hasLockedPinned:s}}},wM={moduleName:"PinnedColumn",version:ut,beans:[CM],css:[vM]},yM=class extends we{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=Pa(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=Ln(e),r=this.descriptionContainer=t.createElement("div");r.classList.add("ag-aria-description-container"),ly(r,"polite"),vR(r,"additions text"),mR(r,!0),e.eGridDiv.appendChild(r)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Ql(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},SM={moduleName:"Aria",version:ut,beans:[yM]},kM=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",u1="ag-delay-render",bM=class extends we{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(u1)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;const{renderStatus:t,ctrlsSvc:r}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}r.getGridBodyCtrl().eGridBody.classList.remove(u1),this.alreadyRevealed=!0}},EM={moduleName:"ColumnDelayRender",version:ut,beans:[bM],css:[kM]};function FM(e){var t;(t=e.overlays)==null||t.showLoadingOverlay()}function TM(e){var t;(t=e.overlays)==null||t.showNoRowsOverlay()}function RM(e){var t;(t=e.overlays)==null||t.hideOverlay()}var _M=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",DM={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},jS=class extends ws{constructor(){super(DM),this.eOverlayWrapper=qe,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(_M)}handleKeyDown(e){if(e.key!==ve.TAB||e.defaultPrevented||Ys(e))return;const t=this.beans;if(Xh(t,this.eOverlayWrapper,!1,e.shiftKey))return;let n=!1;e.shiftKey?n=t.focusSvc.focusGridView({column:ct(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):n=Rl(t,!1),n&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:s,PRINT:i}=hu;r.toggle(n,t.autoHeight),r.toggle(s,t.normal),r.toggle(i,t.print)}postConstruct(){this.createManagedBean(new ip(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),r&&this.isGridFocused()){const s=xr(this.beans);s&&!hR(this.beans)&&(this.elToFocusAfter=s)}e.then(s=>{if(this.activePromise!==e){this.activeOverlay!==s&&(this.destroyBean(s),s=null);return}if(this.activePromise=null,!!s){if(this.activeOverlay!==s&&(this.eOverlayWrapper.appendChild(s.getGui()),this.activeOverlay=s,n)){const i=s;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,({currentValue:o})=>{var a;(a=i.refresh)==null||a.call(i,ot(this.gos,{...o!=null?o:{}}))})}r&&this.isGridFocused()&&rh(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){var n;this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const r=this.updateListenerDestroyFunc;r&&(r(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Ql(this.eOverlayWrapper),(n=t==null?void 0:t.focus)==null||n.call(t,{preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=xr(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},AM={selector:"AG-OVERLAY-WRAPPER",component:jS},PM=class extends we{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Uh(this.gos),this.isServerSide=!this.isClientSide&&qg(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){Ge(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return AM}getOverlayWrapperCompClass(){return jS}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}const{state:e,isClientSide:t,isServerSide:r,beans:{gos:n,colModel:s,rowModel:i}}=this;let o=this.gos.get("loading");o!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&o===void 0&&!n.get("suppressLoadingOverlay")&&(o=!n.get("columnDefs")||!s.ready||!n.get("rowData")&&t),o?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&i.isEmpty()&&!n.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!r&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){!this.eWrapper||(this.state=1,this.showOverlay(CD(this.beans.userCompFactory,ot(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){!this.eWrapper||(this.state=2,this.showOverlay(wD(this.beans.userCompFactory,ot(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){!this.eWrapper||(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,r){var s,i;const n=(s=e==null?void 0:e.newAgStackInstance())!=null?s:null;(i=this.eWrapper)==null||i.showOverlay(n,t,this.isExclusive(),r),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;if(this.state===2){const r=this.beans.ctrlsSvc.get("gridHeaderCtrl");t=(r==null?void 0:r.headerHeight)||0}this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},IM={moduleName:"Overlay",version:ut,userComponents:{agLoadingOverlay:CP,agNoRowsOverlay:yP},apiFunctions:{showLoadingOverlay:FM,showNoRowsOverlay:TM,hideOverlay:RM},beans:[PM]},LM=class extends we{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=kD(),Yu(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;Yu(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),r=e/t;return this.maxScrollY*r}},MM=400,OM=class extends we{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{for(const i of this.getAllCellCtrls())i.onCellSelectionChanged()},t=()=>{for(const i of this.getAllCellCtrls())i.updateRangeBordersIfRangeCount()},r=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{Fl(this.gos)?r():n()}),Fl(this.gos)&&r()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:s})=>{(!s&&n||s&&!n)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:r}=this.beans;if(r&&this.addManagedPropertyListener("showOpenedGroup",()=>{const n=r.getShowRowGroupCols();n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Fr(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e!=null?e:3;this.cachedRowCtrls=new NM(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){var e,t;return(t=(e=this.stickyRowFeature)==null?void 0:e.stickyTopRowCtrls)!=null?t:[]}getStickyBottomRowCtrls(){var e,t;return(t=(e=this.stickyRowFeature)==null?void 0:e.stickyBottomRowCtrls)!=null?t:[]}updateAllRowCtrls(){var n,s;const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),r=(s=(n=this.cachedRowCtrls)==null?void 0:n.getEntries())!=null?s:[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}isCellBeingRendered(e,t){var s;const r=this.rowCtrlsByRowIndex[e];return!t||!r?!!r:r.isFullWidth()?!0:!!((s=this.beans.spannedRowRenderer)==null?void 0:s.getCellByPosition({rowIndex:e,column:t,rowPinned:null}))||!!r.getCellCtrl(t)||!r.isRowRendered()}updateCellFocus(e){for(const t of this.getAllCellCtrls())t.onCellFocused(e);for(const t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){var t;if((e==null?void 0:e.rowIndex)!=null&&!e.rowPinned){const r=(t=this.beans.colModel.getCol(e.column))!=null?t:void 0;this.isCellBeingRendered(e.rowIndex,r)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(const t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(const t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;if(t)for(const r of this.getAllCellCtrls())t.onFlashCells(r,e)},columnHoverChanged:()=>{for(const e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(const e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(const e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(const e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.colModel.getCols();for(const t of e){const r=l=>{for(const c of this.getAllCellCtrls())c.column===t&&l(c)},n=()=>{r(l=>l.onLeftChanged())},s=()=>{r(l=>l.onWidthChanged())},i=()=>{r(l=>l.onFirstRightPinnedChanged())},o=()=>{r(l=>l.onLastLeftPinnedChanged())},a=()=>{r(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",s),t.__addEventListener("firstRightPinnedChanged",i),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",s),t.__removeEventListener("firstRightPinnedChanged",i),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){const e=Fr(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){var r;const t=[];for(const n of this.getAllRowCtrls()){const s=(r=n.getCellCtrl(e,!0))==null?void 0:r.eGui;s&&t.push(s)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,r){var l;const{pinnedRowModel:n,beans:s,printLayout:i}=this,o=Object.fromEntries(e.map(c=>[c.rowNode.id,c]));n==null||n.forEachPinnedRow(t,(c,u)=>{const h=e[u];h&&n.getPinnedRowById(h.rowNode.id,t)===void 0&&(h.destroyFirstPass(),h.destroySecondPass()),c.id in o&&r?(e[u]=o[c.id],delete o[c.id]):e[u]=new M0(c,s,!1,!1,i)});const a=(l=t==="top"?n==null?void 0:n.getPinnedTopRowCount():n==null?void 0:n.getPinnedBottomRowCount())!=null?l:0;e.length=a}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){var r,n;if(e.sticky)(r=this.stickyRowFeature)==null||r.refreshStickyNode(e);else if((n=this.cachedRowCtrls)!=null&&n.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const s=i=>{const o=i[e.rowIndex];!o||o.rowNode===e&&(o.destroyFirstPass(),o.destroySecondPass(),i[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":s(this.topRowCtrls);break;case"bottom":s(this.bottomRowCtrls);break;default:s(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){const{editSvc:t}=this.beans;if(t!=null&&t.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(const n of e!=null?e:[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){var a;this.getLockOnRefresh();const t=(a=this.beans.focusSvc)==null?void 0:a.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Jg(this.gos),s=r?this.getRowsToRecycle():null;r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:i,gos:o}=this;if(i){i.checkStickyRows();const l=i.extraTopHeight+i.extraBottomHeight;l&&this.updateContainerHeights(l)}this.recycleRows(s,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(o.get("enableRowPinning")?r:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){var n;const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),(n=this.stickyRowFeature)==null||n.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let r=this.pageBounds.getCurrentPageHeight();r===0&&(r=1),t.setModelHeight(r+e)}getLockOnRefresh(){var e,t;if(this.refreshInProgress)throw new Error(b0(252));this.refreshInProgress=!0,(t=(e=this.beans.frameworkOverrides).getLockOnRefresh)==null||t.call(e)}releaseLockOnRefresh(){var e,t;this.refreshInProgress=!1,(t=(e=this.beans.frameworkOverrides).releaseLockOnRefresh)==null||t.call(e)}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,r=this.findPositionToFocus(e);if(!r){t.focusHeaderPosition({headerPosition:{headerRowIndex:jn(this.beans)-1,column:e.column}});return}if(e.rowIndex!==r.rowIndex||e.rowPinned!=r.rowPinned){t.setFocusedCell({...r,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(ot(this.gos,{...r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:r}=this.beans;let n=e;for(n.rowPinned==null&&t&&r&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:r.getFirstRow()});n;){if(n.rowPinned==null&&r)if(n.rowIndex<r.getFirstRow()){if(n=ah(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>r.getLastRow()&&(n={rowPinned:null,rowIndex:r.getLastRow()});const s=this.getRowByPosition(n);if(s!=null&&s.isAlive())return{...s.getRowPosition(),column:e.column};n=ah(this.beans,n)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let n=0;n<r;n++){const s=t[n].getAllCellCtrls(),i=s.length;for(let o=0;o<i;o++)e.push(s[o])}return e}getAllRowCtrls(){var s,i,o;const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),r=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...r,...(s=e==null?void 0:e.getCtrls("top"))!=null?s:[],...(i=e==null?void 0:e.getCtrls("bottom"))!=null?i:[],...(o=e==null?void 0:e.getCtrls("center"))!=null?o:[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,r){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,r)}refreshCells({rowNodes:e,columns:t,force:r,suppressFlash:n}={}){const s={force:r,newData:!1,suppressFlash:n};for(const i of this.getCellCtrls(e,t))i.refreshOrDestroyCell(s);this.refreshFullWidth(e)}refreshRows(e={}){for(const t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||(t=!0,this.redrawRow(r.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=h1(e),r=this.getAllRowCtrls();return!e||!t?r:r.filter(n=>{const s=n.rowNode;return d1(s,t)})}getCellCtrls(e,t){let r;Be(t)&&(r={},t.forEach(s=>{const i=this.colModel.getCol(s);Be(i)&&(r[i.getId()]=!0)}));const n=[];for(const s of this.getRowCtrls(e))for(const i of s.getAllCellCtrls()){const o=i.column.getId();r&&!r[o]||n.push(i)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){var r;const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),(r=this.stickyRowFeature)==null||r.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const r of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[r].rowNode.id==null&&e.push(r);this.removeRowCtrls(e);const t={};for(const r of Object.values(this.rowCtrlsByRowIndex)){const n=r.rowNode;t[n.id]=r}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(const r of e){const n=this.rowCtrlsByRowIndex[r];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:r}=this.beans,{afterScroll:n}=e;let s;const i=this.stickyRowFeature;i&&(s=(t==null?void 0:t.getFocusCellToUseAfterRefresh())||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(i){l=i.checkStickyRows();const u=i.extraTopHeight+i.extraBottomHeight;u&&this.updateContainerHeights(u)}const c=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(n&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),s!=null)){const u=t==null?void 0:t.getFocusCellToUseAfterRefresh();s!=null&&u==null&&(r==null||r.flushAllFrames(),this.restoreFocusedCell(s))}}removeRowCompsNotToDraw(e,t){const r={};for(const i of e)r[i]=!0;const s=Object.keys(this.rowCtrlsByRowIndex).filter(i=>!r[i]);this.removeRowCtrls(s,t)}calculateIndexesToDraw(e){var o,a;const t=[];for(let l=this.firstRenderedRow;l<=this.lastRenderedRow;l++)t.push(l);const r=this.beans.pagination,n=(a=(o=this.beans.focusSvc)==null?void 0:o.getFocusedCell())==null?void 0:a.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!r||r.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);const s=l=>{const c=l.rowNode.rowIndex;c==null||c===n||(c<this.firstRenderedRow||c>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(l)&&t.push(c)};for(const l of Object.values(this.rowCtrlsByRowIndex))s(l);if(e)for(const l of Object.values(e))s(l);t.sort((l,c)=>l-c);const i=[];for(let l=0;l<t.length;l++){const c=t[l],u=this.rowModel.getRow(c);u&&!u.sticky&&i.push(c)}return i}recycleRows(e,t=!1,r=!1){const n=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(const s of n)this.createOrUpdateRowCtrl(s,e,t,r);if(e){const{animationFrameSvc:s}=this.beans;(s==null?void 0:s.active)&&r&&!this.printLayout?s.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),r=e.isPinningRight();(this.pinningLeft!==t||r!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];for(const t of this.getFullWidthRowCtrls()){const r=t.rowNode.rowIndex;e.push(r.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=h1(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const n=r.rowNode;return!(t!=null&&!d1(n,t))})}createOrUpdateRowCtrl(e,t,r,n){let s,i=this.rowCtrlsByRowIndex[e];if(i||(s=this.rowModel.getRow(e),Be(s)&&Be(t)&&t[s.id]&&s.alreadyRendered&&(i=t[s.id],t[s.id]=null)),!i)if(s||(s=this.rowModel.getRow(e)),Be(s))i=this.createRowCon(s,r,n);else return;s&&(s.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=i}destroyRowCtrls(e,t){const r=[];if(e){for(const n of Object.values(e))if(!!n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){const s=n.instanceId;this.zombieRowCtrls[s]=n,r.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[s]})}else n.destroySecondPass()}}t&&(r.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(const n of r)n()},MM))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=Oy(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:r}=this;e.updateOffset();let n,s;if(!r.isRowsToRender())n=0,s=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),s=t.getLastRow();else{const u=this.getRowBufferInPixels(),h=this.ctrlsSvc.getScrollFeature(),d=this.gos.get("suppressRowVirtualisation");let f=!1,p,g;do{const w=t.getPixelOffset(),{pageFirstPixel:k,pageLastPixel:E}=t.getCurrentPagePixelRange(),y=e.divStretchOffset,R=h.getVScrollPosition(),D=R.top,N=R.bottom;d?(p=k+y,g=E+y):(p=Math.max(D+w-u,k)+y,g=Math.min(N+w+u,E)+y),this.firstVisibleVPixel=Math.max(D+w,k)+y,this.lastVisibleVPixel=Math.min(N+w,E)+y,f=this.ensureAllRowsInRangeHaveHeightsCalculated(p,g)}while(f);let m=r.getRowIndexAtPixel(p),v=r.getRowIndexAtPixel(g);const C=t.getFirstRow(),x=t.getLastRow();m<C&&(m=C),v>x&&(v=x),n=m,s=v}const i=Fr(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);i&&!o&&s-n>a&&(s=n+a);const l=n!==this.firstRenderedRow,c=s!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=s,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:s}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,ai(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){var a,l;const r=(a=this.pinnedRowModel)==null?void 0:a.ensureRowHeightsValid(),n=(l=this.stickyRowFeature)==null?void 0:l.ensureRowHeightsValid(),{pageBounds:s,rowModel:i}=this,o=i.ensureRowHeightsValid(e,t,s.getFirstRow(),s.getLastRow());return(o||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||o||r?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){var c;const n=e.rowNode,s=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),i=(c=this.editSvc)==null?void 0:c.isEditing(e),o=n.detail;return s||i||o?!!this.isRowPresent(n):!1}isRowPresent(e){var t,r;return this.rowModel.isRowPresent(e)?(r=(t=this.beans.pagination)==null?void 0:t.isRowInPage(e.rowIndex))!=null?r:!0:!1}createRowCon(e,t,r){var o,a,l;const n=(a=(o=this.cachedRowCtrls)==null?void 0:o.getRow(e))!=null?a:null;if(n)return n;const s=r&&!this.printLayout&&!!((l=this.beans.animationFrameSvc)!=null&&l.active);return new M0(e,this.beans,t,s,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),r=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...r]}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===r)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},NM=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if((e==null?void 0:e.id)==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],Bi(this.entriesList,r)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Bi(this.entriesList,e)}getEntries(){return this.entriesList}};function h1(e){if(!e)return;const t={top:{},bottom:{},normal:{}};for(const r of e){const n=r.id;switch(r.rowPinned){case"top":t.top[n]=r;break;case"bottom":t.bottom[n]=r;break;default:t.normal[n]=r;break}}return t}function d1(e,t){const r=e.id;switch(e.rowPinned){case"top":return t.top[r]!=null;case"bottom":return t.bottom[r]!=null;default:return t.normal[r]!=null}}var BM=class extends we{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=ss(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=ss(e))}doFullSort(e,t){const r=e.map((n,s)=>({currentPos:s,rowNode:n}));return r.sort(this.compareRowNodes.bind(this,t)),r.map(n=>n.rowNode)}compareRowNodes(e,t,r){const n=t.rowNode,s=r.rowNode;for(let i=0,o=e.length;i<o;i++){const a=e[i],l=a.sort==="desc",c=this.getValue(n,a.column),u=this.getValue(s,a.column);let h;const d=this.getComparator(a,n);if(d?h=d(c,u,n,s,l):h=lR(c,u,this.isAccentedSort),!isNaN(h)&&h!==0)return a.sort==="asc"?h:h*-1}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column,n=r.getColDef().comparator;if(n!=null)return n;if(!r.getColDef().showRowGroup)return;const s=!t.group&&r.getColDef().field;if(!s)return;const i=this.beans.colModel.getColDefCol(s);if(!!i)return i.getColDef().comparator}getValue(e,t){var a;const{valueSvc:r,colModel:n,showRowGroupCols:s,gos:i}=this.beans;if(!this.primaryColumnsSortGroups)return r.getValue(t,e,!1);if(e.rowGroupColumn===t){if(Hy(i,n.isPivotActive())){const u=e.data?e:SA(e.childrenAfterGroup);return u&&r.getValue(t,u,!1)}const c=s==null?void 0:s.getShowRowGroupCol(t.getId());return c?(a=e.groupData)==null?void 0:a[c.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return r.getValue(t,e,!1)}};function HM(e){var t;(t=e.sortSvc)==null||t.onSortChanged("api")}var WM={moduleName:"Sort",version:ut,beans:[pL,BM],apiFunctions:{onSortChanged:HM},userComponents:{agSortIndicator:hp},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},VM=class extends we{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:r}=this.beans;t.setColumnDefs(e!=null?e:[],"gridInitializing"),r.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),Yu(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(!!t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,cu(e.source))}}},GM="paste",zM=class extends we{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;Uh(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:r}=this.beans;if(e.source===GM||t.get("suppressChangeDetection"))return;const n=e.node,s=[n],i=this.clientSideRowModel,o=i==null?void 0:i.rootNode;if(o&&!n.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new tI(a,o);l.addParentNode(n.parent,[e.column]),i.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{s.push(c),c.sibling&&s.push(c.sibling)})}r.refreshCells({rowNodes:s})}},UM=class extends we{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);gn(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return gn(16,{expression:e,params:t,e:r}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const r=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",r);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},jM={moduleName:"Expression",version:ut,beans:[UM]},$M={moduleName:"ChangeDetection",version:ut,beans:[zM]},KM=class extends we{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=qg(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,r=!1,n=!1,s="ui"){const{showRowGroupColValueSvc:i}=this.beans,o=!e&&t.group,a=e==null?void 0:e.colDef.showRowGroup,l=!this.isTreeData||t.footer;if(i&&l&&(o||a)){const g=i.getGroupValue(t,e);if(g==null)return{value:null,valueFormatted:null};if(!r)return{value:g.value,valueFormatted:null};const m=i.formatAndPrefixGroupColValue(g,e,n);return{value:g.value,valueFormatted:m}}if(!e)return{value:t.key,valueFormatted:null};const c=t.leafGroup&&this.colModel.isPivotMode(),u=t.group&&t.expanded&&!t.footer&&!c,h=this.gos.get("groupSuppressBlankHeader")||!t.sibling,d=u&&!h,f=this.getValue(e,t,d,s),p=r&&!(n&&e.colDef.useValueFormatterForExport===!1);return{value:f,valueFormatted:p?this.formatValue(e,t,f):null}}getValue(e,t,r=!1,n="ui"){var g,m;if(this.initialised||this.init(),!t)return;const s=e.getColDef(),i=s.field,o=e.getColId(),a=t.data;if(this.hasEditSvc&&n==="ui"){const v=this.editSvc;if(v.isEditing()){const C=v.getCellDataValue({rowNode:t,column:e},!0);if(C!==void 0)return C}}let l;const c=s.showRowGroup;if(typeof c=="string"&&((m=(g=this.beans.rowGroupColsSvc)==null?void 0:g.getColumnIndex(c))!=null?m:-1)>t.level)return null;const u=typeof c!="string"||!t.group,h=t.groupData&&o in t.groupData,d=!r&&t.aggData&&t.aggData[o]!==void 0,f=this.isSsrm&&r&&!!s.aggFunc,p=this.isSsrm&&t.footer&&t.field&&(s.showRowGroup===!0||s.showRowGroup===t.field);if(this.isTreeData&&d)l=t.aggData[o];else if(this.isTreeData&&s.valueGetter)l=this.executeValueGetter(s.valueGetter,a,e,t);else if(this.isTreeData&&i&&a)l=gu(a,i,e.isFieldContainsDots());else if(h)l=t.groupData[o];else if(d)l=t.aggData[o];else if(s.valueGetter&&!f){if(!u)return l;l=this.executeValueGetter(s.valueGetter,a,e,t)}else if(p)l=gu(a,t.field,e.isFieldContainsDots());else if(i&&a&&!f){if(!u)return l;l=gu(a,i,e.isFieldContainsDots())}if(this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const v=l.substring(1);l=this.executeValueGetter(v,a,e,t)}return l}parseValue(e,t,r,n){var o;const s=e.getColDef(),i=s.valueParser;if(Be(i)){const a=ot(this.gos,{node:t,data:t==null?void 0:t.data,oldValue:n,newValue:r,colDef:s,column:e});return typeof i=="function"?i(a):(o=this.expressionSvc)==null?void 0:o.evaluate(i,a)}return r}getDeleteValue(e,t){var r;return Be(e.getColDef().valueParser)&&(r=this.parseValue(e,t,"",this.getValueForDisplay(e,t).value))!=null?r:null}formatValue(e,t,r,n,s=!0){const{expressionSvc:i}=this.beans;let o=null,a;const l=e.getColDef();if(n?a=n:s&&(a=l.valueFormatter),a){const c=t?t.data:null,u=ot(this.gos,{value:r,node:t,data:c,colDef:l,column:e});typeof a=="function"?o=a(u):o=i?i.evaluate(a,u):null}else if(l.refData)return l.refData[r]||"";return o==null&&Array.isArray(r)&&(o=r.join(", ")),o}setValue(e,t,r,n){var u,h;const s=this.colModel.getColDefCol(t);if(!e||!s)return!1;Jt(e.data)&&(e.data={});const{field:i,valueSetter:o}=s.getColDef();if(Jt(i)&&Jt(o))return Ge(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(s,r))return Ge(135),!1;const a=ot(this.gos,{node:e,data:e.data,oldValue:this.getValue(s,e,void 0,n),newValue:r,colDef:s.getColDef(),column:s});a.newValue=r;let l;if(Be(o)?typeof o=="function"?l=o(a):l=(u=this.expressionSvc)==null?void 0:u.evaluate(o,a):l=this.setValueUsingField(e.data,i,r,s.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),(h=this.valueCache)==null||h.onDataChanged();const c=this.getValue(s,e);return this.dispatchCellValueChangedEvent(e,a,c,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,a,c,n),!0}dispatchCellValueChangedEvent(e,t,r,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:r,value:r,source:n})}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,n){if(!t)return!1;let s=!1;if(!n)s=e[t]===r,s||(e[t]=r);else{const i=t.split(".");let o=e;for(;i.length>0&&o;){const a=i.shift();i.length===0?(s=o[a]===r,s||(o[a]=r)):o=o[a]}}return!s}executeValueGetterWithValueCache(e,t,r,n){const s=r.getColId(),i=this.valueCache.getValue(n,s);if(i!==void 0)return i;const o=this.executeValueGetterWithoutValueCache(e,t,r,n);return this.valueCache.setValue(n,s,o),o}executeValueGetterWithoutValueCache(e,t,r,n){var o;const s=ot(this.gos,{data:t,node:n,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,n)});let i;return typeof e=="function"?i=e(s):i=(o=this.expressionSvc)==null?void 0:o.evaluate(e,s),i}getValueCallback(e,t){const r=this.colModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),n=e.getColDef().keyCreator;let s=r;if(n){const i=ot(this.gos,{value:r,colDef:e.getColDef(),column:e,node:t,data:t.data});s=n(i)}return typeof s=="string"||s==null||(s=String(s),s==="[object Object]"&&Ge(121)),s}},XM={moduleName:"CommunityCore",version:ut,beans:[cL,WP,g4,Q_,LM,XI,nL,wL,j_,mM,pM,OM,KM,aL,rL,lL,m4,VM,c4,u4,AL],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:VP,destroy:GP,isDestroyed:zP,getGridOption:UP,setGridOption:jP,updateGridOptions:_S,isModuleRegistered:$P},dependsOn:[o4,EI,II,WM,TL,QI,RL,IM,$M,DL,gM,wM,SM,IL,f4,a4,jM,e4,EM]},YM=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `;function QM({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var f1=new WeakMap,g1=new WeakMap,ZM=1,qM=class{create(e,t,r,n,s,i){var g;const o=Qg.applyGlobalGridOptions(t),a=(g=o.gridId)!=null?g:String(ZM++),l=this.getRegisteredModules(s,a,o.rowModelType),c=this.createBeansList(o.rowModelType,l,a),u=this.createProvidedBeans(e,o,s);if(!c)return;const d={providedBeanInstances:u,beanClasses:c,id:a,beanInitComparator:OP,beanDestroyComparator:NP,derivedBeans:[LP],destroyCallback:()=>{g1.delete(p),f1.delete(e),YR(a),i==null||i()}},f=new hA(d);this.registerModuleFeatures(f,l),r(f),f.getBean("syncSvc").start(),n==null||n(f);const p=f.getBean("gridApi");return f1.set(e,p),g1.set(p,e),p}getRegisteredModules(e,t,r){var n;return y0(XM,void 0,!0),(n=e==null?void 0:e.modules)==null||n.forEach(s=>y0(s,t)),QR(t,p1(r))}registerModuleFeatures(e,t){const r=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(const s of t){r.registerModule(s);const i=s.apiFunctions;if(i){const o=Object.keys(i);for(const a of o)n==null||n.addFunction(a,i[a])}}}createProvidedBeans(e,t,r){let n=r?r.frameworkOverrides:null;Jt(n)&&(n=new TS);const s={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:r?r.globalListener:null,globalSyncListener:r?r.globalSyncListener:null,frameworkOverrides:n};return r!=null&&r.providedBeanInstances&&Object.assign(s,r.providedBeanInstances),s}createBeansList(e,t,r){var a;const n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},s=p1(e),i=n[s];if(!i){Ia(201,{rowModelType:s},`Unknown rowModelType ${s}.`);return}if(!JR()){Ia(272,void 0,YM());return}if(!e){const l=Object.entries(n).filter(([c,u])=>S0(u,r,c));if(l.length==1){const[c,u]=l[0];if(c!==s){const h={moduleName:u,rowModelType:c};Ia(275,h,QM(h));return}}}if(!S0(i,r,s)){Ia(200,{reasonOrId:`rowModelType = '${s}'`,moduleName:i,gridScoped:_y(),gridId:r,rowModelType:s},`Missing module ${i}Module for rowModelType ${s}.`);return}const o=new Set;for(const l of t)for(const c of(a=l.beans)!=null?a:[])o.add(c);return Array.from(o)}};function p1(e){return e!=null?e:"clientSide"}var JM=class{wrap(e,t,r,n){const s=this.createWrapper(e,n);for(const i of t!=null?t:[])this.createMethod(s,i,!0);for(const i of r!=null?r:[])this.createMethod(s,i,!1);return s}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&Ge(49,{methodName:t}),null)}}},wr=ue.createContext({}),$S=ue.createContext("default"),ec=(e,t,r,n)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const i=e.newAgStackInstance();let o,a,l=!1;return i.then(c=>{if(l){t.destroyBean(c);return}o=c,a=o.getGui(),r.appendChild(a),m1(n,o)}),()=>{l=!0,o&&(a==null||a.remove(),t.destroyBean(o),n&&m1(n,void 0))}},m1=(e,t)=>{if(!!e)if(e instanceof Function)e(t);else{const r=e;r.current=t}},cn=(...e)=>e.filter(r=>r!=null&&r!=="").join(" "),pn=class KS{constructor(...t){this.classesMap={};for(const r of t)this.classesMap[r]=!0}setClass(t,r){if(!!this.classesMap[t]==r)return this;const s=new KS;return s.classesMap={...this.classesMap},s.classesMap[t]=r,s}toString(){return Object.keys(this.classesMap).filter(r=>this.classesMap[r]).join(" ")}},la=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,r=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===r()},Lx,O0=(Lx=ue.version)==null?void 0:Lx.split(".")[0],XS=O0==="16"||O0==="17";function e3(){return O0==="19"}var mu=!1;function t3(e){return mu||setTimeout(()=>mu=!1,0),mu=!0,e()}var _l=(e,t)=>{!XS&&e&&!mu?Uw.flushSync(t):t()},r3=e=>{XS?e():ue.startTransition(e)};function n3(e,t,r){return ue.useSyncExternalStore?ue.useSyncExternalStore(e,t):r}function lh(e,t,r){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(r||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const n=[],s=[],i=new Map,o=new Map;for(let a=0;a<t.length;a++){const l=t[a];o.set(l.instanceId,l)}for(let a=0;a<e.length;a++){const l=e[a];i.set(l.instanceId,l),o.has(l.instanceId)&&n.push(l)}for(let a=0;a<t.length;a++){const l=t[a],c=l.instanceId;i.has(c)||s.push(l)}return n.length===e.length&&s.length===0?e:n.length===0&&s.length===t.length?t:n.length===0?s:s.length===0?n:[...n,...s]}var YS=S.exports.forwardRef((e,t)=>{var te;const{registry:r,context:n}=S.exports.useContext(wr),s=S.exports.useRef(null),i=S.exports.useRef(null),o=S.exports.useRef(null),a=S.exports.useRef(null),l=S.exports.useRef(null),c=S.exports.useRef(),[u,h]=S.exports.useState(),[d,f]=S.exports.useState(),[p,g]=S.exports.useState(),[m,v]=S.exports.useState(()=>new pn),[C,x]=S.exports.useState(()=>new pn("ag-hidden")),[w,k]=S.exports.useState(()=>new pn("ag-hidden")),[E,y]=S.exports.useState(()=>new pn("ag-invisible"));S.exports.useImperativeHandle(t,()=>({refresh(){return!1}})),S.exports.useLayoutEffect(()=>ec(u,n,i.current),[u]);const R=S.exports.useCallback(Z=>{if(s.current=Z,!Z||n.isDestroyed()){c.current=n.destroyBean(c.current);return}const H={setInnerRenderer:(ie,F)=>{h(ie),g(F)},setChildCount:ie=>f(ie),toggleCss:(ie,F)=>v(W=>W.setClass(ie,F)),setContractedDisplayed:ie=>k(F=>F.setClass("ag-hidden",!ie)),setExpandedDisplayed:ie=>x(F=>F.setClass("ag-hidden",!ie)),setCheckboxVisible:ie=>y(F=>F.setClass("ag-invisible",!ie)),setCheckboxSpacing:ie=>y(F=>F.setClass("ag-group-checkbox-spacing",ie))},Q=r.createDynamicBean("groupCellRendererCtrl",!0);Q&&(c.current=n.createBean(Q),c.current.init(H,Z,o.current,a.current,l.current,YS,e))},[]),D=S.exports.useMemo(()=>`ag-cell-wrapper ${m.toString()}`,[m]),N=S.exports.useMemo(()=>`ag-group-expanded ${C.toString()}`,[C]),O=S.exports.useMemo(()=>`ag-group-contracted ${w.toString()}`,[w]),A=S.exports.useMemo(()=>`ag-group-checkbox ${E.toString()}`,[E]),G=u==null?void 0:u.componentFromFramework,q=G?u.componentClass:void 0,z=u==null&&p!=null,se=Vh(p);return ue.createElement("span",{className:D,ref:R,...e.colDef?{}:{role:(te=c.current)==null?void 0:te.getCellAriaRole()}},ue.createElement("span",{className:N,ref:a}),ue.createElement("span",{className:O,ref:l}),ue.createElement("span",{className:A,ref:o}),ue.createElement("span",{className:"ag-group-value",ref:i},z?se:G?ue.createElement(q,{...u.params}):null),ue.createElement("span",{className:"ag-group-child-count"},d))}),v1=YS,dp=S.exports.createContext({setMethods:()=>{}}),s3=e=>{const{initialProps:t,addUpdateCallback:r,CustomComponentClass:n,setMethods:s}=e,[{key:i,...o},a]=S.exports.useState(t);return S.exports.useEffect(()=>{r(l=>a(l))},[]),ue.createElement(dp.Provider,{value:{setMethods:s}},ue.createElement(n,{key:i,...o}))},i3=S.exports.memo(s3),o3=0;function x1(){return`agPortalKey_${++o3}`}var QS=class{constructor(e,t,r,n){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=r,this.suppressFallbackMethods=!!n,this.statelessComponent=this.isStateless(this.reactComponent),this.key=x1(),this.portalKey=x1(),this.instanceCreated=this.isStatelessComponent()?Tr.resolve(!1):new Tr(s=>{this.resolveInstanceCreated=s})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),r=document.createElement(t||"div");return r.classList.add("ag-react-container"),e.reactContainer=r,r}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,!!t&&t[0]?t[0]:{});if(!r){setTimeout(()=>this.callMethod(e,t));return}const n=r[e];if(n)return n.apply(r,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,!!t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Tr(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{var r;this.componentInstance=t,(r=this.resolveInstanceCreated)==null||r.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=ea.exports.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return S.exports.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const r=this[`${e}Component`];if(!this.suppressFallbackMethods&&!!r)return r.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function qh(e,t,r){for(const n of e){const s=t[n];s&&(r[n]=s)}}var Jr=class extends QS{constructor(){super(...arguments),this.awaitUpdateCallback=new Tr(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=i3}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:r=>this.setMethods(r),addUpdateCallback:r=>{this.updateCallback=()=>(r(this.getProps()),new Tr(n=>{setTimeout(()=>{n()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,qh(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new Tr(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},a3=class extends Jr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},l3=class extends Jr{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},c3=class extends Jr{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:r,shake:n}=this;return e.label=t,e.icon=r,e.shake=n,e}},u3=class extends Jr{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new Tr(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var r;const t=this.providedMethods;t?(r=t.afterGuiAttached)==null||r.call(t,e):this.awaitSetMethodsCallback.then(()=>{var n,s;return(s=(n=this.providedMethods)==null?void 0:n.afterGuiAttached)==null?void 0:s.call(n,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){var t,r;this.expectingNewMethods===!1&&this.hasBeenActive&&((t=this.providedMethods)==null?void 0:t.doesFilterPass)!==(e==null?void 0:e.doesFilterPass)&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),(r=this.resolveFilterPassCallback)==null||r.call(this),this.resolveFilterPassCallback=void 0}updateModel(e){var r;(r=this.resolveFilterPassCallback)==null||r.call(this);const t=new Tr(n=>{this.resolveFilterPassCallback=n});this.setModel(e).then(()=>{t.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},h3=class extends Jr{constructor(){super(...arguments),this.awaitSetMethodsCallback=new Tr(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){var r;const t=this.providedMethods;t?(r=t.afterGuiAttached)==null||r.call(t,e):this.awaitSetMethodsCallback.then(()=>{var n,s;return(s=(n=this.providedMethods)==null?void 0:n.afterGuiAttached)==null?void 0:s.call(n,e)})}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function ZS(e,t){e.parentFilterInstance(r=>{(r.setModel(t)||Tr.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var d3=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=r=>this.updateModel(r)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){qh(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ZS(this.floatingFilterParams,e)}},f3=class extends Jr{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),ZS(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},g3=class extends Jr{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},p3=class extends Jr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},m3=class extends Jr{refresh(e){this.sourceParams=e,this.refreshProps()}},v3=class extends Jr{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},x3=class extends Jr{refresh(e){this.sourceParams=e,this.refreshProps()}},C3=class extends Jr{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},w3=class extends Jr{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function fp(){Ge(231)}var y3=1e3,S3=class{constructor(e,t,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||y3}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(t=>t!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,r){this.portals=[...this.portals,e],this.waitForInstance(t,r),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t,r=Date.now()){if(this.destroyed){t(null);return}if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){_l(!0,()=>this.refresher()),e.rendered()&&t(e);return}window.setTimeout(()=>{this.waitForInstance(e,t,r)})}}},k3=({ctrl:e})=>{const t=e.isAlive(),{context:r}=S.exports.useContext(wr),[n,s]=S.exports.useState(),[i,o]=S.exports.useState(),a=S.exports.useRef(),l=S.exports.useRef(null),c=S.exports.useRef(null),u=S.exports.useRef(null),h=S.exports.useRef(),d=S.exports.useRef();t&&!d.current&&(d.current=new Zl(()=>l.current));const f=S.exports.useCallback(v=>{if(l.current=v,!v||!e.isAlive()||r.isDestroyed()){a.current=r.destroyBean(a.current);return}a.current=r.createBean(new aa);const C=()=>{var k;const w=e.getSelectAllGui();w&&((k=c.current)==null||k.insertAdjacentElement("afterend",w),a.current.addDestroyFunc(()=>w.remove()))},x={setWidth:w=>{l.current&&(l.current.style.width=w)},toggleCss:(w,k)=>d.current.toggleCss(w,k),setUserStyles:w=>o(w),setAriaSort:w=>{l.current&&(w?bR(l.current,w):ER(l.current))},setUserCompDetails:w=>s(w),getUserCompInstance:()=>h.current||void 0,refreshSelectAllGui:C,removeSelectAllGui:()=>{var w;return(w=e.getSelectAllGui())==null?void 0:w.remove()}};e.setComp(x,v,c.current,u.current,a.current),C()},[]);S.exports.useLayoutEffect(()=>ec(n,r,u.current,h),[n]),S.exports.useEffect(()=>{e.setDragSource(l.current)},[n]);const p=S.exports.useMemo(()=>!!((n==null?void 0:n.componentFromFramework)&&la(n.componentClass)),[n]),g=n==null?void 0:n.componentFromFramework,m=n==null?void 0:n.componentClass;return ue.createElement("div",{ref:f,style:i,className:"ag-header-cell",role:"columnheader"},ue.createElement("div",{ref:c,className:"ag-header-cell-resize",role:"presentation"}),ue.createElement("div",{ref:u,className:"ag-header-cell-comp-wrapper",role:"presentation"},g?p?ue.createElement(m,{...n.params}):ue.createElement(m,{...n.params,ref:h}):null))},b3=S.exports.memo(k3),E3=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){qh(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},F3=({ctrl:e})=>{const{context:t,gos:r}=S.exports.useContext(wr),[n,s]=S.exports.useState(),[i,o]=S.exports.useState(()=>new pn("ag-header-cell","ag-floating-filter")),[a,l]=S.exports.useState(()=>new pn),[c,u]=S.exports.useState(()=>new pn("ag-floating-filter-button","ag-hidden")),[h,d]=S.exports.useState("false"),[f,p]=S.exports.useState(),[,g]=S.exports.useState(1),m=S.exports.useRef(),v=S.exports.useRef(null),C=S.exports.useRef(null),x=S.exports.useRef(null),w=S.exports.useRef(null),k=S.exports.useRef(),E=S.exports.useRef(),y=Q=>{Q!=null&&k.current&&k.current(Q)},R=S.exports.useCallback(Q=>{if(v.current=Q,!Q||!e.isAlive()||t.isDestroyed()){m.current=t.destroyBean(m.current);return}m.current=t.createBean(new aa),E.current=new Tr(F=>{k.current=F});const ie={toggleCss:(F,W)=>o(B=>B.setClass(F,W)),setUserStyles:F=>s(F),addOrRemoveBodyCssClass:(F,W)=>l(B=>B.setClass(F,W)),setButtonWrapperDisplayed:F=>{u(W=>W.setClass("ag-hidden",!F)),d(F?"false":"true")},setWidth:F=>{v.current&&(v.current.style.width=F)},setCompDetails:F=>p(F),getFloatingFilterComp:()=>E.current?E.current:null,setMenuIcon:F=>{var W;return(W=w.current)==null?void 0:W.appendChild(F)}};e.setComp(ie,Q,w.current,C.current,m.current)},[]);S.exports.useLayoutEffect(()=>ec(f,t,C.current,y),[f]);const D=S.exports.useMemo(()=>i.toString(),[i]),N=S.exports.useMemo(()=>a.toString(),[a]),O=S.exports.useMemo(()=>c.toString(),[c]),A=S.exports.useMemo(()=>!!(f&&f.componentFromFramework&&la(f.componentClass)),[f]),G=S.exports.useMemo(()=>r.get("reactiveCustomComponents"),[]),q=S.exports.useMemo(()=>r.get("enableFilterHandlers"),[]),[z,se]=S.exports.useState();S.exports.useEffect(()=>{if(f!=null&&f.componentFromFramework)if(G){const Q=q?E3:d3,ie=new Q(f.params,()=>g(F=>F+1));y(ie),se(ie)}else fp()},[f]);const te=z==null?void 0:z.getProps(),Z=f==null?void 0:f.componentFromFramework,H=f==null?void 0:f.componentClass;return ue.createElement("div",{ref:R,style:n,className:D,role:"gridcell"},ue.createElement("div",{ref:C,className:N,role:"presentation"},Z?G?te&&ue.createElement(dp.Provider,{value:{setMethods:Q=>z.setMethods(Q)}},ue.createElement(H,{...te})):ue.createElement(H,{...f.params,ref:A?()=>{}:y}):null),ue.createElement("div",{ref:x,"aria-hidden":h,className:O,role:"presentation"},ue.createElement("button",{ref:w,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},T3=S.exports.memo(F3),R3=({ctrl:e})=>{const{context:t}=S.exports.useContext(wr),[r,n]=S.exports.useState(),[s,i]=S.exports.useState(()=>new pn),[o,a]=S.exports.useState(()=>new pn),[l,c]=S.exports.useState("false"),[u,h]=S.exports.useState(),[d,f]=S.exports.useState(),p=S.exports.useRef(),g=S.exports.useRef(null),m=S.exports.useRef(null),v=S.exports.useRef(null),C=S.exports.useRef(),x=S.exports.useCallback(D=>{if(g.current=D,!D||!e.isAlive()||t.isDestroyed()){p.current=t.destroyBean(p.current);return}p.current=t.createBean(new aa);const N={setWidth:O=>{g.current&&(g.current.style.width=O)},toggleCss:(O,A)=>i(G=>G.setClass(O,A)),setUserStyles:O=>n(O),setHeaderWrapperHidden:O=>{const A=v.current;!A||(O?A.style.setProperty("display","none"):A.style.removeProperty("display"))},setHeaderWrapperMaxHeight:O=>{const A=v.current;!A||(O!=null?A.style.setProperty("max-height",`${O}px`):A.style.removeProperty("max-height"),A.classList.toggle("ag-header-cell-comp-wrapper-limited-height",O!=null))},setUserCompDetails:O=>f(O),setResizableDisplayed:O=>{a(A=>A.setClass("ag-hidden",!O)),c(O?"false":"true")},setAriaExpanded:O=>h(O),getUserCompInstance:()=>C.current||void 0};e.setComp(N,D,m.current,v.current,p.current)},[]);S.exports.useLayoutEffect(()=>ec(d,t,v.current),[d]),S.exports.useEffect(()=>{g.current&&e.setDragSource(g.current)},[d]);const w=S.exports.useMemo(()=>!!((d==null?void 0:d.componentFromFramework)&&la(d.componentClass)),[d]),k=S.exports.useMemo(()=>"ag-header-group-cell "+s.toString(),[s]),E=S.exports.useMemo(()=>"ag-header-cell-resize "+o.toString(),[o]),y=d==null?void 0:d.componentFromFramework,R=d==null?void 0:d.componentClass;return ue.createElement("div",{ref:x,style:r,className:k,role:"columnheader","aria-expanded":u},ue.createElement("div",{ref:v,className:"ag-header-cell-comp-wrapper",role:"presentation"},y?w?ue.createElement(R,{...d.params}):ue.createElement(R,{...d.params,ref:C}):null),ue.createElement("div",{ref:m,"aria-hidden":l,className:E}))},_3=S.exports.memo(R3),D3=({ctrl:e})=>{const{gos:t,context:r}=S.exports.useContext(wr),{topOffset:n,rowHeight:s}=S.exports.useMemo(()=>e.getTopAndHeight(),[]),i=S.exports.useMemo(()=>t.get("tabIndex"),[]),[o,a]=S.exports.useState(()=>e.getAriaRowIndex()),l=e.headerRowClass,[c,u]=S.exports.useState(()=>s+"px"),[h,d]=S.exports.useState(()=>n+"px"),f=S.exports.useRef(null),[p,g]=S.exports.useState(()=>e.getUpdatedHeaderCtrls()),m=S.exports.useRef(),v=S.exports.useRef(null),C=S.exports.useCallback(k=>{if(v.current=k,!k||!e.isAlive()||r.isDestroyed()){m.current=r.destroyBean(m.current);return}m.current=r.createBean(new aa);const E={setHeight:y=>u(y),setTop:y=>d(y),setHeaderCtrls:(y,R,D)=>{const N=f.current,O=lh(N,y,R);O!==N&&(f.current=O,_l(D,()=>g(O)))},setWidth:y=>{v.current&&(v.current.style.width=y)},setRowIndex:y=>{a(y)}};e.setComp(E,m.current,!1)},[]),x=S.exports.useMemo(()=>({height:c,top:h}),[c,h]),w=S.exports.useCallback(k=>{switch(e.type){case"group":return ue.createElement(_3,{ctrl:k,key:k.instanceId});case"filter":return ue.createElement(T3,{ctrl:k,key:k.instanceId});default:return ue.createElement(b3,{ctrl:k,key:k.instanceId})}},[]);return ue.createElement("div",{ref:C,className:l,role:"row",style:x,tabIndex:i,"aria-rowindex":o},p.map(w))},A3=S.exports.memo(D3),P3=({pinned:e})=>{const[t,r]=S.exports.useState(!0),[n,s]=S.exports.useState([]),{context:i}=S.exports.useContext(wr),o=S.exports.useRef(null),a=S.exports.useRef(null),l=S.exports.useRef(),c=e==="left",u=e==="right",h=!c&&!u,d=S.exports.useCallback(g=>{if(o.current=g,!g||i.isDestroyed()){l.current=i.destroyBean(l.current);return}l.current=i.createBean(new vP(e));const m={setDisplayed:r,setCtrls:v=>s(v),setCenterWidth:v=>{a.current&&(a.current.style.width=v)},setViewportScrollLeft:v=>{o.current&&(o.current.scrollLeft=v)},setPinnedContainerWidth:v=>{o.current&&(o.current.style.width=v,o.current.style.minWidth=v,o.current.style.maxWidth=v)}};l.current.setComp(m,o.current)},[]),f=t?"":"ag-hidden",p=()=>n.map(g=>ue.createElement(A3,{ctrl:g,key:g.instanceId}));return c?ue.createElement("div",{ref:d,className:"ag-pinned-left-header "+f,"aria-hidden":!t,role:"rowgroup"},p()):u?ue.createElement("div",{ref:d,className:"ag-pinned-right-header "+f,"aria-hidden":!t,role:"rowgroup"},p()):h?ue.createElement("div",{ref:d,className:"ag-header-viewport "+f,role:"rowgroup",tabIndex:-1},ue.createElement("div",{ref:a,className:"ag-header-container",role:"presentation"},p())):null},cf=S.exports.memo(P3),I3=()=>{const[e,t]=S.exports.useState(()=>new pn),[r,n]=S.exports.useState(),{context:s}=S.exports.useContext(wr),i=S.exports.useRef(null),o=S.exports.useRef(),a=S.exports.useCallback(u=>{if(i.current=u,!u||s.isDestroyed()){o.current=s.destroyBean(o.current);return}o.current=s.createBean(new fP);const h={toggleCss:(d,f)=>t(p=>p.setClass(d,f)),setHeightAndMinHeight:d=>n(d)};o.current.setComp(h,u,u)},[]),l=S.exports.useMemo(()=>"ag-header "+e.toString(),[e]),c=S.exports.useMemo(()=>({height:r,minHeight:r}),[r]);return ue.createElement("div",{ref:a,className:l,style:c,role:"presentation"},ue.createElement(cf,{pinned:"left"}),ue.createElement(cf,{pinned:null}),ue.createElement(cf,{pinned:"right"}))},L3=S.exports.memo(I3),M3=(e,t)=>{S.exports.useEffect(()=>{const r=t.current;if(r){const n=r.parentElement;if(n){const s=document.createComment(e);return n.insertBefore(s,r),()=>{s.remove()}}}},[e])},pi=M3,O3=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Tr(r=>{this.resolveInstanceCreated=r}),this.onValueChange=r=>this.updateValue(r),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){qh(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var t;this.componentInstance=e,(t=this.resolveInstanceCreated)==null||t.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},N3=e=>{const t=S.exports.useRef(e),r=S.exports.useRef(),n=S.exports.useRef(!1),s=S.exports.useRef(!1),[,i]=S.exports.useState(0);n.current&&(s.current=!0),S.exports.useEffect(()=>(n.current||(r.current=t.current(),n.current=!0),i(o=>o+1),()=>{var o;!s.current||(o=r.current)==null||o.call(r)}),[])},B3=e=>{const[t,r]=S.exports.useState(),n=S.exports.useContext(wr),{context:s,popupSvc:i,gos:o,editSvc:a}=n,{editDetails:l,cellCtrl:c,eParentCell:u}=e;return N3(()=>{var g,m;const{compDetails:h}=l,d=o.get("stopEditingWhenCellsLoseFocus");let f,p;if(!s.isDestroyed()){p=s.createBean(a.createPopupEditorWrapper(h.params));const v=p.getGui();if(e.jsChildComp){const y=e.jsChildComp.getGui();y&&v.appendChild(y)}const{column:C,rowNode:x}=c,w={column:C,rowNode:x,type:"popupCellEditor",eventSource:u,ePopup:v,position:l.popupPosition,keepWithinBounds:!0},k=i==null?void 0:i.positionPopupByComponent.bind(i,w),E=i==null?void 0:i.addPopup({modal:d,eChild:v,closeOnEsc:!0,closedCallback:()=>{c.onPopupEditorClosed()},anchorToElement:u,positionCallback:k,ariaOwns:u});f=E?E.hideFunc:void 0,r(p),(m=(g=e.jsChildComp)==null?void 0:g.afterGuiAttached)==null||m.call(g)}return()=>{f==null||f(),s.destroyBean(p)}}),S.exports.useLayoutEffect(()=>()=>{c.isCellFocused()&&(t==null?void 0:t.getGui().contains(xr(n)))&&u.focus({preventScroll:!0})},[t]),t&&e.wrappedContent?ea.exports.createPortal(e.wrappedContent,t.getGui()):null},C1=S.exports.memo(B3),H3=(e,t,r)=>{const{compProxy:n}=e;r(n);const s=n.getProps(),i=la(t);return ue.createElement(dp.Provider,{value:{setMethods:o=>n.setMethods(o)}},i?ue.createElement(t,{...s}):ue.createElement(t,{...s,ref:o=>n.setRef(o)}))},w1=(e,t,r)=>e.compProxy?H3(e,t,r):ue.createElement(t,{...e.compDetails.params,ref:r}),W3=(e,t,r,n,s)=>{const i=e.compDetails,o=i.componentClass,a=i.componentFromFramework&&!e.popup,l=i.componentFromFramework&&e.popup,c=!i.componentFromFramework&&e.popup;return a?w1(e,o,t):l?ue.createElement(C1,{editDetails:e,cellCtrl:n,eParentCell:r,wrappedContent:w1(e,o,t)}):c&&s?ue.createElement(C1,{editDetails:e,cellCtrl:n,eParentCell:r,jsChildComp:s}):null},V3=(e,t,r,n,s,i)=>{const{context:o}=S.exports.useContext(wr),a=S.exports.useCallback(()=>{const l=s.current;if(!l)return;const c=l.getGui();c&&c.parentElement&&c.remove(),o.destroyBean(l),s.current=void 0},[]);S.exports.useEffect(()=>{const l=e!=null,c=(e==null?void 0:e.compDetails)&&!e.compDetails.componentFromFramework,u=t&&r==null;if(!(l&&c&&!u)){a();return}const d=e.compDetails;if(s.current){const p=s.current,m=p.refresh!=null&&e.force==!1?p.refresh(d.params):!1;if(m===!0||m===void 0)return;a()}d.newAgStackInstance().then(p=>{if(!p)return;const g=p.getGui();if(!g)return;(t?r:i.current).appendChild(g),s.current=p})},[e,t,n]),S.exports.useEffect(()=>a,[])},qS=V3,G3=({cellCtrl:e,parent:t})=>{var s;const r=S.exports.useRef(),n=S.exports.useMemo(()=>{const{loadingComp:i}=e.getDeferLoadingCellRenderer();return i?{value:void 0,compDetails:i,force:!1}:void 0},[e]);if(qS(n,!1,void 0,1,r,t),(s=n==null?void 0:n.compDetails)!=null&&s.componentFromFramework){const i=n.compDetails.componentClass;return ue.createElement(i,{...n.compDetails.params})}return ue.createElement(ue.Fragment,null)},z3=({cellCtrl:e,printLayout:t,editingCell:r})=>{const n=S.exports.useContext(wr),{context:s}=n,{column:{colIdSanitised:i},instanceId:o}=e,a=S.exports.useRef(),[l,c]=S.exports.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[u,h]=S.exports.useState(),[d,f]=S.exports.useState(1),[p,g]=S.exports.useState(),[m,v]=S.exports.useState(!1),[C,x]=S.exports.useState(!1),[w,k]=S.exports.useState(!1),[E,y]=S.exports.useState(),R=S.exports.useMemo(()=>e.isForceWrapper(),[e]),D=S.exports.useMemo(()=>e.getCellAriaRole(),[e]),N=S.exports.useRef(null),O=S.exports.useRef(null),A=S.exports.useRef(null),G=S.exports.useRef(),q=S.exports.useRef(),z=S.exports.useRef(),se=S.exports.useRef([]),te=S.exports.useRef(),Z=S.exports.useRef(),[H,Q]=S.exports.useState(0),ie=S.exports.useCallback(Ce=>{Z.current=Ce,Q(oe=>oe+1)},[]),F=l!=null&&(m||w||C)&&(u==null||!!u.popup),W=R||F,B=S.exports.useMemo(()=>e.getCellValueClass(),[e]),V=S.exports.useCallback(Ce=>{if(q.current=Ce,Ce){const oe=Ce.isCancelBeforeStart&&Ce.isCancelBeforeStart();setTimeout(()=>{oe?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(Ce))})}},[e]),X=S.exports.useRef();X.current||(X.current=new Zl(()=>N.current)),qS(l,W,Z.current,H,G,N);const ne=S.exports.useRef();S.exports.useLayoutEffect(()=>{var be,Je;const Ce=ne.current,oe=l;if(ne.current=l,Ce==null||Ce.compDetails==null||oe==null||oe.compDetails==null)return;(be=te.current)==null||be.refreshVisibility();const Oe=Ce.compDetails,Qe=oe.compDetails;if(Oe.componentClass!=Qe.componentClass||((Je=A.current)==null?void 0:Je.refresh)==null)return;A.current.refresh(Qe.params)!=!0&&f(st=>st+1)},[l]),S.exports.useLayoutEffect(()=>{if(!(u&&!u.compDetails.componentFromFramework)||s.isDestroyed())return;const oe=u.compDetails,Oe=u.popup===!0,Qe=oe.newAgStackInstance();return Qe.then(je=>{var Je;if(!je)return;const be=je.getGui();if(V(je),!Oe){const st=(R?z:N).current;st==null||st.appendChild(be),(Je=je.afterGuiAttached)==null||Je.call(je)}y(je)}),()=>{Qe.then(je=>{const be=je.getGui();e.disableEditorTooltipFeature(),s.destroyBean(je),V(void 0),y(void 0),be==null||be.remove()})}},[u]);const le=S.exports.useCallback(Ce=>{if(z.current=Ce,!Ce||s.isDestroyed()||!e.isAlive()){const Qe=se.current;se.current=[];for(const je of Qe)je();return}let oe;const Oe=Qe=>{Qe&&(Ce.insertAdjacentElement("afterbegin",Qe.getGui()),se.current.push(()=>{C0(Qe.getGui()),s.destroyBean(Qe),te.current===oe&&(te.current=void 0)}))};m&&Oe(e.createSelectionCheckbox()),w&&Oe(e.createDndSource()),C&&(oe=e.createRowDragComp(),te.current=oe,oe&&(Oe(oe),oe.refreshVisibility()))},[e,s,w,C,m]),ce=S.exports.useCallback(()=>{var je;const Ce=!e.isCellSpanning()||O.current,oe=N.current;if(!oe||!Ce||!e||!e.isAlive()||s.isDestroyed()){a.current=s.destroyBean(a.current);return}a.current=s.createBean(new aa);const Oe={toggleCss:(be,Je)=>X.current.toggleCss(be,Je),setUserStyles:be=>g(be),getFocusableElement:()=>N.current,setIncludeSelection:be=>v(be),setIncludeRowDrag:be=>x(be),setIncludeDndSource:be=>k(be),getCellEditor:()=>{var be;return(be=q.current)!=null?be:null},getCellRenderer:()=>{var be;return(be=A.current)!=null?be:G.current},getParentOfValue:()=>{var be,Je;return(Je=(be=Z.current)!=null?be:z.current)!=null?Je:N.current},setRenderDetails:(be,Je,st)=>{var Vt;const mt=()=>{c(at=>(at==null?void 0:at.compDetails)!==be||(at==null?void 0:at.value)!==Je||(at==null?void 0:at.force)!==st?{value:Je,compDetails:be,force:st}:at)};if(((Vt=be==null?void 0:be.params)==null?void 0:Vt.deferRender)&&!e.rowNode.group){const{loadingComp:at,onReady:Mn}=e.getDeferLoadingCellRenderer();if(at){c({value:void 0,compDetails:at,force:!1}),Mn.then(()=>r3(mt));return}}mt()},setEditDetails:(be,Je,st,mt)=>{if(be){let Vt;be.componentFromFramework&&(mt?Vt=new O3(be.params,()=>f(at=>at+1)):fp()),h({compDetails:be,popup:Je,popupPosition:st,compProxy:Vt}),Je||c(void 0)}else e.hasBrowserFocus()&&Oe.getFocusableElement().focus({preventScroll:!0}),q.current=void 0,h(void 0)},refreshEditStyles:(be,Je)=>{if(!N.current)return;const{current:st}=X;st.toggleCss("ag-cell-value",!W),st.toggleCss("ag-cell-inline-editing",!!be&&!Je),st.toggleCss("ag-cell-popup-editing",!!be&&!!Je),st.toggleCss("ag-cell-not-inline-editing",!be||!!Je)}},Qe=z.current||void 0;e.setComp(Oe,oe,(je=O.current)!=null?je:void 0,Qe,t,r,a.current)},[]),ee=S.exports.useCallback(Ce=>{N.current=Ce,ce()},[]),Ee=S.exports.useCallback(Ce=>{O.current=Ce,ce()},[]),L=S.exports.useMemo(()=>{var oe;return!!(((oe=l==null?void 0:l.compDetails)==null?void 0:oe.componentFromFramework)&&la(l.compDetails.componentClass))},[l]);S.exports.useLayoutEffect(()=>{if(!N.current)return;const{current:Ce}=X;Ce.toggleCss("ag-cell-value",!W),Ce.toggleCss("ag-cell-inline-editing",!!u&&!u.popup),Ce.toggleCss("ag-cell-popup-editing",!!u&&!!u.popup),Ce.toggleCss("ag-cell-not-inline-editing",!u||!!u.popup)});const He=()=>{var Oe,Qe;const{compDetails:Ce,value:oe}=l;if(!Ce)return(Qe=(Oe=oe==null?void 0:oe.toString)==null?void 0:Oe.call(oe))!=null?Qe:oe;if(Ce.componentFromFramework){const je=Ce.componentClass;return ue.createElement(S.exports.Suspense,{fallback:ue.createElement(G3,{cellCtrl:e,parent:N})},L?ue.createElement(je,{...Ce.params,key:d}):ue.createElement(je,{...Ce.params,key:d,ref:A}))}},Ae=()=>{const Ce=()=>l==null?null:W?ue.createElement("span",{role:"presentation",id:`cell-${o}`,className:B,ref:ie},He()):He(),oe=Oe=>W3(Oe,V,N.current,e,E);return u!=null?u.popup?ue.createElement(ue.Fragment,null,Ce(),oe(u)):oe(u):Ce()},Ue=()=>ue.createElement("div",{ref:ee,style:p,role:D,"col-id":i},W?ue.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:le},Ae()):Ae());return e.isCellSpanning()?ue.createElement("div",{ref:Ee,className:"ag-spanned-cell-wrapper",role:"presentation"},Ue()):Ue()},U3=S.exports.memo(z3),j3=({rowCtrl:e,containerType:t})=>{const{context:r,gos:n,editSvc:s}=S.exports.useContext(wr),i=S.exports.useContext($S)==="default",o=S.exports.useRef(),a=S.exports.useRef(e.getDomOrder()),l=e.isFullWidth(),c=e.rowNode.displayed,[u,h]=S.exports.useState(()=>c?e.rowNode.getRowIndexString():null),[d,f]=S.exports.useState(()=>e.rowId),[p,g]=S.exports.useState(()=>e.businessKey),[m,v]=S.exports.useState(()=>e.rowStyles),C=S.exports.useRef(null),[x,w]=S.exports.useState(()=>null),[k,E]=S.exports.useState(),[y,R]=S.exports.useState(()=>c?e.getInitialRowTop(t):void 0),[D,N]=S.exports.useState(()=>c?e.getInitialTransform(t):void 0),O=S.exports.useRef(null),A=S.exports.useRef(),G=S.exports.useRef(),q=S.exports.useRef(!1),[z,se]=S.exports.useState(0);S.exports.useEffect(()=>{var Ee;if(q.current||!k||z>10)return;const ee=(Ee=O.current)==null?void 0:Ee.firstChild;ee?(e.setupDetailRowAutoHeight(ee),q.current=!0):se(L=>L+1)},[k,z]);const te=S.exports.useRef();te.current||(te.current=new Zl(()=>O.current));const Z=S.exports.useRef(()=>{}),H=S.exports.useCallback(ee=>(Z.current=ee,()=>{Z.current=()=>{}}),[]),Q=n3(H,()=>C.current,[]),ie=i?Q:x,F=S.exports.useCallback(ee=>{if(O.current=ee,o.current=ee?r.createBean(new aa):r.destroyBean(o.current),!ee){e.unsetComp(t);return}if(!e.isAlive()||r.isDestroyed())return;const Ee={setTop:R,setTransform:N,toggleCss:(L,He)=>te.current.toggleCss(L,He),setDomOrder:L=>a.current=L,setRowIndex:h,setRowId:f,setRowBusinessKey:g,setUserStyles:v,setCellCtrls:(L,He)=>{const Ae=C.current,Ue=lh(Ae,L,a.current);Ue!==Ae&&(C.current=Ue,i?Z.current():_l(He,()=>w(Ue)))},showFullWidth:L=>{G.current=L.params,E(L)},getFullWidthCellRenderer:()=>A.current,getFullWidthCellRendererParams:()=>G.current,refreshFullWidth:L=>{const He=L();return G.current=He,ne.current?(E(Ae=>({...Ae,params:He})),!0):!A.current||!A.current.refresh?!1:A.current.refresh(He)}};e.setComp(Ee,ee,t,o.current)},[]);S.exports.useLayoutEffect(()=>ec(k,r,O.current,A),[k]);const W=S.exports.useMemo(()=>{const ee={top:y,transform:D};return Object.assign(ee,m),ee},[y,D,m]),B=l&&(k==null?void 0:k.componentFromFramework),V=!l&&ie!=null,X=S.exports.useMemo(()=>!!((k==null?void 0:k.componentFromFramework)&&la(k.componentClass)),[k]),ne=S.exports.useRef(!1);S.exports.useEffect(()=>{ne.current=X&&!!k&&!!n.get("reactiveCustomComponents")},[X,k]);const le=()=>ie==null?void 0:ie.map(ee=>{var Ee;return ue.createElement(U3,{cellCtrl:ee,editingCell:(Ee=s==null?void 0:s.isEditing(ee,{withOpenEditor:!0}))!=null?Ee:!1,printLayout:e.printLayout,key:ee.instanceId})}),ce=()=>{const ee=k.componentClass;return X?ue.createElement(ee,{...k.params}):ue.createElement(ee,{...k.params,ref:A})};return ue.createElement("div",{ref:F,role:"row",style:W,"row-index":u,"row-id":d,"row-business-key":p},V?le():B?ce():null)},y1=S.exports.memo(j3),$3=({name:e})=>{const{context:t,gos:r}=S.exports.useContext(wr),n=S.exports.useMemo(()=>ql(e),[e]),s=S.exports.useRef(null),i=S.exports.useRef(null),o=S.exports.useRef(null),a=S.exports.useRef([]),l=S.exports.useRef([]),[c,u]=S.exports.useState(()=>[]),h=!!r.get("enableCellSpan")&&!!n.getSpannedRowCtrls,d=S.exports.useRef([]),f=S.exports.useRef([]),[p,g]=S.exports.useState(()=>[]),m=S.exports.useRef(!1),v=S.exports.useRef(),C=S.exports.useMemo(()=>cn("ag-viewport",pS(e)),[e]),x=S.exports.useMemo(()=>cn(fu(e)),[e]),w=S.exports.useMemo(()=>cn("ag-spanning-container",HA(e)),[e]),k=n.type==="center"||h,E=k?s:i;pi(" AG Row Container "+e+" ",E);const y=S.exports.useCallback(()=>{const z=!k||s.current!=null,se=i.current!=null,te=!h||o.current!=null;return z&&se&&te},[]),R=S.exports.useCallback(()=>s.current==null&&i.current==null&&o.current==null,[]),D=S.exports.useCallback(()=>{var z;if(R()&&(v.current=t.destroyBean(v.current)),!t.isDestroyed()&&y()){const se=H=>{const Q=lh(l.current,a.current,m.current);Q!==l.current&&(l.current=Q,_l(H,()=>u(Q)))},te=H=>{const Q=lh(f.current,d.current,m.current);Q!==f.current&&(f.current=Q,_l(H,()=>g(Q)))},Z={setHorizontalScroll:H=>{s.current&&(s.current.scrollLeft=H)},setViewportHeight:H=>{s.current&&(s.current.style.height=H)},setRowCtrls:({rowCtrls:H,useFlushSync:Q})=>{const ie=!!Q&&a.current.length>0&&H.length>0;a.current=H,se(ie)},setSpannedRowCtrls:(H,Q)=>{const ie=!!Q&&d.current.length>0&&H.length>0;d.current=H,te(ie)},setDomOrder:H=>{m.current!=H&&(m.current=H,se(!1))},setContainerWidth:H=>{i.current&&(i.current.style.width=H)},setOffsetTop:H=>{i.current&&(i.current.style.transform=`translateY(${H})`)}};v.current=t.createBean(new YA(e)),v.current.setComp(Z,i.current,(z=o.current)!=null?z:void 0,s.current)}},[y,R]),N=S.exports.useCallback(z=>{i.current=z,D()},[D]),O=S.exports.useCallback(z=>{o.current=z,D()},[D]),A=S.exports.useCallback(z=>{s.current=z,D()},[D]),G=()=>ue.createElement("div",{className:x,ref:N,role:k?"presentation":"rowgroup"},c.map(z=>ue.createElement(y1,{rowCtrl:z,containerType:n.type,key:z.instanceId})));if(!k)return G();const q=()=>ue.createElement("div",{className:w,ref:O,role:"presentation"},p.map(z=>ue.createElement(y1,{rowCtrl:z,containerType:n.type,key:z.instanceId})));return ue.createElement("div",{className:C,ref:A,role:"rowgroup"},G(),h?q():null)},K3=S.exports.memo($3),X3=()=>{const e=S.exports.useContext(wr),{context:t,overlays:r}=e,[n,s]=S.exports.useState(""),[i,o]=S.exports.useState(0),[a,l]=S.exports.useState(0),[c,u]=S.exports.useState("0px"),[h,d]=S.exports.useState("0px"),[f,p]=S.exports.useState("100%"),[g,m]=S.exports.useState("0px"),[v,C]=S.exports.useState("0px"),[x,w]=S.exports.useState("100%"),[k,E]=S.exports.useState(!0),[y,R]=S.exports.useState(!0),[D,N]=S.exports.useState(null),[O,A]=S.exports.useState(""),[G,q]=S.exports.useState(null),[z,se]=S.exports.useState("ag-layout-normal"),te=S.exports.useRef();te.current||(te.current=new Zl(()=>Z.current));const Z=S.exports.useRef(null),H=S.exports.useRef(null),Q=S.exports.useRef(null),ie=S.exports.useRef(null),F=S.exports.useRef(null),W=S.exports.useRef(null),B=S.exports.useRef(null),V=S.exports.useRef([]),X=S.exports.useRef([]);pi(" AG Grid Body ",Z),pi(" AG Pinned Top ",H),pi(" AG Sticky Top ",Q),pi(" AG Middle ",W),pi(" AG Pinned Bottom ",B);const ne=S.exports.useCallback(be=>{if(Z.current=be,!be||t.isDestroyed()){V.current=t.destroyBeans(V.current);for(const We of X.current)We();X.current=[];return}const Je=(We,vt)=>{We.appendChild(vt),X.current.push(()=>vt.remove())},st=We=>{const vt=t.createBean(new We);return V.current.push(vt),vt},mt=(We,vt,Me)=>{Je(We,document.createComment(Me)),Je(We,st(vt).getGui())};mt(be,rP," AG Fake Horizontal Scroll ");const Vt=r==null?void 0:r.getOverlayWrapperCompClass();Vt&&mt(be,Vt," AG Overlay Wrapper "),F.current&&mt(F.current,sP," AG Fake Vertical Scroll ");const at={setRowAnimationCssOnBodyViewport:s,setColumnCount:We=>{Z.current&&SR(Z.current,We)},setRowCount:We=>{Z.current&&wR(Z.current,We)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:d,setStickyTopWidth:p,setTopInvisible:E,setBottomInvisible:R,setColumnMovingCss:(We,vt)=>te.current.toggleCss(We,vt),updateLayoutClasses:se,setAlwaysVerticalScrollClass:N,setPinnedTopBottomOverflowY:A,setCellSelectableCss:(We,vt)=>q(vt?We:null),setBodyViewportWidth:We=>{W.current&&(W.current.style.width=We)},registerBodyViewportResizeListener:We=>{if(W.current){const vt=ia(e,W.current,We);X.current.push(()=>vt())}},setStickyBottomHeight:m,setStickyBottomBottom:C,setStickyBottomWidth:w,setGridRootRole:We=>be.setAttribute("role",We)},Mn=t.createBean(new JA);V.current.push(Mn),Mn.setComp(at,be,W.current,H.current,B.current,Q.current,ie.current)},[]),le=S.exports.useMemo(()=>cn("ag-root","ag-unselectable",z),[z]),ce=S.exports.useMemo(()=>cn("ag-body-viewport",n,z,D,G),[n,z,D,G]),ee=S.exports.useMemo(()=>cn("ag-body",z),[z]),Ee=S.exports.useMemo(()=>cn("ag-floating-top",k?"ag-invisible":null,G),[G,k]),L=S.exports.useMemo(()=>cn("ag-sticky-top",G),[G]),He=S.exports.useMemo(()=>cn("ag-sticky-bottom",g==="0px"?"ag-invisible":null,G),[G,g]),Ae=S.exports.useMemo(()=>cn("ag-floating-bottom",y?"ag-invisible":null,G),[G,y]),Ue=S.exports.useMemo(()=>({height:i,minHeight:i,overflowY:O}),[i,O]),Ce=S.exports.useMemo(()=>({height:c,top:h,width:f}),[c,h,f]),oe=S.exports.useMemo(()=>({height:g,bottom:v,width:x}),[g,v,x]),Oe=S.exports.useMemo(()=>({height:a,minHeight:a,overflowY:O}),[a,O]),Qe=be=>ue.createElement(K3,{name:be,key:`${be}-container`}),je=({section:be,children:Je,className:st,style:mt})=>ue.createElement("div",{ref:be,className:st,role:"presentation",style:mt},Je.map(Qe));return ue.createElement("div",{ref:ne,className:le},ue.createElement(L3,null),je({section:H,className:Ee,style:Ue,children:["topLeft","topCenter","topRight","topFullWidth"]}),ue.createElement("div",{className:ee,ref:F,role:"presentation"},je({section:W,className:ce,children:["left","center","right","fullWidth"]})),je({section:Q,className:L,style:Ce,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),je({section:ie,className:He,style:oe,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),je({section:B,className:Ae,style:Oe,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},Y3=S.exports.memo(X3),Q3=(e,t)=>{const{children:r,eFocusableElement:n,onTabKeyDown:s,gridCtrl:i,forceFocusOutWhenTabGuardsAreEmpty:o,isEmpty:a}=e,{context:l}=S.exports.useContext(wr),c=S.exports.useRef(null),u=S.exports.useRef(null),h=S.exports.useRef(),d=v=>{var x,w;const C=v==null?void 0:parseInt(v,10).toString();for(const k of[c,u])C===void 0?(x=k.current)==null||x.removeAttribute("tabindex"):(w=k.current)==null||w.setAttribute("tabindex",C)};S.exports.useImperativeHandle(t,()=>({forceFocusOutOfContainer(v){var C;(C=h.current)==null||C.forceFocusOutOfContainer(v)}}));const f=S.exports.useCallback(()=>{const v=c.current,C=u.current;if(!v&&!C||l.isDestroyed()){h.current=l.destroyBean(h.current);return}if(v&&C){const x={setTabIndex:d};h.current=l.createBean(new DP({comp:x,eTopGuard:v,eBottomGuard:C,eFocusableElement:n,onTabKeyDown:s,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:w=>i.focusInnerElement(w),isEmpty:a}))}},[]),p=S.exports.useCallback(v=>{c.current=v,f()},[f]),g=S.exports.useCallback(v=>{u.current=v,f()},[f]),m=v=>{const C=v==="top"?Jd.TAB_GUARD_TOP:Jd.TAB_GUARD_BOTTOM;return ue.createElement("div",{className:`${Jd.TAB_GUARD} ${C}`,role:"presentation",ref:v==="top"?p:g})};return ue.createElement(ue.Fragment,null,m("top"),r,m("bottom"))},Z3=S.exports.forwardRef(Q3),q3=S.exports.memo(Z3),J3=({context:e})=>{const[t,r]=S.exports.useState(""),[n,s]=S.exports.useState(""),[i,o]=S.exports.useState(null),[a,l]=S.exports.useState(null),[c,u]=S.exports.useState(!1),[h,d]=S.exports.useState(),f=S.exports.useRef(),p=S.exports.useRef(null),g=S.exports.useRef(),[m,v]=S.exports.useState(null),C=S.exports.useRef(()=>{}),x=S.exports.useRef(),w=S.exports.useRef([]),k=S.exports.useCallback(()=>{},[]);pi(" AG Grid ",p);const E=S.exports.useCallback(A=>{if(p.current=A,f.current=A?e.createBean(new BP):e.destroyBean(f.current),!A||e.isDestroyed())return;const G=f.current;C.current=G.focusInnerElement.bind(G);const q={destroyGridUi:()=>{},setRtlClass:r,forceFocusOutOfContainer:z=>{var se,te;if(!z&&((se=x.current)==null?void 0:se.isDisplayed())){x.current.forceFocusOutOfContainer(z);return}(te=g.current)==null||te.forceFocusOutOfContainer(z)},updateLayoutClasses:s,getFocusableContainers:()=>{var te;const z=[],se=(te=p.current)==null?void 0:te.querySelector(".ag-root");se&&z.push({getGui:()=>se});for(const Z of w.current)Z.isDisplayed()&&z.push(Z);return z},setCursor:o,setUserSelect:l};G.setComp(q,A,A),u(!0)},[]);S.exports.useEffect(()=>{const A=f.current,G=p.current;if(!h||!A||!m||!G||e.isDestroyed())return;const q=[],{watermarkSelector:z,paginationSelector:se,sideBarSelector:te,statusBarSelector:Z,gridHeaderDropZonesSelector:H}=A.getOptionalSelectors(),Q=[];if(H){const F=e.createBean(new H.component),W=F.getGui();G.insertAdjacentElement("afterbegin",W),Q.push(W),q.push(F)}if(te){const F=e.createBean(new te.component),W=F.getGui(),B=m.querySelector(".ag-tab-guard-bottom");B&&(B.insertAdjacentElement("beforebegin",W),Q.push(W)),q.push(F),w.current.push(F)}const ie=F=>{const W=e.createBean(new F),B=W.getGui();return G.insertAdjacentElement("beforeend",B),Q.push(B),q.push(W),W};if(Z&&ie(Z.component),se){const F=ie(se.component);x.current=F,w.current.push(F)}return z&&ie(z.component),()=>{e.destroyBeans(q);for(const F of Q)F.remove()}},[h,m,e]);const y=S.exports.useMemo(()=>cn("ag-root-wrapper",t,n),[t,n]),R=S.exports.useMemo(()=>cn("ag-root-wrapper-body","ag-focus-managed",n),[n]),D=S.exports.useMemo(()=>({userSelect:a!=null?a:"",WebkitUserSelect:a!=null?a:"",cursor:i!=null?i:""}),[a,i]),N=S.exports.useCallback(A=>{g.current=A,d(A!==null)},[]),O=S.exports.useCallback(()=>{var A;return!((A=f.current)!=null&&A.isFocusable())},[]);return ue.createElement("div",{ref:E,className:y,style:D,role:"presentation"},ue.createElement("div",{className:R,ref:v,role:"presentation"},c&&m&&!e.isDestroyed()&&ue.createElement(wr.Provider,{value:e.getBeans()},ue.createElement(q3,{ref:N,eFocusableElement:m,onTabKeyDown:k,gridCtrl:f.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:O},ue.createElement(Y3,null)))))},eO=S.exports.memo(J3),tO=class extends we{postConstruct(){if(this.beans.colAutosize){const e=this.queueResizeOperationsForTick.bind(this);this.addManagedEventListeners({rowExpansionStateChanged:e,expandOrCollapseAll:e,cellValueChanged:e,rowNodeDataChanged:e,rowDataUpdated:e})}}queueResizeOperationsForTick(){const e=this.beans.colAutosize;e.shouldQueueResizeOperations=!0,setTimeout(()=>{e.processResizeOperations()},0)}areHeaderCellsRendered(){return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(t=>t.areCellsRendered()))}areCellsRendered(){return this.beans.rowRenderer.getAllRowCtrls().every(e=>e.isRowRendered()&&e.getAllCellCtrls().every(t=>!!t.eGui))}},JS={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},rO={gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0,...JS},e2=new Set(Object.keys(rO)),nO=new Set(Object.keys(JS)),t2=e=>{var v,C;const t=S.exports.useRef(),r=S.exports.useRef(null),n=S.exports.useRef(null),s=S.exports.useRef([]),i=S.exports.useRef([]),o=S.exports.useRef(e),a=S.exports.useRef(),l=S.exports.useRef(),c=S.exports.useRef(!1),[u,h]=S.exports.useState(void 0),[,d]=S.exports.useState(0),f=S.exports.useCallback(x=>{var G;if(r.current=x,!x){for(const q of s.current)q();s.current.length=0;return}const w=e.modules||[];n.current||(n.current=new S3(()=>d(q=>q+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),s.current.push(()=>{var q;(q=n.current)==null||q.destroy(),n.current=null}));const k=x_(e.gridOptions,e,Object.keys(e).filter(q=>!e2.has(q))),E=()=>{if(c.current){const q=()=>{var se;return(se=a.current)!=null&&se.shouldQueueUpdates()?void 0:i.current.shift()};let z=q();for(;z;)z(),z=q()}},y=new aO(E);a.current=y;const R=new tO,D={providedBeanInstances:{frameworkCompWrapper:new iO(n.current,k),renderStatus:R},modules:w,frameworkOverrides:y,setThemeOnGridDiv:!0},N=q=>{h(q),q.createBean(R),s.current.push(()=>{q.destroy()}),q.getBean("ctrlsSvc").whenReady({addDestroyFunc:z=>{s.current.push(z)}},()=>{var se;if(q.isDestroyed())return;const z=t.current;z&&((se=e.passGridApi)==null||se.call(e,z))})},O=q=>{q.getBean("ctrlsSvc").whenReady({addDestroyFunc:z=>{s.current.push(z)}},()=>{for(const z of i.current)z();i.current.length=0,c.current=!0})},A=new qM;(G=k.gridId)!=null||(k.gridId=l.current),t.current=A.create(x,k,N,O,D),s.current.push(()=>{t.current=void 0}),t.current&&(l.current=t.current.getGridId())},[]),p=S.exports.useMemo(()=>({height:"100%",...e.containerStyle||{}}),[e.containerStyle]),g=S.exports.useCallback(x=>{var w;c.current&&!((w=a.current)!=null&&w.shouldQueueUpdates())?x():i.current.push(x)},[]);S.exports.useEffect(()=>{const x=sO(o.current,e);o.current=e,g(()=>{t.current&&C_(x,t.current)})},[e]);const m=!ue.useSyncExternalStore||au(e,"renderingMode")==="legacy"?"legacy":"default";return ue.createElement("div",{style:p,className:e.className,ref:f},ue.createElement($S.Provider,{value:m},u&&!u.isDestroyed()?ue.createElement(eO,{key:u.instanceId,context:u}):null,(C=(v=n.current)==null?void 0:v.getPortals())!=null?C:null))};function sO(e,t){const r={};for(const n of Object.keys(t)){if(e2.has(n)){nO.has(n)&&Ge(274,{prop:n});continue}const s=t[n];e[n]!==s&&(r[n]=s)}return r}var iO=class extends JM{constructor(e,t){super(),this.parent=e,this.gridOptions=t}createWrapper(e,t){const r=this.gridOptions;if(au(r,"reactiveCustomComponents")){const o=(a=>{switch(a){case"filter":return au(r,"enableFilterHandlers")?h3:u3;case"floatingFilterComponent":return au(r,"enableFilterHandlers")?g3:f3;case"dateComponent":return l3;case"dragAndDropImageComponent":return c3;case"loadingOverlayComponent":return m3;case"noRowsOverlayComponent":return x3;case"statusPanel":return C3;case"toolPanel":return w3;case"menuItem":return v3;case"cellRenderer":return a3;case"innerHeaderComponent":return p3}})(t.name);if(o)return new o(e,this.parent,t)}else switch(t.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":fp();break}const s=!t.cellRenderer&&t.name!=="toolPanel";return new QS(e,this.parent,t,s)}},oO=S.exports.forwardRef((e,t)=>{const r=S.exports.useContext(wr),{registry:n,context:s,gos:i,rowModel:o}=r,[a,l]=S.exports.useState(()=>new pn),[c,u]=S.exports.useState(()=>new pn),[h,d]=S.exports.useState(),[f,p]=S.exports.useState(),g=S.exports.useRef(),m=S.exports.useRef(null),v=S.exports.useRef(),C=S.exports.useMemo(()=>{var y;return qR(e.api.getGridId(),(y=h==null?void 0:h.rowModelType)!=null?y:"clientSide")},[e]),x=S.exports.useMemo(()=>a.toString()+" ag-details-row",[a]),w=S.exports.useMemo(()=>c.toString()+" ag-details-grid",[c]);t&&S.exports.useImperativeHandle(t,()=>({refresh(){var y,R;return(R=(y=g.current)==null?void 0:y.refresh())!=null?R:!1}})),e.template&&Ge(230);const k=S.exports.useCallback(y=>{var N;if(m.current=y,!y||s.isDestroyed()){g.current=s.destroyBean(g.current),(N=v.current)==null||N.call(v);return}const R={toggleCss:(O,A)=>l(G=>G.setClass(O,A)),toggleDetailGridCss:(O,A)=>u(G=>G.setClass(O,A)),setDetailGrid:O=>d(O),setRowData:O=>p(O),getGui:()=>m.current},D=n.createDynamicBean("detailCellRendererCtrl",!0);if(!!D&&(s.createBean(D),D.init(R,e),g.current=D,i.get("detailRowAutoHeight"))){const O=()=>{if(m.current==null)return;const A=m.current.clientHeight;A!=null&&A>0&&setTimeout(()=>{e.node.setRowHeight(A),(Uh(i)||qg(i))&&o.onRowHeightChanged()},0)};v.current=ia(r,y,O),O()}},[]),E=S.exports.useCallback(y=>{var R;(R=g.current)==null||R.registerDetailWithMaster(y)},[]);return ue.createElement("div",{className:x,ref:k},h&&ue.createElement(t2,{className:w,...h,modules:C,rowData:f,passGridApi:E}))}),aO=class extends TS{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:v1,agGroupRowRenderer:v1,agDetailCellRenderer:oO},this.wrapIncoming=(t,r)=>r==="ensureVisible"?t3(t):t()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return e3()}},lO=class extends S.exports.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e;for(const t of this.apiListeners)t(e)}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return ge(t2,{...this.props,passGridApi:this.setGridApi})}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ch={};ch.version="0.18.5";var r2=1252,cO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pp=function(e){cO.indexOf(e)!=-1&&(r2=gp[0]=e)};function uO(){pp(1252)}var Tn=function(e){pp(e)};function mp(){Tn(1200),uO()}function S1(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function hO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function n2(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ma=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?hO(e.slice(2)):t==254&&r==255?n2(e.slice(2)):t==65279?e.slice(1):e},Mc=function(t){return String.fromCharCode(t)},k1=function(t){return String.fromCharCode(t)},Is,Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Dl(e){for(var t="",r=0,n=0,s=0,i=0,o=0,a=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),o=(r&3)<<4|n>>4,s=e.charCodeAt(c++),a=(n&15)<<2|s>>6,l=s&63,isNaN(n)?a=l=64:isNaN(s)&&(l=64),t+=Ns.charAt(i)+Ns.charAt(o)+Ns.charAt(a)+Ns.charAt(l);return t}function Qr(e){var t="",r=0,n=0,s=0,i=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Ns.indexOf(e.charAt(c++)),o=Ns.indexOf(e.charAt(c++)),r=i<<2|o>>4,t+=String.fromCharCode(r),a=Ns.indexOf(e.charAt(c++)),n=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(n)),l=Ns.indexOf(e.charAt(c++)),s=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Ne=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ys=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function qs(e){return Ne?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function b1(e){return Ne?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ur=function(t){return Ne?ys(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Jh(e){if(typeof ArrayBuffer>"u")return Ur(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function li(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function dO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function vp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return vp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Qt=Ne?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ys(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function fO(e){for(var t=[],r=0,n=e.length+250,s=qs(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|a>>6&15|(o&3)<<4,s[r++]=128|a&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=qs(65535),n=65530)}return t.push(s.slice(0,r)),Qt(t)}var Rr=/\u0000/g,Oa=/[\u0001-\u0006]/g;function Oo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Rn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function xp(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function uh(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function gO(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function pO(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var E1=Math.pow(2,32);function io(e,t){if(e>E1||e<-E1)return gO(e,t);var r=Math.round(e);return pO(r,t)}function hh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var F1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],uf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var Re={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},T1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function dh(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(s);c<t&&(h=Math.floor(s),a=h*o+i,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),i=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=i):(u=c,a=o)),!r)return[0,n*a,u];var d=Math.floor(n*a/u);return[d,n*a-d*u,u]}function yi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,o=[],a={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++s==86400&&(a.T=s=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=kO(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=s%60,s=Math.floor(s/60),a.M=s%60,s=Math.floor(s/60),a.H=s,a.q=i,a}var s2=new Date(1899,11,31,0,0,0),xO=s2.getTime(),CO=new Date(1900,2,1,0,0,0);function i2(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=CO&&(r+=24*60*60*1e3),(r-(xO+(e.getTimezoneOffset()-s2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yO(e){var t=e<0?12:11,r=Cp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function SO(e){var t=Cp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Al(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yO(e):t===10?r=e.toFixed(10).substr(0,12):r=SO(e),Cp(wO(r.toUpperCase()))}function Hi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Al(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return wn(14,i2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function kO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function bO(e,t,r,n){var s="",i=0,o=0,a=r.y,l,c=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return uf[r.m-1][1];case 5:return uf[r.m-1][0];default:return uf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return F1[r.q][0];default:return F1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Rn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=Rn(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Rn(l,c):"";return u}function Bs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var o2=/%/g;function EO(e,t,r){var n=t.replace(o2,""),s=t.length-n.length;return hs(e,n,r*Math.pow(10,2*s))+Tt("%",s)}function FO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function a2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+a2(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var l2=/# (\?+)( ?)\/( ?)(\d+)/;function TO(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),o=s-i*n,a=n;return r+(i===0?"":""+i)+" "+(o===0?Tt(" ",e[1].length+1+e[4].length):xp(o,e[1].length)+e[2]+"/"+e[3]+Rn(a,e[4].length))}function RO(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var c2=/^#*0*\.([0#]+)/,u2=/\).*[0#]/,h2=/\(###\) ###\\?-####/;function kr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function R1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _O(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function DO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function rn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(u2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rn("n",n,r):"("+rn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return FO(e,t,r);if(t.indexOf("%")!==-1)return EO(e,t,r);if(t.indexOf("E")!==-1)return a2(t,r);if(t.charCodeAt(0)===36)return"$"+rn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+io(l,t.length);if(t.match(/^[#?]+$/))return s=io(r,0),s==="0"&&(s=""),s.length>t.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(l2))return TO(i,l,c);if(t.match(/^#+0+$/))return c+io(l,t.length-t.indexOf("0"));if(i=t.match(c2))return s=R1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+kr(i[1])).replace(/\.$/,"."+kr(i[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+Tt("0",kr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+R1(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Bs(io(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rn(e,t,-r):Bs(""+(Math.floor(r)+_O(r,i[1].length)))+"."+Rn(_1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return rn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Oo(rn(e,t.replace(/[\\-]/g,""),r)),o=0,Oo(Oo(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<s.length?s.charAt(o++):p==="0"?"0":""}));if(t.match(h2))return s=rn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),a=dh(l,Math.pow(10,o)-1,!1),s=""+c,u=hs("n",i[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=uh(a[2],o),u.length<i[4].length&&(u=kr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),a=dh(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?xp(a[1],o)+i[2]+"/"+i[3]+uh(a[2],o):Tt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=io(r,0),t.length<=s.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var h=t.indexOf(".")-o,d=t.length-s.length-h;return kr(t.substr(0,h)+s+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=_1(r,i[1].length),r<0?"-"+rn(e,t,-r):Bs(DO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Rn(0,3-p.length):"")+p})+"."+Rn(o,i[1].length);switch(t){case"###,##0.00":return rn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=Bs(io(l,0));return f!=="0"?c+f:"";case"###,###.00":return rn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return rn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function AO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function PO(e,t,r){var n=t.replace(o2,""),s=t.length-n.length;return hs(e,n,r*Math.pow(10,2*s))+Tt("%",s)}function d2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+d2(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(u2)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bn("n",n,r):"("+Bn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return AO(e,t,r);if(t.indexOf("%")!==-1)return PO(e,t,r);if(t.indexOf("E")!==-1)return d2(t,r);if(t.charCodeAt(0)===36)return"$"+Bn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Rn(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(l2))return RO(i,l,c);if(t.match(/^#+0+$/))return c+Rn(l,t.length-t.indexOf("0"));if(i=t.match(c2))return s=(""+r).replace(/^([^\.]+)$/,"$1."+kr(i[1])).replace(/\.$/,"."+kr(i[1])),s=s.replace(/\.(\d*)$/,function(p,g){return"."+g+Tt("0",kr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Bs(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):Bs(""+r)+"."+Tt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Bn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Oo(Bn(e,t.replace(/[\\-]/g,""),r)),o=0,Oo(Oo(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<s.length?s.charAt(o++):p==="0"?"0":""}));if(t.match(h2))return s=Bn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),a=dh(l,Math.pow(10,o)-1,!1),s=""+c,u=hs("n",i[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=uh(a[2],o),u.length<i[4].length&&(u=kr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),a=dh(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?xp(a[1],o)+i[2]+"/"+i[3]+uh(a[2],o):Tt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var h=t.indexOf(".")-o,d=t.length-s.length-h;return kr(t.substr(0,h)+s+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bn(e,t,-r):Bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Rn(0,3-p.length):"")+p})+"."+Rn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Bs(""+l);return f!=="0"?c+f:"";default:if(t.match(/\.[0#?]*$/))return Bn(e,t.slice(0,t.lastIndexOf(".")),r)+kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function hs(e,t,r){return(r|0)===r?Bn(e,t,r):rn(e,t,r)}function IO(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var f2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ca(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":hh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(f2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function LO(e,t,r,n){for(var s=[],i="",o=0,a="",l="t",c,u,h,d="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!hh(e,o))throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++o;break;case"\\":var f=e.charAt(++o),p=f==="("||f===")"?f:"t";s[s.length]={t:p,v:f},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=yi(t,r,e.charAt(o+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=yi(t,r),c==null))return"";for(i=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)i+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=d),s[s.length]={t:a,v:i},l=a;break;case"A":case"a":case"\u4E0A":var g={t:a,v:a};if(c==null&&(c=yi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",o+=5,d="h"):e.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(g.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),g.t="T",o+=5,d="h"):(g.t="t",++o),c==null&&g.t==="T")return"";s[s.length]=g,l=a;break;case"[":for(i=a;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(f2)){if(c==null&&(c=yi(t,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ca(e)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=a;++o<e.length&&(a=e.charAt(o))==="0";)i+=a;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)i+=a;s[s.length]={t:"n",v:i};break;case"?":for(i=a;e.charAt(++o)===a;)i+=a;s[s.length]={t:a,v:i},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:a,v:a},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);s[s.length]={t:"t",v:a},++o;break}var m=0,v=0,C;for(o=s.length-1,l="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=d,l="h",m<1&&(m=1);break;case"s":(C=s[o].v.match(/\.0+$/))&&(v=Math.max(v,C[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=s[o].t;break;case"m":l==="s"&&(s[o].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&s[o].v.match(/[Hh]/)&&(m=1),m<2&&s[o].v.match(/[Mm]/)&&(m=2),m<3&&s[o].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",w;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=bO(s[o].t.charCodeAt(0),s[o].v,c,v),s[o].t="t";break;case"n":case"?":for(w=o+1;s[w]!=null&&((a=s[w].t)==="?"||a==="D"||(a===" "||a==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[o].v+=s[w].v,s[w]={v:"",t:";"},++w;x+=s[o].v,o=w-1;break;case"G":s[o].t="t",s[o].v=Hi(t,r);break}var k="",E,y;if(x.length>0){x.charCodeAt(0)==40?(E=t<0&&x.charCodeAt(0)===45?-t:t,y=hs("n",x,E)):(E=t<0&&n>1?-t:t,y=hs("n",x,E),E<0&&s[0]&&s[0].t=="t"&&(y=y.substr(1),s[0].v="-"+s[0].v)),w=y.length-1;var R=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){R=o;break}var D=s.length;if(R===s.length&&y.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(w>=s[o].v.length-1?(w-=s[o].v.length,s[o].v=y.substr(w+1,s[o].v.length)):w<0?s[o].v="":(s[o].v=y.substr(0,w+1),w=-1),s[o].t="t",D=o);w>=0&&D<s.length&&(s[D].v=y.substr(0,w+1)+s[D].v)}else if(R!==s.length&&y.indexOf("E")===-1){for(w=y.indexOf(".")-1,o=R;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===R?s[o].v.indexOf(".")-1:s[o].v.length-1,k=s[o].v.substr(u+1);u>=0;--u)w>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(k=y.charAt(w--)+k);s[o].v=k,s[o].t="t",D=o}for(w>=0&&D<s.length&&(s[D].v=y.substr(0,w+1)+s[D].v),w=y.indexOf(".")+1,o=R;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==R)){for(u=s[o].v.indexOf(".")>-1&&o===R?s[o].v.indexOf(".")+1:0,k=s[o].v.substr(0,u);u<s[o].v.length;++u)w<y.length&&(k+=y.charAt(w++));s[o].v=k,s[o].t="t",D=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(E=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=hs(s[o].t,s[o].v,E),s[o].t="t");var N="";for(o=0;o!==s.length;++o)s[o]!=null&&(N+=s[o].v);return N}var D1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function A1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function MO(e,t){var r=IO(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(D1),a=r[1].match(D1);return A1(t,o)?[n,r[0]]:A1(t,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,i]}function wn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Re)[e],n==null&&(n=r.table&&r.table[T1[e]]||Re[T1[e]]),n==null&&(n=vO[e]||"General");break}if(hh(n,0))return Hi(t,r);t instanceof Date&&(t=i2(t,r.date1904));var s=MO(n,t);if(hh(s[1]))return Hi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return LO(s[1],t,r,s[0])}function ds(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Re[r]==null){t<0&&(t=r);continue}if(Re[r]==e){t=r;break}}t<0&&(t=391)}return Re[t]=e,t}function ed(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ds(e[t],t)}function ua(){Re=mO()}var OO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},g2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NO(e){var t=typeof e=="number"?Re[e]:e;return t=t.replace(g2,"(\\d+)"),new RegExp("^"+t+"$")}function BO(e,t,r){var n=-1,s=-1,i=-1,o=-1,a=-1,l=-1;(t.match(g2)||[]).forEach(function(h,d){var f=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":i=f;break;case"h":o=f;break;case"s":l=f;break;case"m":o>=0?a=f:s=f;break}}),l>=0&&a==-1&&s>=0&&(a=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var HO=function(){var e={};e.version="1.2.0";function t(){for(var y=0,R=new Array(256),D=0;D!=256;++D)y=D,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,R[D]=y;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(y){var R=0,D=0,N=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)O[N]=y[N];for(N=0;N!=256;++N)for(D=y[N],R=256+N;R<4096;R+=256)D=O[R]=D>>>8^y[D&255];var A=[];for(N=1;N!=16;++N)A[N-1]=typeof Int32Array<"u"?O.subarray(N*256,N*256+256):O.slice(N*256,N*256+256);return A}var s=n(r),i=s[0],o=s[1],a=s[2],l=s[3],c=s[4],u=s[5],h=s[6],d=s[7],f=s[8],p=s[9],g=s[10],m=s[11],v=s[12],C=s[13],x=s[14];function w(y,R){for(var D=R^-1,N=0,O=y.length;N<O;)D=D>>>8^r[(D^y.charCodeAt(N++))&255];return~D}function k(y,R){for(var D=R^-1,N=y.length-15,O=0;O<N;)D=x[y[O++]^D&255]^C[y[O++]^D>>8&255]^v[y[O++]^D>>16&255]^m[y[O++]^D>>>24]^g[y[O++]]^p[y[O++]]^f[y[O++]]^d[y[O++]]^h[y[O++]]^u[y[O++]]^c[y[O++]]^l[y[O++]]^a[y[O++]]^o[y[O++]]^i[y[O++]]^r[y[O++]];for(N+=15;O<N;)D=D>>>8^r[(D^y[O++])&255];return~D}function E(y,R){for(var D=R^-1,N=0,O=y.length,A=0,G=0;N<O;)A=y.charCodeAt(N++),A<128?D=D>>>8^r[(D^A)&255]:A<2048?(D=D>>>8^r[(D^(192|A>>6&31))&255],D=D>>>8^r[(D^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,G=y.charCodeAt(N++)&1023,D=D>>>8^r[(D^(240|A>>8&7))&255],D=D>>>8^r[(D^(128|A>>2&63))&255],D=D>>>8^r[(D^(128|G>>6&15|(A&3)<<4))&255],D=D>>>8^r[(D^(128|G&63))&255]):(D=D>>>8^r[(D^(224|A>>12&15))&255],D=D>>>8^r[(D^(128|A>>6&63))&255],D=D>>>8^r[(D^(128|A&63))&255]);return~D}return e.table=r,e.bstr=w,e.buf=k,e.str=E,e}(),Fe=function(){var t={};t.version="1.2.1";function r(b,P){for(var T=b.split("/"),_=P.split("/"),I=0,M=0,j=Math.min(T.length,_.length);I<j;++I){if(M=T[I].length-_[I].length)return M;if(T[I]!=_[I])return T[I]<_[I]?-1:1}return T.length-_.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var P=b.lastIndexOf("/");return P===-1?b:b.slice(0,P+1)}function s(b){if(b.charAt(b.length-1)=="/")return s(b.slice(0,-1));var P=b.lastIndexOf("/");return P===-1?b:b.slice(P+1)}function i(b,P){typeof P=="string"&&(P=new Date(P));var T=P.getHours();T=T<<6|P.getMinutes(),T=T<<5|P.getSeconds()>>>1,b.write_shift(2,T);var _=P.getFullYear()-1980;_=_<<4|P.getMonth()+1,_=_<<5|P.getDate(),b.write_shift(2,_)}function o(b){var P=b.read_shift(2)&65535,T=b.read_shift(2)&65535,_=new Date,I=T&31;T>>>=5;var M=T&15;T>>>=4,_.setMilliseconds(0),_.setFullYear(T+1980),_.setMonth(M-1),_.setDate(I);var j=P&31;P>>>=5;var re=P&63;return P>>>=6,_.setHours(P),_.setMinutes(re),_.setSeconds(j<<1),_}function a(b){rr(b,0);for(var P={},T=0;b.l<=b.length-4;){var _=b.read_shift(2),I=b.read_shift(2),M=b.l+I,j={};switch(_){case 21589:T=b.read_shift(1),T&1&&(j.mtime=b.read_shift(4)),I>5&&(T&2&&(j.atime=b.read_shift(4)),T&4&&(j.ctime=b.read_shift(4))),j.mtime&&(j.mt=new Date(j.mtime*1e3));break}b.l=M,P[_]=j}return P}var l;function c(){return l||(l={})}function u(b,P){if(b[0]==80&&b[1]==75)return sm(b,P);if((b[0]|32)==109&&(b[1]|32)==105)return Sb(b,P);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var T=3,_=512,I=0,M=0,j=0,re=0,U=0,K=[],Y=b.slice(0,512);rr(Y,0);var he=h(Y);switch(T=he[0],T){case 3:_=512;break;case 4:_=4096;break;case 0:if(he[1]==0)return sm(b,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+T)}_!==512&&(Y=b.slice(0,_),rr(Y,28));var xe=b.slice(0,_);d(Y,T);var Se=Y.read_shift(4,"i");if(T===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);Y.l+=4,j=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),re=Y.read_shift(4,"i"),I=Y.read_shift(4,"i"),U=Y.read_shift(4,"i"),M=Y.read_shift(4,"i");for(var fe=-1,ye=0;ye<109&&(fe=Y.read_shift(4,"i"),!(fe<0));++ye)K[ye]=fe;var Pe=f(b,_);m(U,M,Pe,_,K);var Ct=C(Pe,j,K,_);Ct[j].name="!Directory",I>0&&re!==G&&(Ct[re].name="!MiniFAT"),Ct[K[0]].name="!FAT",Ct.fat_addrs=K,Ct.ssz=_;var wt={},or=[],fa=[],ga=[];x(j,Ct,Pe,or,I,wt,fa,re),p(fa,ga,or),or.shift();var pa={FileIndex:fa,FullPaths:ga};return P&&P.raw&&(pa.raw={header:xe,sectors:Pe}),pa}function h(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(q,"Header Signature: "),b.l+=16;var P=b.read_shift(2,"u");return[b.read_shift(2,"u"),P]}function d(b,P){var T=9;switch(b.l+=2,T=b.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+T);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+T);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+T)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function f(b,P){for(var T=Math.ceil(b.length/P)-1,_=[],I=1;I<T;++I)_[I-1]=b.slice(I*P,(I+1)*P);return _[T-1]=b.slice(T*P),_}function p(b,P,T){for(var _=0,I=0,M=0,j=0,re=0,U=T.length,K=[],Y=[];_<U;++_)K[_]=Y[_]=_,P[_]=T[_];for(;re<Y.length;++re)_=Y[re],I=b[_].L,M=b[_].R,j=b[_].C,K[_]===_&&(I!==-1&&K[I]!==I&&(K[_]=K[I]),M!==-1&&K[M]!==M&&(K[_]=K[M])),j!==-1&&(K[j]=_),I!==-1&&_!=K[_]&&(K[I]=K[_],Y.lastIndexOf(I)<re&&Y.push(I)),M!==-1&&_!=K[_]&&(K[M]=K[_],Y.lastIndexOf(M)<re&&Y.push(M));for(_=1;_<U;++_)K[_]===_&&(M!==-1&&K[M]!==M?K[_]=K[M]:I!==-1&&K[I]!==I&&(K[_]=K[I]));for(_=1;_<U;++_)if(b[_].type!==0){if(re=_,re!=K[re])do re=K[re],P[_]=P[re]+"/"+P[_];while(re!==0&&K[re]!==-1&&re!=K[re]);K[_]=-1}for(P[0]+="/",_=1;_<U;++_)b[_].type!==2&&(P[_]+="/")}function g(b,P,T){for(var _=b.start,I=b.size,M=[],j=_;T&&I>0&&j>=0;)M.push(P.slice(j*A,j*A+A)),I-=A,j=mi(T,j*4);return M.length===0?J(0):Qt(M).slice(0,b.size)}function m(b,P,T,_,I){var M=G;if(b===G){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var j=T[b],re=(_>>>2)-1;if(!j)return;for(var U=0;U<re&&(M=mi(j,U*4))!==G;++U)I.push(M);m(mi(j,_-4),P-1,T,_,I)}}function v(b,P,T,_,I){var M=[],j=[];I||(I=[]);var re=_-1,U=0,K=0;for(U=P;U>=0;){I[U]=!0,M[M.length]=U,j.push(b[U]);var Y=T[Math.floor(U*4/_)];if(K=U*4&re,_<4+K)throw new Error("FAT boundary crossed: "+U+" 4 "+_);if(!b[Y])break;U=mi(b[Y],K)}return{nodes:M,data:z1([j])}}function C(b,P,T,_){var I=b.length,M=[],j=[],re=[],U=[],K=_-1,Y=0,he=0,xe=0,Se=0;for(Y=0;Y<I;++Y)if(re=[],xe=Y+P,xe>=I&&(xe-=I),!j[xe]){U=[];var fe=[];for(he=xe;he>=0;){fe[he]=!0,j[he]=!0,re[re.length]=he,U.push(b[he]);var ye=T[Math.floor(he*4/_)];if(Se=he*4&K,_<4+Se)throw new Error("FAT boundary crossed: "+he+" 4 "+_);if(!b[ye]||(he=mi(b[ye],Se),fe[he]))break}M[xe]={nodes:re,data:z1([U])}}return M}function x(b,P,T,_,I,M,j,re){for(var U=0,K=_.length?2:0,Y=P[b].data,he=0,xe=0,Se;he<Y.length;he+=128){var fe=Y.slice(he,he+128);rr(fe,64),xe=fe.read_shift(2),Se=Fp(fe,0,xe-K),_.push(Se);var ye={name:Se,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},Pe=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Pe!==0&&(ye.ct=w(fe,fe.l-8));var Ct=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Ct!==0&&(ye.mt=w(fe,fe.l-8)),ye.start=fe.read_shift(4,"i"),ye.size=fe.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=G,ye.name=""),ye.type===5?(U=ye.start,I>0&&U!==G&&(P[U].name="!StreamData")):ye.size>=4096?(ye.storage="fat",P[ye.start]===void 0&&(P[ye.start]=v(T,ye.start,P.fat_addrs,P.ssz)),P[ye.start].name=ye.name,ye.content=P[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:U!==G&&ye.start!==G&&P[U]&&(ye.content=g(ye,P[U].data,(P[re]||{}).data))),ye.content&&rr(ye.content,0),M[Se]=ye,j.push(ye)}}function w(b,P){return new Date((zr(b,P+4)/1e7*Math.pow(2,32)+zr(b,P)/1e7-11644473600)*1e3)}function k(b,P){return c(),u(l.readFileSync(b),P)}function E(b,P){var T=P&&P.type;switch(T||Ne&&Buffer.isBuffer(b)&&(T="buffer"),T||"base64"){case"file":return k(b,P);case"base64":return u(Ur(Qr(b)),P);case"binary":return u(Ur(b),P)}return u(b,P)}function y(b,P){var T=P||{},_=T.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=_+"/",b.FileIndex[0]={name:_,type:5}),T.CLSID&&(b.FileIndex[0].clsid=T.CLSID),R(b)}function R(b){var P="Sh33tJ5";if(!Fe.find(b,"/"+P)){var T=J(4);T[0]=55,T[1]=T[3]=50,T[2]=54,b.FileIndex.push({name:P,type:2,content:T,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+P),D(b)}}function D(b,P){y(b);for(var T=!1,_=!1,I=b.FullPaths.length-1;I>=0;--I){var M=b.FileIndex[I];switch(M.type){case 0:_?T=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(M.R*M.L*M.C)&&(T=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(T=!0);break;default:T=!0;break}}if(!(!T&&!P)){var j=new Date(1987,1,19),re=0,U=Object.create?Object.create(null):{},K=[];for(I=0;I<b.FullPaths.length;++I)U[b.FullPaths[I]]=!0,b.FileIndex[I].type!==0&&K.push([b.FullPaths[I],b.FileIndex[I]]);for(I=0;I<K.length;++I){var Y=n(K[I][0]);_=U[Y],_||(K.push([Y,{name:s(Y).replace("/",""),type:1,clsid:se,ct:j,mt:j,content:null}]),U[Y]=!0)}for(K.sort(function(Se,fe){return r(Se[0],fe[0])}),b.FullPaths=[],b.FileIndex=[],I=0;I<K.length;++I)b.FullPaths[I]=K[I][0],b.FileIndex[I]=K[I][1];for(I=0;I<K.length;++I){var he=b.FileIndex[I],xe=b.FullPaths[I];if(he.name=s(xe).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||se,I===0)he.C=K.length>1?1:-1,he.size=0,he.type=5;else if(xe.slice(-1)=="/"){for(re=I+1;re<K.length&&n(b.FullPaths[re])!=xe;++re);for(he.C=re>=K.length?-1:re,re=I+1;re<K.length&&n(b.FullPaths[re])!=n(xe);++re);he.R=re>=K.length?-1:re,he.type=1}else n(b.FullPaths[I+1]||"")==n(xe)&&(he.R=I+1),he.type=2}}}function N(b,P){var T=P||{};if(T.fileType=="mad")return kb(b,T);switch(D(b),T.fileType){case"zip":return mb(b,T)}var _=function(Se){for(var fe=0,ye=0,Pe=0;Pe<Se.FileIndex.length;++Pe){var Ct=Se.FileIndex[Pe];if(!!Ct.content){var wt=Ct.content.length;wt>0&&(wt<4096?fe+=wt+63>>6:ye+=wt+511>>9)}}for(var or=Se.FullPaths.length+3>>2,fa=fe+7>>3,ga=fe+127>>7,pa=fa+ye+or+ga,di=pa+127>>7,cd=di<=109?0:Math.ceil((di-109)/127);pa+di+cd+127>>7>di;)cd=++di<=109?0:Math.ceil((di-109)/127);var Jn=[1,cd,di,ga,or,ye,fe,0];return Se.FileIndex[0].size=fe<<6,Jn[7]=(Se.FileIndex[0].start=Jn[0]+Jn[1]+Jn[2]+Jn[3]+Jn[4]+Jn[5])+(Jn[6]+7>>3),Jn}(b),I=J(_[7]<<9),M=0,j=0;{for(M=0;M<8;++M)I.write_shift(1,z[M]);for(M=0;M<8;++M)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),M=0;M<3;++M)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,_[2]),I.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),I.write_shift(4,0),I.write_shift(4,1<<12),I.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:G),I.write_shift(4,_[3]),I.write_shift(-4,_[1]?_[0]-1:G),I.write_shift(4,_[1]),M=0;M<109;++M)I.write_shift(-4,M<_[2]?_[1]+M:-1)}if(_[1])for(j=0;j<_[1];++j){for(;M<236+j*127;++M)I.write_shift(-4,M<_[2]?_[1]+M:-1);I.write_shift(-4,j===_[1]-1?G:j+1)}var re=function(Se){for(j+=Se;M<j-1;++M)I.write_shift(-4,M+1);Se&&(++M,I.write_shift(-4,G))};for(j=M=0,j+=_[1];M<j;++M)I.write_shift(-4,te.DIFSECT);for(j+=_[2];M<j;++M)I.write_shift(-4,te.FATSECT);re(_[3]),re(_[4]);for(var U=0,K=0,Y=b.FileIndex[0];U<b.FileIndex.length;++U)Y=b.FileIndex[U],Y.content&&(K=Y.content.length,!(K<4096)&&(Y.start=j,re(K+511>>9)));for(re(_[6]+7>>3);I.l&511;)I.write_shift(-4,te.ENDOFCHAIN);for(j=M=0,U=0;U<b.FileIndex.length;++U)Y=b.FileIndex[U],Y.content&&(K=Y.content.length,!(!K||K>=4096)&&(Y.start=j,re(K+63>>6)));for(;I.l&511;)I.write_shift(-4,te.ENDOFCHAIN);for(M=0;M<_[4]<<2;++M){var he=b.FullPaths[M];if(!he||he.length===0){for(U=0;U<17;++U)I.write_shift(4,0);for(U=0;U<3;++U)I.write_shift(4,-1);for(U=0;U<12;++U)I.write_shift(4,0);continue}Y=b.FileIndex[M],M===0&&(Y.start=Y.size?Y.start-1:G);var xe=M===0&&T.root||Y.name;if(K=2*(xe.length+1),I.write_shift(64,xe,"utf16le"),I.write_shift(2,K),I.write_shift(1,Y.type),I.write_shift(1,Y.color),I.write_shift(-4,Y.L),I.write_shift(-4,Y.R),I.write_shift(-4,Y.C),Y.clsid)I.write_shift(16,Y.clsid,"hex");else for(U=0;U<4;++U)I.write_shift(4,0);I.write_shift(4,Y.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,Y.start),I.write_shift(4,Y.size),I.write_shift(4,0)}for(M=1;M<b.FileIndex.length;++M)if(Y=b.FileIndex[M],Y.size>=4096)if(I.l=Y.start+1<<9,Ne&&Buffer.isBuffer(Y.content))Y.content.copy(I,I.l,0,Y.size),I.l+=Y.size+511&-512;else{for(U=0;U<Y.size;++U)I.write_shift(1,Y.content[U]);for(;U&511;++U)I.write_shift(1,0)}for(M=1;M<b.FileIndex.length;++M)if(Y=b.FileIndex[M],Y.size>0&&Y.size<4096)if(Ne&&Buffer.isBuffer(Y.content))Y.content.copy(I,I.l,0,Y.size),I.l+=Y.size+63&-64;else{for(U=0;U<Y.size;++U)I.write_shift(1,Y.content[U]);for(;U&63;++U)I.write_shift(1,0)}if(Ne)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function O(b,P){var T=b.FullPaths.map(function(U){return U.toUpperCase()}),_=T.map(function(U){var K=U.split("/");return K[K.length-(U.slice(-1)=="/"?2:1)]}),I=!1;P.charCodeAt(0)===47?(I=!0,P=T[0].slice(0,-1)+P):I=P.indexOf("/")!==-1;var M=P.toUpperCase(),j=I===!0?T.indexOf(M):_.indexOf(M);if(j!==-1)return b.FileIndex[j];var re=!M.match(Oa);for(M=M.replace(Rr,""),re&&(M=M.replace(Oa,"!")),j=0;j<T.length;++j)if((re?T[j].replace(Oa,"!"):T[j]).replace(Rr,"")==M||(re?_[j].replace(Oa,"!"):_[j]).replace(Rr,"")==M)return b.FileIndex[j];return null}var A=64,G=-2,q="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(b,P,T){c();var _=N(b,T);l.writeFileSync(P,_)}function H(b){for(var P=new Array(b.length),T=0;T<b.length;++T)P[T]=String.fromCharCode(b[T]);return P.join("")}function Q(b,P){var T=N(b,P);switch(P&&P.type||"buffer"){case"file":return c(),l.writeFileSync(P.filename,T),T;case"binary":return typeof T=="string"?T:H(T);case"base64":return Dl(typeof T=="string"?T:H(T));case"buffer":if(Ne)return Buffer.isBuffer(T)?T:ys(T);case"array":return typeof T=="string"?Ur(T):T}return T}var ie;function F(b){try{var P=b.InflateRaw,T=new P;if(T._processChunk(new Uint8Array([3,0]),T._finishFlushFlag),T.bytesRead)ie=b;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function W(b,P){if(!ie)return rm(b,P);var T=ie.InflateRaw,_=new T,I=_._processChunk(b.slice(b.l),_._finishFlushFlag);return b.l+=_.bytesRead,I}function B(b){return ie?ie.deflateRawSync(b):Me(b)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(b){var P=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(P>>16|P>>8|P)&255}for(var ce=typeof Uint8Array<"u",ee=ce?new Uint8Array(1<<8):[],Ee=0;Ee<1<<8;++Ee)ee[Ee]=le(Ee);function L(b,P){var T=ee[b&255];return P<=8?T>>>8-P:(T=T<<8|ee[b>>8&255],P<=16?T>>>16-P:(T=T<<8|ee[b>>16&255],T>>>24-P))}function He(b,P){var T=P&7,_=P>>>3;return(b[_]|(T<=6?0:b[_+1]<<8))>>>T&3}function Ae(b,P){var T=P&7,_=P>>>3;return(b[_]|(T<=5?0:b[_+1]<<8))>>>T&7}function Ue(b,P){var T=P&7,_=P>>>3;return(b[_]|(T<=4?0:b[_+1]<<8))>>>T&15}function Ce(b,P){var T=P&7,_=P>>>3;return(b[_]|(T<=3?0:b[_+1]<<8))>>>T&31}function oe(b,P){var T=P&7,_=P>>>3;return(b[_]|(T<=1?0:b[_+1]<<8))>>>T&127}function Oe(b,P,T){var _=P&7,I=P>>>3,M=(1<<T)-1,j=b[I]>>>_;return T<8-_||(j|=b[I+1]<<8-_,T<16-_)||(j|=b[I+2]<<16-_,T<24-_)||(j|=b[I+3]<<24-_),j&M}function Qe(b,P,T){var _=P&7,I=P>>>3;return _<=5?b[I]|=(T&7)<<_:(b[I]|=T<<_&255,b[I+1]=(T&7)>>8-_),P+3}function je(b,P,T){var _=P&7,I=P>>>3;return T=(T&1)<<_,b[I]|=T,P+1}function be(b,P,T){var _=P&7,I=P>>>3;return T<<=_,b[I]|=T&255,T>>>=8,b[I+1]=T,P+8}function Je(b,P,T){var _=P&7,I=P>>>3;return T<<=_,b[I]|=T&255,T>>>=8,b[I+1]=T&255,b[I+2]=T>>>8,P+16}function st(b,P){var T=b.length,_=2*T>P?2*T:P+5,I=0;if(T>=P)return b;if(Ne){var M=b1(_);if(b.copy)b.copy(M);else for(;I<b.length;++I)M[I]=b[I];return M}else if(ce){var j=new Uint8Array(_);if(j.set)j.set(b);else for(;I<T;++I)j[I]=b[I];return j}return b.length=_,b}function mt(b){for(var P=new Array(b),T=0;T<b;++T)P[T]=0;return P}function Vt(b,P,T){var _=1,I=0,M=0,j=0,re=0,U=b.length,K=ce?new Uint16Array(32):mt(32);for(M=0;M<32;++M)K[M]=0;for(M=U;M<T;++M)b[M]=0;U=b.length;var Y=ce?new Uint16Array(U):mt(U);for(M=0;M<U;++M)K[I=b[M]]++,_<I&&(_=I),Y[M]=0;for(K[0]=0,M=1;M<=_;++M)K[M+16]=re=re+K[M-1]<<1;for(M=0;M<U;++M)re=b[M],re!=0&&(Y[M]=K[re+16]++);var he=0;for(M=0;M<U;++M)if(he=b[M],he!=0)for(re=L(Y[M],_)>>_-he,j=(1<<_+4-he)-1;j>=0;--j)P[re|j<<he]=he&15|M<<4;return _}var at=ce?new Uint16Array(512):mt(512),Mn=ce?new Uint16Array(32):mt(32);if(!ce){for(var We=0;We<512;++We)at[We]=0;for(We=0;We<32;++We)Mn[We]=0}(function(){for(var b=[],P=0;P<32;P++)b.push(5);Vt(b,Mn,32);var T=[];for(P=0;P<=143;P++)T.push(8);for(;P<=255;P++)T.push(9);for(;P<=279;P++)T.push(7);for(;P<=287;P++)T.push(8);Vt(T,at,288)})();var vt=function(){for(var P=ce?new Uint8Array(32768):[],T=0,_=0;T<ne.length-1;++T)for(;_<ne[T+1];++_)P[_]=T;for(;_<32768;++_)P[_]=29;var I=ce?new Uint8Array(259):[];for(T=0,_=0;T<X.length-1;++T)for(;_<X[T+1];++_)I[_]=T;function M(re,U){for(var K=0;K<re.length;){var Y=Math.min(65535,re.length-K),he=K+Y==re.length;for(U.write_shift(1,+he),U.write_shift(2,Y),U.write_shift(2,~Y&65535);Y-- >0;)U[U.l++]=re[K++]}return U.l}function j(re,U){for(var K=0,Y=0,he=ce?new Uint16Array(32768):[];Y<re.length;){var xe=Math.min(65535,re.length-Y);if(xe<10){for(K=Qe(U,K,+(Y+xe==re.length)),K&7&&(K+=8-(K&7)),U.l=K/8|0,U.write_shift(2,xe),U.write_shift(2,~xe&65535);xe-- >0;)U[U.l++]=re[Y++];K=U.l*8;continue}K=Qe(U,K,+(Y+xe==re.length)+2);for(var Se=0;xe-- >0;){var fe=re[Y];Se=(Se<<5^fe)&32767;var ye=-1,Pe=0;if((ye=he[Se])&&(ye|=Y&-32768,ye>Y&&(ye-=32768),ye<Y))for(;re[ye+Pe]==re[Y+Pe]&&Pe<250;)++Pe;if(Pe>2){fe=I[Pe],fe<=22?K=be(U,K,ee[fe+1]>>1)-1:(be(U,K,3),K+=5,be(U,K,ee[fe-23]>>5),K+=3);var Ct=fe<8?0:fe-4>>2;Ct>0&&(Je(U,K,Pe-X[fe]),K+=Ct),fe=P[Y-ye],K=be(U,K,ee[fe]>>3),K-=3;var wt=fe<4?0:fe-2>>1;wt>0&&(Je(U,K,Y-ye-ne[fe]),K+=wt);for(var or=0;or<Pe;++or)he[Se]=Y&32767,Se=(Se<<5^re[Y])&32767,++Y;xe-=Pe-1}else fe<=143?fe=fe+48:K=je(U,K,1),K=be(U,K,ee[fe]),he[Se]=Y&32767,++Y}K=be(U,K,0)-1}return U.l=(K+7)/8|0,U.l}return function(U,K){return U.length<8?M(U,K):j(U,K)}}();function Me(b){var P=J(50+Math.floor(b.length*1.1)),T=vt(b,P);return P.slice(0,T)}var Dt=ce?new Uint16Array(32768):mt(32768),en=ce?new Uint16Array(32768):mt(32768),Gt=ce?new Uint16Array(128):mt(128),hi=1,tm=1;function fb(b,P){var T=Ce(b,P)+257;P+=5;var _=Ce(b,P)+1;P+=5;var I=Ue(b,P)+4;P+=4;for(var M=0,j=ce?new Uint8Array(19):mt(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],U=1,K=ce?new Uint8Array(8):mt(8),Y=ce?new Uint8Array(8):mt(8),he=j.length,xe=0;xe<I;++xe)j[V[xe]]=M=Ae(b,P),U<M&&(U=M),K[M]++,P+=3;var Se=0;for(K[0]=0,xe=1;xe<=U;++xe)Y[xe]=Se=Se+K[xe-1]<<1;for(xe=0;xe<he;++xe)(Se=j[xe])!=0&&(re[xe]=Y[Se]++);var fe=0;for(xe=0;xe<he;++xe)if(fe=j[xe],fe!=0){Se=ee[re[xe]]>>8-fe;for(var ye=(1<<7-fe)-1;ye>=0;--ye)Gt[Se|ye<<fe]=fe&7|xe<<3}var Pe=[];for(U=1;Pe.length<T+_;)switch(Se=Gt[oe(b,P)],P+=Se&7,Se>>>=3){case 16:for(M=3+He(b,P),P+=2,Se=Pe[Pe.length-1];M-- >0;)Pe.push(Se);break;case 17:for(M=3+Ae(b,P),P+=3;M-- >0;)Pe.push(0);break;case 18:for(M=11+oe(b,P),P+=7;M-- >0;)Pe.push(0);break;default:Pe.push(Se),U<Se&&(U=Se);break}var Ct=Pe.slice(0,T),wt=Pe.slice(T);for(xe=T;xe<286;++xe)Ct[xe]=0;for(xe=_;xe<30;++xe)wt[xe]=0;return hi=Vt(Ct,Dt,286),tm=Vt(wt,en,30),P}function gb(b,P){if(b[0]==3&&!(b[1]&3))return[qs(P),2];for(var T=0,_=0,I=b1(P||1<<18),M=0,j=I.length>>>0,re=0,U=0;(_&1)==0;){if(_=Ae(b,T),T+=3,_>>>1==0){T&7&&(T+=8-(T&7));var K=b[T>>>3]|b[(T>>>3)+1]<<8;if(T+=32,K>0)for(!P&&j<M+K&&(I=st(I,M+K),j=I.length);K-- >0;)I[M++]=b[T>>>3],T+=8;continue}else _>>1==1?(re=9,U=5):(T=fb(b,T),re=hi,U=tm);for(;;){!P&&j<M+32767&&(I=st(I,M+32767),j=I.length);var Y=Oe(b,T,re),he=_>>>1==1?at[Y]:Dt[Y];if(T+=he&15,he>>>=4,(he>>>8&255)===0)I[M++]=he;else{if(he==256)break;he-=257;var xe=he<8?0:he-4>>2;xe>5&&(xe=0);var Se=M+X[he];xe>0&&(Se+=Oe(b,T,xe),T+=xe),Y=Oe(b,T,U),he=_>>>1==1?Mn[Y]:en[Y],T+=he&15,he>>>=4;var fe=he<4?0:he-2>>1,ye=ne[he];for(fe>0&&(ye+=Oe(b,T,fe),T+=fe),!P&&j<Se&&(I=st(I,Se+100),j=I.length);M<Se;)I[M]=I[M-ye],++M}}}return P?[I,T+7>>>3]:[I.slice(0,M),T+7>>>3]}function rm(b,P){var T=b.slice(b.l||0),_=gb(T,P);return b.l+=_[1],_[0]}function nm(b,P){if(b)typeof console<"u"&&console.error(P);else throw new Error(P)}function sm(b,P){var T=b;rr(T,0);var _=[],I=[],M={FileIndex:_,FullPaths:I};y(M,{root:P.root});for(var j=T.length-4;(T[j]!=80||T[j+1]!=75||T[j+2]!=5||T[j+3]!=6)&&j>=0;)--j;T.l=j+4,T.l+=4;var re=T.read_shift(2);T.l+=6;var U=T.read_shift(4);for(T.l=U,j=0;j<re;++j){T.l+=20;var K=T.read_shift(4),Y=T.read_shift(4),he=T.read_shift(2),xe=T.read_shift(2),Se=T.read_shift(2);T.l+=8;var fe=T.read_shift(4),ye=a(T.slice(T.l+he,T.l+he+xe));T.l+=he+xe+Se;var Pe=T.l;T.l=fe+4,pb(T,K,Y,M,ye),T.l=Pe}return M}function pb(b,P,T,_,I){b.l+=2;var M=b.read_shift(2),j=b.read_shift(2),re=o(b);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var U=b.read_shift(4),K=b.read_shift(4),Y=b.read_shift(4),he=b.read_shift(2),xe=b.read_shift(2),Se="",fe=0;fe<he;++fe)Se+=String.fromCharCode(b[b.l++]);if(xe){var ye=a(b.slice(b.l,b.l+xe));(ye[21589]||{}).mt&&(re=ye[21589].mt),((I||{})[21589]||{}).mt&&(re=I[21589].mt)}b.l+=xe;var Pe=b.slice(b.l,b.l+K);switch(j){case 8:Pe=W(b,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+j)}var Ct=!1;M&8&&(U=b.read_shift(4),U==134695760&&(U=b.read_shift(4),Ct=!0),K=b.read_shift(4),Y=b.read_shift(4)),K!=P&&nm(Ct,"Bad compressed size: "+P+" != "+K),Y!=T&&nm(Ct,"Bad uncompressed size: "+T+" != "+Y),ld(_,Se,Pe,{unsafe:!0,mt:re})}function mb(b,P){var T=P||{},_=[],I=[],M=J(1),j=T.compression?8:0,re=0,U=0,K=0,Y=0,he=0,xe=b.FullPaths[0],Se=xe,fe=b.FileIndex[0],ye=[],Pe=0;for(U=1;U<b.FullPaths.length;++U)if(Se=b.FullPaths[U].slice(xe.length),fe=b.FileIndex[U],!(!fe.size||!fe.content||Se=="Sh33tJ5")){var Ct=Y,wt=J(Se.length);for(K=0;K<Se.length;++K)wt.write_shift(1,Se.charCodeAt(K)&127);wt=wt.slice(0,wt.l),ye[he]=HO.buf(fe.content,0);var or=fe.content;j==8&&(or=B(or)),M=J(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,re),M.write_shift(2,j),fe.mt?i(M,fe.mt):M.write_shift(4,0),M.write_shift(-4,ye[he]),M.write_shift(4,or.length),M.write_shift(4,fe.content.length),M.write_shift(2,wt.length),M.write_shift(2,0),Y+=M.length,_.push(M),Y+=wt.length,_.push(wt),Y+=or.length,_.push(or),M=J(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,re),M.write_shift(2,j),M.write_shift(4,0),M.write_shift(-4,ye[he]),M.write_shift(4,or.length),M.write_shift(4,fe.content.length),M.write_shift(2,wt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Ct),Pe+=M.l,I.push(M),Pe+=wt.length,I.push(wt),++he}return M=J(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,he),M.write_shift(2,he),M.write_shift(4,Pe),M.write_shift(4,Y),M.write_shift(2,0),Qt([Qt(_),Qt(I),M])}var cc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vb(b,P){if(b.ctype)return b.ctype;var T=b.name||"",_=T.match(/\.([^\.]+)$/);return _&&cc[_[1]]||P&&(_=(T=P).match(/[\.\\]([^\.\\])+$/),_&&cc[_[1]])?cc[_[1]]:"application/octet-stream"}function xb(b){for(var P=Dl(b),T=[],_=0;_<P.length;_+=76)T.push(P.slice(_,_+76));return T.join(`\r
`)+`\r
`}function Cb(b){var P=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var Y=K.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var T=[],_=P.split(`\r
`),I=0;I<_.length;++I){var M=_[I];if(M.length==0){T.push("");continue}for(var j=0;j<M.length;){var re=76,U=M.slice(j,j+re);U.charAt(re-1)=="="?re--:U.charAt(re-2)=="="?re-=2:U.charAt(re-3)=="="&&(re-=3),U=M.slice(j,j+re),j+=re,j<M.length&&(U+="="),T.push(U)}}return T.join(`\r
`)}function wb(b){for(var P=[],T=0;T<b.length;++T){for(var _=b[T];T<=b.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+b[++T];P.push(_)}for(var I=0;I<P.length;++I)P[I]=P[I].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Ur(P.join(`\r
`))}function yb(b,P,T){for(var _="",I="",M="",j,re=0;re<10;++re){var U=P[re];if(!U||U.match(/^\s*$/))break;var K=U.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":_=K[2].trim();break;case"content-type":M=K[2].trim();break;case"content-transfer-encoding":I=K[2].trim();break}}switch(++re,I.toLowerCase()){case"base64":j=Ur(Qr(P.slice(re).join("")));break;case"quoted-printable":j=wb(P.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var Y=ld(b,_.slice(T.length),j,{unsafe:!0});M&&(Y.ctype=M)}function Sb(b,P){if(H(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var T=P&&P.root||"",_=(Ne&&Buffer.isBuffer(b)?b.toString("binary"):H(b)).split(`\r
`),I=0,M="";for(I=0;I<_.length;++I)if(M=_[I],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),T||(T=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,T.length)!=T))for(;T.length>0&&(T=T.slice(0,T.length-1),T=T.slice(0,T.lastIndexOf("/")+1),M.slice(0,T.length)!=T););var j=(_[1]||"").match(/boundary="(.*?)"/);if(!j)throw new Error("MAD cannot find boundary");var re="--"+(j[1]||""),U=[],K=[],Y={FileIndex:U,FullPaths:K};y(Y);var he,xe=0;for(I=0;I<_.length;++I){var Se=_[I];Se!==re&&Se!==re+"--"||(xe++&&yb(Y,_.slice(he,I),T),he=I)}return Y}function kb(b,P){var T=P||{},_=T.boundary||"SheetJS";_="------="+_;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],M=b.FullPaths[0],j=M,re=b.FileIndex[0],U=1;U<b.FullPaths.length;++U)if(j=b.FullPaths[U].slice(M.length),re=b.FileIndex[U],!(!re.size||!re.content||j=="Sh33tJ5")){j=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var K=re.content,Y=Ne&&Buffer.isBuffer(K)?K.toString("binary"):H(K),he=0,xe=Math.min(1024,Y.length),Se=0,fe=0;fe<=xe;++fe)(Se=Y.charCodeAt(fe))>=32&&Se<128&&++he;var ye=he>=xe*4/5;I.push(_),I.push("Content-Location: "+(T.root||"file:///C:/SheetJS/")+j),I.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),I.push("Content-Type: "+vb(re,j)),I.push(""),I.push(ye?Cb(Y):xb(Y))}return I.push(_+`--\r
`),I.join(`\r
`)}function bb(b){var P={};return y(P,b),P}function ld(b,P,T,_){var I=_&&_.unsafe;I||y(b);var M=!I&&Fe.find(b,P);if(!M){var j=b.FullPaths[0];P.slice(0,j.length)==j?j=P:(j.slice(-1)!="/"&&(j+="/"),j=(j+P).replace("//","/")),M={name:s(P),type:2},b.FileIndex.push(M),b.FullPaths.push(j),I||Fe.utils.cfb_gc(b)}return M.content=T,M.size=T?T.length:0,_&&(_.CLSID&&(M.clsid=_.CLSID),_.mt&&(M.mt=_.mt),_.ct&&(M.ct=_.ct)),M}function Eb(b,P){y(b);var T=Fe.find(b,P);if(T){for(var _=0;_<b.FileIndex.length;++_)if(b.FileIndex[_]==T)return b.FileIndex.splice(_,1),b.FullPaths.splice(_,1),!0}return!1}function Fb(b,P,T){y(b);var _=Fe.find(b,P);if(_){for(var I=0;I<b.FileIndex.length;++I)if(b.FileIndex[I]==_)return b.FileIndex[I].name=s(T),b.FullPaths[I]=T,!0}return!1}function Tb(b){D(b,!0)}return t.find=O,t.read=E,t.parse=u,t.write=Q,t.writeFile=Z,t.utils={cfb_new:bb,cfb_add:ld,cfb_del:Eb,cfb_mov:Fb,cfb_gc:Tb,ReadShift:qa,CheckField:N2,prep_blob:rr,bconcat:Qt,use_zlib:F,_deflateRaw:Me,_inflateRaw:rm,consts:te},t}();function WO(e){return typeof e=="string"?Jh(e):Array.isArray(e)?dO(e):e}function tc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Jh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?$n(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([WO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=li(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function VO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function _t(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function P1(e,t){for(var r=[],n=_t(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function td(e){for(var t=[],r=_t(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function rd(e){for(var t=[],r=_t(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function GO(e){for(var t=[],r=_t(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var fh=new Date(1899,11,30,0,0,0);function $t(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=fh.getTime()+(e.getTimezoneOffset()-fh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var p2=new Date,zO=fh.getTime()+(p2.getTimezoneOffset()-fh.getTimezoneOffset())*6e4,I1=p2.getTimezoneOffset();function nd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+zO),t.getTimezoneOffset()!==I1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-I1)*6e4),t}function UO(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(!!s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var L1=new Date("2017-02-19T19:06:09.000Z"),m2=isNaN(L1.getFullYear())?new Date("2/19/17"):L1,jO=m2.getFullYear()==2017;function gt(e,t){var r=new Date(e);if(jO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(m2.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Wi(e,t){if(Ne&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return $n(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return $n(n2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return $n(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return $n(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function pt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pt(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function An(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var $O=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&$O.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var KO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],a=1;a<i.length;++a)o.push(s),o.push(i[a]);return o}}();function v2(e){return e?e.content&&e.type?Wi(e.content,!0):e.data?Ma(e.data):e.asNodeBuffer&&Ne?Ma(e.asNodeBuffer().toString("binary")):e.asBinary?Ma(e.asBinary()):e._data&&e._data.getContent?Ma(Wi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function x2(e){if(!e)return null;if(e.data)return S1(e.data);if(e.asNodeBuffer&&Ne)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?S1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function XO(e){return e&&e.name.slice(-4)===".bin"?x2(e):v2(e)}function an(e,t){for(var r=e.FullPaths||_t(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function wp(e,t){var r=an(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ot(e,t,r){if(!r)return XO(wp(e,t));if(!t)return null;try{return Ot(e,t)}catch{return null}}function jr(e,t,r){if(!r)return v2(wp(e,t));if(!t)return null;try{return jr(e,t)}catch{return null}}function C2(e,t,r){if(!r)return x2(wp(e,t));if(!t)return null;try{return C2(e,t)}catch{return null}}function M1(e){for(var t=e.FullPaths||_t(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Le(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ne?n=ys(r):n=fO(r),Fe.utils.cfb_add(e,t,n)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function yp(){return Fe.utils.cfb_new()}function w2(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Na(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Lt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,YO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,O1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,QO=/<[^>]*>/g,yr=Lt.match(O1)?O1:QO,ZO=/<\w*:/,qO=/<(\/?)\w+:/;function De(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(YO),a=0,l="",c=0,u="",h="",d=1;if(o)for(c=0;c!=o.length;++c){for(h=o[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(d=(s=h.charCodeAt(i+1))==34||s==39?1:0,l=h.slice(i+1+d,h.length-d),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var f=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(n[f]&&u.slice(a-3,a)=="ext")continue;n[f]=l,r||(n[f.toLowerCase()]=l)}}return n}function Zn(e){return e.replace(qO,"<$1")}var y2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sp=td(y2),Xe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(a,l){return y2[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(t,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),kp=/[&<>'"]/g,JO=/[\u0000-\u0008\u000b-\u001f]/g;function rt(e){var t=e+"";return t.replace(kp,function(r){return Sp[r]}).replace(JO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function N1(e){return rt(e).replace(/ /g,"_x0020_")}var S2=/[\u0000-\u001f]/g;function bp(e){var t=e+"";return t.replace(kp,function(r){return Sp[r]}).replace(/\n/g,"<br/>").replace(S2,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function eN(e){var t=e+"";return t.replace(kp,function(r){return Sp[r]}).replace(S2,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var B1=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function tN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function dt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hf(e){for(var t="",r=0,n=0,s=0,i=0,o=0,a=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),a=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function H1(e){var t=qs(2*e.length),r,n,s=1,i=0,o=0,a;for(n=0;n<e.length;n+=s)s=1,(a=e.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(n+1)&63),s=2):a<240?(r=(a&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(a&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function W1(e){return ys(e,"binary").toString("utf8")}var Oc="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",it=Ne&&(W1(Oc)==hf(Oc)&&W1||H1(Oc)==hf(Oc)&&H1)||hf,$n=Ne?function(e){return ys(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Pl=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),k2=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),rN=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),nN=/<\/?(?:vt:)?variant>/g,sN=/<(?:vt:)([^>]*)>([\s\S]*)</;function V1(e,t){var r=De(e),n=e.match(rN(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(nN,"").match(sN);o&&s.push({v:it(o[2]),t:o[1]})}),s}var b2=/(^\s|\s$|\n)/;function nr(e,t){return"<"+e+(t.match(b2)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Il(e){return _t(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pe(e,t,r){return"<"+e+(r!=null?Il(r):"")+(t!=null?(t.match(b2)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function N0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function iN(e,t){switch(typeof e){case"string":var r=pe("vt:lpwstr",rt(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return pe((e|0)==e?"vt:i4":"vt:r8",rt(String(e)));case"boolean":return pe("vt:bool",e?"true":"false")}if(e instanceof Date)return pe("vt:filetime",N0(e));throw new Error("Unable to serialize "+e)}function Ep(e){if(Ne&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return it(li(vp(e)));throw new Error("Bad input format: expected Buffer or string")}var Ll=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ut={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Qi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Gr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function oN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function aN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=n?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var a=0;a<=5;++a,i/=256)e[r+a]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var G1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},z1=Ne?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ys(t)})):G1(e)}:G1,U1=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(ls(e,s)));return n.join("").replace(Rr,"")},Fp=Ne?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Rr,""):U1(e,t,r)}:U1,j1=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},E2=Ne?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):j1(e,t,r)}:j1,$1=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(lo(e,s)));return n.join("")},rc=Ne?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):$1(t,r,n)}:$1,F2=function(e,t){var r=zr(e,t);return r>0?rc(e,t+4,t+4+r-1):""},T2=F2,R2=function(e,t){var r=zr(e,t);return r>0?rc(e,t+4,t+4+r-1):""},_2=R2,D2=function(e,t){var r=2*zr(e,t);return r>0?rc(e,t+4,t+4+r-1):""},A2=D2,P2=function(t,r){var n=zr(t,r);return n>0?Fp(t,r+4,r+4+n):""},I2=P2,L2=function(e,t){var r=zr(e,t);return r>0?rc(e,t+4,t+4+r):""},M2=L2,O2=function(e,t){return oN(e,t)},gh=O2,Tp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ne&&(T2=function(t,r){if(!Buffer.isBuffer(t))return F2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_2=function(t,r){if(!Buffer.isBuffer(t))return R2(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},A2=function(t,r){if(!Buffer.isBuffer(t))return D2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},I2=function(t,r){if(!Buffer.isBuffer(t))return P2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},M2=function(t,r){if(!Buffer.isBuffer(t))return L2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},gh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):O2(t,r)},Tp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var lo=function(e,t){return e[t]},ls=function(e,t){return e[t+1]*(1<<8)+e[t]},lN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},mi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},cN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function qa(e,t){var r="",n,s,i=[],o,a,l,c;switch(t){case"dbcs":if(c=this.l,Ne&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ls(this,c)),c+=2;e*=2;break;case"utf8":r=rc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fp(this,this.l,this.l+e);break;case"wstr":return qa.call(this,e,"dbcs");case"lpstr-ansi":r=T2(this,this.l),e=4+zr(this,this.l);break;case"lpstr-cp":r=_2(this,this.l),e=4+zr(this,this.l);break;case"lpwstr":r=A2(this,this.l),e=4+2*zr(this,this.l);break;case"lpp4":e=4+zr(this,this.l),r=I2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zr(this,this.l),r=M2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=lo(this,this.l+e++))!==0;)i.push(Mc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=ls(this,this.l+e))!==0;)i.push(Mc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=lo(this,c),this.l=c+1,a=qa.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+a;i.push(Mc(ls(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=lo(this,c),this.l=c+1,a=qa.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+a;i.push(Mc(lo(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=lo(this,this.l),this.l++,n;case 2:return n=(t==="i"?lN:ls)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?mi:cN)(this,this.l),this.l+=4,n):(s=zr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=gh(this,this.l):s=gh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=E2(this,this.l,e);break}}return this.l+=e,r}var uN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},hN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fN(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)dN(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,uN(this,t,this.l);break;case 8:if(n=8,r==="f"){aN(this,t,this.l);break}case 16:break;case-4:n=4,hN(this,t,this.l);break}return this.l+=n,this}function N2(e,t){var r=E2(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rr(e,t){e.l=t,e.read_shift=qa,e.chk=N2,e.write_shift=fN}function Cr(e,t){e.l+=t}function J(e){var t=qs(e);return rr(t,0),t}function Ss(e,t,r){if(!!e){var n,s,i;rr(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var c=Wl[a]||Wl[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,a))return}}}function Hr(){var e=[],t=Ne?256:2048,r=function(c){var u=J(c);return rr(u,0),u},n=r(t),s=function(){!n||(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},o=function(){return s(),Qt(e)},a=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:a,end:o,_bufs:e}}function ae(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=Wl[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Tp(r)&&e.push(r)}}function Ja(e,t,r){var n=pt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function K1(e,t,r){var n=pt(e);return n.s=Ja(n.s,t.s,r),n.e=Ja(n.e,t.s,r),n}function el(e,t){if(e.cRel&&e.c<0)for(e=pt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=_e(e);return!e.cRel&&e.cRel!=null&&(r=mN(r)),!e.rRel&&e.rRel!=null&&(r=gN(r)),r}function df(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+St(e.s.c)+":"+(e.e.cRel?"":"$")+St(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+It(e.s.r)+":"+(e.e.rRel?"":"$")+It(e.e.r):el(e.s,t.biff)+":"+el(e.e,t.biff)}function Rp(e){return parseInt(pN(e),10)-1}function It(e){return""+(e+1)}function gN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pN(e){return e.replace(/\$(\d+)$/,"$1")}function _p(e){for(var t=vN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function St(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mN(e){return e.replace(/^([A-Z])/,"$$$1")}function vN(e){return e.replace(/^\$([A-Z])/,"$1")}function xN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function _e(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Wr(e){var t=e.indexOf(":");return t==-1?{s:kt(e),e:kt(e)}:{s:kt(e.slice(0,t)),e:kt(e.slice(t+1))}}function Ie(e,t){return typeof t>"u"||typeof t=="number"?Ie(e.s,e.e):(typeof e!="string"&&(e=_e(e)),typeof t!="string"&&(t=_e(t)),e==t?e:e+":"+t)}function Ye(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function X1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=wn(e.z,r?$t(t):t)}catch{}try{return e.w=wn((e.XF||{}).numFmtId||(r?14:0),r?$t(t):t)}catch{return""+t}}function xs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ks[e.v]||e.v:t==null?X1(e,e.v):X1(e,t))}function ci(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function B2(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),o=0,a=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?kt(n.origin):n.origin;o=l.r,a=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Ye(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(!!t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var f={v:t[h][d]},p=o+h,g=a+d;if(c.s.r>p&&(c.s.r=p),c.s.c>g&&(c.s.c=g),c.e.r<p&&(c.e.r=p),c.e.c<g&&(c.e.c=g),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))f=t[h][d];else if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Re[14],n.cellDates?(f.t="d",f.w=wn(f.z,$t(f.v))):(f.t="n",f.v=$t(f.v),f.w=wn(f.z,f.v))):f.t="s";if(s)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=_e({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return c.s.c<1e7&&(i["!ref"]=Ie(c)),i}function ha(e,t){return B2(null,e,t)}function CN(e){return e.read_shift(4,"i")}function Pn(e,t){return t||(t=J(4)),t.write_shift(4,e),t}function mr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Zt(e,t){var r=!1;return t==null&&(r=!0,t=J(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function wN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yN(e,t){return t||(t=J(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function Dp(e,t){var r=e.l,n=e.read_shift(1),s=mr(e),i=[],o={t:s,h:s};if((n&1)!==0){for(var a=e.read_shift(4),l=0;l!=a;++l)i.push(wN(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function SN(e,t){var r=!1;return t==null&&(r=!0,t=J(15+4*e.t.length)),t.write_shift(1,0),Zt(e.t,t),r?t.slice(0,t.l):t}var kN=Dp;function bN(e,t){var r=!1;return t==null&&(r=!0,t=J(23+4*e.t.length)),t.write_shift(1,1),Zt(e.t,t),t.write_shift(4,1),yN({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function yn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Zi(e,t){return t==null&&(t=J(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ji(e,t){return t==null&&(t=J(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var EN=mr,H2=Zt;function Ap(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ph(e,t){var r=!1;return t==null&&(r=!0,t=J(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var FN=mr,B0=Ap,Pp=ph;function Ip(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?gh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):mi(t,0)>>2;return r?s/100:s}function W2(e,t){t==null&&(t=J(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function V2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function TN(e,t){return t||(t=J(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var eo=V2,da=TN;function pr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vi(e,t){return(t||J(8)).write_shift(8,e,"f")}function RN(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Ri[s];c&&(t.rgb=Ol(c));break;case 2:t.rgb=Ol([o,a,l]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function mh(e,t){if(t||(t=J(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function _N(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DN(e,t){t||(t=J(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function G2(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function AN(e){return G2(e,1)}function PN(e){return G2(e,2)}var Lp=2,Pr=3,Nc=11,Y1=12,vh=19,Bc=64,IN=65,LN=71,MN=4108,ON=4126,Kt=80,z2=81,NN=[Kt,z2],H0={1:{n:"CodePage",t:Lp},2:{n:"Category",t:Kt},3:{n:"PresentationFormat",t:Kt},4:{n:"ByteCount",t:Pr},5:{n:"LineCount",t:Pr},6:{n:"ParagraphCount",t:Pr},7:{n:"SlideCount",t:Pr},8:{n:"NoteCount",t:Pr},9:{n:"HiddenCount",t:Pr},10:{n:"MultimediaClipCount",t:Pr},11:{n:"ScaleCrop",t:Nc},12:{n:"HeadingPairs",t:MN},13:{n:"TitlesOfParts",t:ON},14:{n:"Manager",t:Kt},15:{n:"Company",t:Kt},16:{n:"LinksUpToDate",t:Nc},17:{n:"CharacterCount",t:Pr},19:{n:"SharedDoc",t:Nc},22:{n:"HyperlinksChanged",t:Nc},23:{n:"AppVersion",t:Pr,p:"version"},24:{n:"DigSig",t:IN},26:{n:"ContentType",t:Kt},27:{n:"ContentStatus",t:Kt},28:{n:"Language",t:Kt},29:{n:"Version",t:Kt},255:{},2147483648:{n:"Locale",t:vh},2147483651:{n:"Behavior",t:vh},1919054434:{}},W0={1:{n:"CodePage",t:Lp},2:{n:"Title",t:Kt},3:{n:"Subject",t:Kt},4:{n:"Author",t:Kt},5:{n:"Keywords",t:Kt},6:{n:"Comments",t:Kt},7:{n:"Template",t:Kt},8:{n:"LastAuthor",t:Kt},9:{n:"RevNumber",t:Kt},10:{n:"EditTime",t:Bc},11:{n:"LastPrinted",t:Bc},12:{n:"CreatedDate",t:Bc},13:{n:"ModifiedDate",t:Bc},14:{n:"PageCount",t:Pr},15:{n:"WordCount",t:Pr},16:{n:"CharCount",t:Pr},17:{n:"Thumbnail",t:LN},18:{n:"Application",t:Kt},19:{n:"DocSecurity",t:Pr},255:{},2147483648:{n:"Locale",t:vh},2147483651:{n:"Behavior",t:vh},1919054434:{}},Q1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},BN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function HN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var WN=HN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ri=pt(WN),ks={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},U2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},V0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Mp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function VN(e){var t=Mp();if(!e||!e.match)return t;var r={};if((e.match(yr)||[]).forEach(function(n){var s=De(n);switch(s[0].replace(ZO,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[V0[s.ContentType]]!==void 0&&t[V0[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Ut.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function j2(e,t){var r=GO(V0),n=[],s;n[n.length]=Lt,n[n.length]=pe("Types",null,{xmlns:Ut.CT,"xmlns:xsd":Ut.xsd,"xmlns:xsi":Ut.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return pe("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(s=e[l][0],n[n.length]=pe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Hc[l][t.bookType]||Hc[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=pe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Hc[l][t.bookType]||Hc[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=pe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ve={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ml(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function tl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(yr)||[]).forEach(function(s){var i=De(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var a=i.TargetMode==="External"?i.Target:Na(i.Target,t);r[a]=o,n[i.Id]=o}}),r["!id"]=n,r}function No(e){var t=[Lt,pe("Relationships",null,{xmlns:Ut.RELS})];return _t(e["!id"]).forEach(function(r){t[t.length]=pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function tt(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,i?s.TargetMode=i:[Ve.HLINK,Ve.XPATH,Ve.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var GN="application/vnd.oasis.opendocument.spreadsheet";function zN(e,t){for(var r=Ep(e),n,s;n=Ll.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=De(n[0],!1),s.path=="/"&&s.type!==GN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function UN(e){var t=[Lt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Z1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jN(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $N(e){var t=[Lt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Z1(e[r][0],e[r][1])),t.push(jN("",e[r][0]));return t.push(Z1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ch.version+"</meta:generator></office:meta></office:document-meta>"}var vn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],KN=function(){for(var e=new Array(vn.length),t=0;t<vn.length;++t){var r=vn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function K2(e){var t={};e=it(e);for(var r=0;r<vn.length;++r){var n=vn[r],s=e.match(KN[r]);s!=null&&s.length>0&&(t[n[1]]=Xe(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=gt(t[n[1]]))}return t}function ff(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=rt(t),n[n.length]=r?pe(e,t,r):nr(e,t))}function X2(e,t){var r=t||{},n=[Lt,pe("cp:coreProperties",null,{"xmlns:cp":Ut.CORE_PROPS,"xmlns:dc":Ut.dc,"xmlns:dcterms":Ut.dcterms,"xmlns:dcmitype":Ut.dcmitype,"xmlns:xsi":Ut.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ff("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:N0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&ff("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:N0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=vn.length;++i){var o=vn[i],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&ff(o[0],a,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var _i=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Y2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Q2(e,t,r,n){var s=[];if(typeof e=="string")s=V1(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?V1(t,n).map(function(u){return u.v}):t,a=0,l=0;if(o.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function XN(e,t,r){var n={};return t||(t={}),e=it(e),_i.forEach(function(s){var i=(e.match(Pl(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Xe(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Q2(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Z2(e){var t=[],r=pe;return e||(e={}),e.Application="SheetJS",t[t.length]=Lt,t[t.length]=pe("Properties",null,{xmlns:Ut.EXT_PROPS,"xmlns:vt":Ut.vt}),_i.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=rt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+rt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var YN=/<[^>]+>[^<]*/g;function QN(e,t){var r={},n="",s=e.match(YN);if(s)for(var i=0;i!=s.length;++i){var o=s[i],a=De(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Xe(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Xe(u);break;case"bool":r[n]=dt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=gt(u);break;case"cy":case"error":r[n]=Xe(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function q2(e){var t=[Lt,pe("Properties",null,{xmlns:Ut.CUST_PROPS,"xmlns:vt":Ut.vt})];if(!e)return t.join("");var r=1;return _t(e).forEach(function(s){++r,t[t.length]=pe("property",iN(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var G0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gf;function ZN(e,t,r){gf||(gf=td(G0)),t=gf[t]||t,e[t]=r}function qN(e,t){var r=[];return _t(G0).map(function(n){for(var s=0;s<vn.length;++s)if(vn[s][1]==n)return vn[s];for(s=0;s<_i.length;++s)if(_i[s][1]==n)return _i[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(nr(G0[n[1]]||n[1],s))}}),pe("DocumentProperties",r.join(""),{xmlns:Gr.o})}function JN(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&_t(e).forEach(function(i){if(!!Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<vn.length;++o)if(i==vn[o][1])return;for(o=0;o<_i.length;++o)if(i==_i[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var a=e[i],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),s.push(pe(N1(i),a,{"dt:dt":l}))}}),t&&_t(t).forEach(function(i){if(!!Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),s.push(pe(N1(i),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+Gr.o+'">'+s.join("")+"</"+n+">"}function Op(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function eB(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=J(8);return o.write_shift(4,n),o.write_shift(4,s),o}function J2(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function ek(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function tk(e,t,r){return t===31?ek(e):J2(e,t,r)}function z0(e,t,r){return tk(e,t,r===!1?0:4)}function tB(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tk(e,t,0)}function rB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Rr,""),e.l-s&2&&(e.l+=2)}return r}function nB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Rr,"");return r}function sB(e){var t=e.l,r=xh(e,z2);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=xh(e,Pr);return[r,n]}function iB(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(sB(e));return r}function q1(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Rr,"").replace(Oa,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function rk(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function oB(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function xh(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Y1&&n!==t&&NN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Y1?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return J2(e,n,4).replace(Rr,"");case 31:return ek(e);case 64:return Op(e);case 65:return rk(e);case 71:return oB(e);case 80:return z0(e,n,!i.raw).replace(Rr,"");case 81:return tB(e,n).replace(Rr,"");case 4108:return iB(e);case 4126:case 4127:return n==4127?rB(e):nB(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function J1(e,t){var r=J(4),n=J(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=J(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=eB(t);break;case 31:case 80:for(n=J(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qt([r,n])}function ex(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0,a=0,l=-1,c={};for(o=0;o!=s;++o){var u=e.read_shift(4),h=e.read_shift(4);i[o]=[u,h+r]}i.sort(function(C,x){return C[1]-x[1]});var d={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var f=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,f=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],f=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],f=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(f=!1,e.l=i[o][1]),f)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(d[p.n]=xh(e,p.t,{raw:!0}),p.p==="version"&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(d[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Tn(a=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(i[o][0]===1){if(a=d.CodePage=xh(e,Lp),Tn(a),l!==-1){var g=e.l;e.l=i[l][1],c=q1(e,a),e.l=g}}else if(i[o][0]===0){if(a===0){l=o,e.l=i[o+1][1];continue}c=q1(e,a)}else{var m=c[i[o][0]],v;switch(e[e.l]){case 65:e.l+=4,v=rk(e);break;case 30:e.l+=4,v=z0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=z0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=At(e,4);break;case 64:e.l+=4,v=gt(Op(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=v}}return e.l=r+n,d}var nk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aB(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function tx(e,t,r){var n=J(8),s=[],i=[],o=8,a=0,l=J(8),c=J(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),s.push(c),o+=8+l.length,!t){c=J(8),c.write_shift(4,0),s.unshift(c);var u=[J(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var h=e[a][0];for(l=J(4+4+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Qt(u),i.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(nk.indexOf(e[a][0])>-1||Y2.indexOf(e[a][0])>-1)&&e[a][1]!=null){var d=e[a][1],f=0;if(t){f=+t[e[a][0]];var p=r[f];if(p.p=="version"&&typeof d=="string"){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=J1(p.t,d)}else{var m=aB(d);m==-1&&(m=31,d=String(d)),l=J1(m,d)}i.push(l),c=J(8),c.write_shift(4,t?f:2+a),s.push(c),o+=8+l.length}var v=8*(i.length+1);for(a=0;a<i.length;++a)s[a].write_shift(4,v),v+=i[a].length;return n.write_shift(4,o),n.write_shift(4,i.length),Qt([n].concat(s).concat(i))}function rx(e,t,r){var n=e.content;if(!n)return{};rr(n,0);var s,i,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Fe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),a=n.read_shift(4),s===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);s===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=ex(n,t),d={SystemIdentifier:c};for(var f in h)d[f]=h[f];if(d.FMTID=i,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=ex(n,null)}catch{}for(f in p)d[f]=p[f];return d.FMTID=[i,o],d}function nx(e,t,r,n,s,i){var o=J(s?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Fe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var l=tx(e,r,n);if(a.push(l),s){var c=tx(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Qt(a)}function Fs(e,t){return e.read_shift(t),null}function lB(e,t){t||(t=J(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function cB(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function At(e,t){return e.read_shift(t)===1}function br(e,t){return t||(t=J(2)),t.write_shift(2,+!!e),t}function Nt(e){return e.read_shift(2,"u")}function ln(e,t){return t||(t=J(2)),t.write_shift(2,e),t}function sk(e,t){return cB(e,t,Nt)}function uB(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ik(e,t,r){return r||(r=J(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function nc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function hB(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,a,l={};s&&(o=e.read_shift(2)),n&&(a=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*o),n&&(e.l+=a),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function dB(e){var t=e.t||"",r=J(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=J(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Qt(s)}function Gi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function sc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Gi(e,n,r)}function to(e,t,r){if(r.biff>5)return sc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ok(e,t,r){return r||(r=J(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function fB(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function gB(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Rr,"");return n&&(e.l+=24),s}function pB(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Rr,"");return r+o}function mB(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gB(e);case"0303000000000000c000000000000046":return pB(e);default:throw new Error("Unsupported Moniker "+r)}}function Wc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Rr,""):"";return r}function sx(e,t){t||(t=J(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function vB(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,o,a,l,c="",u,h;s&16&&(i=Wc(e,r-e.l)),s&128&&(o=Wc(e,r-e.l)),(s&257)===257&&(a=Wc(e,r-e.l)),(s&257)===1&&(l=mB(e,r-e.l)),s&8&&(c=Wc(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(h=Op(e)),e.l=r;var d=o||a||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var f={Target:d};return u&&(f.guid=u),h&&(f.time=h),i&&(f.Tooltip=i),f}function xB(e){var t=J(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),sx(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var a=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),i&8&&sx(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ak(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function lk(e,t){var r=ak(e);return r[3]=0,r}function qn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zi(e,t,r,n){return n||(n=J(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function CB(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function wB(e,t,r){return t===0?"":to(e,t,r)}function yB(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,i,o]}function ck(e){var t=e.read_shift(2),r=Ip(e);return[t,r]}function SB(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=nc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function sd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function uk(e,t){return t||(t=J(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function hk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var kB=hk;function dk(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function bB(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function EB(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function cr(e){e.l+=2,e.l+=e.read_shift(2)}var FB={0:cr,4:cr,5:cr,6:cr,7:EB,8:cr,9:cr,10:cr,11:cr,12:cr,13:bB,14:cr,15:cr,16:cr,17:cr,18:cr,19:cr,20:cr,21:dk};function TB(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(FB[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Vc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Np(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=J(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function RB(e,t){return t===0||e.read_shift(2),1200}function _B(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=to(e,0,r);return e.read_shift(t+n-e.l),s}function DB(e,t){var r=!t||t.biff==8,n=J(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function AB(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function PB(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=nc(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function IB(e,t){var r=!t||t.biff>=8?2:1,n=J(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function LB(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(hB(e));return i.Count=n,i.Unique=s,i}function MB(e,t){var r=J(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=dB(e[s]);var i=Qt([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function OB(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function NB(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function BB(e){var t=CB(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function HB(e){return e.read_shift(2),e.read_shift(4)}function ix(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function WB(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function VB(){var e=J(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function GB(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zB(e){var t=J(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function UB(){}function jB(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=nc(e,0,r),n}function $B(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=J(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function KB(e){var t=qn(e);return t.isst=e.read_shift(4),t}function XB(e,t,r,n){var s=J(10);return zi(e,t,n,s),s.write_shift(4,r),s}function YB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=qn(e);r.biff==2&&e.l++;var i=sc(e,n-e.l,r);return s.val=i,s}function QB(e,t,r,n,s){var i=!s||s.biff==8,o=J(6+2+ +i+(1+i)*r.length);return zi(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function ZB(e,t,r){var n=e.read_shift(2),s=to(e,0,r);return[n,s]}function qB(e,t,r,n){var s=r&&r.biff==5;n||(n=J(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var JB=to;function ox(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),a=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:a},e:{r:o,c:l}}}function e8(e,t){var r=t.biff==8||!t.biff?4:2,n=J(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function t8(e){var t=e.read_shift(2),r=e.read_shift(2),n=ck(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function r8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(ck(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function n8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function s8(e,t,r,n){var s={},i=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return s.patternType=BN[a>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=a&127,s.icvBottom=a>>7&127,s.icvDiag=a>>14&127,s.dgDiag=a>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function i8(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=s8(e,t,n.fStyle,r),n}function ax(e,t,r,n){var s=r&&r.biff==5;n||(n=J(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function o8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function a8(e){var t=J(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function lx(e,t,r){var n=qn(e);(r.biff==2||t==9)&&++e.l;var s=uB(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function l8(e,t,r,n,s,i){var o=J(8);return zi(e,t,n,o),ik(r,i,o),o}function c8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=qn(e),s=pr(e);return n.val=s,n}function u8(e,t,r,n){var s=J(14);return zi(e,t,n,s),Vi(r,s),s}var cx=wB;function h8(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Gi(e,i),a=[];n>e.l;)a.push(sc(e));return[i,s,o,a]}function ux(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=SB(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var d8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hx(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Gi(e,o,r);s&32&&(c=d8[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||a===0||!(u>0)?[]:TW(e,u,r,a);return{chKey:i,Name:c,itab:l,rgce:h}}function fk(e,t,r){if(r.biff<8)return f8(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(yB(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function f8(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=nc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function g8(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=Gi(e,n,r),o=Gi(e,s,r);return[i,o]}function p8(e,t,r){var n=hk(e);e.l++;var s=e.read_shift(1);return t-=8,[RW(e,t,r),s,n]}function dx(e,t,r){var n=kB(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,EW(e,t,r)]}function m8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function v8(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),a=to(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},a,o,i]}}function x8(e,t,r){return v8(e,t,r)}function C8(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(sd(e));return r}function w8(e){var t=J(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)uk(e[r],t);return t}function y8(e,t,r){if(r&&r.biff<8)return k8(e,t,r);var n=dk(e),s=TB(e,t-22,n[1]);return{cmo:n,ft:s}}var S8={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function k8(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((S8[n]||Cr)(e,t,r)),{cmo:[s,n,i],ft:o}}function b8(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=fB(e,6,r);var a=e.read_shift(2);e.read_shift(2),Nt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=Gi(e,e.lens[c+1]-e.lens[c]-1);if(s+=h,s.length>=(u?a:2*a))break}if(s.length!==a&&s.length!==a*2)throw new Error("cchText: "+a+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function E8(e,t){var r=sd(e);e.l+=16;var n=vB(e,t-24);return[r,n]}function F8(e){var t=J(24),r=kt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Qt([t,xB(e[1])])}function T8(e,t){e.read_shift(2);var r=sd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Rr,""),[r,n]}function R8(e){var t=e[1].Tooltip,r=J(10+2*(t.length+1));r.write_shift(2,2048);var n=kt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function _8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Q1[r]||r,r=e.read_shift(2),t[1]=Q1[r]||r,t}function D8(e){return e||(e=J(4)),e.write_shift(2,1),e.write_shift(2,1),e}function A8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lk(e));return r}function P8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lk(e));return r}function I8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function gk(e,t,r){if(!r.cellStyles)return Cr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:i,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function L8(e,t){var r=J(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function M8(e,t){var r={};return t<32||(e.l+=16,r.header=pr(e),r.footer=pr(e),e.l+=2),r}function O8(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function N8(e){for(var t=J(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var B8=qn,H8=sk,W8=sc;function V8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function G8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=qn(e);++e.l;var s=to(e,t-7,r);return n.t="str",n.val=s,n}function z8(e){var t=qn(e);++e.l;var r=pr(e);return t.t="n",t.val=r,t}function U8(e,t,r){var n=J(15);return lc(n,e,t),n.write_shift(8,r,"f"),n}function j8(e){var t=qn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function $8(e,t,r){var n=J(9);return lc(n,e,t),n.write_shift(2,r),n}function K8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function X8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Y8(e,t,r){var n=e.l+t,s=qn(e),i=e.read_shift(2),o=Gi(e,i,r);return e.l=n,s.t="str",s.val=o,s}var Q8=[2,3,48,49,131,139,140,245],U0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=td({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=qs(1);switch(l.type){case"base64":u=Ur(Qr(a));break;case"binary":u=Ur(a);break;case"buffer":case"array":u=a;break}rr(u,0);var h=u.read_shift(1),d=!!(h&136),f=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,d=!0;break;case 49:f=!0,d=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,m=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(m=u.read_shift(2));var v=u.read_shift(2),C=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(C=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var x=[],w={},k=Math.min(u.length,h==2?521:m-10-(f?264:0)),E=p?32:11;u.l<k&&u[u.l]!=13;)switch(w={},w.name=Is.utils.decode(C,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,w.type=String.fromCharCode(u.read_shift(1)),h!=2&&!p&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),h==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&x.push(w),h!=2&&(u.l+=p?13:14),w.type){case"B":(!f||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var y=0,R=0;for(c[0]=[],R=0;R!=x.length;++R)c[0][R]=x[R].name;for(;g-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++y]=[],R=0,R=0;R!=x.length;++R){var D=u.slice(u.l,u.l+x[R].len);u.l+=x[R].len,rr(D,0);var N=Is.utils.decode(C,D);switch(x[R].type){case"C":N.trim().length&&(c[y][R]=N.replace(/\s+$/,""));break;case"D":N.length===8?c[y][R]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):c[y][R]=N;break;case"F":c[y][R]=parseFloat(N.trim());break;case"+":case"I":c[y][R]=p?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":c[y][R]=!0;break;case"N":case"F":c[y][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[y][R]="##MEMO##"+(p?parseInt(N.trim(),10):D.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(c[y][R]=+N||0);break;case"@":c[y][R]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":c[y][R]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":c[y][R]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][R]=-D.read_shift(-8,"f");break;case"B":if(f&&x[R].len==8){c[y][R]=D.read_shift(8,"f");break}case"G":case"P":D.l+=x[R].len;break;case"0":if(x[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[R].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ha(r(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(a,l){try{return ci(n(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&Tn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Hr(),h=yh(a,{header:1,raw:!0,cellDates:!0}),d=h[0],f=h.slice(1),p=a["!cols"]||[],g=0,m=0,v=0,C=1;for(g=0;g<d.length;++g){if(((p[g]||{}).DBF||{}).name){d[g]=p[g].DBF.name,++v;continue}if(d[g]!=null){if(++v,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(m=0;m<1024;++m)if(d.indexOf(d[g]+"_"+m)==-1){d[g]+="_"+m;break}}}}var x=Ye(a["!ref"]),w=[],k=[],E=[];for(g=0;g<=x.e.c-x.s.c;++g){var y="",R="",D=0,N=[];for(m=0;m<f.length;++m)f[m][g]!=null&&N.push(f[m][g]);if(N.length==0||d[g]==null){w[g]="?";continue}for(m=0;m<N.length;++m){switch(typeof N[m]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=N[m]instanceof Date?"D":"C";break;default:R="C"}D=Math.max(D,String(N[m]).length),y=y&&y!=R?"C":R}D>250&&(D=250),R=((p[g]||{}).DBF||{}).type,R=="C"&&p[g].DBF.len>D&&(D=p[g].DBF.len),y=="B"&&R=="N"&&(y="N",E[g]=p[g].DBF.dec,D=p[g].DBF.len),k[g]=y=="C"||R=="N"?D:i[y]||0,C+=k[g],w[g]=y}var O=u.next(32);for(O.write_shift(4,318902576),O.write_shift(4,f.length),O.write_shift(2,296+32*v),O.write_shift(2,C),g=0;g<4;++g)O.write_shift(4,0);for(O.write_shift(4,0|(+t[r2]||3)<<8),g=0,m=0;g<d.length;++g)if(d[g]!=null){var A=u.next(32),G=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,G,"sbcs"),A.write_shift(1,w[g]=="?"?"C":w[g],"sbcs"),A.write_shift(4,m),A.write_shift(1,k[g]||i[w[g]]||0),A.write_shift(1,E[g]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),m+=k[g]||i[w[g]]||0}var q=u.next(264);for(q.write_shift(4,13),g=0;g<65;++g)q.write_shift(4,0);for(g=0;g<f.length;++g){var z=u.next(C);for(z.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(w[m]){case"L":z.write_shift(1,f[g][m]==null?63:f[g][m]?84:70);break;case"B":z.write_shift(8,f[g][m]||0,"f");break;case"N":var se="0";for(typeof f[g][m]=="number"&&(se=f[g][m].toFixed(E[m]||0)),v=0;v<k[m]-se.length;++v)z.write_shift(1,32);z.write_shift(1,se,"sbcs");break;case"D":f[g][m]?(z.write_shift(4,("0000"+f[g][m].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(f[g][m].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+f[g][m].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var te=String(f[g][m]!=null?f[g][m]:"").slice(0,k[m]);for(z.write_shift(1,te,"sbcs"),v=0;v<k[m]-te.length;++v)z.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),pk=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+_t(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,f){var p=e[f];return typeof p=="number"?k1(p):p},n=function(d,f,p){var g=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?d:k1(g)};e["|"]=254;function s(d,f){switch(f.type){case"base64":return i(Qr(d),f);case"binary":return i(d,f);case"buffer":return i(Ne&&Buffer.isBuffer(d)?d.toString("binary"):li(d),f);case"array":return i(Wi(d),f)}throw new Error("Unrecognized type "+f.type)}function i(d,f){var p=d.split(/[\n\r]+/),g=-1,m=-1,v=0,C=0,x=[],w=[],k=null,E={},y=[],R=[],D=[],N=0,O;for(+f.codepage>=0&&Tn(+f.codepage);v!==p.length;++v){N=0;var A=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=A.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),q=G[0],z;if(A.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&w.push(A.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,te=!1,Z=!1,H=!1,Q=-1,ie=-1;for(C=1;C<G.length;++C)switch(G[C].charAt(0)){case"A":break;case"X":m=parseInt(G[C].slice(1))-1,te=!0;break;case"Y":for(g=parseInt(G[C].slice(1))-1,te||(m=0),O=x.length;O<=g;++O)x[O]=[];break;case"K":z=G[C].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(An(z))?isNaN(Qo(z).getDate())||(z=gt(z)):(z=An(z),k!==null&&ca(k)&&(z=nd(z))),se=!0;break;case"E":H=!0;var F=Bo(G[C].slice(1),{r:g,c:m});x[g][m]=[x[g][m],F];break;case"S":Z=!0,x[g][m]=[x[g][m],"S5S"];break;case"G":break;case"R":Q=parseInt(G[C].slice(1))-1;break;case"C":ie=parseInt(G[C].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+A)}if(se&&(x[g][m]&&x[g][m].length==2?x[g][m][0]=z:x[g][m]=z,k=null),Z){if(H)throw new Error("SYLK shared formula cannot have own formula");var W=Q>-1&&x[Q][ie];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");x[g][m][1]=Ik(W[1],{r:g-Q,c:m-ie})}break;case"F":var B=0;for(C=1;C<G.length;++C)switch(G[C].charAt(0)){case"X":m=parseInt(G[C].slice(1))-1,++B;break;case"Y":for(g=parseInt(G[C].slice(1))-1,O=x.length;O<=g;++O)x[O]=[];break;case"M":N=parseInt(G[C].slice(1))/20;break;case"F":break;case"G":break;case"P":k=w[parseInt(G[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=G[C].slice(1).split(" "),O=parseInt(D[0],10);O<=parseInt(D[1],10);++O)N=parseInt(D[2],10),R[O-1]=N===0?{hidden:!0}:{wch:N},Js(R[O-1]);break;case"C":m=parseInt(G[C].slice(1))-1,R[m]||(R[m]={});break;case"R":g=parseInt(G[C].slice(1))-1,y[g]||(y[g]={}),N>0?(y[g].hpt=N,y[g].hpx=qo(N)):N===0&&(y[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+A)}B<1&&(k=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+A)}}return y.length>0&&(E["!rows"]=y),R.length>0&&(E["!cols"]=R),f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),[x,E]}function o(d,f){var p=s(d,f),g=p[0],m=p[1],v=ha(g,f);return _t(m).forEach(function(C){v[C]=m[C]}),v}function a(d,f){return ci(o(d,f),f)}function l(d,f,p,g){var m="C;Y"+(p+1)+";X"+(g+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+zp(d.f,{r:p,c:g}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function c(d,f){f.forEach(function(p,g){var m="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Nl(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Bl(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function u(d,f){f.forEach(function(p,g){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*Hl(p.hpx)+";"),m.length>2&&d.push(m+"R"+(g+1))})}function h(d,f){var p=["ID;PWXL;N;E"],g=[],m=Ye(d["!ref"]),v,C=Array.isArray(d),x=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),d["!cols"]&&c(p,d["!cols"]),d["!rows"]&&u(p,d["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var w=m.s.r;w<=m.e.r;++w)for(var k=m.s.c;k<=m.e.c;++k){var E=_e({r:w,c:k});v=C?(d[w]||[])[k]:d[E],!(!v||v.v==null&&(!v.f||v.F))&&g.push(l(v,d,w,k))}return p.join(x)+x+g.join(x)+x+"E"+x}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),mk=function(){function e(i,o){switch(o.type){case"base64":return t(Qr(i),o);case"binary":return t(i,o);case"buffer":return t(Ne&&Buffer.isBuffer(i)?i.toString("binary"):li(i),o);case"array":return t(Wi(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var a=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=a[u].trim().split(","),f=d[0],p=d[1];++u;for(var g=a[u]||"";(g.match(/["]/g)||[]).length&1&&u<a.length-1;)g+=`
`+a[++u];switch(g=g.trim(),+f){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(An(p))?isNaN(Qo(p).getDate())?h[l][c]=p:h[l][c]=gt(p):h[l][c]=An(p),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(i,o){return ha(e(i,o),o)}function n(i,o){return ci(r(i,o),o)}var s=function(){var i=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Ye(l["!ref"]),h,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(c,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var g=_e({r:f,c:p});if(h=d?(l[f]||[])[p]:l[g],!h){o(c,1,0,"");continue}switch(h.t){case"n":var m=h.w;!m&&h.v!=null&&(m=h.v),m==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,m,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=wn(h.z||Re[14],$t(gt(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var v=`\r
`,C=c.join(v);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),vk=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var f=h.split(`
`),p=-1,g=-1,m=0,v=[];m!==f.length;++m){var C=f[m].trim().split(":");if(C[0]==="cell"){var x=kt(C[1]);if(v.length<=x.r)for(p=v.length;p<=x.r;++p)v[p]||(v[p]=[]);switch(p=x.r,g=x.c,C[2]){case"t":v[p][g]=e(C[3]);break;case"v":v[p][g]=+C[3];break;case"vtf":var w=C[C.length-1];case"vtc":switch(C[3]){case"nl":v[p][g]=!!+C[4];break;default:v[p][g]=+C[4];break}C[2]=="vtf"&&(v[p][g]=[v[p][g],w])}}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function n(h,d){return ha(r(h,d),d)}function s(h,d){return ci(n(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],f=[],p,g="",m=Wr(h["!ref"]),v=Array.isArray(h),C=m.s.r;C<=m.e.r;++C)for(var x=m.s.c;x<=m.e.c;++x)if(g=_e({r:C,c:x}),p=v?(h[C]||[])[x]:h[g],!(!p||p.v==null||p.t==="z")){switch(f=["cell",g,"t"],p.t){case"s":case"str":f.push(t(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=t(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=$t(gt(p.v));f[2]="vtc",f[3]="nd",f[4]=""+w,f[5]=p.w||wn(p.z||Re[14],w);break;case"e":continue}d.push(f.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[i,o,a,o,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),Zo=function(){function e(u,h,d,f,p){p.raw?h[d][f]=u:u===""||(u==="TRUE"?h[d][f]=!0:u==="FALSE"?h[d][f]=!1:isNaN(An(u))?isNaN(Qo(u).getDate())?h[d][f]=u:h[d][f]=gt(u):h[d][f]=An(u))}function t(u,h){var d=h||{},f=[];if(!u||u.length===0)return f;for(var p=u.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var m=10,v=0,C=0;C<=g;++C)v=p[C].indexOf(" "),v==-1?v=p[C].length:v++,m=Math.max(m,v);for(C=0;C<=g;++C){f[C]=[];var x=0;for(e(p[C].slice(0,m).trim(),f,C,x,d),x=1;x<=(p[C].length-m)/10+1;++x)e(p[C].slice(m+(x-1)*10,m+x*10).trim(),f,C,x,d)}return d.sheetRows&&(f=f.slice(0,d.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},d=!1,f=0,p=0;f<u.length;++f)(p=u.charCodeAt(f))==34?d=!d:!d&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&p.push([h[f],f]);if(!p.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&p.push([h[f],f])}return p.sort(function(g,m){return g[0]-m[0]||n[g[1]]-n[m[1]]}),r[p.pop()[1]]||44}function i(u,h){var d=h||{},f="",p=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=s(u.slice(0,1024)):d&&d.FS?f=d.FS:f=s(u.slice(0,1024));var m=0,v=0,C=0,x=0,w=0,k=f.charCodeAt(0),E=!1,y=0,R=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var D=d.dateNF!=null?NO(d.dateNF):null;function N(){var O=u.slice(x,w),A={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)A.t="z";else if(d.raw)A.t="s",A.v=O;else if(O.trim().length===0)A.t="s",A.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(A.t="s",A.v=O.slice(2,-1).replace(/""/g,'"')):hH(O)?(A.t="n",A.f=O.slice(1)):(A.t="s",A.v=O);else if(O=="TRUE")A.t="b",A.v=!0;else if(O=="FALSE")A.t="b",A.v=!1;else if(!isNaN(C=An(O)))A.t="n",d.cellText!==!1&&(A.w=O),A.v=C;else if(!isNaN(Qo(O).getDate())||D&&O.match(D)){A.z=d.dateNF||Re[14];var G=0;D&&O.match(D)&&(O=BO(O,d.dateNF,O.match(D)||[]),G=1),d.cellDates?(A.t="d",A.v=gt(O,G)):(A.t="n",A.v=$t(gt(O,G))),d.cellText!==!1&&(A.w=wn(A.z,A.v instanceof Date?$t(A.v):A.v)),d.cellNF||delete A.z}else A.t="s",A.v=O;if(A.t=="z"||(d.dense?(p[m]||(p[m]=[]),p[m][v]=A):p[_e({c:v,r:m})]=A),x=w+1,R=u.charCodeAt(x),g.e.c<v&&(g.e.c=v),g.e.r<m&&(g.e.r=m),y==k)++v;else if(v=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;w<u.length;++w)switch(y=u.charCodeAt(w)){case 34:R===34&&(E=!E);break;case k:case 10:case 13:if(!E&&N())break e;break}return w-x>0&&N(),p["!ref"]=Ie(g),p}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):ha(t(u,h),h)}function a(u,h){var d="",f=h.type=="string"?[0,0,0,0]:Zp(u,h);switch(h.type){case"base64":d=Qr(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof Is<"u"?d=Is.utils.decode(h.codepage,u):d=Ne&&Buffer.isBuffer(u)?u.toString("binary"):li(u);break;case"array":d=Wi(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?d=it(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=it(d):h.type=="binary"&&typeof Is<"u"&&h.codepage&&(d=Is.utils.decode(h.codepage,Is.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?vk.to_sheet(h.type=="string"?d:it(d),h):o(d,h)}function l(u,h){return ci(a(u,h),h)}function c(u){for(var h=[],d=Ye(u["!ref"]),f,p=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var m=[],v=d.s.c;v<=d.e.c;++v){var C=_e({r:g,c:v});if(f=p?(u[g]||[])[v]:u[C],!f||f.v==null){m.push("          ");continue}for(var x=(f.w||(xs(f),f.w)||"").slice(0,10);x.length<10;)x+=" ";m.push(x+(v===0?" ":""))}h.push(m.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function Z8(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=pk.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Zo.to_workbook(e,t)}}var Di=function(){function e(F,W,B){if(!!F){rr(F,F.l||0);for(var V=B.Enum||Q;F.l<F.length;){var X=F.read_shift(2),ne=V[X]||V[65535],le=F.read_shift(2),ce=F.l+le,ee=ne.f&&ne.f(F,le,B);if(F.l=ce,W(ee,ne,X))return}}}function t(F,W){switch(W.type){case"base64":return r(Ur(Qr(F)),W);case"binary":return r(Ur(F),W);case"buffer":case"array":return r(F,W)}throw"Unsupported type "+W.type}function r(F,W){if(!F)return F;var B=W||{},V=B.dense?[]:{},X="Sheet1",ne="",le=0,ce={},ee=[],Ee=[],L={s:{r:0,c:0},e:{r:0,c:0}},He=B.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)B.Enum=Q,e(F,function(oe,Oe,Qe){switch(Qe){case 0:B.vers=oe,oe>=4096&&(B.qpro=!0);break;case 6:L=oe;break;case 204:oe&&(ne=oe);break;case 222:ne=oe;break;case 15:case 51:B.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=B.dateNF||Re[14],B.cellDates&&(oe[1].t="d",oe[1].v=nd(oe[1].v))),B.qpro&&oe[3]>le&&(V["!ref"]=Ie(L),ce[X]=V,ee.push(X),V=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},le=oe[3],X=ne||"Sheet"+(le+1),ne="");var je=B.dense?(V[oe[0].r]||[])[oe[0].c]:V[_e(oe[0])];if(je){je.t=oe[1].t,je.v=oe[1].v,oe[1].z!=null&&(je.z=oe[1].z),oe[1].f!=null&&(je.f=oe[1].f);break}B.dense?(V[oe[0].r]||(V[oe[0].r]=[]),V[oe[0].r][oe[0].c]=oe[1]):V[_e(oe[0])]=oe[1];break}},B);else if(F[2]==26||F[2]==14)B.Enum=ie,F[2]==14&&(B.qpro=!0,F.l=0),e(F,function(oe,Oe,Qe){switch(Qe){case 204:X=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>le&&(V["!ref"]=Ie(L),ce[X]=V,ee.push(X),V=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},le=oe[3],X="Sheet"+(le+1)),He>0&&oe[0].r>=He)break;B.dense?(V[oe[0].r]||(V[oe[0].r]=[]),V[oe[0].r][oe[0].c]=oe[1]):V[_e(oe[0])]=oe[1],L.e.c<oe[0].c&&(L.e.c=oe[0].c),L.e.r<oe[0].r&&(L.e.r=oe[0].r);break;case 27:oe[14e3]&&(Ee[oe[14e3][0]]=oe[14e3][1]);break;case 1537:Ee[oe[0]]=oe[1],oe[0]==le&&(X=oe[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(V["!ref"]=Ie(L),ce[ne||X]=V,ee.push(ne||X),!Ee.length)return{SheetNames:ee,Sheets:ce};for(var Ae={},Ue=[],Ce=0;Ce<Ee.length;++Ce)ce[ee[Ce]]?(Ue.push(Ee[Ce]||ee[Ce]),Ae[Ee[Ce]]=ce[Ee[Ce]]||ce[ee[Ce]]):(Ue.push(Ee[Ce]),Ae[Ee[Ce]]={"!ref":"A1"});return{SheetNames:Ue,Sheets:Ae}}function n(F,W){var B=W||{};if(+B.codepage>=0&&Tn(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Hr(),X=Ye(F["!ref"]),ne=Array.isArray(F),le=[];me(V,0,i(1030)),me(V,6,l(X));for(var ce=Math.min(X.e.r,8191),ee=X.s.r;ee<=ce;++ee)for(var Ee=It(ee),L=X.s.c;L<=X.e.c;++L){ee===X.s.r&&(le[L]=St(L));var He=le[L]+Ee,Ae=ne?(F[ee]||[])[L]:F[He];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?me(V,13,f(ee,L,Ae.v)):me(V,14,g(ee,L,Ae.v));else{var Ue=xs(Ae);me(V,15,h(ee,L,Ue.slice(0,239)))}}return me(V,1),V.end()}function s(F,W){var B=W||{};if(+B.codepage>=0&&Tn(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Hr();me(V,0,o(F));for(var X=0,ne=0;X<F.SheetNames.length;++X)(F.Sheets[F.SheetNames[X]]||{})["!ref"]&&me(V,27,H(F.SheetNames[X],ne++));var le=0;for(X=0;X<F.SheetNames.length;++X){var ce=F.Sheets[F.SheetNames[X]];if(!(!ce||!ce["!ref"])){for(var ee=Ye(ce["!ref"]),Ee=Array.isArray(ce),L=[],He=Math.min(ee.e.r,8191),Ae=ee.s.r;Ae<=He;++Ae)for(var Ue=It(Ae),Ce=ee.s.c;Ce<=ee.e.c;++Ce){Ae===ee.s.r&&(L[Ce]=St(Ce));var oe=L[Ce]+Ue,Oe=Ee?(ce[Ae]||[])[Ce]:ce[oe];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")me(V,23,N(Ae,Ce,le,Oe.v));else{var Qe=xs(Oe);me(V,22,y(Ae,Ce,le,Qe.slice(0,239)))}}++le}}return me(V,1),V.end()}function i(F){var W=J(2);return W.write_shift(2,F),W}function o(F){var W=J(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var B=0,V=0,X=0,ne=0;ne<F.SheetNames.length;++ne){var le=F.SheetNames[ne],ce=F.Sheets[le];if(!(!ce||!ce["!ref"])){++X;var ee=Wr(ce["!ref"]);B<ee.e.r&&(B=ee.e.r),V<ee.e.c&&(V=ee.e.c)}}return B>8191&&(B=8191),W.write_shift(2,B),W.write_shift(1,X),W.write_shift(1,V),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function a(F,W,B){var V={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&B.qpro?(V.s.c=F.read_shift(1),F.l++,V.s.r=F.read_shift(2),V.e.c=F.read_shift(1),F.l++,V.e.r=F.read_shift(2),V):(V.s.c=F.read_shift(2),V.s.r=F.read_shift(2),W==12&&B.qpro&&(F.l+=2),V.e.c=F.read_shift(2),V.e.r=F.read_shift(2),W==12&&B.qpro&&(F.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(F){var W=J(8);return W.write_shift(2,F.s.c),W.write_shift(2,F.s.r),W.write_shift(2,F.e.c),W.write_shift(2,F.e.r),W}function c(F,W,B){var V=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(V[0].c=F.read_shift(1),V[3]=F.read_shift(1),V[0].r=F.read_shift(2),F.l+=2):(V[2]=F.read_shift(1),V[0].c=F.read_shift(2),V[0].r=F.read_shift(2)),V}function u(F,W,B){var V=F.l+W,X=c(F,W,B);if(X[1].t="s",B.vers==20768){F.l++;var ne=F.read_shift(1);return X[1].v=F.read_shift(ne,"utf8"),X}return B.qpro&&F.l++,X[1].v=F.read_shift(V-F.l,"cstr"),X}function h(F,W,B){var V=J(7+B.length);V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,F),V.write_shift(1,39);for(var X=0;X<V.length;++X){var ne=B.charCodeAt(X);V.write_shift(1,ne>=128?95:ne)}return V.write_shift(1,0),V}function d(F,W,B){var V=c(F,W,B);return V[1].v=F.read_shift(2,"i"),V}function f(F,W,B){var V=J(7);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,F),V.write_shift(2,B,"i"),V}function p(F,W,B){var V=c(F,W,B);return V[1].v=F.read_shift(8,"f"),V}function g(F,W,B){var V=J(13);return V.write_shift(1,255),V.write_shift(2,W),V.write_shift(2,F),V.write_shift(8,B,"f"),V}function m(F,W,B){var V=F.l+W,X=c(F,W,B);if(X[1].v=F.read_shift(8,"f"),B.qpro)F.l=V;else{var ne=F.read_shift(2);w(F.slice(F.l,F.l+ne),X),F.l+=ne}return X}function v(F,W,B){var V=W&32768;return W&=-32769,W=(V?F:0)+(W>=8192?W-16384:W),(V?"":"$")+(B?St(W):It(W))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(F,W){rr(F,0);for(var B=[],V=0,X="",ne="",le="",ce="";F.l<F.length;){var ee=F[F.l++];switch(ee){case 0:B.push(F.read_shift(8,"f"));break;case 1:ne=v(W[0].c,F.read_shift(2),!0),X=v(W[0].r,F.read_shift(2),!1),B.push(ne+X);break;case 2:{var Ee=v(W[0].c,F.read_shift(2),!0),L=v(W[0].r,F.read_shift(2),!1);ne=v(W[0].c,F.read_shift(2),!0),X=v(W[0].r,F.read_shift(2),!1),B.push(Ee+L+":"+ne+X)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(F.read_shift(2));break;case 6:{for(var He="";ee=F[F.l++];)He+=String.fromCharCode(ee);B.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:ce=B.pop(),le=B.pop(),B.push(["AND","OR"][ee-20]+"("+le+","+ce+")");break;default:if(ee<32&&x[ee])ce=B.pop(),le=B.pop(),B.push(le+x[ee]+ce);else if(C[ee]){if(V=C[ee][1],V==69&&(V=F[F.l++]),V>B.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+B.join("|")+"|");return}var Ae=B.slice(-V);B.length-=V,B.push(C[ee][0]+"("+Ae.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}B.length==1?W[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function k(F){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=F.read_shift(2),W[3]=F[F.l++],W[0].c=F[F.l++],W}function E(F,W){var B=k(F);return B[1].t="s",B[1].v=F.read_shift(W-4,"cstr"),B}function y(F,W,B,V){var X=J(6+V.length);X.write_shift(2,F),X.write_shift(1,B),X.write_shift(1,W),X.write_shift(1,39);for(var ne=0;ne<V.length;++ne){var le=V.charCodeAt(ne);X.write_shift(1,le>=128?95:le)}return X.write_shift(1,0),X}function R(F,W){var B=k(F);B[1].v=F.read_shift(2);var V=B[1].v>>1;if(B[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return B[1].v=V,B}function D(F,W){var B=k(F),V=F.read_shift(4),X=F.read_shift(4),ne=F.read_shift(2);if(ne==65535)return V===0&&X===3221225472?(B[1].t="e",B[1].v=15):V===0&&X===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var le=ne&32768;return ne=(ne&32767)-16446,B[1].v=(1-le*2)*(X*Math.pow(2,ne+32)+V*Math.pow(2,ne)),B}function N(F,W,B,V){var X=J(14);if(X.write_shift(2,F),X.write_shift(1,B),X.write_shift(1,W),V==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ne=0,le=0,ce=0,ee=0;return V<0&&(ne=1,V=-V),le=Math.log2(V)|0,V/=Math.pow(2,le-31),ee=V>>>0,(ee&2147483648)==0&&(V/=2,++le,ee=V>>>0),V-=ee,ee|=2147483648,ee>>>=0,V*=Math.pow(2,32),ce=V>>>0,X.write_shift(4,ce),X.write_shift(4,ee),le+=16383+(ne?32768:0),X.write_shift(2,le),X}function O(F,W){var B=D(F);return F.l+=W-14,B}function A(F,W){var B=k(F),V=F.read_shift(4);return B[1].v=V>>6,B}function G(F,W){var B=k(F),V=F.read_shift(8,"f");return B[1].v=V,B}function q(F,W){var B=G(F);return F.l+=W-10,B}function z(F,W){return F[F.l+W-1]==0?F.read_shift(W,"cstr"):""}function se(F,W){var B=F[F.l++];B>W-1&&(B=W-1);for(var V="";V.length<B;)V+=String.fromCharCode(F[F.l++]);return V}function te(F,W,B){if(!(!B.qpro||W<21)){var V=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var X=F.read_shift(W-21,"cstr");return[V,X]}}function Z(F,W){for(var B={},V=F.l+W;F.l<V;){var X=F.read_shift(2);if(X==14e3){for(B[X]=[0,""],B[X][0]=F.read_shift(2);F[F.l];)B[X][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return B}function H(F,W){var B=J(5+F.length);B.write_shift(2,14e3),B.write_shift(2,W);for(var V=0;V<F.length;++V){var X=F.charCodeAt(V);B[B.l++]=X>127?95:X}return B[B.l++]=0,B}var Q={0:{n:"BOF",f:Nt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function q8(e){var t={},r=e.match(yr),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=De(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=gp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var J8=function(){var e=Pl("t"),t=Pl("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:Xe(o[1])},l=i.match(t);return l&&(a.s=q8(l[1])),a}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(a){return a.v})}}(),e6=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var a=[];s.u&&a.push("text-decoration: underline;"),s.uval&&a.push("text-underline-style:"+s.uval+";"),s.sz&&a.push("font-size:"+s.sz+"pt;"),s.outline&&a.push("text-effect: outline;"),s.shadow&&a.push("text-shadow: auto;"),i.push('<span style="'+a.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),t6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,r6=/<(?:\w+:)?r>/,n6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Xe(it(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=it(e),r&&(n.h=bp(n.t))):e.match(r6)&&(n.r=it(e),n.t=Xe(it((e.replace(n6,"").match(t6)||[]).join("").replace(yr,""))),r&&(n.h=e6(J8(n.r)))),n):{t:""}}var s6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,i6=/<(?:\w+:)?(?:si|sstItem)>/g,o6=/<\/(?:\w+:)?(?:si|sstItem)>/;function a6(e,t){var r=[],n="";if(!e)return r;var s=e.match(s6);if(s){n=s[2].replace(i6,"").split(o6);for(var i=0;i!=n.length;++i){var o=Bp(n[i].trim(),t);o!=null&&(r[r.length]=o)}s=De(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var l6=/^\s|\s$|[\t\n\r]/;function xk(e,t){if(!t.bookSST)return"";var r=[Lt];r[r.length]=pe("sst",null,{xmlns:Qi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(l6)&&(i+=' xml:space="preserve"'),i+=">"+rt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function c6(e){return[e.read_shift(4),e.read_shift(4)]}function u6(e,t){var r=[],n=!1;return Ss(e,function(i,o,a){switch(a){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function h6(e,t){return t||(t=J(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var d6=SN;function f6(e){var t=Hr();ae(t,159,h6(e));for(var r=0;r<e.length;++r)ae(t,19,d6(e[r]));return ae(t,160),t.end()}function Ck(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function fs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function g6(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=fs(e,4),t.U=fs(e,4),t.W=fs(e,4),t}function p6(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function m6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(p6(e));return t}function v6(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function x6(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=fs(e,4),t.U=fs(e,4),t.W=fs(e,4),t}function C6(e){var t=x6(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function wk(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function yk(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function w6(e){var t=fs(e);switch(t.Minor){case 2:return[t.Minor,y6(e)];case 3:return[t.Minor,S6()];case 4:return[t.Minor,k6(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function y6(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=wk(e,r),s=yk(e,e.length-e.l);return{t:"Std",h:n,v:s}}function S6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function k6(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(yr,function(i){var o=De(i);switch(Zn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function b6(e,t){var r={},n=r.EncryptionVersionInfo=fs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=wk(e,s),t-=s,r.EncryptionVerifier=yk(e,t),r}function E6(e){var t={},r=t.EncryptionVersionInfo=fs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Hp(e){var t=0,r,n=Ck(e),s=n.length+1,i,o,a,l,c;for(r=qs(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],a=(t&16384)===0?0:1,l=t<<1&32767,c=a|l,t=c^o;return t^52811}var Sk=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,a){return n(o^a)},i=function(o){for(var a=t[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],h=0;h!=7;++h)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=Ck(o),l=i(a),c=a.length,u=qs(16),h=0;h!=16;++h)u[h]=0;var d,f,p;for((c&1)===1&&(d=l>>8,u[c]=s(e[0],d),--c,d=l&255,f=a[a.length-1],u[c]=s(f,d));c>0;)--c,d=l>>8,u[c]=s(a[c],d),--c,d=l&255,u[c]=s(a[c],d);for(c=15,p=15-a.length;p>0;)d=l>>8,u[c]=s(e[p],d),--c,--p,d=l&255,u[c]=s(a[c],d),--c,--p;return u}}(),F6=function(e,t,r,n,s){s||(s=t),n||(n=Sk(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},T6=function(e){var t=0,r=Sk(e);return function(n){var s=F6("",n,t,r);return t=s[1],s[0]}};function R6(e,t,r,n){var s={key:Nt(e),verificationBytes:Nt(e)};return r.password&&(s.verifier=Hp(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=T6(r.password)),s}function _6(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=E6(e):n.Data=b6(e,t),n}function D6(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?_6(e,t-2,n):R6(e,r.biff>=8?t:t-2,r,n),n}var kk=function(){function e(s,i){switch(i.type){case"base64":return t(Qr(s),i);case"binary":return t(s,i);case"buffer":return t(Ne&&Buffer.isBuffer(s)?s.toString("binary"):li(s),i);case"array":return t(Wi(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},a=o.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var d=/\\\w+\b/g,f=0,p,g=-1;p=d.exec(u);){switch(p[0]){case"\\cell":var m=u.slice(f,d.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var v={v:m,t:"s"};Array.isArray(a)?a[h][g]=v:a[_e({r:h,c:g})]=v}break}f=d.lastIndex}g>c.e.c&&(c.e.c=g)}),a["!ref"]=Ie(c),a}function r(s,i){return ci(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=Ye(s["!ref"]),a,l=Array.isArray(s),c=o.s.r;c<=o.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=_e({r:c,c:u});a=l?(s[c]||[])[u]:s[h],!(!a||a.v==null&&(!a.f||a.F))&&(i.push(" "+(a.w||(xs(a),a.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function A6(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ol(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function P6(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),o=s-i;if(o===0)return[0,0,t];var a=0,l=0,c=s+i;switch(l=o/(c>1?2-c:c),s){case t:a=((r-n)/o+6)%6;break;case r:a=(n-t)/o+2;break;case n:a=(t-r)/o+4;break}return[a/6,l,c/2]}function I6(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],a=6*t,l;if(r!==0)switch(a|0){case 0:case 6:l=s*a,o[0]+=s,o[1]+=l;break;case 1:l=s*(2-a),o[0]+=l,o[1]+=s;break;case 2:l=s*(a-2),o[1]+=s,o[2]+=l;break;case 3:l=s*(4-a),o[1]+=l,o[2]+=s;break;case 4:l=s*(a-4),o[2]+=s,o[0]+=l;break;case 5:l=s*(6-a),o[2]+=l,o[0]+=s;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function Ch(e,t){if(t===0)return e;var r=P6(A6(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ol(I6(r))}var bk=6,L6=15,M6=1,gr=bk;function Nl(e){return Math.floor((e+Math.round(128/gr)/256)*gr)}function Bl(e){return Math.floor((e-5)/gr*100+.5)/100}function wh(e){return Math.round((e*gr+5)/gr*256)/256}function pf(e){return wh(Bl(Nl(e)))}function Wp(e){var t=Math.abs(e-pf(e)),r=gr;if(t>.005)for(gr=M6;gr<L6;++gr)Math.abs(e-pf(e))<=t&&(t=Math.abs(e-pf(e)),r=gr);gr=r}function Js(e){e.width?(e.wpx=Nl(e.width),e.wch=Bl(e.wpx),e.MDW=gr):e.wpx?(e.wch=Bl(e.wpx),e.width=wh(e.wch),e.MDW=gr):typeof e.wch=="number"&&(e.width=wh(e.wch),e.wpx=Nl(e.width),e.MDW=gr),e.customWidth&&delete e.customWidth}var O6=96,Ek=O6;function Hl(e){return e*96/Ek}function qo(e){return e*Ek/96}var N6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function B6(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(yr)||[]).forEach(function(o){var a=De(o);switch(Zn(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},a.diagonalUp&&(s.diagonalUp=dt(a.diagonalUp)),a.diagonalDown&&(s.diagonalDown=dt(a.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in borders")}})}function H6(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(yr)||[]).forEach(function(o){var a=De(o);switch(Zn(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":a.patternType&&(s.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),a.indexed&&(s.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(s.bgColor.theme=parseInt(a.theme,10)),a.tint&&(s.bgColor.tint=parseFloat(a.tint)),a.rgb&&(s.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),a.theme&&(s.fgColor.theme=parseInt(a.theme,10)),a.tint&&(s.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(s.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in fills")}})}function W6(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(yr)||[]).forEach(function(o){var a=De(o);switch(Zn(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":a.val&&(s.name=it(a.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=a.val?dt(a.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=a.val?dt(a.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(a.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=a.val?dt(a.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=a.val?dt(a.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=a.val?dt(a.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=a.val?dt(a.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=a.val?dt(a.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":a.val&&(s.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(s.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(s.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(s.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=gp[parseInt(a.val,10)];break;case"<color":if(s.color||(s.color={}),a.auto&&(s.color.auto=dt(a.auto)),a.rgb)s.color.rgb=a.rgb.slice(-6);else if(a.indexed){s.color.index=parseInt(a.indexed,10);var l=Ri[s.color.index];s.color.index==81&&(l=Ri[1]),l||(l=Ri[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(s.color.theme=parseInt(a.theme,10),a.tint&&(s.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ch(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in fonts")}})}function V6(e,t,r){t.NumberFmt=[];for(var n=_t(Re),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Re[n[s]];var i=e[0].match(yr);if(!!i)for(s=0;s<i.length;++s){var o=De(i[s]);switch(Zn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Xe(it(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=a}ds(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function G6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=pe("numFmt",null,{numFmtId:n,formatCode:rt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gc=["numFmtId","fillId","fontId","borderId","xfId"],zc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function z6(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(yr)||[]).forEach(function(i){var o=De(i),a=0;switch(Zn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<Gc.length;++a)n[Gc[a]]&&(n[Gc[a]]=parseInt(n[Gc[a]],10));for(a=0;a<zc.length;++a)n[zc[a]]&&(n[zc[a]]=dt(n[zc[a]]));if(t.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[a]){n.numFmtId=a;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=dt(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function U6(e){var t=[];return t[t.length]=pe("cellXfs",null),e.forEach(function(r){t[t.length]=pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var j6=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(t))&&V6(h,u,c),(h=a.match(s))&&W6(h,u,l,c),(h=a.match(n))&&H6(h,u,l,c),(h=a.match(i))&&B6(h,u,l,c),(h=a.match(r))&&z6(h,u,c),u}}();function Fk(e,t){var r=[Lt,pe("styleSheet",null,{xmlns:Qi[0],"xmlns:vt":Ut.vt})],n;return e.SSF&&(n=G6(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=U6(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function $6(e,t){var r=e.read_shift(2),n=mr(e);return[r,n]}function K6(e,t,r){r||(r=J(6+4*t.length)),r.write_shift(2,e),Zt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function X6(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=_N(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var a=e.read_shift(1);a>0&&(n.family=a);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=RN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=mr(e),n}function Y6(e,t){t||(t=J(25+4*32)),t.write_shift(2,e.sz*20),DN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),mh(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Zt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Q6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mf,Z6=Cr;function fx(e,t){t||(t=J(4*3+8*7+16*1)),mf||(mf=td(Q6));var r=mf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(mh({auto:1},t),mh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function q6(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function Tk(e,t,r){r||(r=J(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ta(e,t){return t||(t=J(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var J6=Cr;function e5(e,t){return t||(t=J(51)),t.write_shift(1,0),Ta(null,t),Ta(null,t),Ta(null,t),Ta(null,t),Ta(null,t),t.length>t.l?t.slice(0,t.l):t}function t5(e,t){return t||(t=J(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),ph(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function r5(e,t,r){var n=J(2052);return n.write_shift(4,e),ph(t,n),ph(r,n),n.length>n.l?n.slice(0,n.l):n}function n5(e,t,r){var n={};n.NumberFmt=[];for(var s in Re)n.NumberFmt[s]=Re[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Ss(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ds(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ch(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function s5(e,t){if(!!t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ae(e,615,Pn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ae(e,44,K6(s,t[s]))}),ae(e,616))}}function i5(e){var t=1;ae(e,611,Pn(t)),ae(e,43,Y6({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ae(e,612)}function o5(e){var t=2;ae(e,603,Pn(t)),ae(e,45,fx({patternType:"none"})),ae(e,45,fx({patternType:"gray125"})),ae(e,604)}function a5(e){var t=1;ae(e,613,Pn(t)),ae(e,46,e5()),ae(e,614)}function l5(e){var t=1;ae(e,626,Pn(t)),ae(e,47,Tk({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ae(e,627)}function c5(e,t){ae(e,617,Pn(t.length)),t.forEach(function(r){ae(e,47,Tk(r,0))}),ae(e,618)}function u5(e){var t=1;ae(e,619,Pn(t)),ae(e,48,t5({xfId:0,builtinId:0,name:"Normal"})),ae(e,620)}function h5(e){var t=0;ae(e,505,Pn(t)),ae(e,506)}function d5(e){var t=0;ae(e,508,r5(t,"TableStyleMedium9","PivotStyleMedium4")),ae(e,509)}function f5(e,t){var r=Hr();return ae(r,278),s5(r,e.SSF),i5(r),o5(r),a5(r),l5(r),c5(r,t.cellXfs),u5(r),h5(r),d5(r),ae(r,279),r.end()}var g5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function p5(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(yr)||[]).forEach(function(s){var i=De(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[g5.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function m5(){}function v5(){}var x5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,C5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,w5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function y5(e,t,r){t.themeElements={};var n;[["clrScheme",x5,p5],["fontScheme",C5,m5],["fmtScheme",w5,v5]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var S5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Rk(e,t){(!e||e.length===0)&&(e=Vp());var r,n={};if(!(r=e.match(S5)))throw new Error("themeElements not found in theme");return y5(r[0],n,t),n.raw=e,n}function Vp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Lt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function k5(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=w2(i,{type:"array"})}catch{return}var a=jr(o,"theme/theme/theme1.xml",!0);if(!!a)return Rk(a,r)}}function b5(e){return e.read_shift(4)}function E5(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=F5(e,4);break;case 2:t.xclrValue=ak(e);break;case 3:t.xclrValue=b5(e);break;case 4:e.l+=4;break}return e.l+=8,t}function F5(e,t){return Cr(e,t)}function T5(e,t){return Cr(e,t)}function R5(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=E5(e);break;case 6:n[1]=T5(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function _5(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(R5(e,r-e.l));return{ixfe:n,ext:i}}function D5(e,t){t.forEach(function(r){switch(r[0]){}})}function A5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:mr(e)}}function P5(e){var t=J(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zt(e.name,t),t.slice(0,t.l)}function I5(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function L5(e){var t=J(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function M5(e,t){var r=J(8+2*t.length);return r.write_shift(4,e),Zt(t,r),r.slice(0,r.l)}function O5(e){return e.l+=4,e.read_shift(4)!=0}function N5(e,t){var r=J(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function B5(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,a=2;return Ss(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!c.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function H5(){var e=Hr();return ae(e,332),ae(e,334,Pn(1)),ae(e,335,P5({name:"XLDAPR",version:12e4,flags:3496657072})),ae(e,336),ae(e,339,M5(1,"XLDAPR")),ae(e,52),ae(e,35,Pn(514)),ae(e,4096,Pn(0)),ae(e,4097,ln(1)),ae(e,36),ae(e,53),ae(e,340),ae(e,337,N5(1,!0)),ae(e,51,L5([[1,0]])),ae(e,338),ae(e,333),e.end()}function W5(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,o;return e.replace(yr,function(a){var l=De(a);switch(Zn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function _k(){var e=[Lt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function V5(e){var t=[];if(!e)return t;var r=1;return(e.match(yr)||[]).forEach(function(n){var s=De(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function G5(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=_e(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function z5(e,t,r){var n=[];return Ss(e,function(i,o,a){switch(a){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function U5(e,t,r,n){if(!e)return e;var s=n||{},i=!1;Ss(e,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function j5(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Eo=1024;function Dk(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[pe("xml",null,{"xmlns:v":Gr.v,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:mv":Gr.mv}).replace(/\/>/,">"),pe("o:shapelayout",pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),pe("v:shapetype",[pe("v:stroke",null,{joinstyle:"miter"}),pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Eo<e*1e3;)Eo+=1e3;return t.forEach(function(i){var o=kt(i[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=pe("v:fill",l,a),u={on:"t",obscured:"t"};++Eo,s=s.concat(["<v:shape"+Il({id:"_x0000_s"+Eo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,pe("v:shadow",null,u),pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",nr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),nr("x:AutoFill","False"),nr("x:Row",String(o.r)),nr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function gx(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(o){var a=kt(o.ref);if(s?(e[a.r]||(e[a.r]=[]),i=e[a.r][a.c]):i=e[o.ref],!i){i={t:"z"},s?e[a.r][a.c]=i:e[o.ref]=i;var l=Ye(e["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=Ie(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function $5(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(!!a){var l=De(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=kt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Bp(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function Ak(e){var t=[Lt,pe("comments",null,{xmlns:Qi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=rt(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(rt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(nr("t",rt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,a=1;a<i.length;++a)o+=`Reply:
    `+i[a]+`
`;t.push(nr("t",rt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function K5(e,t){var r=[],n=!1,s={},i=0;return e.replace(yr,function(a,l){var c=De(a);switch(Zn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+a.length;break;case"</text>":s.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function X5(e,t,r){var n=[Lt,pe("ThreadedComments",null,{xmlns:Ut.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?i=l.id:l.parentId=i,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(pe("threadedComment",nr("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Y5(e,t){var r=[],n=!1;return e.replace(yr,function(i){var o=De(i);switch(Zn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Q5(e){var t=[Lt,pe("personList",null,{xmlns:Ut.TCMNT,"xmlns:x":Qi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Z5(e){var t={};t.iauthor=e.read_shift(4);var r=eo(e);return t.rfx=r.s,t.ref=_e(r.s),e.l+=16,t}function q5(e,t){return t==null&&(t=J(36)),t.write_shift(4,e[1].iauthor),da(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var J5=mr;function eH(e){return Zt(e.slice(0,54))}function tH(e,t){var r=[],n=[],s={},i=!1;return Ss(e,function(a,l,c){switch(c){case 632:n.push(a);break;case 635:s=a;break;case 637:s.t=a.t,s.h=a.h,s.r=a.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function rH(e){var t=Hr(),r=[];return ae(t,628),ae(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ae(t,632,eH(s.a)))})}),ae(t,631),ae(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:kt(n[0]),e:kt(n[0])};ae(t,635,q5([i,s])),s.t&&s.t.length>0&&ae(t,637,bN(s)),ae(t,636),delete s.iauthor})}),ae(t,634),ae(t,629),t.end()}var nH="application/vnd.ms-office.vbaProject";function sH(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Fe.write(t)}function iH(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Fe.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Pk=["xlsb","xlsm","xlam","biff8","xla"];function oH(){return{"!type":"dialog"}}function aH(){return{"!type":"dialog"}}function lH(){return{"!type":"macro"}}function cH(){return{"!type":"macro"}}var Bo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,o){var a=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=t.c:--u,l?c+=t.r:--c,s+(a?"":"$")+St(u)+(l?"":"$")+It(c)}return function(s,i){return t=i,s.replace(e,r)}}(),Gp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zp=function(){return function(t,r){return t.replace(Gp,function(n,s,i,o,a,l){var c=_p(o)-(i?0:r.c),u=Rp(l)-(a?0:r.r),h=u==0?"":a?u+1:"["+u+"]",d=c==0?"":i?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function Ik(e,t){return e.replace(Gp,function(r,n,s,i,o,a){return n+(s=="$"?s+i:St(_p(i)+t.c))+(o=="$"?o+a:It(Rp(a)+t.r))})}function uH(e,t,r){var n=Wr(t),s=n.s,i=kt(r),o={r:i.r-s.r,c:i.c-s.c};return Ik(e,o)}function hH(e){return e.length!=1}function px(e){return e.replace(/_xlfn\./g,"")}function Mt(e){e.l+=1}function ei(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Lk(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Mk(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),o=ei(e,2),a=ei(e,2);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Mk(e){var t=ei(e,2),r=ei(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function dH(e,t,r){if(r.biff<8)return Mk(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=ei(e,2),o=ei(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Ok(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fH(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ei(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function fH(e){var t=ei(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function gH(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pH(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mH(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,a=(i&32768)>>15;if(i&=16383,a==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:a}}function mH(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function vH(e,t,r){var n=(e[e.l++]&96)>>5,s=Lk(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function xH(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=Lk(e,i,r);return[n,s,o]}function CH(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function wH(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function yH(e,t,r){var n=(e[e.l++]&96)>>5,s=dH(e,t-1,r);return[n,s]}function SH(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function kH(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function bH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function EH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function FH(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function TH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Nk(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function RH(e){return e.read_shift(2),Nk(e)}function _H(e){return e.read_shift(2),Nk(e)}function DH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Ok(e,0,r);return[n,s]}function AH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=pH(e,0,r);return[n,s]}function PH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Ok(e,0,r);return[n,s,i]}function IH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[OW[s],Wk[s],n]}function LH(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:MH(e);return[s,(i[0]===0?Wk:MW)[i[1]]]}function MH(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function OH(e,t,r){e.l+=r&&r.biff==2?3:4}function NH(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function BH(e){return e.l++,ks[e.read_shift(1)]}function HH(e){return e.l++,e.read_shift(2)}function WH(e){return e.l++,e.read_shift(1)!==0}function VH(e){return e.l++,pr(e)}function GH(e,t,r){return e.l++,nc(e,t-1,r)}function zH(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=At(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ks[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=pr(e);break;case 2:r[1]=to(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function UH(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?eo:sd)(e));return s}function jH(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var a=0;a!=s;++a)o[i][a]=zH(e,r.biff);return o}function $H(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function KH(e,t,r){if(r.biff==5)return XH(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function XH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function YH(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function QH(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ZH(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function qH(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var JH=Cr,eW=Cr,tW=Cr;function ic(e,t,r){return e.l+=2,[gH(e)]}function Up(e){return e.l+=6,[]}var rW=ic,nW=Up,sW=Up,iW=ic;function Bk(e){return e.l+=2,[Nt(e),e.read_shift(2)&1]}var oW=ic,aW=Bk,lW=Up,cW=ic,uW=ic,hW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dW(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=hW[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:i}}function fW(e){return e.l+=2,[e.read_shift(4)]}function gW(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function pW(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xW(e){return e.l+=4,[0,0]}var vx={1:{n:"PtgExp",f:NH},2:{n:"PtgTbl",f:tW},3:{n:"PtgAdd",f:Mt},4:{n:"PtgSub",f:Mt},5:{n:"PtgMul",f:Mt},6:{n:"PtgDiv",f:Mt},7:{n:"PtgPower",f:Mt},8:{n:"PtgConcat",f:Mt},9:{n:"PtgLt",f:Mt},10:{n:"PtgLe",f:Mt},11:{n:"PtgEq",f:Mt},12:{n:"PtgGe",f:Mt},13:{n:"PtgGt",f:Mt},14:{n:"PtgNe",f:Mt},15:{n:"PtgIsect",f:Mt},16:{n:"PtgUnion",f:Mt},17:{n:"PtgRange",f:Mt},18:{n:"PtgUplus",f:Mt},19:{n:"PtgUminus",f:Mt},20:{n:"PtgPercent",f:Mt},21:{n:"PtgParen",f:Mt},22:{n:"PtgMissArg",f:Mt},23:{n:"PtgStr",f:GH},26:{n:"PtgSheet",f:gW},27:{n:"PtgEndSheet",f:pW},28:{n:"PtgErr",f:BH},29:{n:"PtgBool",f:WH},30:{n:"PtgInt",f:HH},31:{n:"PtgNum",f:VH},32:{n:"PtgArray",f:SH},33:{n:"PtgFunc",f:IH},34:{n:"PtgFuncVar",f:LH},35:{n:"PtgName",f:$H},36:{n:"PtgRef",f:DH},37:{n:"PtgArea",f:vH},38:{n:"PtgMemArea",f:YH},39:{n:"PtgMemErr",f:JH},40:{n:"PtgMemNoMem",f:eW},41:{n:"PtgMemFunc",f:QH},42:{n:"PtgRefErr",f:ZH},43:{n:"PtgAreaErr",f:CH},44:{n:"PtgRefN",f:AH},45:{n:"PtgAreaN",f:yH},46:{n:"PtgMemAreaN",f:mW},47:{n:"PtgMemNoMemN",f:vW},57:{n:"PtgNameX",f:KH},58:{n:"PtgRef3d",f:PH},59:{n:"PtgArea3d",f:xH},60:{n:"PtgRefErr3d",f:qH},61:{n:"PtgAreaErr3d",f:wH},255:{}},CW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},wW={1:{n:"PtgElfLel",f:Bk},2:{n:"PtgElfRw",f:cW},3:{n:"PtgElfCol",f:rW},6:{n:"PtgElfRwV",f:uW},7:{n:"PtgElfColV",f:iW},10:{n:"PtgElfRadical",f:oW},11:{n:"PtgElfRadicalS",f:lW},13:{n:"PtgElfColS",f:nW},15:{n:"PtgElfColSV",f:sW},16:{n:"PtgElfRadicalLel",f:aW},25:{n:"PtgList",f:dW},29:{n:"PtgSxName",f:fW},255:{}},yW={0:{n:"PtgAttrNoop",f:xW},1:{n:"PtgAttrSemi",f:TH},2:{n:"PtgAttrIf",f:EH},4:{n:"PtgAttrChoose",f:kH},8:{n:"PtgAttrGoto",f:bH},16:{n:"PtgAttrSum",f:OH},32:{n:"PtgAttrBaxcel",f:mx},33:{n:"PtgAttrBaxcel",f:mx},64:{n:"PtgAttrSpace",f:RH},65:{n:"PtgAttrSpaceSemi",f:_H},128:{n:"PtgAttrIfError",f:FH},255:{}};function oc(e,t,r,n){if(n.biff<8)return Cr(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jH(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=UH(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(Cr(e,t)),i}function ac(e,t,r){for(var n=e.l+t,s,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],s=vx[i]||vx[CW[i]],(i===24||i===25)&&(s=(i===24?wW:yW)[e[e.l+1]]),!s||!s.f?Cr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function SW(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var kW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bW(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Hk(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xx(e,t,r){var n=Hk(e,t,r);return n=="#REF"?n:bW(n,r)}function dr(e,t,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,h=0,d=0,f,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,C=e[0].length;v<C;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=Tt(" ",e[0][g][1][1]);break;case 1:m=Tt("\r",e[0][g][1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+m,g=-1}a.push(c+kW[x[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ja(x[1][1],o,s),a.push(el(u,i));break;case"PtgRefN":u=r?Ja(x[1][1],r,s):x[1][1],a.push(el(u,i));break;case"PtgRef3d":h=x[1][1],u=Ja(x[1][2],o,s),p=xx(n,h,s),a.push(p+"!"+el(u,i));break;case"PtgFunc":case"PtgFuncVar":var w=x[1][0],k=x[1][1];w||(w=0),w&=127;var E=w==0?[]:a.slice(-w);a.length-=w,k==="User"&&(k=E.shift()),a.push(k+"("+E.join(",")+")");break;case"PtgBool":a.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(x[1]);break;case"PtgNum":a.push(String(x[1]));break;case"PtgStr":a.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(x[1]);break;case"PtgAreaN":f=K1(x[1][1],r?{s:r}:o,s),a.push(df(f,s));break;case"PtgArea":f=K1(x[1][1],o,s),a.push(df(f,s));break;case"PtgArea3d":h=x[1][1],f=x[1][2],p=xx(n,h,s),a.push(p+"!"+df(f,s));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],R=y?y.Name:"SH33TJSNAME"+String(d);R&&R.slice(0,6)=="_xlfn."&&!s.xlfn&&(R=R.slice(6)),a.push(R);break;case"PtgNameX":var D=x[1][1];d=x[1][2];var N;if(s.biff<=5)D<0&&(D=-D),n[D]&&(N=n[D][d]);else{var O="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][d]&&n[D][d].itab>0&&(O=n.SheetNames[n[D][d].itab-1]+"!"):O=n.SheetNames[d-1]+"!"),n[D]&&n[D][d])O+=n[D][d].Name;else if(n[0]&&n[0][d])O+=n[0][d].Name;else{var A=(Hk(n,D,s)||"").split(";;");A[d-1]?O=A[d-1]:O+="SH33TJSERRX"}a.push(O);break}N||(N={Name:"SH33TJSERRY"}),a.push(N.Name);break;case"PtgParen":var G="(",q=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:G=Tt(" ",e[0][g][1][1])+G;break;case 3:G=Tt("\r",e[0][g][1][1])+G;break;case 4:q=Tt(" ",e[0][g][1][1])+q;break;case 5:q=Tt("\r",e[0][g][1][1])+q;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}a.push(G+a.pop()+q);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:x[1][1],r:x[1][0]};var z={c:r.c,r:r.r};if(n.sharedf[_e(u)]){var se=n.sharedf[_e(u)];a.push(dr(se,o,z,n,s))}else{var te=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(dr(c[1],o,z,n,s)),te=!0;break}te||a.push(x[1])}break;case"PtgArray":a.push("{"+SW(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Z.indexOf(e[0][v][0])==-1){x=e[0][g];var H=!0;switch(x[1][0]){case 4:H=!1;case 0:m=Tt(" ",x[1][1]);break;case 5:H=!1;case 1:m=Tt("\r",x[1][1]);break;default:if(m="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}a.push((H?m:"")+a.pop()+(H?"":m)),g=-1}}if(a.length>1&&s.WTF)throw new Error("bad formula stack");return a[0]}function EW(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Cr(e,t-2)];var a=ac(e,o,r);return t!==o+s&&(i=oc(e,t-o-s,a,r)),e.l=n,[a,i]}function FW(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Cr(e,t-2)];var a=ac(e,o,r);return t!==o+s&&(i=oc(e,t-o-s,a,r)),e.l=n,[a,i]}function TW(e,t,r,n){var s=e.l+t,i=ac(e,n,r),o;return s!==e.l&&(o=oc(e,s-e.l,i,r)),[i,o]}function RW(e,t,r){var n=e.l+t,s,i=e.read_shift(2),o=ac(e,i,r);return i==65535?[[],Cr(e,t-2)]:(t!==i+2&&(s=oc(e,n-i-2,o,r)),[o,s])}function _W(e){var t;if(ls(e,e.l+6)!==65535)return[pr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function DW(e){if(e==null){var t=J(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Vi(e);return Vi(0)}function vf(e,t,r){var n=e.l+t,s=qn(e);r.biff==2&&++e.l;var i=_W(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=FW(e,n-e.l,r);return{cell:s,val:i[0],formula:a,shared:o>>3&1,tt:i[1]}}function AW(e,t,r,n,s){var i=zi(t,r,s),o=DW(e.v),a=J(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=J(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Qt([i,o,a,c]);return h}function id(e,t,r){var n=e.read_shift(4),s=ac(e,n,r),i=e.read_shift(4),o=i>0?oc(e,i,s,r):null;return[s,o]}var PW=id,od=id,IW=id,LW=id,MW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Wk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function NW(e){var t="of:="+e.replace(Gp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function xf(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function BW(e){return e.replace(/\./,"!")}var rl={},Ho={},nl=typeof Map<"u";function jp(e,t,r){var n=0,s=e.length;if(r){if(nl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=nl?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(nl?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function ad(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(gr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Bl(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=wh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ai(e,t){if(!!e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ui(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ds(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Vk(e,t,r,n,s,i){try{n.cellNF&&(e.z=Re[t])}catch(a){if(n.WTF)throw a}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Re[t]==null&&ds(OO[t]||"General",t),e.t==="e")e.w=e.w||ks[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v);else if(e.t==="d"){var o=$t(e.v);(o|0)===o?e.w=o.toString(10):e.w=Al(o)}else{if(e.v===void 0)return"";e.w=Hi(e.v,Ho)}else e.t==="d"?e.w=wn(t,$t(e.v),Ho):e.w=wn(t,e.v,Ho)}catch(a){if(n.WTF)throw a}if(!!n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ch(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ch(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&i.Fills)throw a}}}function HW(e,t,r){if(e&&e["!ref"]){var n=Ye(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function WW(e,t){var r=Ye(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ie(r))}var VW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,GW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zW=/<(?:\w:)?hyperlink [^>]*>/mg,UW=/"(\w*:\w*)"/,jW=/<(?:\w:)?col\b[^>]*[\/]?>/g,$W=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,KW=/<(?:\w:)?pageMargins[^>]*\/>/g,Gk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,XW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,YW=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function QW(e,t,r,n,s,i,o){if(!e)return e;n||(n={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(GW);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(Gk);d?$p(d[0],a,s,r):(d=c.match(XW))&&qW(d[0],d[1]||"",a,s,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=c.slice(f,f+50).match(UW);p&&WW(a,p[1])}var g=c.match(YW);g&&g[1]&&hV(g[1],s);var m=[];if(t.cellStyles){var v=c.match(jW);v&&oV(m,v)}h&&gV(h[1],a,t,l,i,o);var C=u.match($W);C&&(a["!autofilter"]=lV(C[0]));var x=[],w=u.match(VW);if(w)for(f=0;f!=w.length;++f)x[f]=Ye(w[f].slice(w[f].indexOf('"')+1));var k=u.match(zW);k&&nV(a,k,n);var E=u.match(KW);if(E&&(a["!margins"]=sV(De(E[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=Ie(l)),t.sheetRows>0&&a["!ref"]){var y=Ye(a["!ref"]);t.sheetRows<=+y.e.r&&(y.e.r=t.sheetRows-1,y.e.r>l.e.r&&(y.e.r=l.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>l.e.c&&(y.e.c=l.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Ie(y))}return m.length>0&&(a["!cols"]=m),x.length>0&&(a["!merges"]=x),a}function ZW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ie(e[r])+'"/>';return t+"</mergeCells>"}function $p(e,t,r,n){var s=De(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Xe(it(s.codeName)))}function qW(e,t,r,n,s){$p(e.slice(0,e.indexOf(">")),r,n,s)}function JW(e,t,r,n,s){var i=!1,o={},a=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,o.codeName=$n(rt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+pe("outlinePr",null,c)}!i&&!a||(s[s.length]=pe("sheetPr",a,o))}var eV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],tV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function rV(e){var t={sheet:1};return eV.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),tV.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Hp(e.password).toString(16).toUpperCase()),pe("sheetProtection",null,t)}function nV(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=De(it(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Xe(i.location))):(i.Target="#"+Xe(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var a=Ye(i.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=_e({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function sV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function iV(e){return Ai(e),pe("pageMargins",null,e)}function oV(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=De(t[n],!0);s.hidden&&(s.hidden=dt(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Wp(s.width)),Js(s);i<=o;)e[i++]=pt(s)}}function aV(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)!(n=t[s])||(r[r.length]=pe("col",null,ad(s,n)));return r[r.length]="</cols>",r.join("")}function lV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function cV(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ie(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Wr(s);o.s.r==o.e.r&&(o.e.r=Wr(t["!ref"]).e.r,s=Ie(o));for(var a=0;a<i.length;++a){var l=i[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return a==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),pe("autoFilter",null,{ref:s})}var uV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function hV(e,t){t.Views||(t.Views=[{}]),(e.match(uV)||[]).forEach(function(r,n){var s=De(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),dt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function dV(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pe("sheetViews",pe("sheetView",null,s),{})}function fV(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ks[e.v];break;case"d":n&&n.cellDates?s=gt(e.v,-1).toISOString():(e=pt(e),e.t="n",s=""+(e.v=$t(gt(e.v)))),typeof e.z>"u"&&(e.z=Re[14]);break;default:s=e.v;break}var a=nr("v",rt(s)),l={r:t},c=ui(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=nr("v",""+jp(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=pe("f",rt(e.f),u)+(e.v!=null?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),pe("c",a,l)}var gV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Pl("v"),o=Pl("f");return function(l,c,u,h,d,f){for(var p=0,g="",m=[],v=[],C=0,x=0,w=0,k="",E,y,R=0,D=0,N,O,A=0,G=0,q=Array.isArray(f.CellXf),z,se=[],te=[],Z=Array.isArray(c),H=[],Q={},ie=!1,F=!!u.sheetStubs,W=l.split(t),B=0,V=W.length;B!=V;++B){g=W[B].trim();var X=g.length;if(X===0)continue;var ne=0;e:for(p=0;p<X;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(y=De(g.slice(ne,p),!0),R=y.r!=null?parseInt(y.r,10):R+1,D=-1,u.sheetRows&&u.sheetRows<R)continue;Q={},ie=!1,y.ht&&(ie=!0,Q.hpt=parseFloat(y.ht),Q.hpx=qo(Q.hpt)),y.hidden=="1"&&(ie=!0,Q.hidden=!0),y.outlineLevel!=null&&(ie=!0,Q.level=+y.outlineLevel),ie&&(H[R-1]=Q)}break;case"<":ne=p;break}if(ne>=p)break;if(y=De(g.slice(ne,p),!0),R=y.r!=null?parseInt(y.r,10):R+1,D=-1,!(u.sheetRows&&u.sheetRows<R)){h.s.r>R-1&&(h.s.r=R-1),h.e.r<R-1&&(h.e.r=R-1),u&&u.cellStyles&&(Q={},ie=!1,y.ht&&(ie=!0,Q.hpt=parseFloat(y.ht),Q.hpx=qo(Q.hpt)),y.hidden=="1"&&(ie=!0,Q.hidden=!0),y.outlineLevel!=null&&(ie=!0,Q.level=+y.outlineLevel),ie&&(H[R-1]=Q)),m=g.slice(p).split(e);for(var le=0;le!=m.length&&m[le].trim().charAt(0)=="<";++le);for(m=m.slice(le),p=0;p!=m.length;++p)if(g=m[p].trim(),g.length!==0){if(v=g.match(r),C=p,x=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(C=0,k=v[1],x=0;x!=k.length&&!((w=k.charCodeAt(x)-64)<1||w>26);++x)C=26*C+w;--C,D=C}else++D;for(x=0;x!=g.length&&g.charCodeAt(x)!==62;++x);if(++x,y=De(g.slice(0,x),!0),y.r||(y.r=_e({r:R-1,c:D})),k=g.slice(x),E={t:""},(v=k.match(i))!=null&&v[1]!==""&&(E.v=Xe(v[1])),u.cellFormula){if((v=k.match(o))!=null&&v[1]!==""){if(E.f=Xe(it(v[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=px(E.f)),v[0].indexOf('t="array"')>-1)E.F=(k.match(s)||[])[1],E.F.indexOf(":")>-1&&se.push([Ye(E.F),E.F]);else if(v[0].indexOf('t="shared"')>-1){O=De(v[0]);var ce=Xe(it(v[1]));u.xlfn||(ce=px(ce)),te[parseInt(O.si,10)]=[O,ce,y.r]}}else(v=k.match(/<f[^>]*\/>/))&&(O=De(v[0]),te[O.si]&&(E.f=uH(te[O.si][1],te[O.si][2],y.r)));var ee=kt(y.r);for(x=0;x<se.length;++x)ee.r>=se[x][0].s.r&&ee.r<=se[x][0].e.r&&ee.c>=se[x][0].s.c&&ee.c<=se[x][0].e.c&&(E.F=se[x][1])}if(y.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(F)E.t="z";else continue;else E.t=y.t||"n";switch(h.s.c>D&&(h.s.c=D),h.e.c<D&&(h.e.c=D),E.t){case"n":if(E.v==""||E.v==null){if(!F)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!F)continue;E.t="z"}else N=rl[parseInt(E.v,10)],E.v=N.t,E.r=N.r,u.cellHTML&&(E.h=N.h);break;case"str":E.t="s",E.v=E.v!=null?it(E.v):"",u.cellHTML&&(E.h=bp(E.v));break;case"inlineStr":v=k.match(n),E.t="s",v!=null&&(N=Bp(v[1]))?(E.v=N.t,u.cellHTML&&(E.h=N.h)):E.v="";break;case"b":E.v=dt(E.v);break;case"d":u.cellDates?E.v=gt(E.v,1):(E.v=$t(gt(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=U2[E.v];break}if(A=G=0,z=null,q&&y.s!==void 0&&(z=f.CellXf[y.s],z!=null&&(z.numFmtId!=null&&(A=z.numFmtId),u.cellStyles&&z.fillId!=null&&(G=z.fillId))),Vk(E,A,G,u,d,f),u.cellDates&&q&&E.t=="n"&&ca(Re[A])&&(E.t="d",E.v=nd(E.v)),y.cm&&u.xlmeta){var Ee=(u.xlmeta.Cell||[])[+y.cm-1];Ee&&Ee.type=="XLDAPR"&&(E.D=!0)}if(Z){var L=kt(y.r);c[L.r]||(c[L.r]=[]),c[L.r][L.c]=E}else c[y.r]=E}}}H.length>0&&(c["!rows"]=H)}}();function pV(e,t,r,n){var s=[],i=[],o=Ye(e["!ref"]),a="",l,c="",u=[],h=0,d=0,f=e["!rows"],p=Array.isArray(e),g={r:c},m,v=-1;for(d=o.s.c;d<=o.e.c;++d)u[d]=St(d);for(h=o.s.r;h<=o.e.r;++h){for(i=[],c=It(h),d=o.s.c;d<=o.e.c;++d){l=u[d]+c;var C=p?(e[h]||[])[d]:e[l];C!==void 0&&(a=fV(C,l,e,t))!=null&&i.push(a)}(i.length>0||f&&f[h])&&(g={r:c},f&&f[h]&&(m=f[h],m.hidden&&(g.hidden=1),v=-1,m.hpx?v=Hl(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(g.ht=v,g.customHeight=1),m.level&&(g.outlineLevel=m.level)),s[s.length]=pe("row",i.join(""),g))}if(f)for(;h<f.length;++h)f&&f[h]&&(g={r:h+1},m=f[h],m.hidden&&(g.hidden=1),v=-1,m.hpx?v=Hl(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(g.ht=v,g.customHeight=1),m.level&&(g.outlineLevel=m.level),s[s.length]=pe("row","",g));return s.join("")}function zk(e,t,r,n){var s=[Lt,pe("worksheet",null,{xmlns:Qi[0],"xmlns:r":Ut.r})],i=r.SheetNames[e],o=0,a="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=Ye(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ie(u)}n||(n={}),l["!comments"]=[];var h=[];JW(l,r,e,t,s),s[s.length]=pe("dimension",null,{ref:c}),s[s.length]=dV(l,t,e,r),t.sheetFormat&&(s[s.length]=pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=aV(l,l["!cols"])),s[o=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=pV(l,t),a.length>0&&(s[s.length]=a)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),l["!protect"]&&(s[s.length]=rV(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=cV(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=ZW(l["!merges"]));var d=-1,f,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(g){!g[1].Target||(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=tt(n,-1,rt(g[1].Target).replace(/#.*$/,""),Ve.HLINK),f["r:id"]="rId"+p),(d=g[1].Target.indexOf("#"))>-1&&(f.location=rt(g[1].Target.slice(d+1))),g[1].Tooltip&&(f.tooltip=rt(g[1].Tooltip)),s[s.length]=pe("hyperlink",null,f))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=iV(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=nr("ignoredErrors",pe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=tt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ve.DRAW),s[s.length]=pe("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=tt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ve.VML),s[s.length]=pe("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function mV(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function vV(e,t,r){var n=J(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=Hl(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var p=Array.isArray(r)?(r[c.r]||[])[c.c]:r[_e(c)];p&&(h<0&&(h=f),d=f)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,a),n.l=g,n.length>n.l?n.slice(0,n.l):n}function xV(e,t,r,n){var s=vV(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ae(e,0,s)}var CV=eo,wV=da;function yV(){}function SV(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=EN(e),r}function kV(e,t,r){r==null&&(r=J(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return mh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),H2(e,r),r.slice(0,r.l)}function bV(e){var t=yn(e);return[t]}function EV(e,t,r){return r==null&&(r=J(8)),Zi(t,r)}function FV(e){var t=qi(e);return[t]}function TV(e,t,r){return r==null&&(r=J(4)),Ji(t,r)}function RV(e){var t=yn(e),r=e.read_shift(1);return[t,r,"b"]}function _V(e,t,r){return r==null&&(r=J(9)),Zi(t,r),r.write_shift(1,e.v?1:0),r}function DV(e){var t=qi(e),r=e.read_shift(1);return[t,r,"b"]}function AV(e,t,r){return r==null&&(r=J(5)),Ji(t,r),r.write_shift(1,e.v?1:0),r}function PV(e){var t=yn(e),r=e.read_shift(1);return[t,r,"e"]}function IV(e,t,r){return r==null&&(r=J(9)),Zi(t,r),r.write_shift(1,e.v),r}function LV(e){var t=qi(e),r=e.read_shift(1);return[t,r,"e"]}function MV(e,t,r){return r==null&&(r=J(8)),Ji(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function OV(e){var t=yn(e),r=e.read_shift(4);return[t,r,"s"]}function NV(e,t,r){return r==null&&(r=J(12)),Zi(t,r),r.write_shift(4,t.v),r}function BV(e){var t=qi(e),r=e.read_shift(4);return[t,r,"s"]}function HV(e,t,r){return r==null&&(r=J(8)),Ji(t,r),r.write_shift(4,t.v),r}function WV(e){var t=yn(e),r=pr(e);return[t,r,"n"]}function VV(e,t,r){return r==null&&(r=J(16)),Zi(t,r),Vi(e.v,r),r}function Uk(e){var t=qi(e),r=pr(e);return[t,r,"n"]}function GV(e,t,r){return r==null&&(r=J(12)),Ji(t,r),Vi(e.v,r),r}function zV(e){var t=yn(e),r=Ip(e);return[t,r,"n"]}function UV(e,t,r){return r==null&&(r=J(12)),Zi(t,r),W2(e.v,r),r}function jV(e){var t=qi(e),r=Ip(e);return[t,r,"n"]}function $V(e,t,r){return r==null&&(r=J(8)),Ji(t,r),W2(e.v,r),r}function KV(e){var t=yn(e),r=Dp(e);return[t,r,"is"]}function XV(e){var t=yn(e),r=mr(e);return[t,r,"str"]}function YV(e,t,r){return r==null&&(r=J(12+4*e.v.length)),Zi(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function QV(e){var t=qi(e),r=mr(e);return[t,r,"str"]}function ZV(e,t,r){return r==null&&(r=J(8+4*e.v.length)),Ji(t,r),Zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function qV(e,t,r){var n=e.l+t,s=yn(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var a=od(e,n-e.l,r);o[3]=dr(a,null,s,r.supbooks,r)}else e.l=n;return o}function JV(e,t,r){var n=e.l+t,s=yn(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var a=od(e,n-e.l,r);o[3]=dr(a,null,s,r.supbooks,r)}else e.l=n;return o}function eG(e,t,r){var n=e.l+t,s=yn(e);s.r=r["!row"];var i=pr(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var a=od(e,n-e.l,r);o[3]=dr(a,null,s,r.supbooks,r)}else e.l=n;return o}function tG(e,t,r){var n=e.l+t,s=yn(e);s.r=r["!row"];var i=mr(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var a=od(e,n-e.l,r);o[3]=dr(a,null,s,r.supbooks,r)}else e.l=n;return o}var rG=eo,nG=da;function sG(e,t){return t==null&&(t=J(4)),t.write_shift(4,e),t}function iG(e,t){var r=e.l+t,n=eo(e),s=Ap(e),i=mr(e),o=mr(e),a=mr(e);e.l=r;var l={rfx:n,relId:s,loc:i,display:a};return o&&(l.Tooltip=o),l}function oG(e,t){var r=J(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));da({s:kt(e[0]),e:kt(e[0])},r),Pp("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Zt(s||"",r),Zt(e[1].Tooltip||"",r),Zt("",r),r.slice(0,r.l)}function aG(){}function lG(e,t,r){var n=e.l+t,s=V2(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var a=PW(e,n-e.l,r);o[1]=a}else e.l=n;return o}function cG(e,t,r){var n=e.l+t,s=eo(e),i=[s];if(r.cellFormula){var o=LW(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function uG(e,t,r){r==null&&(r=J(18));var n=ad(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var jk=["left","right","top","bottom","header","footer"];function hG(e){var t={};return jk.forEach(function(r){t[r]=pr(e)}),t}function dG(e,t){return t==null&&(t=J(6*8)),Ai(e),jk.forEach(function(r){Vi(e[r],t)}),t}function fG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gG(e,t,r){r==null&&(r=J(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function pG(e){var t=J(24);return t.write_shift(4,4),t.write_shift(4,1),da(e,t),t}function mG(e,t){return t==null&&(t=J(16*4+2)),t.write_shift(2,e.password?Hp(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function vG(){}function xG(){}function CG(e,t,r,n,s,i,o){if(!e)return e;var a=t||{};n||(n={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,f,p,g,m,v,C,x,w,k,E=[];a.biff=12,a["!row"]=0;var y=0,R=!1,D=[],N={},O=a.supbooks||s.supbooks||[[]];if(O.sharedf=N,O.arrayf=D,O.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!a.supbooks&&(a.supbooks=O,s.Names))for(var A=0;A<s.Names.length;++A)O[0][A+1]=s.Names[A];var G=[],q=[],z=!1;Wl[16]={n:"BrtShortReal",f:Uk};var se;if(Ss(e,function(H,Q,ie){if(!d)switch(ie){case 148:c=H;break;case 0:f=H,a.sheetRows&&a.sheetRows<=f.r&&(d=!0),w=It(m=f.r),a["!row"]=f.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=qo(H.hpt)),q[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:H[2]},H[2]){case"n":p.v=H[1];break;case"s":x=rl[H[1]],p.v=x.t,p.r=x.r;break;case"b":p.v=!!H[1];break;case"e":p.v=H[1],a.cellText!==!1&&(p.w=ks[p.v]);break;case"str":p.t="s",p.v=H[1];break;case"is":p.t="s",p.v=H[1].t;break}if((g=o.CellXf[H[0].iStyleRef])&&Vk(p,g.numFmtId,null,a,i,o),v=H[0].c==-1?v+1:H[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=p):l[St(v)+w]=p,a.cellFormula){for(R=!1,y=0;y<D.length;++y){var F=D[y];f.r>=F[0].s.r&&f.r<=F[0].e.r&&v>=F[0].s.c&&v<=F[0].e.c&&(p.F=Ie(F[0]),R=!0)}!R&&H.length>3&&(p.f=H[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),a.cellDates&&g&&p.t=="n"&&ca(Re[g.numFmtId])){var W=yi(p.v);W&&(p.t="d",p.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}se&&(se.type=="XLDAPR"&&(p.D=!0),se=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;p={t:"z",v:void 0},v=H[0].c==-1?v+1:H[0].c,a.dense?(l[m]||(l[m]=[]),l[m][v]=p):l[St(v)+w]=p,u.s.r>f.r&&(u.s.r=f.r),u.s.c>v&&(u.s.c=v),u.e.r<f.r&&(u.e.r=f.r),u.e.c<v&&(u.e.c=v),se&&(se.type=="XLDAPR"&&(p.D=!0),se=void 0);break;case 176:E.push(H);break;case 49:se=((a.xlmeta||{}).Cell||[])[H-1];break;case 494:var B=n["!id"][H.relId];for(B?(H.Target=B.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=B):H.relId==""&&(H.Target="#"+H.loc),m=H.rfx.s.r;m<=H.rfx.e.r;++m)for(v=H.rfx.s.c;v<=H.rfx.e.c;++v)a.dense?(l[m]||(l[m]=[]),l[m][v]||(l[m][v]={t:"z",v:void 0}),l[m][v].l=H):(C=_e({c:v,r:m}),l[C]||(l[C]={t:"z",v:void 0}),l[C].l=H);break;case 426:if(!a.cellFormula)break;D.push(H),k=a.dense?l[m][v]:l[St(v)+w],k.f=dr(H[1],u,{r:f.r,c:v},O,a),k.F=Ie(H[0]);break;case 427:if(!a.cellFormula)break;N[_e(H[0].s)]=H[1],k=a.dense?l[m][v]:l[St(v)+w],k.f=dr(H[1],u,{r:f.r,c:v},O,a);break;case 60:if(!a.cellStyles)break;for(;H.e>=H.s;)G[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},z||(z=!0,Wp(H.w/256)),Js(G[H.e+1]);break;case 161:l["!autofilter"]={ref:Ie(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Q.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ie(c||u)),a.sheetRows&&l["!ref"]){var te=Ye(l["!ref"]);a.sheetRows<=+te.e.r&&(te.e.r=a.sheetRows-1,te.e.r>u.e.r&&(te.e.r=u.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>u.e.c&&(te.e.c=u.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ie(te))}return E.length>0&&(l["!merges"]=E),G.length>0&&(l["!cols"]=G),q.length>0&&(l["!rows"]=q),l}function wG(e,t,r,n,s,i,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=pt(t),t.z=t.z||Re[14],t.v=$t(gt(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r,c:n};switch(l.s=ui(s.cellXfs,t,s),t.l&&i["!links"].push([_e(l),t.l]),t.c&&i["!comments"].push([_e(l),t.c]),t.t){case"s":case"str":return s.bookSST?(a=jp(s.Strings,t.v,s.revStrings),l.t="s",l.v=a,o?ae(e,18,HV(t,l)):ae(e,7,NV(t,l))):(l.t="str",o?ae(e,17,ZV(t,l)):ae(e,6,YV(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ae(e,13,$V(t,l)):ae(e,2,UV(t,l)):o?ae(e,16,GV(t,l)):ae(e,5,VV(t,l)),!0;case"b":return l.t="b",o?ae(e,15,AV(t,l)):ae(e,4,_V(t,l)),!0;case"e":return l.t="e",o?ae(e,14,MV(t,l)):ae(e,3,IV(t,l)),!0}return o?ae(e,12,TV(t,l)):ae(e,1,EV(t,l)),!0}function yG(e,t,r,n){var s=Ye(t["!ref"]||"A1"),i,o="",a=[];ae(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){o=It(u),xV(e,t,s,u);var h=!1;if(u<=s.e.r)for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(a[d]=St(d)),i=a[d]+o;var f=l?(t[u]||[])[d]:t[i];if(!f){h=!1;continue}h=wG(e,f,u,d,n,t,h)}}ae(e,146)}function SG(e,t){!t||!t["!merges"]||(ae(e,177,sG(t["!merges"].length)),t["!merges"].forEach(function(r){ae(e,176,nG(r))}),ae(e,178))}function kG(e,t){!t||!t["!cols"]||(ae(e,390),t["!cols"].forEach(function(r,n){r&&ae(e,60,uG(n,r))}),ae(e,391))}function bG(e,t){!t||!t["!ref"]||(ae(e,648),ae(e,649,pG(Ye(t["!ref"]))),ae(e,650))}function EG(e,t,r){t["!links"].forEach(function(n){if(!!n[1].Target){var s=tt(r,-1,n[1].Target.replace(/#.*$/,""),Ve.HLINK);ae(e,494,oG(n,s))}}),delete t["!links"]}function FG(e,t,r,n){if(t["!comments"].length>0){var s=tt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ve.VML);ae(e,551,Pp("rId"+s)),t["!legacy"]=s}}function TG(e,t,r,n){if(!!t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:Ie(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=Wr(i);a.s.r==a.e.r&&(a.e.r=Wr(t["!ref"]).e.r,i=Ie(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ae(e,161,da(Ye(i))),ae(e,162)}}function RG(e,t,r){ae(e,133),ae(e,137,gG(t,r)),ae(e,138),ae(e,134)}function _G(e,t){!t["!protect"]||ae(e,535,mG(t["!protect"]))}function DG(e,t,r,n){var s=Hr(),i=r.SheetNames[e],o=r.Sheets[i]||{},a=i;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var l=Ye(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ae(s,129),(r.vbaraw||o["!outline"])&&ae(s,147,kV(a,o["!outline"])),ae(s,148,wV(l)),RG(s,o,r.Workbook),kG(s,o),yG(s,o,e,t),_G(s,o),TG(s,o,r,e),SG(s,o),EG(s,o,n),o["!margins"]&&ae(s,476,dG(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&bG(s,o),FG(s,o,e,n),ae(s,130),s.end()}function AG(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!o||(t[+o[1]]=r?+o[2]:o[2])});var s=Xe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function PG(e,t,r,n,s,i){var o=i||{"!type":"chart"};if(!e)return i;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=AG(h);u.s.r=u.s.c=0,u.e.c=a,c=St(a),d[0].forEach(function(f,p){o[c+It(p)]={t:"n",v:f,z:d[1]},l=p}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=Ie(u)),o}function IG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(Gk);return a&&$p(a[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function LG(e,t){e.l+=10;var r=mr(e);return{name:r}}function MG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ss(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Kp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NG=[],BG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=dt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function yx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=dt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function $k(e){yx(e.WBProps,Kp),yx(e.CalcPr,BG),wx(e.WBView,OG),wx(e.Sheets,NG),Ho.date1904=dt(e.WBProps.date1904)}function HG(e){return!e.Workbook||!e.Workbook.WBProps?"false":dt(e.Workbook.WBProps.date1904)?"true":"false"}var WG="][*?/\\".split("");function Kk(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return WG.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function VG(e,t,r){e.forEach(function(n,s){Kk(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function GG(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];VG(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)HW(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var zG=/<\w+:workbook/;function UG(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(e.replace(yr,function(l,c){var u=De(l);switch(Zn(u[0])){case"<?xml":break;case"<workbook":l.match(zG)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Kp.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=dt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=it(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Xe(it(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=it(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),dt(u.hidden||"0")&&(i.Hidden=!0),o=c+l.length;break;case"</definedName>":i.Ref=Xe(it(e.slice(o,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Qi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $k(r),r}function Xk(e){var t=[Lt];t[t.length]=pe("workbook",null,{xmlns:Qi[0],"xmlns:r":Ut.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Kp.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=pe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&!!s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:rt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=pe("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=pe("definedName",rt(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=B0(e),r.name=mr(e),r}function $G(e,t){return t||(t=J(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Pp(e.strRelID,t),Zt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function KG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?mr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function XG(e,t){t||(t=J(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),H2(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function YG(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function QG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=FN(e),o=IW(e,0,r),a=Ap(e);e.l=n;var l={Name:i,Ptg:o};return s<268435455&&(l.Sheet=s),a&&(l.Comment=a),l}function ZG(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Wl[16]={n:"BrtFRTArchID$",f:YG},Ss(e,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=dr(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),$k(r),r.Names=i,r.supbooks=o,r}function qG(e,t){ae(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ae(e,156,$G(s))}ae(e,144)}function JG(e,t){t||(t=J(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Zt("SheetJS",t),Zt(ch.version,t),Zt(ch.version,t),Zt("7262",t),t.length>t.l?t.slice(0,t.l):t}function e7(e,t){t||(t=J(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function t7(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(ae(e,135),ae(e,158,e7(s)),ae(e,136))}}function r7(e,t){var r=Hr();return ae(r,131),ae(r,128,JG()),ae(r,153,XG(e.Workbook&&e.Workbook.WBProps||null)),t7(r,e),qG(r,e),ae(r,132),r.end()}function n7(e,t,r){return t.slice(-4)===".bin"?ZG(e,r):UG(e,r)}function s7(e,t,r,n,s,i,o,a){return t.slice(-4)===".bin"?CG(e,n,r,s,i,o,a):QW(e,n,r,s,i,o,a)}function i7(e,t,r,n,s,i,o,a){return t.slice(-4)===".bin"?MG(e,n,r,s,i):IG(e,n,r,s,i)}function o7(e,t,r,n,s,i,o,a){return t.slice(-4)===".bin"?lH():cH()}function a7(e,t,r,n,s,i,o,a){return t.slice(-4)===".bin"?oH():aH()}function l7(e,t,r,n){return t.slice(-4)===".bin"?n5(e,r,n):j6(e,r,n)}function c7(e,t,r){return Rk(e,r)}function u7(e,t,r){return t.slice(-4)===".bin"?u6(e,r):a6(e,r)}function h7(e,t,r){return t.slice(-4)===".bin"?tH(e,r):$5(e,r)}function d7(e,t,r){return t.slice(-4)===".bin"?z5(e):V5(e)}function f7(e,t,r,n){return r.slice(-4)===".bin"?U5(e,t,r,n):void 0}function g7(e,t,r){return t.slice(-4)===".bin"?B5(e,t,r):W5(e,t,r)}function p7(e,t,r){return(t.slice(-4)===".bin"?r7:Xk)(e)}function m7(e,t,r,n,s){return(t.slice(-4)===".bin"?DG:zk)(e,r,n,s)}function v7(e,t,r){return(t.slice(-4)===".bin"?f5:Fk)(e,r)}function x7(e,t,r){return(t.slice(-4)===".bin"?f6:xk)(e,r)}function C7(e,t,r){return(t.slice(-4)===".bin"?rH:Ak)(e)}function w7(e){return(e.slice(-4)===".bin"?H5:_k)()}var Yk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Qk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function kn(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match(Yk),i,o,a,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(Qk),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(o+1),n[a]=i[2].slice(1,i[2].length-1));return n}function y7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Yk),s,i,o,a;if(n)for(a=0;a!=n.length;++a)s=n[a].match(Qk),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var sl;function S7(e,t){var r=sl[e]||Xe(e);return r==="General"?Hi(t):wn(r,t)}function k7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=dt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=gt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Xe(t)]=s}function b7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ks[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=Hi(e.v):e.w=S7(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=sl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ca(n)){var s=yi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function E7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=N6[n.Pattern]||n.Pattern)}e[t.ID]=t}function F7(e,t,r,n,s,i,o,a,l,c){var u="General",h=n.StyleID,d={};c=c||{};var f=[],p=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&f.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dt(e);break;case"String":n.t="s",n.r=B1(Xe(e)),n.v=e.indexOf("<")>-1?Xe(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Xe(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=U2[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=B1(t||e));break}if(b7(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=Xe(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Bo(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Bo("RC:RC",s):n.ArrayRange&&(n.F=Bo(n.ArrayRange,s),l.push([Ye(n.F),n.F]))}else for(p=0;p<l.length;++p)s.r>=l[p][0].s.r&&s.r<=l[p][0].e.r&&s.c>=l[p][0].s.c&&s.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(f.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function T7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Cf(e,t){var r=t||{};ua();var n=Ma(Ep(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=it(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=pt(r);return o.type="string",Zo.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){s.indexOf("<"+Oe)>=0&&(i=!0)}),i)return d9(n,r);sl={"General Number":"General","General Date":Re[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Re[15],"Short Date":Re[14],"Long Time":Re[19],"Medium Time":Re[18],"Short Time":Re[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Re[2],Standard:Re[4],Percent:Re[10],Scientific:Re[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},h=[],d=r.dense?[]:{},f="",p={},g={},m=kn('<Data ss:Type="String">'),v=0,C=0,x=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},E={},y="",R=0,D=[],N={},O={},A=0,G=[],q=[],z={},se=[],te,Z=!1,H=[],Q=[],ie={},F=0,W=0,B={Sheets:[],WBProps:{date1904:!1}},V={};Ll.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";a=Ll.exec(n);)switch(a[3]=(X=a[3]).toLowerCase()){case"data":if(X=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?F7(n.slice(v,a.index),y,m,l[l.length-1][0]=="comment"?z:p,{c:C,r:x},k,se[C],g,H,r):(y="",m=kn(a[0]),v=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(q.length>0&&(p.c=q),(!r.sheetRows||r.sheetRows>x)&&p.v!==void 0&&(r.dense?(d[x]||(d[x]=[]),d[x][C]=p):d[St(C)+It(x)]=p),p.HRef&&(p.l={Target:Xe(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=C+(parseInt(p.MergeAcross,10)|0),W=x+(parseInt(p.MergeDown,10)|0),D.push({s:{c:C,r:x},e:{c:F,r:W}})),!r.sheetStubs)p.MergeAcross?C=F+1:++C;else if(p.MergeAcross||p.MergeDown){for(var ne=C;ne<=F;++ne)for(var le=x;le<=W;++le)(ne>C||le>x)&&(r.dense?(d[le]||(d[le]=[]),d[le][ne]={t:"z"}):d[St(ne)+It(le)]={t:"z"});C=F+1}else++C;else p=y7(a[0]),p.Index&&(C=+p.Index-1),C<w.s.c&&(w.s.c=C),C>w.e.c&&(w.e.c=C),a[0].slice(-2)==="/>"&&++C,q=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(x<w.s.r&&(w.s.r=x),x>w.e.r&&(w.e.r=x),a[0].slice(-2)==="/>"&&(g=kn(a[0]),g.Index&&(x=+g.Index-1)),C=0,++x):(g=kn(a[0]),g.Index&&(x=+g.Index-1),ie={},(g.AutoFitHeight=="0"||g.Height)&&(ie.hpx=parseInt(g.Height,10),ie.hpt=Hl(ie.hpx),Q[x]=ie),g.Hidden=="1"&&(ie.hidden=!0,Q[x]=ie));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(f),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(d["!ref"]=Ie(w),r.sheetRows&&r.sheetRows<=w.e.r&&(d["!fullref"]=d["!ref"],w.e.r=r.sheetRows-1,d["!ref"]=Ie(w))),D.length&&(d["!merges"]=D),se.length>0&&(d["!cols"]=se),Q.length>0&&(d["!rows"]=Q),u[f]=d}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=C=0,l.push([a[3],!1]),c=kn(a[0]),f=Xe(c.Name),d=r.dense?[]:{},D=[],H=[],Q=[],V={name:f,Hidden:0},B.Sheets.push(V);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),se=[],Z=!1}break;case"style":a[1]==="/"?E7(k,E,r):E=kn(a[0]);break;case"numberformat":E.nf=Xe(kn(a[0]).Format||"General"),sl[E.nf]&&(E.nf=sl[E.nf]);for(var ce=0;ce!=392&&Re[ce]!=E.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(Re[ce]==null){ds(E.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(te=kn(a[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!Z&&te.wpx>10){Z=!0,gr=bk;for(var ee=0;ee<se.length;++ee)se[ee]&&Js(se[ee])}Z&&Js(te),se[te.Index-1||se.length]=te;for(var Ee=0;Ee<+te.Span;++Ee)se[se.length]=pt(te);break;case"namedrange":if(a[1]==="/")break;B.Names||(B.Names=[]);var L=De(a[0]),He={Name:L.Name,Ref:Bo(L.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(He.Sheet=B.Sheets.length-1),B.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?y+=n.slice(R,a.index):R=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=kn(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?ZN(N,X,n.slice(A,a.index)):A=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));T7(z),q.push(z)}else l.push([a[3],!1]),c=kn(a[0]),z={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var Ae=kn(a[0]);d["!autofilter"]={ref:Bo(Ae.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return Fx(n,r);var Ue=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ue=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ue=!1}break;case"excelworkbook":switch(a[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ue=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:Ue=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(A,a.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else A=a.index+a[0].length;break;case"header":d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+De(a[0]).Margin)||(d["!margins"].header=+De(a[0]).Margin);break;case"footer":d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+De(a[0]).Margin)||(d["!margins"].footer=+De(a[0]).Margin);break;case"pagemargins":var Ce=De(a[0]);d["!margins"]||Ai(d["!margins"]={},"xlml"),isNaN(+Ce.Top)||(d["!margins"].top=+Ce.Top),isNaN(+Ce.Left)||(d["!margins"].left=+Ce.Left),isNaN(+Ce.Right)||(d["!margins"].right=+Ce.Right),isNaN(+Ce.Bottom)||(d["!margins"].bottom=+Ce.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ue=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ue=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ue=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ue=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ue=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ue=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ue=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ue=!1}break;case"smarttags":break;default:Ue=!1;break}if(Ue||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?k7(O,X,G,n.slice(A,a.index)):(G=a,A=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=u),oe.SheetNames=h,oe.Workbook=B,oe.SSF=pt(Re),oe.Props=N,oe.Custprops=O,oe}function j0(e,t){switch(Yp(t=t||{}),t.type||"base64"){case"base64":return Cf(Qr(e),t);case"binary":case"buffer":case"file":return Cf(e,t);case"array":return Cf(li(e),t)}}function R7(e,t){var r=[];return e.Props&&r.push(qN(e.Props,t)),e.Custprops&&r.push(JN(e.Props,e.Custprops)),r.join("")}function _7(){return""}function D7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(pe("NumberFormat",null,{"ss:Format":rt(Re[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(pe("Style",i.join(""),o))}),pe("Styles",r.join(""))}function Zk(e){return pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+zp(e.Ref,{r:0,c:0})})}function A7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Zk(s)))}return pe("Names",r.join(""))}function P7(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var a=s[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||i.push(Zk(a)))}return i.join("")}function I7(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(pe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(nr("ProtectContents","True")),e["!protect"].objects&&s.push(nr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(nr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(nr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(nr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":pe("WorksheetOptions",s.join(""),{xmlns:Gr.x})}function L7(e){return e.map(function(t){var r=tN(t.t||""),n=pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return pe("Comment",n,{"ss:Author":t.a})}).join("")}function M7(e,t,r,n,s,i,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+rt(zp(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=kt(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=rt(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=rt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=ks[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Re[14]);break;case"s":h="String",d=eN(e.v||"");break}var f=ui(n.cellXfs,e,n);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=o.c+1;var p=e.v!=null?d:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=L7(e.c)),pe("Cell",g,a)}function O7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=qo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function N7(e,t,r,n){if(!e["!ref"])return"";var s=Ye(e["!ref"]),i=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(m,v){Js(m);var C=!!m.width,x=ad(v,m),w={"ss:Index":v+1};C&&(w["ss:Width"]=Nl(x.width)),m.hidden&&(w["ss:Hidden"]="1"),a.push(pe("Column",null,w))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var u=[O7(c,(e["!rows"]||[])[c])],h=s.s.c;h<=s.e.c;++h){var d=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>c)&&!(i[o].e.c<h)&&!(i[o].e.r<c)){(i[o].s.c!=h||i[o].s.r!=c)&&(d=!0);break}if(!d){var f={r:c,c:h},p=_e(f),g=l?(e[c]||[])[h]:e[p];u.push(M7(g,p,e,t,r,n,f))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function B7(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?P7(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?N7(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(I7(i,t,e,r)),n.join("")}function H7(e,t){t||(t={}),e.SSF||(e.SSF=pt(Re)),e.SSF&&(ua(),ed(e.SSF),t.revssf=rd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(R7(e,t)),r.push(_7()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(pe("Worksheet",B7(n,t,e),{"ss:Name":rt(e.SheetNames[n])}));return r[2]=D7(e,t),r[3]=A7(e),Lt+pe("Workbook",r.join(""),{xmlns:Gr.ss,"xmlns:o":Gr.o,"xmlns:x":Gr.x,"xmlns:ss":Gr.ss,"xmlns:dt":Gr.dt,"xmlns:html":Gr.html})}function W7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=AN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=PN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var V7=[60,1084,2066,2165,2175];function G7(e,t,r,n,s){var i=n,o=[],a=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(a)}o.push(a),r.l+=i;for(var l=ls(r,r.l),c=$0[l],u=0;c!=null&&V7.indexOf(l)>-1;)i=ls(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+i),o.push(a),r.l+=4+i,c=$0[l=ls(r,r.l)];var h=Qt(o);rr(h,0);var d=0;h.lens=[];for(var f=0;f<o.length;++f)h.lens.push(d),d+=o[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Nn(e,t,r){if(e.t!=="z"&&!!e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Re[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ks[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Al(e.v):e.w=Hi(e.v):e.w=wn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&ca(Re[n]||String(n))){var s=yi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Uc(e,t,r){return{v:e,ixfe:t,t:r}}function z7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},o={},a=null,l=[],c="",u={},h,d="",f,p,g,m,v={},C=[],x,w,k=[],E=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},D=function(Me){return Me<8?Ri[Me]:Me<64&&E[Me-8]||Ri[Me]},N=function(Me,Dt,en){var Gt=Dt.XF.data;if(!(!Gt||!Gt.patternType||!en||!en.cellStyles)){Dt.s={},Dt.s.patternType=Gt.patternType;var hi;(hi=Ol(D(Gt.icvFore)))&&(Dt.s.fgColor={rgb:hi}),(hi=Ol(D(Gt.icvBack)))&&(Dt.s.bgColor={rgb:hi})}},O=function(Me,Dt,en){if(!(ie>1)&&!(en.sheetRows&&Me.r>=en.sheetRows)){if(en.cellStyles&&Dt.XF&&Dt.XF.data&&N(Me,Dt,en),delete Dt.ixfe,delete Dt.XF,h=Me,d=_e(Me),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Me.r<o.s.r&&(o.s.r=Me.r),Me.c<o.s.c&&(o.s.c=Me.c),Me.r+1>o.e.r&&(o.e.r=Me.r+1),Me.c+1>o.e.c&&(o.e.c=Me.c+1),en.cellFormula&&Dt.f){for(var Gt=0;Gt<C.length;++Gt)if(!(C[Gt][0].s.c>Me.c||C[Gt][0].s.r>Me.r)&&!(C[Gt][0].e.c<Me.c||C[Gt][0].e.r<Me.r)){Dt.F=Ie(C[Gt][0]),(C[Gt][0].s.c!=Me.c||C[Gt][0].s.r!=Me.r)&&delete Dt.f,Dt.f&&(Dt.f=""+dr(C[Gt][1],o,Me,H,A));break}}en.dense?(s[Me.r]||(s[Me.r]=[]),s[Me.r][Me.c]=Dt):s[d]=Dt}},A={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var G,q=[],z=[],se=[],te=[],Z=!1,H=[];H.SheetNames=A.snames,H.sharedf=A.sharedf,H.arrayf=A.arrayf,H.names=[],H.XTI=[];var Q=0,ie=0,F=0,W=[],B=[],V;A.codepage=1200,Tn(1200);for(var X=!1;e.l<e.length-1;){var ne=e.l,le=e.read_shift(2);if(le===0&&Q===10)break;var ce=e.l===e.length?0:e.read_shift(2),ee=$0[le];if(ee&&ee.f){if(t.bookSheets&&Q===133&&le!==133)break;if(Q=le,ee.r===2||ee.r==12){var Ee=e.read_shift(2);if(ce-=2,!A.enc&&Ee!==le&&((Ee&255)<<8|Ee>>8)!==le)throw new Error("rt mismatch: "+Ee+"!="+le);ee.r==12&&(e.l+=10,ce-=10)}var L={};if(le===10?L=ee.f(e,ce,A):L=G7(le,ee,e,ce,A),ie==0&&[9,521,1033,2057].indexOf(Q)===-1)continue;switch(le){case 34:r.opts.Date1904=y.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=L;break;case 66:var He=Number(L);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}Tn(A.codepage=He),X=!0;break;case 317:A.rrtabid=L;break;case 25:A.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:A.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(s["!type"]="dialog"),L.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),L.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:k.push(L);break;case 430:H.push([L]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(L);break;case 24:case 536:V={Name:L.Name,Ref:dr(L.rgce,o,null,H,A)},L.itab>0&&(V.Sheet=L.itab-1),H.names.push(V),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(B[L.itab-1]={ref:Ie(L.rgce[0][0][1][2])});break;case 22:A.ExternCount=L;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(L),H.XTI=H.XTI.concat(L);break;case 2196:if(A.biff<8)break;V!=null&&(V.Comment=L[1]);break;case 18:s["!protect"]=L;break;case 19:L!==0&&A.WTF&&console.error("Password verifier: "+L);break;case 133:i[L.pos]=L,A.snames.push(L.name);break;case 10:{if(--ie)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Ie(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ae=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ie(o),o.e.r=Ae}o.e.r++,o.e.c++}q.length>0&&(s["!merges"]=q),z.length>0&&(s["!objects"]=z),se.length>0&&(s["!cols"]=se),te.length>0&&(s["!rows"]=te),y.Sheets.push(R)}c===""?u=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),A.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(A.biff=5,X=!0,Tn(A.codepage=28591)),A.biff==8&&L.BIFFVer==0&&L.dt==16&&(A.biff=2),ie++)break;if(s=t.dense?[]:{},A.biff<8&&!X&&(X=!0,Tn(A.codepage=t.codepage||1252)),A.biff<5||L.BIFFVer==0&&L.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ue={pos:e.l-ce,name:c};i[Ue.pos]=Ue,A.snames.push(c)}else c=(i[ne]||{name:""}).name;L.dt==32&&(s["!type"]="chart"),L.dt==64&&(s["!type"]="macro"),q=[],z=[],A.arrayf=C=[],se=[],te=[],Z=!1,R={Hidden:(i[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[L.r]||[])[L.c]:s[_e({c:L.c,r:L.r})])&&++L.c,x={ixfe:L.ixfe,XF:k[L.ixfe]||{},v:L.val,t:"n"},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t);break;case 5:case 517:x={ixfe:L.ixfe,XF:k[L.ixfe],v:L.val,t:L.t},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t);break;case 638:x={ixfe:L.ixfe,XF:k[L.ixfe],v:L.rknum,t:"n"},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t);break;case 189:for(var Ce=L.c;Ce<=L.C;++Ce){var oe=L.rkrec[Ce-L.c][0];x={ixfe:oe,XF:k[oe],v:L.rkrec[Ce-L.c][1],t:"n"},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:Ce,r:L.r},x,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){a=L;break}if(x=Uc(L.val,L.cell.ixfe,L.tt),x.XF=k[x.ixfe],t.cellFormula){var Oe=L.formula;if(Oe&&Oe[0]&&Oe[0][0]&&Oe[0][0][0]=="PtgExp"){var Qe=Oe[0][0][1][0],je=Oe[0][0][1][1],be=_e({r:Qe,c:je});v[be]?x.f=""+dr(L.formula,o,L.cell,H,A):x.F=((t.dense?(s[Qe]||[])[je]:s[be])||{}).F}else x.f=""+dr(L.formula,o,L.cell,H,A)}F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O(L.cell,x,t),a=L}break;case 7:case 519:if(a)a.val=L,x=Uc(L,a.cell.ixfe,"s"),x.XF=k[x.ixfe],t.cellFormula&&(x.f=""+dr(a.formula,o,a.cell,H,A)),F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O(a.cell,x,t),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(L);var Je=_e(L[0].s);if(f=t.dense?(s[L[0].s.r]||[])[L[0].s.c]:s[Je],t.cellFormula&&f){if(!a||!Je||!f)break;f.f=""+dr(L[1],o,L[0],H,A),f.F=Ie(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!a)break;v[_e(a.cell)]=L[0],f=t.dense?(s[a.cell.r]||[])[a.cell.c]:s[_e(a.cell)],(f||{}).f=""+dr(L[0],o,h,H,A)}}break;case 253:x=Uc(l[L.isst].t,L.ixfe,"s"),l[L.isst].h&&(x.h=l[L.isst].h),x.XF=k[x.ixfe],F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:L.ixfe,XF:k[L.ixfe],t:"z"},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t));break;case 190:if(t.sheetStubs)for(var st=L.c;st<=L.C;++st){var mt=L.ixfe[st-L.c];x={ixfe:mt,XF:k[mt],t:"z"},F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:st,r:L.r},x,t)}break;case 214:case 516:case 4:x=Uc(L.val,L.ixfe,"s"),x.XF=k[x.ixfe],F>0&&(x.z=W[x.ixfe>>8&63]),Nn(x,t,r.opts.Date1904),O({c:L.c,r:L.r},x,t);break;case 0:case 512:ie===1&&(o=L);break;case 252:l=L;break;case 1054:if(A.biff==4){W[F++]=L[1];for(var Vt=0;Vt<F+163&&Re[Vt]!=L[1];++Vt);Vt>=163&&ds(L[1],F+163)}else ds(L[1],L[0]);break;case 30:{W[F++]=L;for(var at=0;at<F+163&&Re[at]!=L;++at);at>=163&&ds(L,F+163)}break;case 229:q=q.concat(L);break;case 93:z[L.cmo[0]]=A.lastobj=L;break;case 438:A.lastobj.TxO=L;break;case 127:A.lastobj.ImData=L;break;case 440:for(m=L[0].s.r;m<=L[0].e.r;++m)for(g=L[0].s.c;g<=L[0].e.c;++g)f=t.dense?(s[m]||[])[g]:s[_e({c:g,r:m})],f&&(f.l=L[1]);break;case 2048:for(m=L[0].s.r;m<=L[0].e.r;++m)for(g=L[0].s.c;g<=L[0].e.c;++g)f=t.dense?(s[m]||[])[g]:s[_e({c:g,r:m})],f&&f.l&&(f.l.Tooltip=L[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;f=t.dense?(s[L[0].r]||[])[L[0].c]:s[_e(L[0])];var Mn=z[L[2]];f||(t.dense?(s[L[0].r]||(s[L[0].r]=[]),f=s[L[0].r][L[0].c]={t:"z"}):f=s[_e(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),f.c||(f.c=[]),p={a:L[1],t:Mn.TxO.t},f.c.push(p)}break;case 2173:D5(k[L.ixfe],L.ext);break;case 125:{if(!A.cellStyles)break;for(;L.e>=L.s;)se[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},Z||(Z=!0,Wp(L.w/256)),Js(se[L.e+1])}break;case 520:{var We={};L.level!=null&&(te[L.r]=We,We.level=L.level),L.hidden&&(te[L.r]=We,We.hidden=!0),L.hpt&&(te[L.r]=We,We.hpt=L.hpt,We.hpx=qo(L.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ai(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=L;break;case 161:s["!margins"]||Ai(s["!margins"]={}),s["!margins"].header=L.header,s["!margins"].footer=L.footer;break;case 574:L.RTL&&(y.Views[0].RTL=!0);break;case 146:E=L;break;case 2198:G=L;break;case 140:w=L;break;case 442:c?R.CodeName=L||R.name:y.WBProps.CodeName=L||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=ce}return r.SheetNames=_t(i).sort(function(vt,Me){return Number(vt)-Number(Me)}).map(function(vt){return i[vt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(vt,Me){r.Sheets[r.SheetNames[Me]]["!autofilter"]=vt}),r.Strings=l,r.SSF=pt(Re),A.enc&&(r.Encryption=A.enc),G&&(r.Themes=G),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),H.names.length>0&&(y.Names=H.names),r.Workbook=y,r}var il={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function U7(e,t,r){var n=Fe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=rx(n,H0,il.DSI);for(var i in s)t[i]=s[i]}catch(c){if(r.WTF)throw c}var o=Fe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=rx(o,W0,il.SI);for(var l in a)t[l]==null&&(t[l]=a[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Q2(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function j7(e,t){var r=[],n=[],s=[],i=0,o,a=P1(H0,"n"),l=P1(W0,"n");if(e.Props)for(o=_t(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(a,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?n:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=_t(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(a,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?n:s).push([o[i],e.Custprops[o[i]]]);var c=[];for(i=0;i<s.length;++i)nk.indexOf(s[i][0])>-1||Y2.indexOf(s[i][0])>-1||s[i][1]!=null&&c.push(s[i]);n.length&&Fe.utils.cfb_add(t,"/SummaryInformation",nx(n,il.SI,l,W0)),(r.length||c.length)&&Fe.utils.cfb_add(t,"/DocumentSummaryInformation",nx(r,il.DSI,a,H0,c.length?c:null,il.UDI))}function qk(e,t){t||(t={}),Yp(t),mp(),t.codepage&&pp(t.codepage);var r,n;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),n=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=Ur(Qr(e));break;case"binary":e=Ur(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}rr(e,0),n={content:e}}var s,i;if(r&&W7(r),t.bookProps&&!t.bookSheets)s={};else{var o=Ne?"buffer":"array";if(n&&n.content)s=z7(n.content,t);else if((i=Fe.find(e,"PerfectOffice_MAIN"))&&i.content)s=Di.to_workbook(i.content,(t.type=o,t));else if((i=Fe.find(e,"NativeContent_MAIN"))&&i.content)s=Di.to_workbook(i.content,(t.type=o,t));else throw(i=Fe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=sH(e))}var a={};return e.FullPaths&&U7(e,a,t),s.Props=s.Custprops=a,t.bookFiles&&(s.cfb=e),s}function $7(e,t){var r=t||{},n=Fe.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Fe.utils.cfb_add(n,s,Jk(e,r)),r.biff==8&&(e.Props||e.Custprops)&&j7(e,n),r.biff==8&&e.vbaraw&&iH(n,Fe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Wl={0:{f:mV},1:{f:bV},2:{f:zV},3:{f:PV},4:{f:RV},5:{f:WV},6:{f:XV},7:{f:OV},8:{f:tG},9:{f:eG},10:{f:qV},11:{f:JV},12:{f:FV},13:{f:jV},14:{f:LV},15:{f:DV},16:{f:Uk},17:{f:QV},18:{f:BV},19:{f:Dp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:QG},40:{},42:{},43:{f:X6},44:{f:$6},45:{f:Z6},46:{f:J6},47:{f:q6},48:{},49:{f:CN},50:{},51:{f:I5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gk},62:{f:KV},63:{f:G5},64:{f:vG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:fG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:SV},148:{f:CV,p:16},151:{f:aG},152:{},153:{f:KG},154:{},155:{},156:{f:jG},157:{},158:{},159:{T:1,f:c6},160:{T:-1},161:{T:1,f:eo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:rG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:A5},336:{T:-1},337:{f:O5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:B0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:lG},427:{f:cG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:hG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:yV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:iG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:B0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:J5},633:{T:1},634:{T:-1},635:{T:1,f:Z5},636:{T:-1},637:{f:kN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:LG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$0={6:{f:vf},10:{f:Fs},12:{f:Nt},13:{f:Nt},14:{f:At},15:{f:At},16:{f:pr},17:{f:At},18:{f:At},19:{f:Nt},20:{f:cx},21:{f:cx},23:{f:fk},24:{f:hx},25:{f:At},26:{},27:{},28:{f:x8},29:{},34:{f:At},35:{f:ux},38:{f:pr},39:{f:pr},40:{f:pr},41:{f:pr},42:{f:At},43:{f:At},47:{f:D6},49:{f:jB},51:{f:Nt},60:{},61:{f:WB},64:{f:At},65:{f:UB},66:{f:Nt},77:{},80:{},81:{},82:{},85:{f:Nt},89:{},90:{},91:{},92:{f:_B},93:{f:y8},94:{},95:{f:At},96:{},97:{},99:{f:At},125:{f:gk},128:{f:o8},129:{f:AB},130:{f:Nt},131:{f:At},132:{f:At},133:{f:PB},134:{},140:{f:_8},141:{f:Nt},144:{},146:{f:P8},151:{},152:{},153:{},154:{},155:{},156:{f:Nt},157:{},158:{},160:{f:H8},161:{f:M8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:r8},190:{f:n8},193:{f:Fs},197:{},198:{},199:{},200:{},201:{},202:{f:At},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Nt},220:{},221:{f:At},222:{},224:{f:i8},225:{f:RB},226:{f:Fs},227:{},229:{f:C8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:LB},253:{f:KB},255:{f:OB},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:At},353:{f:Fs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:h8},431:{f:At},432:{},433:{},434:{},437:{},438:{f:b8},439:{f:At},440:{f:E8},441:{},442:{f:sc},443:{},444:{f:Nt},445:{},446:{},448:{f:Fs},449:{f:HB,r:2},450:{f:Fs},512:{f:ox},513:{f:B8},515:{f:c8},516:{f:YB},517:{f:lx},519:{f:W8},520:{f:NB},523:{},545:{f:dx},549:{f:ix},566:{},574:{f:GB},638:{f:t8},659:{},1048:{},1054:{f:ZB},1084:{},1212:{f:p8},2048:{f:T8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Fs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:I8,r:12},2173:{f:_5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:At,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:g8,r:12},2197:{},2198:{f:k5,r:12},2199:{},2200:{},2201:{},2202:{f:m8,r:12},2203:{f:Fs},2204:{},2205:{},2206:{},2207:{},2211:{f:BB},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Nt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:O8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:A8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ox},1:{},2:{f:j8},3:{f:z8},4:{f:G8},5:{f:lx},7:{f:K8},8:{},9:{f:Vc},11:{},22:{f:Nt},30:{f:JB},31:{},32:{},33:{f:dx},36:{},37:{f:ix},50:{f:X8},62:{},52:{},67:{},68:{f:Nt},69:{},86:{},126:{},127:{f:V8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Y8},223:{},234:{},354:{},421:{},518:{f:vf},521:{f:Vc},536:{f:hx},547:{f:ux},561:{},579:{},1030:{f:vf},1033:{f:Vc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function me(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Tp(r)&&e.push(r)}}function K7(e,t,r,n){var s=n||(r||[]).length||0;if(s<=8224)return me(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function lc(e,t,r){return e||(e=J(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function X7(e,t,r,n){var s=J(9);return lc(s,e,t),ik(r,n||"b",s),s}function Y7(e,t,r){var n=J(8+2*r.length);return lc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Q7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?$t(gt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?me(e,2,$8(r,n,s)):me(e,3,U8(r,n,s));return;case"b":case"e":me(e,5,X7(r,n,t.v,t.t));return;case"s":case"str":me(e,4,Y7(r,n,(t.v||"").slice(0,255)));return}me(e,1,lc(null,r,n))}function Z7(e,t,r,n){var s=Array.isArray(t),i=Ye(t["!ref"]||"A1"),o,a="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Ie(i)}for(var c=i.s.r;c<=i.e.r;++c){a=It(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=St(u)),o=l[u]+a;var h=s?(t[c]||[])[u]:t[o];!h||Q7(e,h,c,u)}}}function q7(e,t){for(var r=t||{},n=Hr(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&!!r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return me(n,r.biff==4?1033:r.biff==3?521:9,Np(e,16,r)),Z7(n,e.Sheets[e.SheetNames[s]],s,r),me(n,10),n.end()}function J7(e,t,r){me(e,49,$B({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function e9(e,t,r){!t||[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&me(e,1054,qB(s,t[s],r))})}function t9(e,t){var r=J(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),me(e,2151,r),r=J(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uk(Ye(t["!ref"]||"A1"),r),r.write_shift(4,4),me(e,2152,r)}function r9(e,t){for(var r=0;r<16;++r)me(e,224,ax({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){me(e,224,ax(n,0,t))})}function n9(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];me(e,440,F8(n)),n[1].Tooltip&&me(e,2048,R8(n))}delete t["!links"]}function s9(e,t){if(!!t){var r=0;t.forEach(function(n,s){++r<=256&&n&&me(e,125,L8(ad(s,n),s))})}}function i9(e,t,r,n,s){var i=16+ui(s.cellXfs,t,s);if(t.v==null&&!t.bf){me(e,513,zi(r,n,i));return}if(t.bf)me(e,6,AW(t,r,n,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?$t(gt(t.v)):t.v;me(e,515,u8(r,n,o,i));break;case"b":case"e":me(e,517,l8(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var a=jp(s.Strings,t.v,s.revStrings);me(e,253,XB(r,n,a,i))}else me(e,516,QB(r,n,(t.v||"").slice(0,255),i,s));break;default:me(e,513,zi(r,n,i))}}function o9(e,t,r){var n=Hr(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,h="",d=[],f=Ye(i["!ref"]||"A1"),p=c?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}me(n,2057,Np(r,16,t)),me(n,13,ln(1)),me(n,12,ln(100)),me(n,15,br(!0)),me(n,17,br(!1)),me(n,16,Vi(.001)),me(n,95,br(!0)),me(n,42,br(!1)),me(n,43,br(!1)),me(n,130,ln(1)),me(n,128,a8([0,0])),me(n,131,br(!1)),me(n,132,br(!1)),c&&s9(n,i["!cols"]),me(n,512,e8(f,t)),c&&(i["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){h=It(g);for(var m=f.s.c;m<=f.e.c;++m){g===f.s.r&&(d[m]=St(m)),u=d[m]+h;var v=l?(i[g]||[])[m]:i[u];!v||(i9(n,v,g,m,t),c&&v.l&&i["!links"].push([u,v.l]))}}var C=a.CodeName||a.name||s;return c&&me(n,574,zB((o.Views||[])[0])),c&&(i["!merges"]||[]).length&&me(n,229,w8(i["!merges"])),c&&n9(n,i),me(n,442,ok(C)),c&&t9(n,i),me(n,10),n.end()}function a9(e,t,r){var n=Hr(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},a=r.biff==8,l=r.biff==5;if(me(n,2057,Np(e,5,r)),r.bookType=="xla"&&me(n,135),me(n,225,a?ln(1200):null),me(n,193,lB(2)),l&&me(n,191),l&&me(n,192),me(n,226),me(n,92,DB("SheetJS",r)),me(n,66,ln(a?1200:1252)),a&&me(n,353,ln(0)),a&&me(n,448),me(n,317,N8(e.SheetNames.length)),a&&e.vbaraw&&me(n,211),a&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";me(n,442,ok(c))}me(n,156,ln(17)),me(n,25,br(!1)),me(n,18,br(!1)),me(n,19,ln(0)),a&&me(n,431,br(!1)),a&&me(n,444,ln(0)),me(n,61,VB()),me(n,64,br(!1)),me(n,141,ln(0)),me(n,34,br(HG(e)=="true")),me(n,14,br(!0)),a&&me(n,439,br(!1)),me(n,218,ln(0)),J7(n,e,r),e9(n,e.SSF,r),r9(n,r),a&&me(n,352,br(!1));var u=n.end(),h=Hr();a&&me(h,140,D8()),a&&r.Strings&&K7(h,252,MB(r.Strings)),me(h,10);var d=h.end(),f=Hr(),p=0,g=0;for(g=0;g<e.SheetNames.length;++g)p+=(a?12:11)+(a?2:1)*e.SheetNames[g].length;var m=u.length+p+d.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};me(f,133,IB({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),m+=t[g].length}var C=f.end();if(p!=C.length)throw new Error("BS8 "+p+" != "+C.length);var x=[];return u.length&&x.push(u),C.length&&x.push(C),d.length&&x.push(d),Qt(x)}function l9(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=pt(Re)),e&&e.SSF&&(ua(),ed(e.SSF),r.revssf=rd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Qp(r),r.cellXfs=[],ui(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=o9(s,r,e);return n.unshift(a9(e,n,r)),Qt(n)}function Jk(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Wr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return l9(e,t);case 4:case 3:case 2:return q7(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Sx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,a=i&&i.index||e.length,l=KO(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<l.length;++o){var g=l[o].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(m!="<td"&&m!="<th")){var v=g.split(/<\/t[dh]>/i);for(a=0;a<v.length;++a){var C=v[a].trim();if(!!C.match(/<t[dh]/i)){for(var x=C,w=0;x.charAt(0)=="<"&&(w=x.indexOf(">"))>-1;)x=x.slice(w+1);for(var k=0;k<p.length;++k){var E=p[k];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,k=-1)}var y=De(C.slice(0,C.indexOf(">")));d=y.colspan?+y.colspan:1,((h=+y.rowspan)>1||d>1)&&p.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var R=y.t||y["data-t"]||"";if(!x.length){u+=d;continue}if(x=k2(x),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!x.length){u+=d;continue}var D={t:"s",v:x};r.raw||!x.trim().length||R=="s"||(x==="TRUE"?D={t:"b",v:!0}:x==="FALSE"?D={t:"b",v:!1}:isNaN(An(x))?isNaN(Qo(x).getDate())||(D={t:"d",v:gt(x)},r.cellDates||(D={t:"n",v:$t(D.v)}),D.z=r.dateNF||Re[14]):D={t:"n",v:An(x)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=D):n[_e({r:c,c:u})]=D,u+=d}}}}return n["!ref"]=Ie(f),p.length&&(n["!merges"]=p),n}function c9(e,t,r,n){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>o)&&!(s[c].e.r<r||s[c].e.c<o)){if(s[c].s.r<r||s[c].s.c<o){a=-1;break}a=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(a<0)){var u=_e({r,c:o}),h=n.dense?(e[r]||[])[o]:e[u],d=h&&h.v!=null&&(h.h||bp(h.w||(xs(h),h.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,i.push(pe("td",d,f))}}var p="<tr>";return p+i.join("")+"</tr>"}var u9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',h9="</body></html>";function d9(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ci(Sx(r[0],t),t);var n=Jp();return r.forEach(function(s,i){em(n,Sx(s,t),"Sheet"+(i+1))}),n}function f9(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eb(e,t){var r=t||{},n=r.header!=null?r.header:u9,s=r.footer!=null?r.footer:h9,i=[n],o=Wr(e["!ref"]);r.dense=Array.isArray(e),i.push(f9(e,o,r));for(var a=o.s.r;a<=o.e.r;++a)i.push(c9(e,o,a,r));return i.push("</table>"+s),i.join("")}function tb(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?kt(n.origin):n.origin;s=o.r,i=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=Wr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,C=0,x=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&g<l;++p){var w=a[p];if(kx(w)){if(n.display)continue;f[g]={hidden:!0}}var k=w.children;for(m=v=0;m<k.length;++m){var E=k[m];if(!(n.display&&kx(E))){var y=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):k2(E.innerHTML),R=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<h.length;++d){var D=h[d];D.s.c==v+i&&D.s.r<g+s&&g+s<=D.e.r&&(v=D.e.c+1-i,d=-1)}x=+E.getAttribute("colspan")||1,((C=+E.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:g+s,c:v+i},e:{r:g+s+(C||1)-1,c:v+i+(x||1)-1}});var N={t:"s",v:y},O=E.getAttribute("data-t")||E.getAttribute("t")||"";y!=null&&(y.length==0?N.t=O||"z":n.raw||y.trim().length==0||O=="s"||(y==="TRUE"?N={t:"b",v:!0}:y==="FALSE"?N={t:"b",v:!1}:isNaN(An(y))?isNaN(Qo(y).getDate())||(N={t:"d",v:gt(y)},n.cellDates||(N={t:"n",v:$t(N.v)}),N.z=n.dateNF||Re[14]):N={t:"n",v:An(y)})),N.z===void 0&&R!=null&&(N.z=R);var A="",G=E.getElementsByTagName("A");if(G&&G.length)for(var q=0;q<G.length&&!(G[q].hasAttribute("href")&&(A=G[q].getAttribute("href"),A.charAt(0)!="#"));++q);A&&A.charAt(0)!="#"&&(N.l={Target:A}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][v+i]=N):e[_e({c:v+i,r:g+s})]=N,c.e.c<v+i&&(c.e.c=v+i),v+=x}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),e["!ref"]=Ie(c),g>=l&&(e["!fullref"]=Ie((c.e.r=a.length-p+g-1+s,c))),e}function rb(e,t){var r=t||{},n=r.dense?[]:{};return tb(n,e,t)}function g9(e,t){return ci(rb(e,t),t)}function kx(e){var t="",r=p9(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function p9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function m9(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Xe(t.replace(/<[^>]*>/g,""));return[r]}var bx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function nb(e,t){var r=t||{},n=Ep(e),s=[],i,o,a={name:""},l="",c=0,u,h,d={},f=[],p=r.dense?[]:{},g,m,v={value:""},C="",x=0,w=[],k=-1,E=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,D={},N=[],O={},A=0,G=0,q=[],z=1,se=1,te=[],Z={Names:[]},H={},Q=["",""],ie=[],F={},W="",B=0,V=!1,X=!1,ne=0;for(Ll.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Ll.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":g[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?p["!ref"]=Ie(y):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(p["!fullref"]=p["!ref"],y.e.r=r.sheetRows-1,p["!ref"]=Ie(y)),N.length&&(p["!merges"]=N),q.length&&(p["!rows"]=q),u.name=u.\u540D\u79F0||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),d[u.name]=p,X=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=De(g[0],!1),k=E=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,p=r.dense?[]:{},N=[],q=[],X=!0);break;case"table-row-group":g[1]==="/"?--R:++R;break;case"table-row":case"\u884C":if(g[1]==="/"){k+=z,z=1;break}if(h=De(g[0],!1),h.\u884C\u53F7?k=h.\u884C\u53F7-1:k==-1&&(k=0),z=+h["number-rows-repeated"]||1,z<10)for(ne=0;ne<z;++ne)R>0&&(q[k+ne]={level:R});E=-1;break;case"covered-table-cell":g[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(p[k]||(p[k]=[]),p[k][E]={t:"z"}):p[_e({r:k,c:E})]={t:"z"}),C="",w=[];break;case"table-cell":case"\u6570\u636E":if(g[0].charAt(g[0].length-2)==="/")++E,v=De(g[0],!1),se=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(m.f=Cx(Xe(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(m.t="s",m.v=Xe(v["string-value"]||""),r.dense?(p[k]||(p[k]=[]),p[k][E]=m):p[_e({r:k,c:E})]=m),E+=se-1;else if(g[1]!=="/"){++E,C="",x=0,w=[],se=1;var le=z?k+z-1:k;if(E>y.e.c&&(y.e.c=E),E<y.s.c&&(y.s.c=E),k<y.s.r&&(y.s.r=k),le>y.e.r&&(y.e.r=le),v=De(g[0],!1),ie=[],F={},m={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Xe(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(A=parseInt(v["number-matrix-rows-spanned"],10)||0,G=parseInt(v["number-matrix-columns-spanned"],10)||0,O={s:{r:k,c:E},e:{r:k+A-1,c:E+G-1}},m.F=Ie(O),te.push([O,m.F])),v.formula)m.f=Cx(v.formula);else for(ne=0;ne<te.length;++ne)k>=te[ne][0].s.r&&k<=te[ne][0].e.r&&E>=te[ne][0].s.c&&E<=te[ne][0].e.c&&(m.F=te[ne][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(A=parseInt(v["number-rows-spanned"],10)||0,G=parseInt(v["number-columns-spanned"],10)||0,O={s:{r:k,c:E},e:{r:k+A-1,c:E+G-1}},N.push(O)),v["number-columns-repeated"]&&(se=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=dt(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=gt(v["date-value"]),r.cellDates||(m.t="n",m.v=$t(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=UO(v["time-value"])/86400,r.cellDates&&(m.t="d",m.v=nd(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(C=Xe(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(V=!1,m.t==="s"&&(m.v=C||"",w.length&&(m.R=w),V=x==0),H.Target&&(m.l=H),ie.length>0&&(m.c=ie,ie=[]),C&&r.cellText!==!1&&(m.w=C),V&&(m.t="z",delete m.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var ce=0;ce<z;++ce){if(se=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[k+ce]||(p[k+ce]=[]),p[k+ce][E]=ce==0?m:pt(m);--se>0;)p[k+ce][E+se]=pt(m);else for(p[_e({r:k+ce,c:E})]=m;--se>0;)p[_e({r:k+ce,c:E+se})]=pt(m);y.e.c<=E&&(y.e.c=E)}se=parseInt(v["number-columns-repeated"]||"1",10),E+=se-1,se=0,m={},C="",w=[]}H={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;F.t=C,w.length&&(F.R=w),F.a=W,ie.push(F)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);W="",B=0,C="",x=0,w=[];break;case"creator":g[1]==="/"?W=n.slice(B,g.index):B=g.index+g[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);C="",x=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(D[a.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",a=De(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=De(g[0],!1),l+=bx[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=De(g[0],!1),l+=bx[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":o=De(g[0],!1),Q=xf(o["cell-range-address"]);var ee={Name:o.name,Ref:Q[0]+"!"+Q[1]};X&&(ee.Sheet=f.length),Z.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var Ee=m9(n.slice(x,g.index));C=(C.length>0?C+`
`:"")+Ee[0]}else De(g[0],!1),x=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Q=xf(De(g[0])["target-range-address"]),d[Q[0]]["!autofilter"]={ref:Q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(H=De(g[0],!1),!H.href)break;H.Target=Xe(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(Q=xf(H.Target.slice(1)),H.Target="#"+Q[0]+"!"+Q[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(g)}}var L={Sheets:d,SheetNames:f,Workbook:Z};return r.bookSheets&&delete L.Sheets,L}function Ex(e,t){t=t||{},an(e,"META-INF/manifest.xml")&&zN(Ot(e,"META-INF/manifest.xml"),t);var r=jr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=nb(it(r),t);return an(e,"meta.xml")&&(n.Props=K2(Ot(e,"meta.xml"))),n}function Fx(e,t){return nb(e,t)}var v9=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Il({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Lt+t}}(),Tx=function(){var e=function(i){return rt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,a){var l=[];l.push('      <table:table table:name="'+rt(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=Wr(i["!ref"]||"A1"),d=i["!merges"]||[],f=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",m=i["!rows"]||[];for(c=0;c<h.s.r;++c)g=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=m[c]?' table:style-name="ro'+m[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var v=!1,C={},x="";for(f=0;f!=d.length;++f)if(!(d[f].s.c>u)&&!(d[f].s.r>c)&&!(d[f].e.c<u)&&!(d[f].e.r<c)){(d[f].s.c!=u||d[f].s.r!=c)&&(v=!0),C["table:number-columns-spanned"]=d[f].e.c-d[f].s.c+1,C["table:number-rows-spanned"]=d[f].e.r-d[f].s.r+1;break}if(v){l.push(r);continue}var w=_e({r:c,c:u}),k=p?(i[c]||[])[u]:i[w];if(k&&k.f&&(C["table:formula"]=rt(NW(k.f)),k.F&&k.F.slice(0,w.length)==w)){var E=Wr(k.F);C["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,C["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!k){l.push(t);continue}switch(k.t){case"b":x=k.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=k.v?"true":"false";break;case"n":x=k.w||String(k.v||0),C["office:value-type"]="float",C["office:value"]=k.v||0;break;case"s":case"str":x=k.v==null?"":k.v,C["office:value-type"]="string";break;case"d":x=k.w||gt(k.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=gt(k.v).toISOString(),C["table:style-name"]="ce1";break;default:l.push(t);continue}var y=e(x);if(k.l&&k.l.Target){var R=k.l.Target;R=R.charAt(0)=="#"?"#"+BW(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),y=pe("text:a",y,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+pe("table:table-cell",pe("text:p",y,{}),C)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(!!c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Js(h),h.ods=a;var d=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(!!c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Lt],c=Il({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Il({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push($2().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function sb(e,t){if(t.bookType=="fods")return Tx(e,t);var r=yp(),n="",s=[],i=[];return n="mimetype",Le(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Le(r,n,Tx(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Le(r,n,v9(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Le(r,n,Lt+$2()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Le(r,n,$N(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Le(r,n,UN(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ui(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function K0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):it(li(e))}function x9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ur($n(e))}function C9(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ti(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Rx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function w9(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function y9(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Vl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function et(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Rt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ze(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Vl(e,r),i=s&7;s=Math.floor(s/8);var o=0,a;if(s==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0])}break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Vl(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:a,type:i};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function er(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){!s.data||(t.push(et(n*8+s.type)),s.type==2&&t.push(et(s.data.length)),t.push(s.data))})}),ti(t)}function Xp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function nn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Vl(e,n),i=Ze(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Rt(i[1][0].data),messages:[]};i[2].forEach(function(a){var l=Ze(a.data),c=Rt(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(o.merge=Rt(i[3][0].data)>>>0>0),r.push(o)}return r}function oo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:et(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:et(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:et(o.data.length)}],n[2].push({data:er(o.meta),type:2})});var i=er(n);t.push(et(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),ti(t)}function S9(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Vl(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ti(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=ti(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function sn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(S9(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ti(t)}function ao(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=et(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return ti(t)}function k9(e,t,r,n){var s=Ui(e),i=s.getUint32(4,!0),o=(n>1?12:8)+Rx(i&(n>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(a=s.getUint32(o,!0),o+=4),o+=Rx(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(o,!0),o+=4),i&32&&(c=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function b9(e,t,r){var n=Ui(e),s=n.getUint32(8,!0),i=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=w9(e,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(a=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[a]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function wf(e,t){var r=new Uint8Array(32),n=Ui(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,y9(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function yf(e,t){var r=new Uint8Array(32),n=Ui(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function E9(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return k9(e,t,r,e[0]);case 5:return b9(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hr(e){var t=Ze(e);return Vl(t[1][0].data)}function _x(e,t){var r=Ze(t.data),n=Rt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var a=Ze(o.data),l=Rt(a[1][0].data)>>>0;switch(n){case 1:i[l]=K0(a[3][0].data);break;case 8:{var c=e[hr(a[9][0].data)][0],u=Ze(c.data),h=e[hr(u[1][0].data)][0],d=Rt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var f=Ze(h.data);i[l]=f[3].map(function(p){return K0(p.data)}).join("")}break}}),i}function F9(e,t){var r,n,s,i,o,a,l,c,u,h,d,f,p,g,m=Ze(e),v=Rt(m[1][0].data)>>>0,C=Rt(m[2][0].data)>>>0,x=((n=(r=m[8])==null?void 0:r[0])==null?void 0:n.data)&&Rt(m[8][0].data)>0||!1,w,k;if(((i=(s=m[7])==null?void 0:s[0])==null?void 0:i.data)&&t!=0)w=(a=(o=m[7])==null?void 0:o[0])==null?void 0:a.data,k=(c=(l=m[6])==null?void 0:l[0])==null?void 0:c.data;else if(((h=(u=m[4])==null?void 0:u[0])==null?void 0:h.data)&&t!=1)w=(f=(d=m[4])==null?void 0:d[0])==null?void 0:f.data,k=(g=(p=m[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=x?4:1,y=Ui(w),R=[],D=0;D<w.length/2;++D){var N=y.getUint16(D*2,!0);N<65535&&R.push([D,N])}if(R.length!=C)throw"Expected ".concat(C," cells, found ").concat(R.length);var O=[];for(D=0;D<R.length-1;++D)O[R[D][0]]=k.subarray(R[D][1]*E,R[D+1][1]*E);return R.length>=1&&(O[R[R.length-1][0]]=k.subarray(R[R.length-1][1]*E)),{R:v,cells:O}}function T9(e,t){var r,n=Ze(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Rt(n[7][0].data)>>>0>0?1:0:-1,i=Xp(n[5],function(o){return F9(o,s)});return{nrows:Rt(n[4][0].data)>>>0,data:i.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function R9(e,t,r){var n,s=Ze(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Rt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Rt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ie(i);var o=Ze(s[4][0].data),a=_x(e,e[hr(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?_x(e,e[hr(o[17][0].data)][0]):[],c=Ze(o[3][0].data),u=0;c[1].forEach(function(h){var d=Ze(h.data),f=e[hr(d[2][0].data)][0],p=Rt(f.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=T9(e,f);g.data.forEach(function(m,v){m.forEach(function(C,x){var w=_e({r:u+v,c:x}),k=E9(C,a,l);k&&(r[w]=k)})}),u+=g.nrows})}function _9(e,t){var r=Ze(t.data),n={"!ref":"A1"},s=e[hr(r[2][0].data)],i=Rt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return R9(e,s[0],n),n}function D9(e,t){var r,n=Ze(t.data),s={name:(r=n[1])!=null&&r[0]?K0(n[1][0].data):"",sheets:[]},i=Xp(n[2],hr);return i.forEach(function(o){e[o].forEach(function(a){var l=Rt(a.meta[1][0].data);l==6e3&&s.sheets.push(_9(e,a))})}),s}function A9(e,t){var r=Jp(),n=Ze(t.data),s=Xp(n[1],hr);if(s.forEach(function(i){e[i].forEach(function(o){var a=Rt(o.meta[1][0].data);if(a==2){var l=D9(e,o);l.sheets.forEach(function(c,u){em(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sf(e){var t,r,n,s,i={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(!!l.name.match(/\.iwa$/)){var c;try{c=sn(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=nn(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Rt(i[1][0].meta[1][0].data)==1&&i[1][0];if(a||o.forEach(function(l){i[l].forEach(function(c){var u=Rt(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return A9(i,a)}function P9(e,t,r){var n,s,i,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Rt(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Ui(e[7][0].data),u=0,h=[],d=Ui(e[4][0].data),f=0,p=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),d.setUint16(g*2,f,!0);var m,v;switch(typeof t[g]){case"string":m=wf({t:"s",v:t[g]},r),v=yf({t:"s",v:t[g]},r);break;case"number":m=wf({t:"n",v:t[g]},r),v=yf({t:"n",v:t[g]},r);break;case"boolean":m=wf({t:"b",v:t[g]},r),v=yf({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(m),u+=m.length,p.push(v),f+=v.length,++l}for(e[2][0].data=et(l);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535,!0);return e[6][0].data=ti(h),e[3][0].data=ti(p),l}function I9(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Wr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ie(n)));var i=yh(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(W){return W.forEach(function(B){typeof B=="string"&&o.push(B)})});var a={},l=[],c=Fe.read(t.numbers,{type:"base64"});c.FileIndex.map(function(W,B){return[W,c.FullPaths[B]]}).forEach(function(W){var B=W[0],V=W[1];if(B.type==2&&!!B.name.match(/\.iwa/)){var X=B.content,ne=sn(X),le=nn(ne);le.forEach(function(ce){l.push(ce.id),a[ce.id]={deps:[],location:V,type:Rt(ce.messages[0].meta[1][0].data)}})}}),l.sort(function(W,B){return W-B});var u=l.filter(function(W){return W>1}).map(function(W){return[W,et(W)]});c.FileIndex.map(function(W,B){return[W,c.FullPaths[B]]}).forEach(function(W){var B=W[0];if(W[1],!!B.name.match(/\.iwa/)){var V=nn(sn(B.content));V.forEach(function(X){X.messages.forEach(function(ne){u.forEach(function(le){X.messages.some(function(ce){return Rt(ce.meta[1][0].data)!=11006&&C9(ce.data,le[1])})&&a[le[0]].deps.push(X.id)})})})}});for(var h=Fe.find(c,a[1].location),d=nn(sn(h.content)),f,p=0;p<d.length;++p){var g=d[p];g.id==1&&(f=g)}var m=hr(Ze(f.messages[0].data)[1][0].data);for(h=Fe.find(c,a[m].location),d=nn(sn(h.content)),p=0;p<d.length;++p)g=d[p],g.id==m&&(f=g);for(m=hr(Ze(f.messages[0].data)[2][0].data),h=Fe.find(c,a[m].location),d=nn(sn(h.content)),p=0;p<d.length;++p)g=d[p],g.id==m&&(f=g);for(m=hr(Ze(f.messages[0].data)[2][0].data),h=Fe.find(c,a[m].location),d=nn(sn(h.content)),p=0;p<d.length;++p)g=d[p],g.id==m&&(f=g);var v=Ze(f.messages[0].data);{v[6][0].data=et(n.e.r+1),v[7][0].data=et(n.e.c+1);var C=hr(v[46][0].data),x=Fe.find(c,a[C].location),w=nn(sn(x.content));{for(var k=0;k<w.length&&w[k].id!=C;++k);if(w[k].id!=C)throw"Bad ColumnRowUIDMapArchive";var E=Ze(w[k].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var y=0;y<=n.e.c;++y){var R=[];R[1]=R[2]=[{type:0,data:et(y+420690)}],E[1].push({type:2,data:er(R)}),E[2].push({type:0,data:et(y)}),E[3].push({type:0,data:et(y)})}E[4]=[],E[5]=[],E[6]=[];for(var D=0;D<=n.e.r;++D)R=[],R[1]=R[2]=[{type:0,data:et(D+726270)}],E[4].push({type:2,data:er(R)}),E[5].push({type:0,data:et(D)}),E[6].push({type:0,data:et(D)});w[k].messages[0].data=er(E)}x.content=ao(oo(w)),x.size=x.content.length,delete v[46];var N=Ze(v[4][0].data);{N[7][0].data=et(n.e.r+1);var O=Ze(N[1][0].data),A=hr(O[2][0].data);x=Fe.find(c,a[A].location),w=nn(sn(x.content));{if(w[0].id!=A)throw"Bad HeaderStorageBucket";var G=Ze(w[0].messages[0].data);for(D=0;D<i.length;++D){var q=Ze(G[2][0].data);q[1][0].data=et(D),q[4][0].data=et(i[D].length),G[2][D]={type:G[2][0].type,data:er(q)}}w[0].messages[0].data=er(G)}x.content=ao(oo(w)),x.size=x.content.length;var z=hr(N[2][0].data);x=Fe.find(c,a[z].location),w=nn(sn(x.content));{if(w[0].id!=z)throw"Bad HeaderStorageBucket";for(G=Ze(w[0].messages[0].data),y=0;y<=n.e.c;++y)q=Ze(G[2][0].data),q[1][0].data=et(y),q[4][0].data=et(n.e.r+1),G[2][y]={type:G[2][0].type,data:er(q)};w[0].messages[0].data=er(G)}x.content=ao(oo(w)),x.size=x.content.length;var se=hr(N[4][0].data);(function(){for(var W=Fe.find(c,a[se].location),B=nn(sn(W.content)),V,X=0;X<B.length;++X){var ne=B[X];ne.id==se&&(V=ne)}var le=Ze(V.messages[0].data);{le[3]=[];var ce=[];o.forEach(function(L,He){ce[1]=[{type:0,data:et(He)}],ce[2]=[{type:0,data:et(1)}],ce[3]=[{type:2,data:x9(L)}],le[3].push({type:2,data:er(ce)})})}V.messages[0].data=er(le);var ee=oo(B),Ee=ao(ee);W.content=Ee,W.size=W.content.length})();var te=Ze(N[3][0].data);{var Z=te[1][0];delete te[2];var H=Ze(Z.data);{var Q=hr(H[2][0].data);(function(){for(var W=Fe.find(c,a[Q].location),B=nn(sn(W.content)),V,X=0;X<B.length;++X){var ne=B[X];ne.id==Q&&(V=ne)}var le=Ze(V.messages[0].data);{delete le[6],delete te[7];var ce=new Uint8Array(le[5][0].data);le[5]=[];for(var ee=0,Ee=0;Ee<=n.e.r;++Ee){var L=Ze(ce);ee+=P9(L,i[Ee],o),L[1][0].data=et(Ee),le[5].push({data:er(L),type:2})}le[1]=[{type:0,data:et(n.e.c+1)}],le[2]=[{type:0,data:et(n.e.r+1)}],le[3]=[{type:0,data:et(ee)}],le[4]=[{type:0,data:et(n.e.r+1)}]}V.messages[0].data=er(le);var He=oo(B),Ae=ao(He);W.content=Ae,W.size=W.content.length})()}Z.data=er(H)}N[3][0].data=er(te)}v[4][0].data=er(N)}f.messages[0].data=er(v);var ie=oo(d),F=ao(ie);return h.content=F,h.size=h.content.length,c}function ib(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Yp(e){ib([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Qp(e){ib([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function L9(e){return Ve.WS.indexOf(e)>-1?"sheet":e==Ve.CS?"chart":e==Ve.DS?"dialog":e==Ve.MS?"macro":e&&e.length?e:"sheet"}function M9(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,L9(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function O9(e,t,r,n,s,i,o,a,l,c,u,h){try{i[n]=tl(jr(e,r,!0),t);var d=Ot(e,t),f;switch(a){case"sheet":f=s7(d,t,s,l,i[n],c,u,h);break;case"chart":if(f=i7(d,t,s,l,i[n],c,u,h),!f||!f["!drawel"])break;var p=Na(f["!drawel"].Target,t),g=Ml(p),m=j5(jr(e,p,!0),tl(jr(e,g,!0),p)),v=Na(m,p),C=Ml(v);f=PG(jr(e,v,!0),v,l,tl(jr(e,C,!0),v),c,f);break;case"macro":f=o7(d,t,s,l,i[n],c,u,h);break;case"dialog":f=a7(d,t,s,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=f;var x=[];i&&i[n]&&_t(i[n]).forEach(function(w){var k="";if(i[n][w].Type==Ve.CMNT){k=Na(i[n][w].Target,t);var E=h7(Ot(e,k,!0),k,l);if(!E||!E.length)return;gx(f,E,!1)}i[n][w].Type==Ve.TCMNT&&(k=Na(i[n][w].Target,t),x=x.concat(K5(Ot(e,k,!0),l)))}),x&&x.length&&gx(f,x,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function tn(e){return e.charAt(0)=="/"?e.slice(1):e}function N9(e,t){if(ua(),t=t||{},Yp(t),an(e,"META-INF/manifest.xml")||an(e,"objectdata.xml"))return Ex(e,t);if(an(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sf<"u"){if(e.FileIndex)return Sf(e);var r=Fe.utils.cfb_new();return M1(e).forEach(function(q){Le(r,q,C2(e,q))}),Sf(r)}throw new Error("Unsupported NUMBERS file")}if(!an(e,"[Content_Types].xml"))throw an(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):an(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=M1(e),s=VN(jr(e,"[Content_Types].xml")),i=!1,o,a;if(s.workbooks.length===0&&(a="xl/workbook.xml",Ot(e,a,!0)&&s.workbooks.push(a)),s.workbooks.length===0){if(a="xl/workbook.bin",!Ot(e,a,!0))throw new Error("Could not find workbook");s.workbooks.push(a),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(rl=[],s.sst)try{rl=u7(Ot(e,tn(s.sst)),s.sst,t)}catch(q){if(t.WTF)throw q}t.cellStyles&&s.themes.length&&(l=c7(jr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=l7(Ot(e,tn(s.style)),s.style,l,t))}s.links.map(function(q){try{var z=tl(jr(e,Ml(tn(q))),q);return f7(Ot(e,tn(q)),z,q,t)}catch{}});var u=n7(Ot(e,tn(s.workbooks[0])),s.workbooks[0],t),h={},d="";s.coreprops.length&&(d=Ot(e,tn(s.coreprops[0]),!0),d&&(h=K2(d)),s.extprops.length!==0&&(d=Ot(e,tn(s.extprops[0]),!0),d&&XN(d,h,t)));var f={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(d=jr(e,tn(s.custprops[0]),!0),d&&(f=QN(d,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(z){return z.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=f),t.bookSheets&&typeof o<"u"&&(p.SheetNames=o),t.bookSheets?p.SheetNames:t.bookProps))return p;o={};var g={};t.bookDeps&&s.calcchain&&(g=d7(Ot(e,tn(s.calcchain)),s.calcchain));var m=0,v={},C,x;{var w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var k=0;k!=w.length;++k)h.SheetNames[k]=w[k].name}var E=i?"bin":"xml",y=s.workbooks[0].lastIndexOf("/"),R=(s.workbooks[0].slice(0,y+1)+"_rels/"+s.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");an(e,R)||(R="xl/_rels/workbook."+E+".rels");var D=tl(jr(e,R,!0),R.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=g7(Ot(e,tn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Y5(Ot(e,tn(s.people[0])),t)),D&&(D=M9(D,u.Sheets));var N=Ot(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var O="sheet";if(D&&D[m]?(C="xl/"+D[m][1].replace(/[\/]?xl\//,""),an(e,C)||(C=D[m][1]),an(e,C)||(C=R.replace(/_rels\/.*$/,"")+D[m][1]),O=D[m][2]):(C="xl/worksheets/sheet"+(m+1-N)+"."+E,C=C.replace(/sheet0\./,"sheet.")),x=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==m&&(A=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==h.SheetNames[m].toLowerCase()&&(A=1);if(!A)continue e}}O9(e,C,x,h.SheetNames[m],m,v,o,O,t,u,l,c)}return p={Directory:s,Workbook:u,Props:h,Custprops:f,Deps:g,Sheets:o,SheetNames:h.SheetNames,Strings:rl,Styles:c,Themes:l,SSF:pt(Re)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(q,z){q=q.replace(/^Root Entry[\/]/,""),p.keys.push(q),p.files[q]=e.FileIndex[z]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=Ot(e,tn(s.vba[0]),!0):s.defaults&&s.defaults.bin===nH&&(p.vbaraw=Ot(e,"xl/vbaProject.bin",!0))),p}function B9(e,t){var r=t||{},n="Workbook",s=Fe.find(e,n);try{if(n="/!DataSpaces/Version",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(g6(s.content),n="/!DataSpaces/DataSpaceMap",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=m6(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=v6(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);C6(s.content)}catch{}if(n="/EncryptionInfo",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=w6(s.content);if(n="/EncryptedPackage",s=Fe.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],s.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function H9(e,t){return t.bookType=="ods"?sb(e,t):t.bookType=="numbers"?I9(e,t):t.bookType=="xlsb"?W9(e,t):V9(e,t)}function W9(e,t){Eo=1024,e&&!e.SSF&&(e.SSF=pt(Re)),e&&e.SSF&&(ua(),ed(e.SSF),t.revssf=rd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Pk.indexOf(t.bookType)>-1,s=Mp();Qp(t=t||{});var i=yp(),o="",a=0;if(t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Le(i,o,X2(e.Props,t)),s.coreprops.push(o),tt(t.rels,2,o,Ve.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Le(i,o,Z2(e.Props)),s.extprops.push(o),tt(t.rels,3,o,Ve.EXT_PROPS),e.Custprops!==e.Props&&_t(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Le(i,o,q2(e.Custprops)),s.custprops.push(o),tt(t.rels,4,o,Ve.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,Le(i,o,m7(a-1,o,t,e,u)),s.sheets.push(o),tt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ve.WS[0])}if(h){var f=h["!comments"],p=!1,g="";f&&f.length>0&&(g="xl/comments"+a+"."+r,Le(i,g,C7(f,g)),s.comments.push(g),tt(u,-1,"../comments"+a+"."+r,Ve.CMNT),p=!0),h["!legacy"]&&p&&Le(i,"xl/drawings/vmlDrawing"+a+".vml",Dk(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Le(i,Ml(o),No(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Le(i,o,x7(t.Strings,o,t)),s.strs.push(o),tt(t.wbrels,-1,"sharedStrings."+r,Ve.SST)),o="xl/workbook."+r,Le(i,o,p7(e,o)),s.workbooks.push(o),tt(t.rels,1,o,Ve.WB),o="xl/theme/theme1.xml",Le(i,o,Vp(e.Themes,t)),s.themes.push(o),tt(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),o="xl/styles."+r,Le(i,o,v7(e,o,t)),s.styles.push(o),tt(t.wbrels,-1,"styles."+r,Ve.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Le(i,o,e.vbaraw),s.vba.push(o),tt(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),o="xl/metadata."+r,Le(i,o,w7(o)),s.metadata.push(o),tt(t.wbrels,-1,"metadata."+r,Ve.XLMETA),Le(i,"[Content_Types].xml",j2(s,t)),Le(i,"_rels/.rels",No(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",No(t.wbrels)),delete t.revssf,delete t.ssf,i}function V9(e,t){Eo=1024,e&&!e.SSF&&(e.SSF=pt(Re)),e&&e.SSF&&(ua(),ed(e.SSF),t.revssf=rd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Pk.indexOf(t.bookType)>-1,s=Mp();Qp(t=t||{});var i=yp(),o="",a=0;if(t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Le(i,o,X2(e.Props,t)),s.coreprops.push(o),tt(t.rels,2,o,Ve.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Le(i,o,Z2(e.Props)),s.extprops.push(o),tt(t.rels,3,o,Ve.EXT_PROPS),e.Custprops!==e.Props&&_t(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Le(i,o,q2(e.Custprops)),s.custprops.push(o),tt(t.rels,4,o,Ve.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var h={"!id":{}},d=e.Sheets[e.SheetNames[a-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,Le(i,o,zk(a-1,t,e,h)),s.sheets.push(o),tt(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Ve.WS[0])}if(d){var p=d["!comments"],g=!1,m="";if(p&&p.length>0){var v=!1;p.forEach(function(C){C[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+a+"."+r,Le(i,m,X5(p,u,t)),s.threadedcomments.push(m),tt(h,-1,"../threadedComments/threadedComment"+a+"."+r,Ve.TCMNT)),m="xl/comments"+a+"."+r,Le(i,m,Ak(p)),s.comments.push(m),tt(h,-1,"../comments"+a+"."+r,Ve.CMNT),g=!0}d["!legacy"]&&g&&Le(i,"xl/drawings/vmlDrawing"+a+".vml",Dk(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Le(i,Ml(o),No(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Le(i,o,xk(t.Strings,t)),s.strs.push(o),tt(t.wbrels,-1,"sharedStrings."+r,Ve.SST)),o="xl/workbook."+r,Le(i,o,Xk(e)),s.workbooks.push(o),tt(t.rels,1,o,Ve.WB),o="xl/theme/theme1.xml",Le(i,o,Vp(e.Themes,t)),s.themes.push(o),tt(t.wbrels,-1,"theme/theme1.xml",Ve.THEME),o="xl/styles."+r,Le(i,o,Fk(e,t)),s.styles.push(o),tt(t.wbrels,-1,"styles."+r,Ve.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Le(i,o,e.vbaraw),s.vba.push(o),tt(t.wbrels,-1,"vbaProject.bin",Ve.VBA)),o="xl/metadata."+r,Le(i,o,_k()),s.metadata.push(o),tt(t.wbrels,-1,"metadata."+r,Ve.XLMETA),u.length>1&&(o="xl/persons/person.xml",Le(i,o,Q5(u)),s.people.push(o),tt(t.wbrels,-1,"persons/person.xml",Ve.PEOPLE)),Le(i,"[Content_Types].xml",j2(s,t)),Le(i,"_rels/.rels",No(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",No(t.wbrels)),delete t.revssf,delete t.ssf,i}function Zp(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function G9(e,t){return Fe.find(e,"EncryptedPackage")?B9(e,t):qk(e,t)}function z9(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),r=w2(n,s),N9(r,s)}function ob(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return j0(e.slice(r),t);default:break e}return Zo.to_workbook(e,t)}function U9(e,t){var r="",n=Zp(e,t);switch(t.type){case"base64":r=Qr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Wi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=it(r)),t.type="binary",ob(r,t)}function j9(e,t){var r=e;return t.type=="base64"&&(r=Qr(r)),r=Is.utils.decode(1200,r.slice(2),"str"),t.type="binary",ob(r,t)}function $9(e){return e.match(/[^\x00-\x7F]/)?$n(e):e}function kf(e,t,r,n){return n?(r.type="string",Zo.to_workbook(e,r)):Zo.to_workbook(t,r)}function X0(e,t){mp();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return X0(new Uint8Array(e),(r=pt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ho={},r.dateNF&&(Ho.dateNF=r.dateNF),r.type||(r.type=Ne&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ne?"buffer":"binary",n=VO(e),typeof Uint8Array<"u"&&!Ne&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=$9(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=pt(r),r.type="array",X0(vp(n),r)}switch((s=Zp(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return G9(Fe.read(n,r),r);break;case 9:if(s[1]<=8)return qk(n,r);break;case 60:return j0(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Z8(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return mk.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?z9(n,r):kf(e,n,r,i);case 239:return s[3]===60?j0(n,r):kf(e,n,r,i);case 255:if(s[1]===254)return j9(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Di.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Di.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return U0.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return kk.to_workbook(n,r);break;case 10:case 13:case 32:return U9(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Q8.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?U0.to_workbook(n,r):kf(e,n,r,i)}function ab(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return tc(t.file,Fe.write(e,{type:Ne?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Fe.write(e,t)}function K9(e,t){var r=pt(t||{}),n=H9(e,r);return X9(n,r)}function X9(e,t){var r={},n=Ne?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Fe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Jh(s))}return t.password&&typeof encrypt_agile<"u"?ab(encrypt_agile(s,t.password),t):t.type==="file"?tc(t.file,s):t.type=="string"?it(s):s}function Y9(e,t){var r=t||{},n=$7(e,r);return ab(n,r)}function Hn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Dl($n(n));case"binary":return $n(n);case"string":return e;case"file":return tc(t.file,n,"utf8");case"buffer":return Ne?ys(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Hn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Q9(e,t){switch(t.type){case"base64":return Dl(e);case"binary":return e;case"string":return e;case"file":return tc(t.file,e,"binary");case"buffer":return Ne?ys(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function jc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Dl(r):t.type=="string"?it(r):r;case"file":return tc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function lb(e,t){mp(),GG(e);var r=pt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=lb(e,r);return r.type="array",Jh(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Hn(H7(e,r),r);case"slk":case"sylk":return Hn(pk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Hn(eb(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Q9(cb(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Hn(qp(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Hn(mk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return jc(U0.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Hn(Zo.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Hn(kk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Hn(vk.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Hn(sb(e,r),r);case"wk1":return jc(Di.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return jc(Di.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jc(Jk(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Y9(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return K9(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Z9(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function q9(e,t,r){var n=r||{};return n.type="file",n.file=t,Z9(n),lb(e,n)}function J9(e,t,r,n,s,i,o,a){var l=It(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[r][f]:e[n[f]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;i[f]!=null&&(d[i[f]]=c);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[f]!=null){if(g==null)if(p.t=="e"&&g===null)d[i[f]]=null;else if(c!==void 0)d[i[f]]=c;else if(u&&g===null)d[i[f]]=null;else continue;else d[i[f]]=u&&(p.t!=="n"||p.t==="n"&&a.rawNumbers!==!1)?g:xs(p,g,a);g!=null&&(h=!1)}}return{row:d,isempty:h}}function yh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Ye(u);break;case"number":l=Ye(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=It(l.s.r),d=[],f=[],p=0,g=0,m=Array.isArray(e),v=l.s.r,C=0,x={};m&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],k=c.skipHidden&&e["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(w[C]||{}).hidden)switch(d[C]=St(C),r=m?e[v][C]:e[d[C]+h],n){case 1:i[C]=C-l.s.c;break;case 2:i[C]=d[C];break;case 3:i[C]=c.header[C-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=xs(r,null,c),g=x[o]||0,!g)x[o]=1;else{do a=o+"_"+g++;while(x[a]);x[o]=g,x[a]=1}i[C]=a}for(v=l.s.r+s;v<=l.e.r;++v)if(!(k[v]||{}).hidden){var E=J9(e,l,v,d,n,i,m,c);(E.isempty===!1||(n===1?c.blankrows!==!1:!!c.blankrows))&&(f[p++]=E.row)}return f.length=p,f}var Dx=/"/g;function ez(e,t,r,n,s,i,o,a){for(var l=!0,c=[],u="",h=It(r),d=t.s.c;d<=t.e.c;++d)if(!!n[d]){var f=a.dense?(e[r]||[])[d]:e[n[d]+h];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(a.rawNumbers&&f.t=="n"?f.v:xs(f,null,a));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===s||g===i||g===34||a.forceQuotes){u='"'+u.replace(Dx,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(Dx,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function qp(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var s=Ye(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(d[p]||{}).hidden||(h[p]=St(p));for(var g=0,m=s.s.r;m<=s.e.r;++m)(f[m]||{}).hidden||(u=ez(e,s,m,h,o,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?a:"")+u)));return delete n.dense,r.join("")}function cb(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=qp(e,t);return r}function tz(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Ye(e["!ref"]),i="",o=[],a,l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=St(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=It(u),a=s.s.c;a<=s.e.c;++a)if(t=o[a]+i,r=c?(e[u]||[])[a]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function ub(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},o=0,a=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?kt(n.origin):n.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+s}};if(i["!ref"]){var h=Ye(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var d=n.header||[],f=0;t.forEach(function(g,m){_t(g).forEach(function(v){(f=d.indexOf(v))==-1&&(d[f=d.length]=v);var C=g[v],x="z",w="",k=_e({c:a+f,r:o+m+s});c=Gl(i,k),C&&typeof C=="object"&&!(C instanceof Date)?i[k]=C:(typeof C=="number"?x="n":typeof C=="boolean"?x="b":typeof C=="string"?x="s":C instanceof Date?(x="d",n.cellDates||(x="n",C=$t(C)),w=n.dateNF||Re[14]):C===null&&n.nullError&&(x="e",C=0),c?(c.t=x,c.v=C,delete c.w,delete c.R,w&&(c.z=w)):i[k]=c={t:x,v:C},w&&(c.z=w))})}),u.e.c=Math.max(u.e.c,a+d.length-1);var p=It(o);if(s)for(f=0;f<d.length;++f)i[St(f+a)+p]={t:"s",v:d[f]};return i["!ref"]=Ie(u),i}function rz(e,t){return ub(null,e,t)}function Gl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=kt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Gl(e,_e(t)):Gl(e,_e({r:t,c:r||0}))}function nz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Jp(){return{SheetNames:[],Sheets:{}}}function em(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(Kk(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function sz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=nz(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function iz(e,t){return e.z=t,e}function hb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function oz(e,t,r){return hb(e,"#"+t,r)}function az(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function lz(e,t,r,n){for(var s=typeof t!="string"?t:Ye(t),i=typeof t=="string"?t:Ie(t),o=s.s.r;o<=s.e.r;++o)for(var a=s.s.c;a<=s.e.c;++a){var l=Gl(e,o,a);l.t="n",l.F=i,delete l.v,o==s.s.r&&a==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var vu={encode_col:St,encode_row:It,encode_cell:_e,encode_range:Ie,decode_col:_p,decode_row:Rp,split_cell:xN,decode_cell:kt,decode_range:Wr,format_cell:xs,sheet_add_aoa:B2,sheet_add_json:ub,sheet_add_dom:tb,aoa_to_sheet:ha,json_to_sheet:rz,table_to_sheet:rb,table_to_book:g9,sheet_to_csv:qp,sheet_to_txt:cb,sheet_to_json:yh,sheet_to_html:eb,sheet_to_formulae:tz,sheet_to_row_object_array:yh,sheet_get_cell:Gl,book_new:Jp,book_append_sheet:em,book_set_sheet_visibility:sz,cell_set_number_format:iz,cell_set_hyperlink:hb,cell_set_internal_link:oz,cell_add_comment:az,sheet_set_array_formula:lz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const db=({columns:e=[],rows:t=[]})=>{const[r,n]=S.exports.useState(""),[s,i]=S.exports.useState(10),o=S.exports.useRef(null),a=S.exports.useMemo(()=>e.map(d=>({headerName:d.title||d.field,field:d.field,width:d.width,minWidth:120,sortable:!0,filter:!0,resizable:!0})),[e]),l=S.exports.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0}),[]),c=S.exports.useCallback(()=>{o.current&&(o.current.api.setDomLayout("normal"),o.current.api.setQuickFilter(r))},[r]),u=d=>{n(d),o.current&&o.current.api.setQuickFilter(d)},h=()=>{var g;const d=[];(g=o.current)==null||g.api.forEachNodeAfterFilterAndSort(m=>{m.data&&d.push(m.data)});const f=vu.json_to_sheet(d),p=vu.book_new();vu.book_append_sheet(p,f,"Dane"),q9(p,`tabela_${Date.now()}.xlsx`)};return!t||t.length===0?ge("div",{className:"card",children:ge("p",{children:"Brak danych do wy\u015Bwietlenia"})}):$e("div",{className:"card grid-card",style:{marginTop:"20px"},children:[$e("div",{className:"toolbar",style:{display:"flex",gap:"8px",alignItems:"center",margin:"12px 8px"},children:[ge("div",{style:{flex:1},children:ge("input",{placeholder:"Szukaj w tabeli\u2026",value:r,onChange:d=>u(d.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"8px",border:"1px solid #E0E0E0",fontSize:"14px"},onFocus:d=>d.currentTarget.style.borderColor="#E37239",onBlur:d=>d.currentTarget.style.borderColor="#E0E0E0"})}),ge("select",{value:s,onChange:d=>{var p;const f=Number(d.target.value);i(f),(p=o.current)==null||p.api.paginationSetPageSize(f)},style:{padding:"8px 10px",borderRadius:"8px",border:"1px solid #E0E0E0",color:"#254252"},children:[5,10,20,50].map(d=>$e("option",{value:d,children:[d,"/stron\u0119"]},d))}),ge("button",{onClick:h,style:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #E37239",background:"#FFF4ED",color:"#E37239",fontWeight:600,cursor:"pointer"},onMouseEnter:d=>{d.currentTarget.style.background="#FFE8D9"},onMouseLeave:d=>{d.currentTarget.style.background="#FFF4ED"},children:"Eksport do Excel"})]}),ge("div",{className:"ag-theme-quartz",style:{width:"100%",height:520},children:ge(lO,{ref:o,rowData:t,columnDefs:a,defaultColDef:l,rowSelection:"single",animateRows:!0,pagination:!0,paginationPageSize:s,suppressRowClickSelection:!0,onGridReady:c})}),ge("div",{style:{padding:"8px 12px",color:"#656565"},children:"Sortuj, filtruj, przeci\u0105gaj kolumny. Eksport dzia\u0142a na danych po filtrze i sortowaniu."})]})};function cz({file:e}){const[t,r]=S.exports.useState(null),[n,s]=S.exports.useState(null),[i,o]=S.exports.useState(null);return S.exports.useEffect(()=>{let l=!1;async function c(){try{const u=await fetch(e);if(!u.ok)throw new Error(`HTTP ${u.status}`);const h=await u.arrayBuffer(),d=X0(h,{type:"array",cellStyles:!0}),f=d.SheetNames[0],p=d.Sheets[f],g=vu.sheet_to_json(p,{header:1,defval:"",raw:!1});if(!g.length)throw new Error("Pusty arkusz");const m=g[0].map((k,E)=>k==null||k===""?`Kolumna ${E+1}`:String(k)),v=g.slice(1).filter(k=>k.some(E=>E!==""&&E!=null)),C=m.map((k,E)=>{var R;const y=Math.max(((R=m[E])==null?void 0:R.toString().length)||0,...v.map(D=>{var N;return((N=D[E])==null?void 0:N.toString().length)||0}));return Math.min(Math.max(y*10+40,120),400)}),x=m.map((k,E)=>({field:k,title:k,width:C[E]})),w=v.map(k=>{const E={};return m.forEach((y,R)=>{var D;E[y]=(D=k[R])!=null?D:""}),E});l||(r(x),s(w))}catch(u){l||o((u==null?void 0:u.message)||"B\u0142\u0105d wczytywania pliku XLSX")}}return c(),()=>{l=!0}},[e]),S.exports.useMemo(()=>i?ge("div",{className:"card",children:$e("p",{children:["Nie uda\u0142o si\u0119 wczyta\u0107 excela: ",i]})}):!t||!n?ge("div",{className:"card",children:ge("p",{children:"\u0141adowanie arkusza\u2026"})}):ge(db,{columns:t,rows:n}),[t,n,i])}const uz=()=>{const{slug:e}=RT(),[t,r]=S.exports.useState(null),[n,s]=S.exports.useState(!0),[i,o]=S.exports.useState(null);return S.exports.useEffect(()=>{(async()=>{if(!e){o("No slug provided"),s(!1);return}try{const l=await oR(e);r(l)}catch{o("Failed to fetch post")}finally{s(!1)}})()},[e]),n?ge("div",{className:"container",children:ge("div",{children:"Loading..."})}):i?ge("div",{className:"container",children:ge("div",{children:i})}):t?$e("div",{className:"container",children:[$e("article",{className:"card",children:[ge("h1",{style:{marginTop:0},children:t.title}),ge("p",{style:{color:"#8aa0b4"},children:new Date(t.date).toLocaleDateString("pl-PL")}),ge("p",{children:t.content})]}),t.excel?ge(cz,{file:t.excel.file}):t.table?ge(db,{columns:t.table.columns,rows:t.table.rows}):null]}):ge("div",{className:"container",children:$e("div",{children:["Post not found. ",ge(So,{to:"/",children:"Go home"})]})})},hz=()=>$e("div",{className:"container",children:[$e("div",{style:{marginBottom:"32px"},children:[ge("h1",{style:{fontSize:"32px",marginBottom:"8px",color:"#254252"},children:"Edukacja"}),ge("p",{style:{color:"#666",fontSize:"16px",margin:0},children:"Materia\u0142y edukacyjne i przewodniki dotycz\u0105ce danych publicznych"})]}),$e("div",{className:"card",children:[ge("h2",{style:{color:"#254252",marginBottom:"16px"},children:"Jak korzysta\u0107 z portalu?"}),ge("p",{style:{lineHeight:"1.8",color:"#333"},children:"Portal Jawna Gdynia udost\u0119pnia interaktywne raporty i analizy danych publicznych Miasta Gdynia. Wszystkie tabele mo\u017Cna sortowa\u0107, filtrowa\u0107 i eksportowa\u0107 do formatu Excel."})]}),$e("div",{className:"card",children:[ge("h2",{style:{color:"#254252",marginBottom:"16px"},children:"Podstawowe funkcje tabel"}),$e("ul",{style:{lineHeight:"1.8",color:"#333"},children:[$e("li",{children:[ge("strong",{children:"Sortowanie"})," - kliknij nag\u0142\xF3wek kolumny, aby posortowa\u0107 dane"]}),$e("li",{children:[ge("strong",{children:"Filtrowanie"})," - u\u017Cyj ikon filtra w nag\u0142\xF3wkach kolumn"]}),$e("li",{children:[ge("strong",{children:"Wyszukiwanie"})," - wpisz fraz\u0119 w polu wyszukiwania nad tabel\u0105"]}),$e("li",{children:[ge("strong",{children:"Eksport"}),' - kliknij przycisk "Eksport do Excel" aby pobra\u0107 dane']}),$e("li",{children:[ge("strong",{children:"Paginacja"})," - prze\u0142\u0105czaj strony lub zmie\u0144 liczb\u0119 wierszy na stronie"]}),$e("li",{children:[ge("strong",{children:"Przeci\u0105ganie kolumn"})," - mo\u017Cesz zmieni\u0107 kolejno\u015B\u0107 kolumn"]})]})]}),$e("div",{className:"card",children:[ge("h2",{style:{color:"#254252",marginBottom:"16px"},children:"Dodatkowe zasoby"}),ge("p",{style:{lineHeight:"1.8",color:"#333"},children:"Wi\u0119cej informacji o danych publicznych i transparentno\u015Bci znajdziesz na stronie"})]})]});const dz=()=>ge("header",{className:"header",children:$e("div",{className:"header-container",children:[ge("div",{className:"brand",children:$e(So,{to:"/",style:{textDecoration:"none",color:"inherit",display:"flex",alignItems:"center",gap:"16px"},children:[ge("img",{src:"/logo.png",alt:"Logo",style:{height:"80px",width:"auto"}}),$e("div",{children:[ge("h1",{className:"site-title",children:"Jawna Gdynia"}),ge("p",{className:"site-subtitle",children:"Portal Otwartych Danych"})]})]})}),$e("nav",{className:"main-nav",children:[ge(So,{to:"/",className:"nav-link",children:"Raporty"}),$e("div",{className:"dropdown",children:[ge("button",{className:"nav-link dropdown-toggle",children:"Tabele"}),ge("div",{className:"dropdown-menu",children:ge(So,{to:"/post/raport-budzetu-2025",className:"dropdown-item",children:"Raport bud\u017Cetu 2025"})})]}),ge(So,{to:"/edukacja",className:"nav-link",children:"Edukacja"})]})]})}),fz=()=>$e(qw,{children:[ge(dz,{}),$e(jT,{children:[ge(su,{path:"/",element:ge(aR,{})}),ge(su,{path:"/post/:slug",element:ge(uz,{})}),ge(su,{path:"/edukacja",element:ge(hz,{})})]})]});jw(document.getElementById("root")).render(ge(ue.StrictMode,{children:ge(eR,{children:ge(fz,{})})}));
